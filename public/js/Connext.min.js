var JSON,MD5;if(!function(n){"use strict";var t=function(n,t){this.init(n,t)};t.prototype={constructor:t,init:function(t,i){var u=this,r;this.options=i;this.$element=n(t).on("click.dismiss.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").on("load",this.options.remote,function(){var t=n.Event("loaded");u.$element.trigger(t)});r=typeof this.options.manager=="function"?this.options.manager.call(this):this.options.manager;r=r.appendModal?r:n(r).modalmanager().data("modalmanager");r.appendModal(this)},toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=n.Event("show");this.isShown||(this.$element.trigger(t),t.isDefaultPrevented())||(this.escape(),this.tab(),this.options.loading&&this.loading())},hide:function(t){(t&&t.preventDefault(),t=n.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented())&&(this.isShown=!1,this.escape(),this.tab(),this.isLoading&&this.loading(),n(document).off("focusin.modal"),this.$element.removeClass("in").removeClass("animated").removeClass(this.options.attentionAnimation).removeClass("modal-overflow").attr("aria-hidden",!0),n.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},layout:function(){var i=this.options.height?"height":"max-height",r=this.options.height||this.options.maxHeight,t,u;this.options.width?(this.$element.css("width",this.options.width),t=this,this.$element.css("margin-left",function(){return/%/ig.test(t.options.width)?-(parseInt(t.options.width)/2)+"%":-(n(this).width()/2)+"px"})):(this.$element.css("width",""),this.$element.css("margin-left",""));this.$element.find(".modal-body").css("overflow","").css(i,"");r&&this.$element.find(".modal-body").css("overflow","auto").css(i,r);u=n(window).height()-10<this.$element.height();u||this.options.modalOverflow?this.$element.css("margin-top",0).addClass("modal-overflow"):this.$element.css("margin-top",0-this.$element.height()/2).removeClass("modal-overflow")},tab:function(){var t=this;if(this.isShown&&this.options.consumeTab)this.$element.on("keydown.tabindex.modal","[data-tabindex]",function(i){var r,f,u;i.keyCode&&i.keyCode==9&&(r=[],f=Number(n(this).data("tabindex")),t.$element.find("[data-tabindex]:enabled:visible:not([readonly])").each(function(){r.push(Number(n(this).data("tabindex")))}),r.sort(function(n,t){return n-t}),u=n.inArray(f,r),i.shiftKey?u==0?t.$element.find("[data-tabindex="+r[r.length-1]+"]").focus():t.$element.find("[data-tabindex="+r[u-1]+"]").focus():u<r.length-1?t.$element.find("[data-tabindex="+r[u+1]+"]").focus():t.$element.find("[data-tabindex="+r[0]+"]").focus(),i.preventDefault())});else this.isShown||this.$element.off("keydown.tabindex.modal")},escape:function(){var n=this;if(this.isShown&&this.options.keyboard){this.$element.attr("tabindex")||this.$element.attr("tabindex",-1);this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&n.hide()})}else this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,i=setTimeout(function(){t.$element.off(n.support.transition.end);t.hideModal()},500);this.$element.one(n.support.transition.end,function(){clearTimeout(i);t.hideModal()})},hideModal:function(){var n=this.options.height?"height":"max-height",t=this.options.height||this.options.maxHeight;t&&this.$element.find(".modal-body").css("overflow","").css(n,"");this.$element.hide().trigger("hidden")},removeLoading:function(){this.$loading.remove();this.$loading=null;this.isLoading=!1},loading:function(t){var i,r,u;t=t||function(){};i=this.$element.hasClass("fade")?"fade":"";this.isLoading?this.isLoading&&this.$loading?(this.$loading.removeClass("in"),u=this,n.support.transition&&this.$element.hasClass("fade")?this.$loading.one(n.support.transition.end,function(){u.removeLoading()}):u.removeLoading()):t&&t(this.isLoading):(r=n.support.transition&&i,this.$loading=n('<div class="loading-mask '+i+'">').append(this.options.spinner).appendTo(this.$element),r&&this.$loading[0].offsetWidth,this.$loading.addClass("in"),this.isLoading=!0,r?this.$loading.one(n.support.transition.end,t):t())},focus:function(){var n=this.$element.find(this.options.focusOn);n=n.length?n:this.$element;n.focus()},attention:function(){if(this.options.attentionAnimation){this.$element.removeClass("animated").removeClass(this.options.attentionAnimation);var n=this;setTimeout(function(){n.$element.addClass("animated").addClass(n.options.attentionAnimation)},0)}this.focus()},destroy:function(){var t=n.Event("destroy");(this.$element.trigger(t),t.isDefaultPrevented())||(this.$element.off(".connextmodal").removeData("modal").removeClass("in").attr("aria-hidden",!0),this.$parent!==this.$element.parent()?this.$element.appendTo(this.$parent):this.$parent.length||(this.$element.remove(),this.$element=null),this.$element.trigger("destroyed"))}};n.fn.connextmodal=function(i,r){return this.each(function(){var f=n(this),u=f.data("modal"),e=n.extend({},n.fn.connextmodal.defaults,f.data(),typeof i=="object"&&i);u||f.data("modal",u=new t(this,e));typeof i=="string"?u[i].apply(u,[].concat(r)):e.show&&u.show()})};n.fn.connextmodal.defaults={keyboard:!0,backdrop:!0,loading:!1,show:!0,width:null,height:null,maxHeight:null,modalOverflow:!1,consumeTab:!0,focusOn:null,replace:!1,resize:!1,attentionAnimation:!1,manager:"body",spinner:'<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"><\/div><\/div><\/div>',backdropTemplate:'<div class="connext-modal-backdrop" />'};n.fn.connextmodal.Constructor=t;n(function(){n(document).off("click.modal").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var i=n(this),r=i.attr("href"),u=n(i.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),f=u.data("modal")?"toggle":n.extend({remote:!/#/.test(r)&&r},u.data(),i.data());t.preventDefault();u.connextmodal(f).one("hide",function(){i.focus()})})})}(window.jQuery),!function(n){"use strict";function t(n){return function(t){if(t&&this===t.target)return n.apply(this,arguments)}}var r=function(n,t){this.init(n,t)},i;r.prototype={constructor:r,init:function(t,i){if(this.$element=n(t),this.options=n.extend({},n.fn.modalmanager.defaults,this.$element.data(),typeof i=="object"&&i),this.stack=[],this.backdropCount=0,this.options.resize){var r,u=this;n(window).on("resize.modal",function(){r&&clearTimeout(r);r=setTimeout(function(){for(var n=0;n<u.stack.length;n++)u.stack[n].isShown&&u.stack[n].layout()},10)})}},createModal:function(t,i){n(t).modal(n.extend({manager:this},i))},appendModal:function(i){this.stack.push(i);var r=this;i.$element.on("show.modalmanager",t(function(){var t=function(){i.isShown=!0;var t=n.support.transition&&i.$element.hasClass("fade");r.$element.toggleClass("modal-open",r.hasOpenModal()).toggleClass("page-overflow",n(window).height()<r.$element.height());i.$parent=i.$element.parent();i.$container=r.createContainer(i);i.$element.appendTo(i.$container);r.backdrop(i,function(){i.$element.show();t&&i.$element[0].offsetWidth;i.layout();i.$element.addClass("in").attr("aria-hidden",!1);var u=function(){r.setFocus();i.$element.trigger("shown")};t?i.$element.one(n.support.transition.end,u):u()})};i.options.replace?r.replace(t):t()}));i.$element.on("hidden.modalmanager",t(function(){if(r.backdrop(i),r.destroyModal(i),i.$element.parent().length)if(i.$backdrop){var t=n.support.transition&&i.$element.hasClass("fade");t&&i.$element[0].offsetWidth;n.support.transition&&i.$element.hasClass("fade")?i.$backdrop.one(n.support.transition.end,function(){i.destroy()}):i.destroy()}else i.destroy();else r.destroyModal(i)}));i.$element.on("destroyed.modalmanager",t(function(){r.destroyModal(i)}))},getOpenModals:function(){for(var t=[],n=0;n<this.stack.length;n++)this.stack[n].isShown&&t.push(this.stack[n]);return t},hasOpenModal:function(){return this.getOpenModals().length>0},setFocus:function(){for(var t,n=0;n<this.stack.length;n++)this.stack[n].isShown&&(t=this.stack[n]);t&&t.focus()},destroyModal:function(n){n.$element.off(".modalmanager");n.$backdrop&&this.removeBackdrop(n);this.stack.splice(this.getIndexOfModal(n),1);var t=this.hasOpenModal();this.$element.toggleClass("modal-open",t);t||this.$element.removeClass("page-overflow");this.removeContainer(n);this.setFocus()},getModalAt:function(n){return this.stack[n]},getIndexOfModal:function(n){for(var t=0;t<this.stack.length;t++)if(n===this.stack[t])return t},replace:function(i){for(var r,u=0;u<this.stack.length;u++)this.stack[u].isShown&&(r=this.stack[u]);r?(this.$backdropHandle=r.$backdrop,r.$backdrop=null,i&&r.$element.one("hidden",t(n.proxy(i,this))),r.hide()):i&&i()},removeBackdrop:function(n){n.$backdrop.remove();n.$backdrop=null},createBackdrop:function(t,i){var r;return this.$backdropHandle?(r=this.$backdropHandle,r.off(".modalmanager"),this.$backdropHandle=null,this.isLoading&&this.removeSpinner()):r=n(i).addClass(t).appendTo(this.$element),r},removeContainer:function(n){n.$container.remove();n.$container=null},createContainer:function(r){var u;if(u=n('<div class="modal-scrollable">').css("z-index",i("modal",this.getOpenModals().length)).appendTo(this.$element),r&&r.options.backdrop!="static")u.on("click.modal",t(function(){r.hide()}));else if(r)u.on("click.modal",t(function(){r.attention()}));return u},backdrop:function(t,r){var e=t.$element.hasClass("fade")?"fade":"",o=t.options.backdrop&&this.backdropCount<this.options.backdropLimit,u,f;t.isShown&&o?(u=n.support.transition&&e&&!this.$backdropHandle,t.$backdrop=this.createBackdrop(e,t.options.backdropTemplate),t.$backdrop.css("z-index",i("backdrop",this.getOpenModals().length)),u&&t.$backdrop[0].offsetWidth,t.$backdrop.addClass("in"),this.backdropCount+=1,u?t.$backdrop.one(n.support.transition.end,r):r()):!t.isShown&&t.$backdrop?(t.$backdrop.removeClass("in"),this.backdropCount-=1,f=this,n.support.transition&&t.$element.hasClass("fade")?t.$backdrop.one(n.support.transition.end,function(){f.removeBackdrop(t)}):f.removeBackdrop(t)):r&&r()},removeSpinner:function(){this.$spinner&&this.$spinner.remove();this.$spinner=null;this.isLoading=!1},removeLoading:function(){this.$backdropHandle&&this.$backdropHandle.remove();this.$backdropHandle=null;this.removeSpinner()},loading:function(t){var r,f,u;t=t||function(){};this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",n(window).height()<this.$element.height());this.isLoading?this.isLoading&&this.$backdropHandle?(this.$backdropHandle.removeClass("in"),u=this,n.support.transition?this.$backdropHandle.one(n.support.transition.end,function(){u.removeLoading()}):u.removeLoading()):t&&t(this.isLoading):(this.$backdropHandle=this.createBackdrop("fade",this.options.backdropTemplate),this.$backdropHandle[0].offsetWidth,r=this.getOpenModals(),this.$backdropHandle.css("z-index",i("backdrop",r.length+1)).addClass("in"),f=n(this.options.spinner).css("z-index",i("modal",r.length+1)).appendTo(this.$element).addClass("in"),this.$spinner=n(this.createContainer()).append(f).on("click.modalmanager",n.proxy(this.loading,this)),this.isLoading=!0,n.support.transition?this.$backdropHandle.one(n.support.transition.end,t):t())}};i=function(){var i,t={};return function(r,u){if(typeof i=="undefined"){var f=n('<div class="modal hide" />').appendTo("body"),e=n('<div class="connext-modal-backdrop hide" />').appendTo("body");t.modal=+f.css("z-index");t.backdrop=+e.css("z-index");i=t.modal-t.backdrop;f.remove();e.remove();e=f=null}return t[r]+i*u}}();n.fn.modalmanager=function(t,i){return this.each(function(){var f=n(this),u=f.data("modalmanager");u||f.data("modalmanager",u=new r(this,t));typeof t=="string"&&u[t].apply(u,[].concat(i))})};n.fn.modalmanager.defaults={backdropLimit:999,resize:!0,spinner:'<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"><\/div><\/div><\/div>',backdropTemplate:'<div class="connext-modal-backdrop" />'};n.fn.modalmanager.Constructor=r;n(function(){n(document).off("show.bs.modal").off("hidden.bs.modal")})}(jQuery),typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function(n){"use strict";var t=n.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1||t[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4");}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.affix"),f=typeof i=="object"&&i;r||u.data("bs.affix",r=new t(this,f));typeof i=="string"&&r[i]()})}var t=function(i,r){this.options=n.extend({},t.DEFAULTS,r);this.$target=n(this.options.target).on("scroll.bs.affix.data-api",n.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",n.proxy(this.checkPositionWithEventLoop,this));this.$element=n(i);this.affixed=null;this.unpin=null;this.pinnedOffset=null;this.checkPosition()},r;t.VERSION="3.3.7";t.RESET="affix affix-top affix-bottom";t.DEFAULTS={offset:0,target:window};t.prototype.getState=function(n,t,i,r){var u=this.$target.scrollTop(),f=this.$element.offset(),e=this.$target.height();if(i!=null&&this.affixed=="top")return u<i?"top":!1;if(this.affixed=="bottom")return i!=null?u+this.unpin<=f.top?!1:"bottom":u+e<=n-r?!1:"bottom";var o=this.affixed==null,s=o?u:f.top,h=o?e:t;return i!=null&&u<=i?"top":r!=null&&s+h>=n-r?"bottom":!1};t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var n=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-n};t.prototype.checkPositionWithEventLoop=function(){setTimeout(n.proxy(this.checkPosition,this),1)};t.prototype.checkPosition=function(){var i,e,o;if(this.$element.is(":visible")){var s=this.$element.height(),r=this.options.offset,f=r.top,u=r.bottom,h=Math.max(n(document).height(),n(document.body).height());if(typeof r!="object"&&(u=f=r),typeof f=="function"&&(f=r.top(this.$element)),typeof u=="function"&&(u=r.bottom(this.$element)),i=this.getState(h,s,f,u),this.affixed!=i){if(this.unpin!=null&&this.$element.css("top",""),e="affix"+(i?"-"+i:""),o=n.Event(e+".bs.affix"),this.$element.trigger(o),o.isDefaultPrevented())return;this.affixed=i;this.unpin=i=="bottom"?this.getPinnedOffset():null;this.$element.removeClass(t.RESET).addClass(e).trigger(e.replace("affix","affixed")+".bs.affix")}i=="bottom"&&this.$element.offset({top:h-s-u})}};r=n.fn.affix;n.fn.affix=i;n.fn.affix.Constructor=t;n.fn.affix.noConflict=function(){return n.fn.affix=r,this};n(window).on("load",function(){n('[data-spy="affix"]').each(function(){var r=n(this),t=r.data();t.offset=t.offset||{};t.offsetBottom!=null&&(t.offset.bottom=t.offsetBottom);t.offsetTop!=null&&(t.offset.top=t.offsetTop);i.call(r,t)})})}(jQuery),function(){var y=this,at=y.__,s={},r=Array.prototype,g=Object.prototype,vt=Function.prototype,nt=r.push,t=r.slice,u=r.concat,e=g.toString,yt=g.hasOwnProperty,tt=r.forEach,it=r.map,rt=r.reduce,ut=r.reduceRight,ft=r.filter,et=r.every,ot=r.some,h=r.indexOf,st=r.lastIndexOf,pt=Array.isArray,ht=Object.keys,p=vt.bind,n=function(t){if(t instanceof n)return t;if(!(this instanceof n))return new n(t);this.__wrapped=t},i,w,b,o,c,k,l,a,f,ct,lt,v;typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=n),exports.__=n):y.__=n;n.VERSION="1.6.0";i=n.each=n.forEach=function(t,i,r){var e,u,f;if(t==null)return t;if(tt&&t.forEach===tt)t.forEach(i,r);else if(t.length===+t.length){for(u=0,f=t.length;u<f;u++)if(i.call(r,t[u],u,t)===s)return}else for(e=n.keys(t),u=0,f=e.length;u<f;u++)if(i.call(r,t[e[u]],e[u],t)===s)return;return t};n.map=n.collect=function(n,t,r){var u=[];return n==null?u:it&&n.map===it?n.map(t,r):(i(n,function(n,i,f){u.push(t.call(r,n,i,f))}),u)};w="Reduce of empty array with no initial value";n.reduce=n.foldl=n.inject=function(t,r,u,f){var e=arguments.length>2;if(t==null&&(t=[]),rt&&t.reduce===rt)return f&&(r=n.bind(r,f)),e?t.reduce(r,u):t.reduce(r);if(i(t,function(n,t,i){e?u=r.call(f,u,n,t,i):(u=n,e=!0)}),!e)throw new TypeError(w);return u};n.reduceRight=n.foldr=function(t,r,u,f){var o=arguments.length>2,e,s;if(t==null&&(t=[]),ut&&t.reduceRight===ut)return f&&(r=n.bind(r,f)),o?t.reduceRight(r,u):t.reduceRight(r);if(e=t.length,e!==+e&&(s=n.keys(t),e=s.length),i(t,function(n,i,h){i=s?s[--e]:--e;o?u=r.call(f,u,t[i],i,h):(u=t[i],o=!0)}),!o)throw new TypeError(w);return u};n.find=n.detect=function(n,t,i){var r;return b(n,function(n,u,f){if(t.call(i,n,u,f))return r=n,!0}),r};n.filter=n.select=function(n,t,r){var u=[];return n==null?u:ft&&n.filter===ft?n.filter(t,r):(i(n,function(n,i,f){t.call(r,n,i,f)&&u.push(n)}),u)};n.reject=function(t,i,r){return n.filter(t,function(n,t,u){return!i.call(r,n,t,u)},r)};n.every=n.all=function(t,r,u){r||(r=n.identity);var f=!0;return t==null?f:et&&t.every===et?t.every(r,u):(i(t,function(n,t,i){if(!(f=f&&r.call(u,n,t,i)))return s}),!!f)};b=n.some=n.any=function(t,r,u){r||(r=n.identity);var f=!1;return t==null?f:ot&&t.some===ot?t.some(r,u):(i(t,function(n,t,i){if(f||(f=r.call(u,n,t,i)))return s}),!!f)};n.contains=n.include=function(n,t){return n==null?!1:h&&n.indexOf===h?n.indexOf(t)!=-1:b(n,function(n){return n===t})};n.invoke=function(i,r){var u=t.call(arguments,2),f=n.isFunction(r);return n.map(i,function(n){return(f?r:n[r]).apply(n,u)})};n.pluck=function(t,i){return n.map(t,n.property(i))};n.where=function(t,i){return n.filter(t,n.matches(i))};n.findWhere=function(t,i){return n.find(t,n.matches(i))};n.max=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var f=-Infinity,e=-Infinity;return i(t,function(n,t,i){var o=r?r.call(u,n,t,i):n;o>e&&(f=n,e=o)}),f};n.min=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var f=Infinity,e=Infinity;return i(t,function(n,t,i){var o=r?r.call(u,n,t,i):n;o<e&&(f=n,e=o)}),f};n.shuffle=function(t){var u,f=0,r=[];return i(t,function(t){u=n.random(f++);r[f-1]=r[u];r[u]=t}),r};n.sample=function(t,i,r){return i==null||r?(t.length!==+t.length&&(t=n.values(t)),t[n.random(t.length-1)]):n.shuffle(t).slice(0,Math.max(0,i))};o=function(t){return t==null?n.identity:n.isFunction(t)?t:n.property(t)};n.sortBy=function(t,i,r){return i=o(i),n.pluck(n.map(t,function(n,t,u){return{value:n,index:t,criteria:i.call(r,n,t,u)}}).sort(function(n,t){var i=n.criteria,r=t.criteria;if(i!==r){if(i>r||i===void 0)return 1;if(i<r||r===void 0)return-1}return n.index-t.index}),"value")};c=function(n){return function(t,r,u){var f={};return r=o(r),i(t,function(i,e){var o=r.call(u,i,e,t);n(f,o,i)}),f}};n.groupBy=c(function(t,i,r){n.has(t,i)?t[i].push(r):t[i]=[r]});n.indexBy=c(function(n,t,i){n[t]=i});n.countBy=c(function(t,i){n.has(t,i)?t[i]++:t[i]=1});n.sortedIndex=function(n,t,i,r){var f;i=o(i);for(var s=i.call(r,t),u=0,e=n.length;u<e;)f=u+e>>>1,i.call(r,n[f])<s?u=f+1:e=f;return u};n.toArray=function(i){return i?n.isArray(i)?t.call(i):i.length===+i.length?n.map(i,n.identity):n.values(i):[]};n.size=function(t){return t==null?0:t.length===+t.length?t.length:n.keys(t).length};n.first=n.head=n.take=function(n,i,r){if(n!=null)return i==null||r?n[0]:i<0?[]:t.call(n,0,i)};n.initial=function(n,i,r){return t.call(n,0,n.length-(i==null||r?1:i))};n.last=function(n,i,r){if(n!=null)return i==null||r?n[n.length-1]:t.call(n,Math.max(n.length-i,0))};n.rest=n.tail=n.drop=function(n,i,r){return t.call(n,i==null||r?1:i)};n.compact=function(t){return n.filter(t,n.identity)};k=function(t,r,f){return r&&n.every(t,n.isArray)?u.apply(f,t):(i(t,function(t){n.isArray(t)||n.isArguments(t)?r?nt.apply(f,t):k(t,r,f):f.push(t)}),f)};n.flatten=function(n,t){return k(n,t,[])};n.without=function(i){return n.difference(i,t.call(arguments,1))};n.partition=function(n,t,r){t=o(t);var u=[],f=[];return i(n,function(n){(t.call(r,n)?u:f).push(n)}),[u,f]};n.uniq=n.unique=function(t,r,u,f){n.isFunction(r)&&(f=u,u=r,r=!1);var s=u?n.map(t,u,f):t,o=[],e=[];return i(s,function(i,u){(r?u&&e[e.length-1]===i:n.contains(e,i))||(e.push(i),o.push(t[u]))}),o};n.union=function(){return n.uniq(n.flatten(arguments,!0))};n.intersection=function(i){var r=t.call(arguments,1);return n.filter(n.uniq(i),function(t){return n.every(r,function(i){return n.contains(i,t)})})};n.difference=function(i){var f=u.apply(r,t.call(arguments,1));return n.filter(i,function(t){return!n.contains(f,t)})};n.zip=function(){for(var i=n.max(n.pluck(arguments,"length").concat(0)),r=new Array(i),t=0;t<i;t++)r[t]=n.pluck(arguments,""+t);return r};n.object=function(n,t){var r,i,u;if(n==null)return{};for(r={},i=0,u=n.length;i<u;i++)t?r[n[i]]=t[i]:r[n[i][0]]=n[i][1];return r};n.indexOf=function(t,i,r){if(t==null)return-1;var u=0,f=t.length;if(r)if(typeof r=="number")u=r<0?Math.max(0,f+r):r;else return u=n.sortedIndex(t,i),t[u]===i?u:-1;if(h&&t.indexOf===h)return t.indexOf(i,r);for(;u<f;u++)if(t[u]===i)return u;return-1};n.lastIndexOf=function(n,t,i){var u,r;if(n==null)return-1;if(u=i!=null,st&&n.lastIndexOf===st)return u?n.lastIndexOf(t,i):n.lastIndexOf(t);for(r=u?i:n.length;r--;)if(n[r]===t)return r;return-1};n.range=function(n,t,i){arguments.length<=1&&(t=n||0,n=0);i=arguments[2]||1;for(var r=Math.max(Math.ceil((t-n)/i),0),u=0,f=new Array(r);u<r;)f[u++]=n,n+=i;return f};l=function(){};n.bind=function(i,r){var u,f;if(p&&i.bind===p)return p.apply(i,t.call(arguments,1));if(!n.isFunction(i))throw new TypeError;return u=t.call(arguments,2),f=function(){var e,n;return(this instanceof f)?(l.prototype=i.prototype,e=new l,l.prototype=null,n=i.apply(e,u.concat(t.call(arguments))),Object(n)===n)?n:e:i.apply(r,u.concat(t.call(arguments)))}};n.partial=function(i){var r=t.call(arguments,1);return function(){for(var f=0,t=r.slice(),u=0,e=t.length;u<e;u++)t[u]===n&&(t[u]=arguments[f++]);while(f<arguments.length)t.push(arguments[f++]);return i.apply(this,t)}};n.bindAll=function(r){var u=t.call(arguments,1);if(u.length===0)throw new Error("bindAll must be passed function names");return i(u,function(t){r[t]=n.bind(r[t],r)}),r};n.memoize=function(t,i){var r={};return i||(i=n.identity),function(){var u=i.apply(this,arguments);return n.has(r,u)?r[u]:r[u]=t.apply(this,arguments)}};n.delay=function(n,i){var r=t.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},i)};n.defer=function(i){return n.delay.apply(n,[i,1].concat(t.call(arguments,1)))};n.throttle=function(t,i,r){var u,f,s,e=null,o=0,h;return r||(r={}),h=function(){o=r.leading===!1?0:n.now();e=null;s=t.apply(u,f);u=f=null},function(){var c=n.now(),l;return o||r.leading!==!1||(o=c),l=i-(c-o),u=this,f=arguments,l<=0?(clearTimeout(e),e=null,o=c,s=t.apply(u,f),u=f=null):e||r.trailing===!1||(e=setTimeout(h,l)),s}};n.debounce=function(t,i,r){var u,f,e,s,o,h=function(){var c=n.now()-s;c<i?u=setTimeout(h,i-c):(u=null,r||(o=t.apply(e,f),e=f=null))};return function(){e=this;f=arguments;s=n.now();var c=r&&!u;return u||(u=setTimeout(h,i)),c&&(o=t.apply(e,f),e=f=null),o}};n.once=function(n){var i=!1,t;return function(){return i?t:(i=!0,t=n.apply(this,arguments),n=null,t)}};n.wrap=function(t,i){return n.partial(i,t)};n.compose=function(){var n=arguments;return function(){for(var t=arguments,i=n.length-1;i>=0;i--)t=[n[i].apply(this,t)];return t[0]}};n.after=function(n,t){return function(){if(--n<1)return t.apply(this,arguments)}};n.keys=function(t){var i,r;if(!n.isObject(t))return[];if(ht)return ht(t);i=[];for(r in t)n.has(t,r)&&i.push(r);return i};n.values=function(t){for(var r=n.keys(t),u=r.length,f=new Array(u),i=0;i<u;i++)f[i]=t[r[i]];return f};n.pairs=function(t){for(var r=n.keys(t),u=r.length,f=new Array(u),i=0;i<u;i++)f[i]=[r[i],t[r[i]]];return f};n.invert=function(t){for(var u={},r=n.keys(t),i=0,f=r.length;i<f;i++)u[t[r[i]]]=r[i];return u};n.functions=n.methods=function(t){var i=[];for(var r in t)n.isFunction(t[r])&&i.push(r);return i.sort()};n.extend=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)n[i]=t[i]}),n};n.pick=function(n){var f={},e=u.apply(r,t.call(arguments,1));return i(e,function(t){t in n&&(f[t]=n[t])}),f};n.omit=function(i){var e={},o=u.apply(r,t.call(arguments,1));for(var f in i)n.contains(o,f)||(e[f]=i[f]);return e};n.defaults=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)n[i]===void 0&&(n[i]=t[i])}),n};n.clone=function(t){return n.isObject(t)?n.isArray(t)?t.slice():n.extend({},t):t};n.tap=function(n,t){return t(n),n};a=function(t,i,r,u){var l,v,h,c,f,o,s;if(t===i)return t!==0||1/t==1/i;if(t==null||i==null)return t===i;if(t instanceof n&&(t=t.__wrapped),i instanceof n&&(i=i.__wrapped),l=e.call(t),l!=e.call(i))return!1;switch(l){case"[object String]":return t==String(i);case"[object Number]":return t!=+t?i!=+i:t==0?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if(typeof t!="object"||typeof i!="object")return!1;for(v=r.length;v--;)if(r[v]==t)return u[v]==i;if(h=t.constructor,c=i.constructor,h!==c&&!(n.isFunction(h)&&h instanceof h&&n.isFunction(c)&&c instanceof c)&&"constructor"in t&&"constructor"in i)return!1;if(r.push(t),u.push(i),f=0,o=!0,l=="[object Array]"){if(f=t.length,o=f==i.length,o)while(f--)if(!(o=a(t[f],i[f],r,u)))break}else{for(s in t)if(n.has(t,s)&&(f++,!(o=n.has(i,s)&&a(t[s],i[s],r,u))))break;if(o){for(s in i)if(n.has(i,s)&&!f--)break;o=!f}}return r.pop(),u.pop(),o};n.isEqual=function(n,t){return a(n,t,[],[])};n.isEmpty=function(t){if(t==null)return!0;if(n.isArray(t)||n.isString(t))return t.length===0;for(var i in t)if(n.has(t,i))return!1;return!0};n.isElement=function(n){return!!(n&&n.nodeType===1)};n.isArray=pt||function(n){return e.call(n)=="[object Array]"};n.isObject=function(n){return n===Object(n)};i(["Arguments","Function","String","Number","Date","RegExp"],function(t){n["is"+t]=function(n){return e.call(n)=="[object "+t+"]"}});n.isArguments(arguments)||(n.isArguments=function(t){return!!(t&&n.has(t,"callee"))});typeof/./!="function"&&(n.isFunction=function(n){return typeof n=="function"});n.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))};n.isNaN=function(t){return n.isNumber(t)&&t!=+t};n.isBoolean=function(n){return n===!0||n===!1||e.call(n)=="[object Boolean]"};n.isNull=function(n){return n===null};n.isUndefined=function(n){return n===void 0};n.has=function(n,t){return yt.call(n,t)};n.noConflict=function(){return y.__=at,this};n.identity=function(n){return n};n.constant=function(n){return function(){return n}};n.property=function(n){return function(t){return t[n]}};n.matches=function(n){return function(t){if(t===n)return!0;for(var i in n)if(String(n[i])!==String(t[i]))return!1;return!0}};n.times=function(n,t,i){for(var u=Array(Math.max(0,n)),r=0;r<n;r++)u[r]=t.call(i,r);return u};n.random=function(n,t){return t==null&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};n.now=Date.now||function(){return(new Date).getTime()};f={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};f.unescape=n.invert(f.escape);ct={escape:new RegExp("["+n.keys(f.escape).join("")+"]","g"),unescape:new RegExp("("+n.keys(f.unescape).join("|")+")","g")};n.each(["escape","unescape"],function(t){n[t]=function(n){return n==null?"":(""+n).replace(ct[t],function(n){return f[t][n]})}});n.result=function(t,i){if(t==null)return void 0;var r=t[i];return n.isFunction(r)?r.call(t):r};n.mixin=function(t){i(n.functions(t),function(i){var r=n[i]=t[i];n.prototype[i]=function(){var t=[this.__wrapped];return nt.apply(t,arguments),v.call(this,r.apply(n,t))}})};lt=0;n.uniqueId=function(n){var t=++lt+"";return n?n+t:t};n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var d=/(.)^/,wt={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},bt=/\\|'|\r|\n|\t|\u2028|\u2029/g;n.template=function(t,i,r){var f,e;r=n.defaults({},r,n.templateSettings);var h=new RegExp([(r.escape||d).source,(r.interpolate||d).source,(r.evaluate||d).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(h,function(n,i,r,f,e){return u+=t.slice(o,e).replace(bt,function(n){return"\\"+wt[n]}),i&&(u+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),f&&(u+="';\n"+f+"\n__p+='"),o=e+n.length,n});u+="';\n";r.variable||(u="with(obj||{}){\n"+u+"}\n");u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{f=new Function(r.variable||"obj","_",u)}catch(s){s.source=u;throw s;}return i?f(i,n):(e=function(t){return f.call(this,t,n)},e.source="function("+(r.variable||"obj")+"){\n"+u+"}",e)};n.chain=function(t){return n(t).chain()};n.findByKey=function(t,i){if(n.isEmpty(i))return first?void 0:[];var r;return n.each(t,function(n,u){for(var f in i)if(i[f]==n[f])return r=t[u],!0}),r};n.omitByKey=function(t,i){if(n.isEmpty(i))return first?void 0:[];var r=[];return n.each(t,function(n,u){var f,e,o;for(f in i)if(e=i[f],o=n[f],i[f]!=n[f])return r.push(t[u]),!0}),r};n.findAllByKey=function(t,i){var u=arguments[2]?arguments[2]:!1,r;return n.isEmpty(i)?first?void 0:[]:(r=[],n.each(t,function(n,f){for(var e in i)u,i[e]==n[e]&&r.push(t[f])}),r)};n.hasKeyVal=function(t,i){return n.where(t,i).length>0?!0:!1};n.replaceKey=function(t,i,r){return n.map(t,function(t){var u={};return n.each(t,function(n,t){t==i?u[r]=n:u[t]=n}),u})};n.replaceObjKeysByMap=function(t,i){var r=[t];return n.each(i,function(t,i){r=n.replaceKey(r,i,t)}),r[0]};n.addDisplayOrder=function(t,i){var r=[];return n.each(t,function(t,u){var f={};f[i]=u+1;r.push(n.extend(t,f))}),r};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};n.capitalizeKeys=function(t){var i=[];return n.each(t,function(t){var r={};n.each(t,function(n,t){r[t.capitalize()]=n});i.push(r)}),i};n.uniqueByKey=function(i,f){var o=u.apply(r,t.call(arguments,2)),e=[];return n.each(i,function(t){var i={};i[f]=t[f];n.hasKeyVal(e,i)||t[f]===null||(o.length>0?e.push(n.pick(t,o)):e.push(t))}),e};n.pickKeysFromObjArray=function(i){var f=[],e=u.apply(r,t.call(arguments,1));return n.each(i,function(t){f.push(n.pick(t,e))}),f};n.dedupeByKey=function(t,i){return n.each(t,function(t){console.log("OBJ1 ---->  ",t);n.each(i,function(n){console.log("obj1 key - > ",t[key]," obj2 key -> ",n[key])})}),[]};n.differenceByKey=function(t,i,r,u){var f=[],e=[];return n.each(t,function(t){var o={};o[u]=t[r];n.hasKeyVal(i,o)?f.push(t):e.push(t)}),{Matches:f,NoMatches:e}};n.groupByFilter=function(i,f){var o=u.apply(r,t.call(arguments,3)),e={};return n.each(i,function(t,i){console.log("#### group.each",t,i);console.log("XXXX group.each filter",e[t.filter]);n.isArray(e[t.filter])?(console.log("array","group[filter]",t[f],"val",t),e[t.filter].push(t)):(console.log("not array","group[filter]",t[f],"val",t),e[t.filter]=new Array(t))}),e};n.sortedGroupBy=function(t,i,r){var o=arguments[3]?arguments[3]:"__",u=n.uniqueByKey(t,i),f,e;return u=n.sortBy(u,r),f={},e={},console.log("underscore.sortedGroupby","unique",u),n.each(u,function(r){e[i]=r[i];f[o+String(r[i])]=n.findAllByKey(t,e)}),f};n.isNothing=function(t){return n.isEmpty(t)||n.isNull(t)||t===""?!0:!1};v=function(t){return this.__chain?n(t).chain():t};n.mixin(n);i(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=r[t];n.prototype[t]=function(){var n=this.__wrapped;return i.apply(n,arguments),(t=="shift"||t=="splice")&&n.length===0&&delete n[0],v.call(this,n)}});i(["concat","join","slice"],function(t){var i=r[t];n.prototype[t]=function(){return v.call(this,i.apply(this.__wrapped,arguments))}});n.extend(n.prototype,{chain:function(){return this.__chain=!0,this},value:function(){return this.__wrapped}});typeof define=="function"&&define.amd&&define("underscore",[],function(){return n})}.call(this);JSON||(JSON={}),function(){"use strict";function i(n){return n<10?"0"+n:n}function o(n){return e.lastIndex=0,e.test(n)?'"'+n.replace(e,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function u(i,f){var s,l,h,a,v=n,c,e=f[i];e&&typeof e=="object"&&typeof e.toJSON=="function"&&(e=e.toJSON(i));typeof t=="function"&&(e=t.call(f,i,e));switch(typeof e){case"string":return o(e);case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(n+=r,c=[],Object.prototype.toString.apply(e)==="[object Array]"){for(a=e.length,s=0;s<a;s+=1)c[s]=u(s,e)||"null";return h=c.length===0?"[]":n?"[\n"+n+c.join(",\n"+n)+"\n"+v+"]":"["+c.join(",")+"]",n=v,h}if(t&&typeof t=="object")for(a=t.length,s=0;s<a;s+=1)typeof t[s]=="string"&&(l=t[s],h=u(l,e),h&&c.push(o(l)+(n?": ":":")+h));else for(l in e)Object.prototype.hasOwnProperty.call(e,l)&&(h=u(l,e),h&&c.push(o(l)+(n?": ":":")+h));return h=c.length===0?"{}":n?"{\n"+n+c.join(",\n"+n)+"\n"+v+"}":"{"+c.join(",")+"}",n=v,h}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,r,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(i,f,e){var o;if(n="",r="",typeof e=="number")for(o=0;o<e;o+=1)r+=" ";else typeof e=="string"&&(r=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.stringify");return u("",{"":i})});typeof JSON.parse!="function"&&(JSON.parse=function(n,t){function r(n,i){var f,e,u=n[i];if(u&&typeof u=="object")for(f in u)Object.prototype.hasOwnProperty.call(u,f)&&(e=r(u,f),e!==undefined?u[f]=e:delete u[f]);return t.call(n,i,u)}var i;if(n=String(n),f.lastIndex=0,f.test(n)&&(n=n.replace(f,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse");})}(),function(n){var i=window.Cookies,t=window.Cookies=n();t.noConflict=function(){return window.Cookies=i,t}}(function(){function n(){for(var n=0,r={},t,i;n<arguments.length;n++){t=arguments[n];for(i in t)r[i]=t[i]}return r}function t(i){function r(t,u,f){var o,s;if(arguments.length>1){f=n({path:"/"},r.defaults,f);typeof f.expires=="number"&&(s=new Date,s.setMilliseconds(s.getMilliseconds()+f.expires*864e5),f.expires=s);try{o=JSON.stringify(u);/^[\{\[]/.test(o)&&(u=o)}catch(y){}return t!="igmRegID"&&t!="igmContent"&&t!="igmAuth"&&(u=i.write?i.write(u,t):encodeURIComponent(String(u)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",u,f.expires&&"; expires="+f.expires.toUTCString(),f.path&&"; path="+f.path,f.domain&&"; domain="+f.domain,f.secure?"; secure":""].join("")}t||(o={});for(var l=document.cookie?document.cookie.split("; "):[],a=/(%[0-9A-Z]{2})+/g,c=0;c<l.length;c++){var v=l[c].split("="),h=v[0].replace(a,decodeURIComponent),e=v.slice(1).join("=");e.charAt(0)==='"'&&(e=e.slice(1,-1));try{if(e=i.read?i.read(e,h):i(e,h)||e.replace(a,decodeURIComponent),this.json)try{e=JSON.parse(e)}catch(y){}if(t===h){o=e;break}t||(o[h]=e)}catch(y){}}return o}return r.get=r.set=r,r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,i){r(t,"",n(i,{expires:-1}))},r.withConverter=t,r}return t(function(){})});MD5=function(n){function a(n,t){return n<<t|n>>>32-t}function o(n,t){var f,e,r,u,i;return(r=n&2147483648,u=t&2147483648,f=n&1073741824,e=t&1073741824,i=(n&1073741823)+(t&1073741823),f&e)?i^2147483648^r^u:f|e?i&1073741824?i^3221225472^r^u:i^1073741824^r^u:i^r^u}function yt(n,t,i){return n&t|~n&i}function pt(n,t,i){return n&i|t&~i}function wt(n,t,i){return n^t^i}function bt(n,t,i){return t^(n|~i)}function s(n,t,i,r,u,f,e){return n=o(n,o(o(yt(t,i,r),u),e)),o(a(n,f),t)}function h(n,t,i,r,u,f,e){return n=o(n,o(o(pt(t,i,r),u),e)),o(a(n,f),t)}function c(n,t,i,r,u,f,e){return n=o(n,o(o(wt(t,i,r),u),e)),o(a(n,f),t)}function l(n,t,i,r,u,f,e){return n=o(n,o(o(bt(t,i,r),u),e)),o(a(n,f),t)}function kt(n){for(var r,u=n.length,o=u+8,s=(o-o%64)/64,e=(s+1)*16,i=Array(e-1),f=0,t=0;t<u;)r=(t-t%4)/4,f=t%4*8,i[r]=i[r]|n.charCodeAt(t)<<f,t++;return r=(t-t%4)/4,f=t%4*8,i[r]=i[r]|128<<f,i[e-2]=u<<3,i[e-1]=u>>>29,i}function v(n){for(var i="",r="",u,t=0;t<=3;t++)u=n>>>t*8&255,r="0"+u.toString(16),i=i+r.substr(r.length-2,2);return i}function dt(n){var i,r,t;for(n=n.replace(/rn/g,"n"),i="",r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(t&63|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(t&63|128));return i}var e=Array(),f,ht,ct,lt,at,t,i,r,u,y=7,p=12,w=17,b=22,k=5,d=9,g=14,nt=20,tt=4,it=11,rt=16,ut=23,ft=6,et=10,ot=15,st=21,vt;for(n=dt(n),e=kt(n),t=1732584193,i=4023233417,r=2562383102,u=271733878,f=0;f<e.length;f+=16)ht=t,ct=i,lt=r,at=u,t=s(t,i,r,u,e[f+0],y,3614090360),u=s(u,t,i,r,e[f+1],p,3905402710),r=s(r,u,t,i,e[f+2],w,606105819),i=s(i,r,u,t,e[f+3],b,3250441966),t=s(t,i,r,u,e[f+4],y,4118548399),u=s(u,t,i,r,e[f+5],p,1200080426),r=s(r,u,t,i,e[f+6],w,2821735955),i=s(i,r,u,t,e[f+7],b,4249261313),t=s(t,i,r,u,e[f+8],y,1770035416),u=s(u,t,i,r,e[f+9],p,2336552879),r=s(r,u,t,i,e[f+10],w,4294925233),i=s(i,r,u,t,e[f+11],b,2304563134),t=s(t,i,r,u,e[f+12],y,1804603682),u=s(u,t,i,r,e[f+13],p,4254626195),r=s(r,u,t,i,e[f+14],w,2792965006),i=s(i,r,u,t,e[f+15],b,1236535329),t=h(t,i,r,u,e[f+1],k,4129170786),u=h(u,t,i,r,e[f+6],d,3225465664),r=h(r,u,t,i,e[f+11],g,643717713),i=h(i,r,u,t,e[f+0],nt,3921069994),t=h(t,i,r,u,e[f+5],k,3593408605),u=h(u,t,i,r,e[f+10],d,38016083),r=h(r,u,t,i,e[f+15],g,3634488961),i=h(i,r,u,t,e[f+4],nt,3889429448),t=h(t,i,r,u,e[f+9],k,568446438),u=h(u,t,i,r,e[f+14],d,3275163606),r=h(r,u,t,i,e[f+3],g,4107603335),i=h(i,r,u,t,e[f+8],nt,1163531501),t=h(t,i,r,u,e[f+13],k,2850285829),u=h(u,t,i,r,e[f+2],d,4243563512),r=h(r,u,t,i,e[f+7],g,1735328473),i=h(i,r,u,t,e[f+12],nt,2368359562),t=c(t,i,r,u,e[f+5],tt,4294588738),u=c(u,t,i,r,e[f+8],it,2272392833),r=c(r,u,t,i,e[f+11],rt,1839030562),i=c(i,r,u,t,e[f+14],ut,4259657740),t=c(t,i,r,u,e[f+1],tt,2763975236),u=c(u,t,i,r,e[f+4],it,1272893353),r=c(r,u,t,i,e[f+7],rt,4139469664),i=c(i,r,u,t,e[f+10],ut,3200236656),t=c(t,i,r,u,e[f+13],tt,681279174),u=c(u,t,i,r,e[f+0],it,3936430074),r=c(r,u,t,i,e[f+3],rt,3572445317),i=c(i,r,u,t,e[f+6],ut,76029189),t=c(t,i,r,u,e[f+9],tt,3654602809),u=c(u,t,i,r,e[f+12],it,3873151461),r=c(r,u,t,i,e[f+15],rt,530742520),i=c(i,r,u,t,e[f+2],ut,3299628645),t=l(t,i,r,u,e[f+0],ft,4096336452),u=l(u,t,i,r,e[f+7],et,1126891415),r=l(r,u,t,i,e[f+14],ot,2878612391),i=l(i,r,u,t,e[f+5],st,4237533241),t=l(t,i,r,u,e[f+12],ft,1700485571),u=l(u,t,i,r,e[f+3],et,2399980690),r=l(r,u,t,i,e[f+10],ot,4293915773),i=l(i,r,u,t,e[f+1],st,2240044497),t=l(t,i,r,u,e[f+8],ft,1873313359),u=l(u,t,i,r,e[f+15],et,4264355552),r=l(r,u,t,i,e[f+6],ot,2734768916),i=l(i,r,u,t,e[f+13],st,1309151649),t=l(t,i,r,u,e[f+4],ft,4149444226),u=l(u,t,i,r,e[f+11],et,3174756917),r=l(r,u,t,i,e[f+2],ot,718787259),i=l(i,r,u,t,e[f+9],st,3951481745),t=o(t,ht),i=o(i,ct),r=o(r,lt),u=o(u,at);return vt=v(t)+v(i)+v(r)+v(u),vt.toLowerCase()},function(){"use strict";function it(){var u=!1,n;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval");u=!0;window.localStorage.removeItem("_tmptest")}catch(f){}if(u)try{window.localStorage&&(i=window.localStorage,r="localStorage",o=i.jStorage_update)}catch(e){}else if("globalStorage"in window)try{window.globalStorage&&(i=window.location.hostname=="localhost"?window.globalStorage["localhost.localdomain"]:window.globalStorage[window.location.hostname],r="globalStorage",o=i.jStorage_update)}catch(s){}else if(t=document.createElement("link"),t.addBehavior){t.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(t);try{t.load("jStorage")}catch(h){t.setAttribute("jStorage","{}");t.save("jStorage");t.load("jStorage")}n="{}";try{n=t.getAttribute("jStorage")}catch(l){}try{o=t.getAttribute("jStorage_update")}catch(a){}i.jStorage=n;r="userDataBehavior"}else{t=null;return}nt();y();rt();tt();"addEventListener"in window&&window.addEventListener("pageshow",function(n){n.persisted&&c()},!1)}function g(){var n="{}";if(r=="userDataBehavior"){t.load("jStorage");try{n=t.getAttribute("jStorage")}catch(u){}try{o=t.getAttribute("jStorage_update")}catch(f){}i.jStorage=n}nt();y();tt()}function rt(){r=="localStorage"||r=="globalStorage"?"addEventListener"in window?window.addEventListener("storage",c,!1):document.attachEvent("onstorage",c):r=="userDataBehavior"&&setInterval(c,1e3)}function c(){var n;clearTimeout(k);k=setTimeout(function(){if(r=="localStorage"||r=="globalStorage")n=i.jStorage_update;else if(r=="userDataBehavior"){t.load("jStorage");try{n=t.getAttribute("jStorage_update")}catch(u){}}n&&n!=o&&(o=n,ut())},25)}function ut(){var i=f.parse(f.stringify(n.__jstorage_meta.CRC32)),r,t,u,e;g();r=f.parse(f.stringify(n.__jstorage_meta.CRC32));u=[];e=[];for(t in i)if(i.hasOwnProperty(t)){if(!r[t]){e.push(t);continue}i[t]!=r[t]&&String(i[t]).substr(0,2)=="2."&&u.push(t)}for(t in r)r.hasOwnProperty(t)&&(i[t]||u.push(t));h(u,"updated");h(e,"deleted")}function h(n,t){var i,r,o,f,e;if(n=[].concat(n||[]),t=="flushed"){n=[];for(e in u)u.hasOwnProperty(e)&&n.push(e);t="deleted"}for(i=0,o=n.length;i<o;i++){if(u[n[i]])for(r=0,f=u[n[i]].length;r<f;r++)u[n[i]][r](n[i],t);if(u["*"])for(r=0,f=u["*"].length;r<f;r++)u["*"][r](n[i],t)}}function l(){var n=(+new Date).toString();if(r=="localStorage"||r=="globalStorage")try{i.jStorage_update=n}catch(u){r=!1}else r=="userDataBehavior"&&(t.setAttribute("jStorage_update",n),t.save("jStorage"));c()}function nt(){if(i.jStorage)try{n=f.parse(String(i.jStorage))}catch(t){i.jStorage="{}"}else i.jStorage="{}";p=i.jStorage?String(i.jStorage).length:0;n.__jstorage_meta||(n.__jstorage_meta={});n.__jstorage_meta.CRC32||(n.__jstorage_meta.CRC32={})}function a(){et();try{i.jStorage=f.stringify(n);t&&(t.setAttribute("jStorage",i.jStorage),t.save("jStorage"));p=i.jStorage?String(i.jStorage).length:0}catch(r){}}function e(n){if(typeof n!="string"&&typeof n!="number")throw new TypeError("Key name must be string or numeric");if(n=="__jstorage_meta")throw new TypeError("Reserved key name");return!0}function y(){var u,t,i,f,r=Infinity,e=!1,o=[];if(clearTimeout(d),n.__jstorage_meta&&typeof n.__jstorage_meta.TTL=="object"){u=+new Date;i=n.__jstorage_meta.TTL;f=n.__jstorage_meta.CRC32;for(t in i)i.hasOwnProperty(t)&&(i[t]<=u?(delete i[t],delete f[t],delete n[t],e=!0,o.push(t)):i[t]<r&&(r=i[t]));r!=Infinity&&(d=setTimeout(y,Math.min(r-u,2147483647)));e&&(a(),l(),h(o,"deleted"))}}function tt(){var t,f,r,u,i;if(n.__jstorage_meta.PubSub){for(u=w,i=[],t=f=n.__jstorage_meta.PubSub.length-1;t>=0;t--)r=n.__jstorage_meta.PubSub[t],r[0]>w&&(u=r[0],i.unshift(r));for(t=i.length-1;t>=0;t--)ft(i[t][1],i[t][2]);w=u}}function ft(n,t){if(s[n])for(var i=0,r=s[n].length;i<r;i++)try{s[n][i](n,f.parse(f.stringify(t)))}catch(u){}}function et(){var i,t,r;if(n.__jstorage_meta.PubSub){for(i=+new Date-2e3,t=0,r=n.__jstorage_meta.PubSub.length;t<r;t++)if(n.__jstorage_meta.PubSub[t][0]<=i){n.__jstorage_meta.PubSub.splice(t,n.__jstorage_meta.PubSub.length-t);break}n.__jstorage_meta.PubSub.length||delete n.__jstorage_meta.PubSub}}function ot(t,i){n.__jstorage_meta||(n.__jstorage_meta={});n.__jstorage_meta.PubSub||(n.__jstorage_meta.PubSub=[]);n.__jstorage_meta.PubSub.unshift([+new Date,t,i]);a();l()}function st(n,t){for(var f=n.length,i=t^f,u=0,r;f>=4;)r=n.charCodeAt(u)&255|(n.charCodeAt(++u)&255)<<8|(n.charCodeAt(++u)&255)<<16|(n.charCodeAt(++u)&255)<<24,r=(r&65535)*1540483477+(((r>>>16)*1540483477&65535)<<16),r^=r>>>24,r=(r&65535)*1540483477+(((r>>>16)*1540483477&65535)<<16),i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16)^r,f-=4,++u;switch(f){case 3:i^=(n.charCodeAt(u+2)&255)<<16;case 2:i^=(n.charCodeAt(u+1)&255)<<8;case 1:i^=n.charCodeAt(u)&255;i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16)}return i^=i>>>13,i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16),i^=i>>>15,i>>>0}var v=window.jQuery||window.$||(window.$={}),f={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(n){return String(n).evalJSON()}||v.parseJSON||v.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||v.toJSON};if(typeof f.parse!="function"||typeof f.stringify!="function")throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var n={__jstorage_meta:{CRC32:{}}},i={jStorage:"{}"},t=null,p=0,r=!1,u={},k=!1,o=0,s={},w=+new Date,d,b={isXML:function(n){var t=(n?n.ownerDocument||n:0).documentElement;return t?t.nodeName!=="HTML":!1},encode:function(n){if(!this.isXML(n))return!1;try{return(new XMLSerializer).serializeToString(n)}catch(t){try{return n.xml}catch(i){}}return!1},decode:function(n){var i="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(n){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(n),t},t;return i?(t=i.call("DOMParser"in window&&new DOMParser||window,n,"text/xml"),this.isXML(t)?t:!1):!1}};v.jStorage={version:"0.4.12",set:function(t,i,r){if(e(t),r=r||{},typeof i=="undefined")return this.deleteKey(t),i;if(b.isXML(i))i={_is_xml:!0,xml:b.encode(i)};else{if(typeof i=="function")return undefined;i&&typeof i=="object"&&(i=f.parse(f.stringify(i)))}return n[t]=i,n.__jstorage_meta.CRC32[t]="2."+st(f.stringify(i),2538058380),this.setTTL(t,r.TTL||0),h(t,"updated"),i},get:function(t,i){return(e(t),t in n)?n[t]&&typeof n[t]=="object"&&n[t]._is_xml?b.decode(n[t].xml):n[t]:typeof i=="undefined"?null:i},deleteKey:function(t){return(e(t),t in n)?(delete n[t],typeof n.__jstorage_meta.TTL=="object"&&t in n.__jstorage_meta.TTL&&delete n.__jstorage_meta.TTL[t],delete n.__jstorage_meta.CRC32[t],a(),l(),h(t,"deleted"),!0):!1},setTTL:function(t,i){var r=+new Date;return(e(t),i=Number(i)||0,t in n)?(n.__jstorage_meta.TTL||(n.__jstorage_meta.TTL={}),i>0?n.__jstorage_meta.TTL[t]=r+i:delete n.__jstorage_meta.TTL[t],a(),y(),l(),!0):!1},getTTL:function(t){var r=+new Date,i;return(e(t),t in n&&n.__jstorage_meta.TTL&&n.__jstorage_meta.TTL[t])?(i=n.__jstorage_meta.TTL[t]-r,i||0):0},flush:function(){return n={__jstorage_meta:{CRC32:{}}},a(),l(),h(null,"flushed"),!0},storageObj:function(){function t(){}return t.prototype=n,new t},index:function(){var i=[];for(var t in n)n.hasOwnProperty(t)&&t!="__jstorage_meta"&&i.push(t);return i},storageSize:function(){return p},currentBackend:function(){return r},storageAvailable:function(){return!!r},listenKeyChange:function(n,t){e(n);u[n]||(u[n]=[]);u[n].push(t)},stopListening:function(n,t){if(e(n),u[n]){if(!t){delete u[n];return}for(var i=u[n].length-1;i>=0;i--)u[n][i]==t&&u[n].splice(i,1)}},subscribe:function(n,t){if(n=(n||"").toString(),!n)throw new TypeError("Channel not defined");s[n]||(s[n]=[]);s[n].push(t)},publish:function(n,t){if(n=(n||"").toString(),!n)throw new TypeError("Channel not defined");ot(n,t)},reInit:function(){g()},noConflict:function(n){return delete window.$.jStorage,n&&(window.jStorage=this),this}};it()}(),function(n){n.fn.viewportChecker=function(t){var i={classToAdd:"visible",classToRemove:"invisible",classToAddForFullView:"full-visible",removeClassAfterAnimation:!1,offset:100,repeat:!1,invertBottomOffset:!0,callbackFunction:function(){},scrollHorizontal:!1,callbackFunctionBeforeAddClass:null,scrollBox:window},u,r;if(n.extend(i,t),u=this,r={height:n(i.scrollBox).height(),width:n(i.scrollBox).width()},this.checkElements=function(){var t,f;i.scrollHorizontal?(t=Math.max(n("html").scrollLeft(),n("body").scrollLeft(),n(window).scrollLeft()),f=t+r.width):(t=Math.max(n("html").scrollTop(),n("body").scrollTop(),n(window).scrollTop()),f=t+r.height);u.each(function(){var u=n(this),e={},o={};if(u.data("vp-add-class")&&(o.classToAdd=u.data("vp-add-class")),u.data("vp-remove-class")&&(o.classToRemove=u.data("vp-remove-class")),u.data("vp-add-class-full-view")&&(o.classToAddForFullView=u.data("vp-add-class-full-view")),u.data("vp-keep-add-class")&&(o.removeClassAfterAnimation=u.data("vp-remove-after-animation")),u.data("vp-offset")&&(o.offset=u.data("vp-offset")),u.data("vp-repeat")&&(o.repeat=u.data("vp-repeat")),u.data("vp-scrollHorizontal")&&(o.scrollHorizontal=u.data("vp-scrollHorizontal")),u.data("vp-invertBottomOffset")&&(o.scrollHorizontal=u.data("vp-invertBottomOffset")),n.extend(e,i),n.extend(e,o),!u.data("vp-animated")||e.repeat){String(e.offset).indexOf("%")>0&&(e.offset=parseInt(e.offset)/100*r.height);var s=e.scrollHorizontal?u.offset().left:u.offset().top,l=e.scrollHorizontal?s+u.width():s+u.height(),h=Math.round(s)+e.offset,c=e.scrollHorizontal?h+u.width():h+u.height();if(e.invertBottomOffset&&(c-=e.offset*2),h<f&&c>t){if(i.callbackFunctionBeforeAddClass(u),u.removeClass(e.classToRemove),u.addClass(e.classToAdd),e.callbackFunction(u,"add"),l<=f&&s>=t?u.addClass(e.classToAddForFullView):u.removeClass(e.classToAddForFullView),u.data("vp-animated",!0),e.removeClassAfterAnimation)u.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){u.removeClass(e.classToAdd)})}else u.hasClass(e.classToAdd)&&e.repeat&&(u.removeClass(e.classToAdd+" "+e.classToAddForFullView),e.callbackFunction(u,"remove"),u.data("vp-animated",!1))}})},this.destroy=function(){("ontouchstart"in window||"onmsgesturechange"in window)&&n(document).off("touchmove MSPointerMove pointermove",this.checkElements);n(i.scrollBox).off("load scroll",this.checkElements)},"ontouchstart"in window||"onmsgesturechange"in window)n(document).on("touchmove MSPointerMove pointermove",this.checkElements);n(i.scrollBox).on("load scroll",this.checkElements);return n(window).resize(function(){r={height:n(i.scrollBox).height(),width:n(i.scrollBox).width()};u.checkElements()}),this.checkElements(),this}}(jQuery),function(n){n.fn.jalert=function(t){var i=this,f=n('<div class="alert alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><span><\/span><\/div>'),e=n.extend({},{type:"success",useTitles:!1},t),r=function(n){f.find("> span").html(n);i.append(f)},u=function(n){var t=n=="error"?"danger":n;f.addClass("alert-"+t)};return this.error=function(n){return r(n),u("error"),i},this.success=function(n){return r(n),u("success"),i},this.info=function(n){return r(n),u("info"),i},this.warning=function(n){return r(n),u("warning"),i},this.hide=function(n){return i.slideUp(n),i},this.show=function(){return i.css("display","none"),i.removeClass("hide fade"),i.slideDown(),i},this.autohide=function(n){setTimeout(function(){i.slideUp()},n?n:5e3)},this}}(jQuery),function(n){n.fn.loader=function(t){var r=this,u=n.extend({},{location:"in",img:'<img src="https://cdn.mg2connext.com/prod/template_images/ajax-loader.gif" style="margin: 7px auto" />',loaderId:"loader"},t),f=n(u.img).prop("id",u.loaderId),e,i;return this.on=function(){try{i=r.children("span").length?r.children("span"):r;e=i.html();i[0].hasAttribute("data-mg2-submit")&&i.attr("data-mg2-submit","");u.location=="in"&&i.html(f)}catch(n){}},this.off=function(){try{i[0].hasAttribute("data-mg2-submit")&&i.attr("data-mg2-submit","login");i.html(e);f.remove()}catch(n){}},this}}(jQuery);!function(){function n(n,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i}if(typeof window.CustomEvent=="function")return!1;n.prototype=window.Event.prototype;window.CustomEvent=n}();!function(n,t,i){t[n]=i()}("Fingerprint2",this,function(){"use strict";var n=function(t){if(!(this instanceof n))return new n(t);this.options=this.extend(t,{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",detectScreenOrientation:!0,sortPluginsFor:[/palemoon/i],userDefinedFonts:[]});this.nativeForEach=Array.prototype.forEach;this.nativeMap=Array.prototype.map};return n.prototype={extend:function(n,t){if(null==n)return t;for(var i in n)null!=n[i]&&t[i]!==n[i]&&(t[i]=n[i]);return t},get:function(n){var i=this,t={data:[],push:function(n){var r=n.key,t=n.value;"function"==typeof i.options.preprocessor&&(t=i.options.preprocessor(r,t));this.data.push({key:r,value:t})}};t=this.userAgentKey(t);t=this.languageKey(t);t=this.colorDepthKey(t);t=this.pixelRatioKey(t);t=this.hardwareConcurrencyKey(t);t=this.screenResolutionKey(t);t=this.availableScreenResolutionKey(t);t=this.timezoneOffsetKey(t);t=this.sessionStorageKey(t);t=this.localStorageKey(t);t=this.indexedDbKey(t);t=this.addBehaviorKey(t);t=this.openDatabaseKey(t);t=this.cpuClassKey(t);t=this.platformKey(t);t=this.doNotTrackKey(t);t=this.pluginsKey(t);t=this.canvasKey(t);t=this.webglKey(t);t=this.adBlockKey(t);t=this.hasLiedLanguagesKey(t);t=this.hasLiedResolutionKey(t);t=this.hasLiedOsKey(t);t=this.hasLiedBrowserKey(t);t=this.touchSupportKey(t);t=this.customEntropyFunction(t);this.fontsKey(t,function(t){var r=[],u;return i.each(t.data,function(n){var t=n.value;"undefined"!=typeof n.value.join&&(t=n.value.join(";"));r.push(t)}),u=i.x64hash128(r.join("~~~"),31),n(u,t.data)})},customEntropyFunction:function(n){return"function"==typeof this.options.customFunction&&n.push({key:"custom",value:this.options.customFunction()}),n},userAgentKey:function(n){return this.options.excludeUserAgent||n.push({key:"user_agent",value:this.getUserAgent()}),n},getUserAgent:function(){return navigator.userAgent},languageKey:function(n){return this.options.excludeLanguage||n.push({key:"language",value:navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||""}),n},colorDepthKey:function(n){return this.options.excludeColorDepth||n.push({key:"color_depth",value:screen.colorDepth||-1}),n},pixelRatioKey:function(n){return this.options.excludePixelRatio||n.push({key:"pixel_ratio",value:this.getPixelRatio()}),n},getPixelRatio:function(){return window.devicePixelRatio||""},screenResolutionKey:function(n){return this.options.excludeScreenResolution?n:this.getScreenResolution(n)},getScreenResolution:function(n){var t;return t=this.options.detectScreenOrientation&&screen.height>screen.width?[screen.height,screen.width]:[screen.width,screen.height],"undefined"!=typeof t&&n.push({key:"resolution",value:t}),n},availableScreenResolutionKey:function(n){return this.options.excludeAvailableScreenResolution?n:this.getAvailableScreenResolution(n)},getAvailableScreenResolution:function(n){var t;return screen.availWidth&&screen.availHeight&&(t=this.options.detectScreenOrientation?screen.availHeight>screen.availWidth?[screen.availHeight,screen.availWidth]:[screen.availWidth,screen.availHeight]:[screen.availHeight,screen.availWidth]),"undefined"!=typeof t&&n.push({key:"available_resolution",value:t}),n},timezoneOffsetKey:function(n){return this.options.excludeTimezoneOffset||n.push({key:"timezone_offset",value:(new Date).getTimezoneOffset()}),n},sessionStorageKey:function(n){return!this.options.excludeSessionStorage&&this.hasSessionStorage()&&n.push({key:"session_storage",value:1}),n},localStorageKey:function(n){return!this.options.excludeSessionStorage&&this.hasLocalStorage()&&n.push({key:"local_storage",value:1}),n},indexedDbKey:function(n){return!this.options.excludeIndexedDB&&this.hasIndexedDB()&&n.push({key:"indexed_db",value:1}),n},addBehaviorKey:function(n){return document.body&&!this.options.excludeAddBehavior&&document.body.addBehavior&&n.push({key:"add_behavior",value:1}),n},openDatabaseKey:function(n){return!this.options.excludeOpenDatabase&&window.openDatabase&&n.push({key:"open_database",value:1}),n},cpuClassKey:function(n){return this.options.excludeCpuClass||n.push({key:"cpu_class",value:this.getNavigatorCpuClass()}),n},platformKey:function(n){return this.options.excludePlatform||n.push({key:"navigator_platform",value:this.getNavigatorPlatform()}),n},doNotTrackKey:function(n){return this.options.excludeDoNotTrack||n.push({key:"do_not_track",value:this.getDoNotTrack()}),n},canvasKey:function(n){return!this.options.excludeCanvas&&this.isCanvasSupported()&&n.push({key:"canvas",value:this.getCanvasFp()}),n},webglKey:function(n){return this.options.excludeWebGL?n:this.isWebGlSupported()?(n.push({key:"webgl",value:this.getWebglFp()}),n):n},adBlockKey:function(n){return this.options.excludeAdBlock||n.push({key:"adblock",value:this.getAdBlock()}),n},hasLiedLanguagesKey:function(n){return this.options.excludeHasLiedLanguages||n.push({key:"has_lied_languages",value:this.getHasLiedLanguages()}),n},hasLiedResolutionKey:function(n){return this.options.excludeHasLiedResolution||n.push({key:"has_lied_resolution",value:this.getHasLiedResolution()}),n},hasLiedOsKey:function(n){return this.options.excludeHasLiedOs||n.push({key:"has_lied_os",value:this.getHasLiedOs()}),n},hasLiedBrowserKey:function(n){return this.options.excludeHasLiedBrowser||n.push({key:"has_lied_browser",value:this.getHasLiedBrowser()}),n},fontsKey:function(n,t){return this.options.excludeJsFonts?this.flashFontsKey(n,t):this.jsFontsKey(n,t)},flashFontsKey:function(n,t){return this.options.excludeFlashFonts?t(n):this.hasSwfObjectLoaded()&&this.hasMinFlashInstalled()?"undefined"==typeof this.options.swfPath?t(n):void this.loadSwfAndDetectFonts(function(i){n.push({key:"swf_fonts",value:i.join(";")});t(n)}):t(n)},jsFontsKey:function(n,t){var i=this;return setTimeout(function(){var r=["monospace","sans-serif","serif"],u=["Andale Mono","Arial","Arial Black","Arial Hebrew","Arial MT","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Bitstream Vera Sans Mono","Book Antiqua","Bookman Old Style","Calibri","Cambria","Cambria Math","Century","Century Gothic","Century Schoolbook","Comic Sans","Comic Sans MS","Consolas","Courier","Courier New","Garamond","Geneva","Georgia","Helvetica","Helvetica Neue","Impact","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","LUCIDA GRANDE","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Microsoft Sans Serif","Monaco","Monotype Corsiva","MS Gothic","MS Outlook","MS PGothic","MS Reference Sans Serif","MS Sans Serif","MS Serif","MYRIAD","MYRIAD PRO","Palatino","Palatino Linotype","Segoe Print","Segoe Script","Segoe UI","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Tahoma","Times","Times New Roman","Times New Roman PS","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"],f,y,p;i.options.extendedJsFonts&&(u=u.concat(["Abadi MT Condensed Light","Academy Engraved LET","ADOBE CASLON PRO","Adobe Garamond","ADOBE GARAMOND PRO","Agency FB","Aharoni","Albertus Extra Bold","Albertus Medium","Algerian","Amazone BT","American Typewriter","American Typewriter Condensed","AmerType Md BT","Andalus","Angsana New","AngsanaUPC","Antique Olive","Aparajita","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Arabic Typesetting","ARCHER","ARNO PRO","Arrus BT","Aurora Cn BT","AvantGarde Bk BT","AvantGarde Md BT","AVENIR","Ayuthaya","Bandy","Bangla Sangam MN","Bank Gothic","BankGothic Md BT","Baskerville","Baskerville Old Face","Batang","BatangChe","Bauer Bodoni","Bauhaus 93","Bazooka","Bell MT","Bembo","Benguiat Bk BT","Berlin Sans FB","Berlin Sans FB Demi","Bernard MT Condensed","BernhardFashion BT","BernhardMod BT","Big Caslon","BinnerD","Blackadder ITC","BlairMdITC TT","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni MT","Bodoni MT Black","Bodoni MT Condensed","Bodoni MT Poster Compressed","Bookshelf Symbol 7","Boulder","Bradley Hand","Bradley Hand ITC","Bremen Bd BT","Britannic Bold","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Californian FB","Calisto MT","Calligrapher","Candara","CaslonOpnface BT","Castellar","Centaur","Cezanne","CG Omega","CG Times","Chalkboard","Chalkboard SE","Chalkduster","Charlesworth","Charter Bd BT","Charter BT","Chaucer","ChelthmITC Bk BT","Chiller","Clarendon","Clarendon Condensed","CloisterBlack BT","Cochin","Colonna MT","Constantia","Cooper Black","Copperplate","Copperplate Gothic","Copperplate Gothic Bold","Copperplate Gothic Light","CopperplGoth Bd BT","Corbel","Cordia New","CordiaUPC","Cornerstone","Coronet","Cuckoo","Curlz MT","DaunPenh","Dauphin","David","DB LCD Temp","DELICIOUS","Denmark","DFKai-SB","Didot","DilleniaUPC","DIN","DokChampa","Dotum","DotumChe","Ebrima","Edwardian Script ITC","Elephant","English 111 Vivace BT","Engravers MT","EngraversGothic BT","Eras Bold ITC","Eras Demi ITC","Eras Light ITC","Eras Medium ITC","EucrosiaUPC","Euphemia","Euphemia UCAS","EUROSTILE","Exotc350 Bd BT","FangSong","Felix Titling","Fixedsys","FONTIN","Footlight MT Light","Forte","FrankRuehl","Fransiscan","Freefrm721 Blk BT","FreesiaUPC","Freestyle Script","French Script MT","FrnkGothITC Bk BT","Fruitger","FRUTIGER","Futura","Futura Bk BT","Futura Lt BT","Futura Md BT","Futura ZBlk BT","FuturaBlack BT","Gabriola","Galliard BT","Gautami","Geeza Pro","Geometr231 BT","Geometr231 Hv BT","Geometr231 Lt BT","GeoSlab 703 Lt BT","GeoSlab 703 XBd BT","Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed","Gisha","Gloucester MT Extra Condensed","GOTHAM","GOTHAM BOLD","Goudy Old Style","Goudy Stout","GoudyHandtooled BT","GoudyOLSt BT","Gujarati Sangam MN","Gulim","GulimChe","Gungsuh","GungsuhChe","Gurmukhi MN","Haettenschweiler","Harlow Solid Italic","Harrington","Heather","Heiti SC","Heiti TC","HELV","Herald","High Tower Text","Hiragino Kaku Gothic ProN","Hiragino Mincho ProN","Hoefler Text","Humanst 521 Cn BT","Humanst521 BT","Humanst521 Lt BT","Imprint MT Shadow","Incised901 Bd BT","Incised901 BT","Incised901 Lt BT","INCONSOLATA","Informal Roman","Informal011 BT","INTERSTATE","IrisUPC","Iskoola Pota","JasmineUPC","Jazz LET","Jenson","Jester","Jokerman","Juice ITC","Kabel Bk BT","Kabel Ult BT","Kailasa","KaiTi","Kalinga","Kannada Sangam MN","Kartika","Kaufmann Bd BT","Kaufmann BT","Khmer UI","KodchiangUPC","Kokila","Korinna BT","Kristen ITC","Krungthep","Kunstler Script","Lao UI","Latha","Leelawadee","Letter Gothic","Levenim MT","LilyUPC","Lithograph","Lithograph Light","Long Island","Lydian BT","Magneto","Maiandra GD","Malayalam Sangam MN","Malgun Gothic","Mangal","Marigold","Marion","Marker Felt","Market","Marlett","Matisse ITC","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Minion","Minion Pro","Miriam","Miriam Fixed","Mistral","Modern","Modern No. 20","Mona Lisa Solid ITC TT","Mongolian Baiti","MONO","MoolBoran","Mrs Eaves","MS LineDraw","MS Mincho","MS PMincho","MS Reference Specialty","MS UI Gothic","MT Extra","MUSEO","MV Boli","Nadeem","Narkisim","NEVIS","News Gothic","News GothicMT","NewsGoth BT","Niagara Engraved","Niagara Solid","Noteworthy","NSimSun","Nyala","OCR A Extended","Old Century","Old English Text MT","Onyx","Onyx BT","OPTIMA","Oriya Sangam MN","OSAKA","OzHandicraft BT","Palace Script MT","Papyrus","Parchment","Party LET","Pegasus","Perpetua","Perpetua Titling MT","PetitaBold","Pickwick","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Poor Richard","Poster","PosterBodoni BT","PRINCETOWN LET","Pristina","PTBarnum BT","Pythagoras","Raavi","Rage Italic","Ravie","Ribbon131 Bd BT","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Roman","Sakkal Majalla","Santa Fe LET","Savoye LET","Sceptre","Script","Script MT Bold","SCRIPTINA","Serifa","Serifa BT","Serifa Th BT","ShelleyVolante BT","Sherwood","Shonar Bangla","Showcard Gothic","Shruti","Signboard","SILKSCREEN","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sinhala Sangam MN","Sketch Rockwell","Skia","Small Fonts","Snap ITC","Snell Roundhand","Socket","Souvenir Lt BT","Staccato222 BT","Steamer","Stencil","Storybook","Styllo","Subway","Swis721 BlkEx BT","Swiss911 XCm BT","Sylfaen","Synchro LET","System","Tamil Sangam MN","Technical","Teletype","Telugu Sangam MN","Tempus Sans ITC","Terminal","Thonburi","Traditional Arabic","Trajan","TRAJAN PRO","Tristan","Tubular","Tunga","Tw Cen MT","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","TypoUpright BT","Unicorn","Univers","Univers CE 55 Medium","Univers Condensed","Utsaah","Vagabond","Vani","Vijaya","Viner Hand ITC","VisualUI","Vivaldi","Vladimir Script","Vrinda","Westminster","WHITNEY","Wide Latin","ZapfEllipt BT","ZapfHumnst BT","ZapfHumnst Dm BT","Zapfino","Zurich BlkEx BT","Zurich Ex BT","ZWAdobeF"]));u=u.concat(i.options.userDefinedFonts);var b="mmmmmmmmmmlli",k="72px",e=document.getElementsByTagName("body")[0],s=document.createElement("div"),h=document.createElement("div"),c={},l={},a=function(){var n=document.createElement("span");return n.style.position="absolute",n.style.left="-9999px",n.style.fontSize=k,n.style.lineHeight="normal",n.innerHTML=b,n},d=function(n,t){var i=a();return i.style.fontFamily="'"+n+"',"+t,i},g=function(){for(var n,i=[],t=0,u=r.length;t<u;t++)n=a(),n.style.fontFamily=r[t],s.appendChild(n),i.push(n);return i},nt=function(){for(var i,f={},n=0,o=u.length;n<o;n++){for(var e=[],t=0,s=r.length;t<s;t++)i=d(u[n],r[t]),h.appendChild(i),e.push(i);f[u[n]]=e}return f},tt=function(n){for(var i=!1,t=0;t<r.length;t++)if(i=n[t].offsetWidth!==c[r[t]]||n[t].offsetHeight!==l[r[t]])return i;return i},v=g();for(e.appendChild(s),f=0,y=r.length;f<y;f++)c[r[f]]=v[f].offsetWidth,l[r[f]]=v[f].offsetHeight;p=nt();e.appendChild(h);for(var w=[],o=0,it=u.length;o<it;o++)tt(p[u[o]])&&w.push(u[o]);e.removeChild(h);e.removeChild(s);n.push({key:"js_fonts",value:w});t(n)},1)},pluginsKey:function(n){return this.options.excludePlugins||(this.isIE()?this.options.excludeIEPlugins||n.push({key:"ie_plugins",value:this.getIEPlugins()}):n.push({key:"regular_plugins",value:this.getRegularPlugins()})),n},getRegularPlugins:function(){for(var n=[],t=0,i=navigator.plugins.length;t<i;t++)n.push(navigator.plugins[t]);return this.pluginsShouldBeSorted()&&(n=n.sort(function(n,t){return n.name>t.name?1:n.name<t.name?-1:0})),this.map(n,function(n){var t=this.map(n,function(n){return[n.type,n.suffixes].join("~")}).join(",");return[n.name,n.description,t].join("::")},this)},getIEPlugins:function(){var n=[],t;return(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window)&&(t=["AcroPDF.PDF","Adodb.Stream","AgControl.AgControl","DevalVRXCtrl.DevalVRXCtrl.1","MacromediaFlashPaper.MacromediaFlashPaper","Msxml2.DOMDocument","Msxml2.XMLHTTP","PDF.PdfCtrl","QuickTime.QuickTime","QuickTimeCheckObject.QuickTimeCheck.1","RealPlayer","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","Scripting.Dictionary","SWCtl.SWCtl","Shell.UIHelper","ShockwaveFlash.ShockwaveFlash","Skype.Detection","TDCCtl.TDCCtl","WMPlayer.OCX","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1"],n=this.map(t,function(n){try{return new ActiveXObject(n),n}catch(t){return null}})),navigator.plugins&&(n=n.concat(this.getRegularPlugins())),n},pluginsShouldBeSorted:function(){for(var i,t=!1,n=0,r=this.options.sortPluginsFor.length;n<r;n++)if(i=this.options.sortPluginsFor[n],navigator.userAgent.match(i)){t=!0;break}return t},touchSupportKey:function(n){return this.options.excludeTouchSupport||n.push({key:"touch_support",value:this.getTouchSupport()}),n},hardwareConcurrencyKey:function(n){return this.options.excludeHardwareConcurrency||n.push({key:"hardware_concurrency",value:this.getHardwareConcurrency()}),n},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(n){return!0}},hasLocalStorage:function(){try{return!!window.localStorage}catch(n){return!0}},hasIndexedDB:function(){try{return!!window.indexedDB}catch(n){return!0}},getHardwareConcurrency:function(){return navigator.hardwareConcurrency?navigator.hardwareConcurrency:"unknown"},getNavigatorCpuClass:function(){return navigator.cpuClass?navigator.cpuClass:"unknown"},getNavigatorPlatform:function(){return navigator.platform?navigator.platform:"unknown"},getDoNotTrack:function(){return navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:"unknown"},getTouchSupport:function(){var n=0,t=!1,i;"undefined"!=typeof navigator.maxTouchPoints?n=navigator.maxTouchPoints:"undefined"!=typeof navigator.msMaxTouchPoints&&(n=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent");t=!0}catch(r){}return i="ontouchstart"in window,[n,t,i]},getCanvasFp:function(){var i=[],t=document.createElement("canvas"),n;return t.width=2e3,t.height=200,t.style.display="inline",n=t.getContext("2d"),n.rect(0,0,10,10),n.rect(2,2,6,6),i.push("canvas winding:"+(n.isPointInPath(5,5,"evenodd")===!1?"yes":"no")),n.textBaseline="alphabetic",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.font=this.options.dontUseFakeFontInCanvas?"11pt Arial":"11pt no-real-font-123",n.fillText("Cwm fjordbank glyphs vext quiz, ",2,15),n.fillStyle="rgba(102, 204, 0, 0.2)",n.font="18pt Arial",n.fillText("Cwm fjordbank glyphs vext quiz, ",4,45),n.globalCompositeOperation="multiply",n.fillStyle="rgb(255,0,255)",n.beginPath(),n.arc(50,50,50,0,2*Math.PI,!0),n.closePath(),n.fill(),n.fillStyle="rgb(0,255,255)",n.beginPath(),n.arc(100,50,50,0,2*Math.PI,!0),n.closePath(),n.fill(),n.fillStyle="rgb(255,255,0)",n.beginPath(),n.arc(75,100,50,0,2*Math.PI,!0),n.closePath(),n.fill(),n.fillStyle="rgb(255,0,255)",n.arc(75,75,75,0,2*Math.PI,!0),n.arc(75,75,25,0,2*Math.PI,!0),n.fill("evenodd"),i.push("canvas fp:"+t.toDataURL()),i.join("~")},getWebglFp:function(){var n,o=function(t){return n.clearColor(0,0,0,1),n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),"["+t[0]+", "+t[1]+"]"},h=function(n){var t,i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic");return i?(t=n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT),0===t&&(t=2),t):null},s,i,u,f,e;if(n=this.getWebglCanvas(),!n)return null;var t=[],r=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,r);s=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);n.bufferData(n.ARRAY_BUFFER,s,n.STATIC_DRAW);r.itemSize=3;r.numItems=3;i=n.createProgram();u=n.createShader(n.VERTEX_SHADER);n.shaderSource(u,"attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}");n.compileShader(u);f=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(f,"precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}");n.compileShader(f);n.attachShader(i,u);n.attachShader(i,f);n.linkProgram(i);n.useProgram(i);i.vertexPosAttrib=n.getAttribLocation(i,"attrVertex");i.offsetUniform=n.getUniformLocation(i,"uniformOffset");n.enableVertexAttribArray(i.vertexPosArray);n.vertexAttribPointer(i.vertexPosAttrib,r.itemSize,n.FLOAT,!1,0,0);n.uniform2f(i.offsetUniform,1,1);n.drawArrays(n.TRIANGLE_STRIP,0,r.numItems);null!=n.canvas&&t.push(n.canvas.toDataURL());t.push("extensions:"+n.getSupportedExtensions().join(";"));t.push("webgl aliased line width range:"+o(n.getParameter(n.ALIASED_LINE_WIDTH_RANGE)));t.push("webgl aliased point size range:"+o(n.getParameter(n.ALIASED_POINT_SIZE_RANGE)));t.push("webgl alpha bits:"+n.getParameter(n.ALPHA_BITS));t.push("webgl antialiasing:"+(n.getContextAttributes().antialias?"yes":"no"));t.push("webgl blue bits:"+n.getParameter(n.BLUE_BITS));t.push("webgl depth bits:"+n.getParameter(n.DEPTH_BITS));t.push("webgl green bits:"+n.getParameter(n.GREEN_BITS));t.push("webgl max anisotropy:"+h(n));t.push("webgl max combined texture image units:"+n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS));t.push("webgl max cube map texture size:"+n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE));t.push("webgl max fragment uniform vectors:"+n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS));t.push("webgl max render buffer size:"+n.getParameter(n.MAX_RENDERBUFFER_SIZE));t.push("webgl max texture image units:"+n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS));t.push("webgl max texture size:"+n.getParameter(n.MAX_TEXTURE_SIZE));t.push("webgl max varying vectors:"+n.getParameter(n.MAX_VARYING_VECTORS));t.push("webgl max vertex attribs:"+n.getParameter(n.MAX_VERTEX_ATTRIBS));t.push("webgl max vertex texture image units:"+n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS));t.push("webgl max vertex uniform vectors:"+n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS));t.push("webgl max viewport dims:"+o(n.getParameter(n.MAX_VIEWPORT_DIMS)));t.push("webgl red bits:"+n.getParameter(n.RED_BITS));t.push("webgl renderer:"+n.getParameter(n.RENDERER));t.push("webgl shading language version:"+n.getParameter(n.SHADING_LANGUAGE_VERSION));t.push("webgl stencil bits:"+n.getParameter(n.STENCIL_BITS));t.push("webgl vendor:"+n.getParameter(n.VENDOR));t.push("webgl version:"+n.getParameter(n.VERSION));try{e=n.getExtension("WEBGL_debug_renderer_info");e&&(t.push("webgl unmasked vendor:"+n.getParameter(e.UNMASKED_VENDOR_WEBGL)),t.push("webgl unmasked renderer:"+n.getParameter(e.UNMASKED_RENDERER_WEBGL)))}catch(c){}return n.getShaderPrecisionFormat?(t.push("webgl vertex shader high float precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision),t.push("webgl vertex shader high float precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).rangeMin),t.push("webgl vertex shader high float precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).rangeMax),t.push("webgl vertex shader medium float precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision),t.push("webgl vertex shader medium float precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).rangeMin),t.push("webgl vertex shader medium float precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).rangeMax),t.push("webgl vertex shader low float precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).precision),t.push("webgl vertex shader low float precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).rangeMin),t.push("webgl vertex shader low float precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).rangeMax),t.push("webgl fragment shader high float precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision),t.push("webgl fragment shader high float precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).rangeMin),t.push("webgl fragment shader high float precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).rangeMax),t.push("webgl fragment shader medium float precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision),t.push("webgl fragment shader medium float precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).rangeMin),t.push("webgl fragment shader medium float precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).rangeMax),t.push("webgl fragment shader low float precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).precision),t.push("webgl fragment shader low float precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).rangeMin),t.push("webgl fragment shader low float precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).rangeMax),t.push("webgl vertex shader high int precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).precision),t.push("webgl vertex shader high int precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).rangeMin),t.push("webgl vertex shader high int precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).rangeMax),t.push("webgl vertex shader medium int precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).precision),t.push("webgl vertex shader medium int precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).rangeMin),t.push("webgl vertex shader medium int precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).rangeMax),t.push("webgl vertex shader low int precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).precision),t.push("webgl vertex shader low int precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).rangeMin),t.push("webgl vertex shader low int precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).rangeMax),t.push("webgl fragment shader high int precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).precision),t.push("webgl fragment shader high int precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).rangeMin),t.push("webgl fragment shader high int precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).rangeMax),t.push("webgl fragment shader medium int precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).precision),t.push("webgl fragment shader medium int precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).rangeMin),t.push("webgl fragment shader medium int precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).rangeMax),t.push("webgl fragment shader low int precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).precision),t.push("webgl fragment shader low int precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).rangeMin),t.push("webgl fragment shader low int precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).rangeMax),t.join("~")):t.join("~")},getAdBlock:function(){var n=document.createElement("div"),t;n.innerHTML="&nbsp;";n.className="adsbox";t=!1;try{document.body.appendChild(n);t=0===document.getElementsByClassName("adsbox")[0].offsetHeight;document.body.removeChild(n)}catch(i){t=!1}return t},getHasLiedLanguages:function(){if("undefined"!=typeof navigator.languages)try{var n=navigator.languages[0].substr(0,2);if(n!==navigator.language.substr(0,2))return!0}catch(t){return!0}return!1},getHasLiedResolution:function(){return screen.width<screen.availWidth||screen.height<screen.availHeight},getHasLiedOs:function(){var n,r=navigator.userAgent.toLowerCase(),i=navigator.oscpu,t=navigator.platform.toLowerCase(),u;return(n=r.indexOf("windows phone")>=0?"Windows Phone":r.indexOf("win")>=0?"Windows":r.indexOf("android")>=0?"Android":r.indexOf("linux")>=0?"Linux":r.indexOf("iphone")>=0||r.indexOf("ipad")>=0?"iOS":r.indexOf("mac")>=0?"Mac":"Other",u="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,u&&"Windows Phone"!==n&&"Android"!==n&&"iOS"!==n&&"Other"!==n)?!0:"undefined"!=typeof i&&((i=i.toLowerCase(),i.indexOf("win")>=0&&"Windows"!==n&&"Windows Phone"!==n)||i.indexOf("linux")>=0&&"Linux"!==n&&"Android"!==n||i.indexOf("mac")>=0&&"Mac"!==n&&"iOS"!==n||0===i.indexOf("win")&&0===i.indexOf("linux")&&i.indexOf("mac")>=0&&"other"!==n)?!0:t.indexOf("win")>=0&&"Windows"!==n&&"Windows Phone"!==n||(t.indexOf("linux")>=0||t.indexOf("android")>=0||t.indexOf("pike")>=0)&&"Linux"!==n&&"Android"!==n||(t.indexOf("mac")>=0||t.indexOf("ipad")>=0||t.indexOf("ipod")>=0||t.indexOf("iphone")>=0)&&"Mac"!==n&&"iOS"!==n||0===t.indexOf("win")&&0===t.indexOf("linux")&&t.indexOf("mac")>=0&&"other"!==n||"undefined"==typeof navigator.plugins&&"Windows"!==n&&"Windows Phone"!==n},getHasLiedBrowser:function(){var n,t=navigator.userAgent.toLowerCase(),u=navigator.productSub,i,r;if((n=t.indexOf("firefox")>=0?"Firefox":t.indexOf("opera")>=0||t.indexOf("opr")>=0?"Opera":t.indexOf("chrome")>=0?"Chrome":t.indexOf("safari")>=0?"Safari":t.indexOf("trident")>=0?"Internet Explorer":"Other",("Chrome"===n||"Safari"===n||"Opera"===n)&&"20030107"!==u)||(i=eval.toString().length,37===i&&"Safari"!==n&&"Firefox"!==n&&"Other"!==n)||39===i&&"Internet Explorer"!==n&&"Other"!==n||33===i&&"Chrome"!==n&&"Opera"!==n&&"Other"!==n)return!0;try{throw"a";}catch(f){try{f.toSource();r=!0}catch(e){r=!1}}return!(!r||"Firefox"===n||"Other"===n)},isCanvasSupported:function(){var n=document.createElement("canvas");return!(!n.getContext||!n.getContext("2d"))},isWebGlSupported:function(){if(!this.isCanvasSupported())return!1;var n,t=document.createElement("canvas");try{n=t.getContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(i){n=!1}return!!window.WebGLRenderingContext&&!!n},isIE:function(){return"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent))},hasSwfObjectLoaded:function(){return"undefined"!=typeof swfobject},hasMinFlashInstalled:function(){return swfobject.hasFlashPlayerVersion("9.0.0")},addFlashDivNode:function(){var n=document.createElement("div");n.setAttribute("id",this.options.swfContainerId);document.body.appendChild(n)},loadSwfAndDetectFonts:function(n){var t="___fp_swf_loaded",i,r,u;window[t]=function(t){n(t)};i=this.options.swfContainerId;this.addFlashDivNode();r={onReady:t};u={allowScriptAccess:"always",menu:"false"};swfobject.embedSWF(this.options.swfPath,i,"1","1","9.0.0",!1,r,u,{})},getWebglCanvas:function(){var t=document.createElement("canvas"),n=null;try{n=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(i){}return n||(n=null),n},each:function(n,t,i){var r,f,u;if(null!==n)if(this.nativeForEach&&n.forEach===this.nativeForEach)n.forEach(t,i);else if(n.length===+n.length){for(r=0,f=n.length;r<f;r++)if(t.call(i,n[r],r,n)==={})return}else for(u in n)if(n.hasOwnProperty(u)&&t.call(i,n[u],u,n)==={})return},map:function(n,t,i){var r=[];return null==n?r:this.nativeMap&&n.map===this.nativeMap?n.map(t,i):(this.each(n,function(n,u,f){r[r.length]=t.call(i,n,u,f)}),r)},x64Add:function(n,t){n=[n[0]>>>16,65535&n[0],n[1]>>>16,65535&n[1]];t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var i=[0,0,0,0];return i[3]+=n[3]+t[3],i[2]+=i[3]>>>16,i[3]&=65535,i[2]+=n[2]+t[2],i[1]+=i[2]>>>16,i[2]&=65535,i[1]+=n[1]+t[1],i[0]+=i[1]>>>16,i[1]&=65535,i[0]+=n[0]+t[0],i[0]&=65535,[i[0]<<16|i[1],i[2]<<16|i[3]]},x64Multiply:function(n,t){n=[n[0]>>>16,65535&n[0],n[1]>>>16,65535&n[1]];t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var i=[0,0,0,0];return i[3]+=n[3]*t[3],i[2]+=i[3]>>>16,i[3]&=65535,i[2]+=n[2]*t[3],i[1]+=i[2]>>>16,i[2]&=65535,i[2]+=n[3]*t[2],i[1]+=i[2]>>>16,i[2]&=65535,i[1]+=n[1]*t[3],i[0]+=i[1]>>>16,i[1]&=65535,i[1]+=n[2]*t[2],i[0]+=i[1]>>>16,i[1]&=65535,i[1]+=n[3]*t[1],i[0]+=i[1]>>>16,i[1]&=65535,i[0]+=n[0]*t[3]+n[1]*t[2]+n[2]*t[1]+n[3]*t[0],i[0]&=65535,[i[0]<<16|i[1],i[2]<<16|i[3]]},x64Rotl:function(n,t){return t%=64,32===t?[n[1],n[0]]:t<32?[n[0]<<t|n[1]>>>32-t,n[1]<<t|n[0]>>>32-t]:(t-=32,[n[1]<<t|n[0]>>>32-t,n[0]<<t|n[1]>>>32-t])},x64LeftShift:function(n,t){return t%=64,0===t?n:t<32?[n[0]<<t|n[1]>>>32-t,n[1]<<t]:[n[1]<<t-32,0]},x64Xor:function(n,t){return[n[0]^t[0],n[1]^t[1]]},x64Fmix:function(n){return n=this.x64Xor(n,[0,n[0]>>>1]),n=this.x64Multiply(n,[4283543511,3981806797]),n=this.x64Xor(n,[0,n[0]>>>1]),n=this.x64Multiply(n,[3301882366,444984403]),n=this.x64Xor(n,[0,n[0]>>>1])},x64hash128:function(n,t){n=n||"";t=t||0;for(var h=n.length%16,c=n.length-h,f=[0,t],e=[0,t],r=[0,0],u=[0,0],o=[2277735313,289559509],s=[1291169091,658871167],i=0;i<c;i+=16)r=[255&n.charCodeAt(i+4)|(255&n.charCodeAt(i+5))<<8|(255&n.charCodeAt(i+6))<<16|(255&n.charCodeAt(i+7))<<24,255&n.charCodeAt(i)|(255&n.charCodeAt(i+1))<<8|(255&n.charCodeAt(i+2))<<16|(255&n.charCodeAt(i+3))<<24],u=[255&n.charCodeAt(i+12)|(255&n.charCodeAt(i+13))<<8|(255&n.charCodeAt(i+14))<<16|(255&n.charCodeAt(i+15))<<24,255&n.charCodeAt(i+8)|(255&n.charCodeAt(i+9))<<8|(255&n.charCodeAt(i+10))<<16|(255&n.charCodeAt(i+11))<<24],r=this.x64Multiply(r,o),r=this.x64Rotl(r,31),r=this.x64Multiply(r,s),f=this.x64Xor(f,r),f=this.x64Rotl(f,27),f=this.x64Add(f,e),f=this.x64Add(this.x64Multiply(f,[0,5]),[0,1390208809]),u=this.x64Multiply(u,s),u=this.x64Rotl(u,33),u=this.x64Multiply(u,o),e=this.x64Xor(e,u),e=this.x64Rotl(e,31),e=this.x64Add(e,f),e=this.x64Add(this.x64Multiply(e,[0,5]),[0,944331445]);switch(r=[0,0],u=[0,0],h){case 15:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+14)],48));case 14:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+13)],40));case 13:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+12)],32));case 12:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+11)],24));case 11:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+10)],16));case 10:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+9)],8));case 9:u=this.x64Xor(u,[0,n.charCodeAt(i+8)]);u=this.x64Multiply(u,s);u=this.x64Rotl(u,33);u=this.x64Multiply(u,o);e=this.x64Xor(e,u);case 8:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+7)],56));case 7:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+6)],48));case 6:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+5)],40));case 5:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+4)],32));case 4:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+3)],24));case 3:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+2)],16));case 2:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+1)],8));case 1:r=this.x64Xor(r,[0,n.charCodeAt(i)]);r=this.x64Multiply(r,o);r=this.x64Rotl(r,31);r=this.x64Multiply(r,s);f=this.x64Xor(f,r)}return f=this.x64Xor(f,[0,n.length]),e=this.x64Xor(e,[0,n.length]),f=this.x64Add(f,e),e=this.x64Add(e,f),f=this.x64Fmix(f),e=this.x64Fmix(e),f=this.x64Add(f,e),e=this.x64Add(e,f),("00000000"+(f[0]>>>0).toString(16)).slice(-8)+("00000000"+(f[1]>>>0).toString(16)).slice(-8)+("00000000"+(e[0]>>>0).toString(16)).slice(-8)+("00000000"+(e[1]>>>0).toString(16)).slice(-8)}},n.VERSION="1.5.1",n});var Fprinting=function(){function u(){var r=jQuery.Deferred(),u=t(n.cookieName),f;return u==null||u==""?e().Desktop?new Fingerprint2({excludeIndexedDB:!0,excludeLanguage:!0,excludeScreenResolution:!0,excludeAdBlock:!0,excludeDoNotTrack:!0,preprocessor:function(t,i){return n.optionsWithCustomLogic[t]!=undefined?n.optionsWithCustomLogic[t](i):i}}).get(function(n){i(n);r.resolve(n)}):(f=o(),i(f),r.resolve(f)):r.resolve(u),r.promise()}function f(t,i){var r=new Date,u;r.setTime(r.getTime()+n.expireDays*864e5);u="expires="+r.toUTCString();document.cookie=t+"="+i+";"+u+";path=/"}function t(n){for(var t,r=n+"=",f=decodeURIComponent(document.cookie),u=f.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}function i(t){f(n.cookieName,t)}function e(){function t(n){return i.indexOf(n)!==-1}var i=window.navigator.userAgent.toLowerCase(),n={};return n.ios=function(){return n.iphone()||n.ipod()||n.ipad()},n.iphone=function(){return!n.windows()&&t("iphone")},n.ipod=function(){return t("ipod")},n.ipad=function(){return t("ipad")},n.android=function(){return!n.windows()&&t("android")},n.androidPhone=function(){return n.android()&&t("mobile")},n.androidTablet=function(){return n.android()&&!t("mobile")},n.blackberry=function(){return t("blackberry")||t("bb10")||t("rim")},n.blackberryPhone=function(){return n.blackberry()&&!t("tablet")},n.blackberryTablet=function(){return n.blackberry()&&t("tablet")},n.windows=function(){return t("windows")},n.windowsPhone=function(){return n.windows()&&t("phone")},n.windowsTablet=function(){return n.windows()&&t("touch")&&!n.windowsPhone()},n.fxos=function(){return(t("(mobile;")||t("(tablet;"))&&t("; rv:")},n.fxosPhone=function(){return n.fxos()&&t("mobile")},n.fxosTablet=function(){return n.fxos()&&t("tablet")},n.meego=function(){return t("meego")},n.cordova=function(){return window.cordova&&location.protocol==="file:"},n.nodeWebkit=function(){return typeof process=="object"},n.mobile=function(){return n.androidPhone()||n.iphone()||n.ipod()||n.windowsPhone()||n.blackberryPhone()||n.fxosPhone()||n.meego()},n.tablet=function(){return n.ipad()||n.androidTablet()||n.blackberryTablet()||n.windowsTablet()||n.fxosTablet()},n.desktop=function(){return!n.tablet()&&!n.mobile()},{Mobile:n.mobile(),Tablet:n.tablet(),Desktop:n.desktop()}}function o(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()+n()+n()+n()+n()}var r=function(n){return n.replace(/\/[0-9.]{1,}/g,"")},n={cookieName:"anonDeviceId",expireDays:36500,optionsWithCustomLogic:{user_agent:r}};return{init:u,getDeviceId:function(){return t(n.cookieName)}}},ConnextLogger=function(n){function e(n){var r=[],i;if(rest=t.length-n<=0?0:t.length-n,r.push(f()),arguments.length===0)return t.unshift(f()),t;for(i=rest;i<t.length;i+=1)r.push(t[i]);return r}function f(){var r=CnnXt.Utils.GetUserMeta(),n=Connext.GetOptions(),i={};for(var t in n)typeof n[t]=="object"||typeof n[t]=="function"||Array.isArray(n[t])||(i[t]=n[t]);return"USER META:"+JSON.stringify(r)+" || OPTIONS: "+JSON.stringify(i)}function r(){var i;try{var r=Array.prototype.slice.call(arguments[2]),u=arguments[0],e=arguments[1],o=r.length,f=[],t=[];o>0&&n.each(r,function(n,i){typeof i=="string"?f.push(i):t.push(i)});i=e+f.join(" => ");t.length>0?console[u](i,t):console[u](i)}catch(s){}}function u(){try{var u=Array.prototype.slice.call(arguments[1]),o=arguments[0],s=u.length,f=[],i=[],e=(new Date).getHours()+":"+(new Date).getMinutes()+":"+(new Date).getSeconds()+"."+(new Date).getMilliseconds(),r;s>0&&n.each(u,function(n,t){var u,r;if(typeof t=="string")f.push(t);else if(Array.isArray(t))i.push("Array("+t.length+")");else if(typeof t=="object"){u={};for(r in t)typeof t[r]=="object"||Array.isArray(t)||(u[r]=t[r]);i.push(u)}else i.push(t)});r=o+f.join(" => ");i.length>0?t.push(e+" || "+r+", "+JSON.stringify(i)):t.push(e+" || "+r)}catch(h){}}var i=!1,t=[];return{debug:function(){i&&r("log","ConneXt >>>> DEBUG <<<<< ",arguments);u("ConneXt >>>> DEBUG <<<<< ",arguments)},warn:function(){r("warn","ConneXt >>>> WARNING <<<<< ",arguments);u("ConneXt >>>> WARNING <<<<< ",arguments)},exception:function(){i&&r("error","ConneXt >>>> EXCEPTION <<<<< ",arguments);u("ConneXt >>>> EXCEPTION <<<<< ",arguments)},setDebug:function(n){i=n},startTracing:function(){n.jStorage.set("cxt_trcng",{isDebugging:!0});this.setDebug(!0)},stopTracing:function(){n.jStorage.set("cxt_trcng",{isDebugging:!1});this.setDebug(!1)},getSessionLogs:e}},ConnextCommon=function(){return{S3RootUrl:{localhost:"https://mg2assetsdev.blob.core.windows.net/connext/dev/",dev:"https://mg2assetsdev.blob.core.windows.net/connext/dev/",test:"https://mg2assetsdev.blob.core.windows.net/connext/test/",demo:"https://prodmg2.blob.core.windows.net/connext/demo/",stage:"https://prodmg2.blob.core.windows.net/connext/stage/",test20:"https://prodmg2.blob.core.windows.net/connext/test20/",prod:"https://prodmg2.blob.core.windows.net/connext/prod/",preprod:"https://prodmg2.blob.core.windows.net/connext/preprod/"},S3LastPublishDatePath:"data/last_publish/<%- siteCode %>.json",CSSPluginUrl:{localhost:"//localhost:20001/plugin/assets/css/themes/",dev:"https://mg2assetsdev.blob.core.windows.net/connext/dev/1.13/themes/",test:"https://mg2assetsdev.blob.core.windows.net/connext/test/1.13/themes/",stage:"https://prodmg2.blob.core.windows.net/connext/stage/1.13/themes/",demo:"https://prodmg2.blob.core.windows.net/connext/demo/1.13/themes/",test20:"https://prodmg2.blob.core.windows.net/connext/test20/1.13/themes/",prod:"https://cdn.mg2connext.com/prod/1.6/themes/",preprod:"https://cdn.mg2connext.com/preprod/1.6/themes/"},APIUrl:{localhost:"https://dev-connext-api.azurewebsites.net/",dev:"https://dev-connext-api.azurewebsites.net/",test:"https://test-connext-api.azurewebsites.net/",stage:"https://stage-mg2-proxy-connext.azurewebsites.net/",test20:"https://test20-connext-api.azurewebsites.net/",demo:"https://demo-connext-api.azurewebsites.net/",preprod:"https://preprod-connext-api.azurewebsites.net/",prod:"{{apiUrl}}"},APPInsightKeys:{localhost:"a57959cf-5e4d-4ab3-8a3e-d17f7e2a8bf8",dev:"a57959cf-5e4d-4ab3-8a3e-d17f7e2a8bf8",test:"c35138a3-3d28-4543-9a47-b693ce4d744e",stage:"17780e8e-a865-44bd-a20d-4f50f5f38ddb",test20:"adbc9fed-bb63-4105-8904-61ade12b2006",preprod:"34e4d18d-cb50-44e5-88bc-f26520e5d4c3",demo:"e336d95f-e0ab-48a9-956e-1d79f6fd5fe8",prod:"1819964f-57a2-45c2-b878-c270d7e5d1d9"},Environments:["localhost","dev","test","stage","demo","prod","test20"],IPInfo:window.location.protocol+"//api-mg2.db-ip.com/v2/p14891b727f063924f0d86d8a8e5063678abd2ac/self",StorageKeys:{configuration:"Connext_Configuration",userToken:"Connext_UserToken",janrainUserProfile:"janrainCaptureProfileData",accessToken:"Connext_AccessToken",viewedArticles:"Connext_ViewedArticles",lastPublishDate:"Connext_LastPublishDate",conversations:{current:"Connext_CurrentConversations",previous:"Connext_PreviousConversations"},user:{state:"Connext_UserState",zipCodes:"Connext_UserZipCodes",data:"Connext_userData"},configurationSiteCode:"Connext_Configuration_SiteCode",configurationConfigCode:"Connext_Configuration_ConfigCode",configurationIsCustom:"Connext_Configuration_isCustom",customZip:"CustomZip",repeatablesInConv:"repeatablesInConv",igmRegID:"igmRegID",igmContent:"igmContent",igmAuth:"igmAuth",connext_user_Id:"connext_anonymousUserId",WhitelistSet:"WhitelistSet",WhitelistInfobox:"WhitelistInfobox",NeedHidePinTemplate:"NeedHidePinTemplate",PinAttempts:"PinAttempts",connext_user_profile:"connext_user_profile",connext_user_data:"connext_user_data",connext_paywallFired:"connext_paywallFired",connext_auth_type:"connext_auth_type",connext_viewstructure:"nxt",connext_userLastUpdateDate:"connext_userLastUpdateDate",connext_updateArticleCount:"nxt_upd_ac",connext_domain:"nxt_dmn",connext_root_domain:"nxt_rt_dmn",connext_check_domain_write:"nxt_ckck_dmn_wrt",device_postfix:"_device",connext_time_repeatable_actions:"nxtact"},MeteredArticleCountObj:{active_convo_id:"_acnv"},ConvoArticleCountObj:{article_count:"ac",device_article_count:"ac_d",start_date:"s"},TimeRepeatableActionsCS:{repeat_after:"rpt",count:"rtpc"},MeterLevels:{1:"Free",2:"Metered",3:"Premium"},ConversationOptionNamesMap:{Expiration:{2:"Time",6:"Register",11:"CustomAction",27:"UserState",32:"JSVar",57:"FlittzStatus"},Activation:{38:"Activate"},Filter:{1:"Geo",2:"Javascript",3:"DeviceType",4:"UserState",5:"AdBlock"}},FlittzStatusesMap:{FlittzLoggedIn:"Logged In",FlittzLoggedOut:"Logged Out"},ActionOptionMap:{Who:[5,6,14,16,17,18,19,21,23,24,25,12,27,28,29,30,31],What:[2,7,13,20,15,22,26],When:[8,9,10]},ConversationOptionMap:{Expiration:[2],Filter:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],Activation:[4]},WhenClassMap:{8:"Time",9:"EOS",10:"Hover"},DefaultArticleFormat:"MMM Do, YYYY",QualifierMap:{"==":"==","=":"==",Equal:"==",Equals:"==","Not Equal":"!=","Not Equals":"!=","More Than":">","Less Than":"<","More Or Equal Than":">=","Less Or Equal Than":"<=",Yes:"true",No:"false","More Than Or Equals To":">=","Less Than Or Equals To":"<="},ERROR:{NO_CONFIG:{code:600,message:"No Configuration Found. ",custom:!0},NO_CONVO_FOUND:{code:601,message:"No Conversation found to process. ",custom:!0},NO_SITE_CODE:{code:602,message:"No Site Code. ",custom:!0},NO_CONFIG_CODE:{code:603,message:"No Config Code. ",custom:!0},NO_JQUERY:{code:604,message:"Jquery not loaded. ",custom:!0},NO_METER_LEVEL_SET:{code:605,message:"No meter level set. ",custom:!0},NO_CAMPAIGN:{code:606,message:"No campaign data. ",custom:!0},NO_AUTH0_LOCK:{code:607,message:"No auth0Lock object in the authSettings! ",custom:!0},UNKNOWN_REG_TYPE:{code:608,message:"Unknown registration type. ",custom:!0},UNKNOWN_USER_STATE:{code:609,message:"Unknown user state. ",custom:!0},NO_USER_DATA:{code:610,message:"No user data result. ",custom:!0},NO_JANRAIN_DATA:{code:611,message:"No user data UUID. ",custom:!0},CONFIG_HAS_NOT_PUBLISHED:{code:612,message:"Configuration has not published. ",custom:!0},S3DATA_IS_INVALID:{code:613,message:"s3Data is not an object. ",custom:!0},HIDE_CONTENT:{code:614,message:"Cannot hide content! ",custom:!0}},DownloadConfigReasons:{noLocalConfig:"localStorage config not found",noLocalPublishDate:"localStorage config found, no publishDate found",getPublishFailed:"localStorage config found, error getting server publishFile",parsePublishFailed:"localStorage config found, server publishFile downloaded, error parsing",noConfigCodeinPublish:"localStorage config found, server publishFile downloaded and parsed, configCode not found",oldConfig:"localStorage config found, server publishFile downloaded and parsed, configCode found, local config is old"},AppInsightEvents:{APICall:"APICall",LoadConnext:"LoadConnext"},RegistrationTypes:{1:"MG2",2:"Janrain",3:"GUP",4:"Auth0",5:"Custom"},AuthSystem:{MG2:1,Janrain:2,GUP:3,Auth0:4,Custom:5},DigitalAccessLevels:{Premium:"PREMIUM",Upgrade:"UPGRADE",Purchase:"PURCHASE"},USER_STATES:{NotLoggedIn:"Logged Out",LoggedIn:"Logged In",NoActiveSubscription:"No Active Subscription",SubscribedNotEntitled:"Subscribed Not Entitled",Subscribed:"Subscribed"},ValidationPatterns:{email:/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i,atLeast1Letter1Number:/(?=.*[a-zA-Z])(?=.*[\d])/,atLeast1Letter:/(?=.*[a-zA-Z])/,atLeast1CapitalLetter:/(?=.*[a-zA-Z])/,atLeast1LowerCaseLetter:/(?=.*[a-z])/,atLeast1UpperCaseLetter:/(?=.*[A-Z])/,atLeast1SpecialCharacter:/(?=.*[!@#$%^&*])/,atLeast1Number:/(?=.*[\d])/},TimeTypeMap:{s:"seconds",m:"minutes",h:"hours",d:"days",w:"weeks",M:"months",Y:"years"},DisplayName:"ConneXt",InfinityDate:"9999-01-01",CookieExpireDate:"2018-02-28",CLOSE_CASES:{CloseButton:"closeButton",CloseSpan:"closeSpan",ClickOutside:"clickOutside",EscButton:"escButton"}}},ConnextEvents=function(n){function r(t){CnnXt.GetOptions().debug&&(h.push(t),n("#ddNote").text(t))}function l(n){t.debug("Fire Default onInit function.",n)}function a(n){n.EventData.conversation=CnnXt.Storage.GetCurrentConversation();n.EventData.viewCount=CnnXt.Campaign.GetCurrentConversationViewCount();n.EventData.hasFlittz=i.integrateFlittz;window.CommonFz.PushData("Connext-onFlittzPaywallShown",n);t.debug("Flittz paywall shown",n)}function v(n){n.EventData.conversation=CnnXt.Storage.GetCurrentConversation();n.EventData.viewCount=CnnXt.Campaign.GetCurrentConversationViewCount();n.EventData.hasFlittz=i.integrateFlittz;window.CommonFz.PushData("Connext-onFlittzPaywallClosed",n);t.debug("Flittz paywall closed",n)}function y(n){n.EventData.conversation=CnnXt.Storage.GetCurrentConversation();n.EventData.viewCount=CnnXt.Campaign.GetCurrentConversationViewCount();n.EventData.hasFlittz=i.integrateFlittz;window.CommonFz.PushData("Connext-onFlittzButtonClick",n);t.debug("Click on Flittz button",n)}function p(i){CnnXt.GetOptions().debug&&(t.debug("Fire Default onCriticalError function.",i),h.push(i.EventData.message),n("#ddNote").text(i.EventData.message))}function w(i){t.debug("Fire Default onDynamicMeterFound function.",i);CnnXt.GetOptions().debug&&n("#ddMeterSet").text(i.EventData)}function b(i){CnnXt.GetOptions().debug&&n("#ddMeterLevel").text(CnnXt.Common.MeterLevels[i.EventData.level]+" ("+i.EventData.method+")");t.debug("Fire Default onMeterLevelSet function.",i);CnnXt.Storage.SetMeter(i.EventData)}function k(n){t.debug("Fire Default onLoggedIn function.",n)}function d(n){t.debug("Fire Default onHasAccess function.",n);r("onHasAccess")}function g(n){t.debug("Fire Default onHasAccessNotEntitled function.",n);r("onHasAccessNotEntitled")}function nt(n){t.debug("Fire Default onHasNoActiveSubscription function.",n);r("onHasNoActiveSubscription")}function tt(n){t.debug("Fire Default onAuthorized function.",n);r("onAuthorized")}function it(n){t.debug("Fire Default onNotAuthorized function.",n);r("onNotAuthorized")}function rt(i){CnnXt.GetOptions().debug&&n("#ddCampaign").text(i.EventData.Name);t.debug("Fire Default onCampaignFound function.",i)}function ut(n){t.debug("Fire Default onConversationDetermined function.",n)}function ft(r){t.debug("Fire Default onActionShown",r);r&&r.EventData&&r.EventData.actionDom&&n(r.EventData.actionDom).hasClass("flittz")&&i.integrateFlittz&&CnnXt.Event.fire("onFlittzPaywallShown",r.EventData);r&&r.ActionTypeId==3&&CnnXt.Storage.SetConnextPaywallCookie(!0);CnnXt.Action.actionStartTime=Date.now()}function et(i){if(CnnXt.GetOptions().debug){CnnXt.Action.actionEndTime=Date.now();var r=CnnXt.Action.actionEndTime-CnnXt.Action.actionStartTime;n("#ddViewTime")[0].textContent=r+"ms"}t.debug("Fire Default onActionClosed",i)}function ot(n){t.debug("Fire Default onButtonClick",n)}function st(n){t.debug("Fire Default onLoginShown",n)}function ht(n){t.debug("Fire Default onLoginClosed",n)}function ct(n){t.debug("Fire Default onLoginSuccess",n)}function lt(n){t.debug("Fire Default onLoginError",n)}function at(n){t.debug("Fire Default onAccessTemplateShown",n)}function vt(n){t.debug("Fire Default onAccessTemplateClosed",n)}function yt(n){t.debug("Fire Default onAccessGranted",n)}function pt(n){t.debug("Fire Default onAccessDenied",n)}function wt(n){t.debug("Fire Default onActivationFormShown",n)}function bt(n){t.debug("Fire Default onActivationLoginStepShown",n)}function kt(n){t.debug("Fire Default onActivationLoginStepClosed",n)}function dt(n){t.debug("Fire Default onActivationLinkStepShown",n)}function gt(n){t.debug("Fire Default onActivationLinkStepClosed",n)}function ni(n){t.debug("Fire Default onActivationLinkStepSubmitted",n)}function ti(n){t.debug("Fire Default onActivationLinkSuccessStepShown",n)}function ii(n){t.debug("Fire Default onActivationLinkSuccessStepClosed",n)}function ri(n){t.debug("Fire Default onActivationLinkErrorStepShown",n)}function ui(n){t.debug("Fire Default onActivationLinkErrorStepClosed",n)}function fi(n){t.debug("Fire Default onActivationFormClosed",n)}function ei(){t.debug("Fire Default onRun")}function oi(){if(CnnXt.GetOptions().debug){var i=CnnXt.Storage.GetCurrentConversationViewCount();n("#ddCurrentConversationArticleViews").text(i)}t.debug("Fire Default onFinish")}function si(){t.debug("Fire Default onNewsdayButtonClick");window.setDestUrl&&__.isFunction(window.setDestUrl)&&window.setDestUrl()}var u="Events";const c=["onDynamicMeterFound","onCampaignFound","onHasAccess","onHasAccessNotEntitled","onHasNoActiveSubscription","onAuthorized","onDebugNote"];var i,t,e,f=null,o=null,s={onMeterLevelSet:b,onDynamicMeterFound:w,onCampaignFound:rt,onConversationDetermined:ut,onHasAccess:d,onHasAccessNotEntitled:g,onHasNoActiveSubscription:nt,onCriticalError:p,onAuthorized:tt,onLoggedIn:k,onNotAuthorized:it,onDebugNote:r,onActionShown:ft,onActionClosed:et,onInit:l,onButtonClick:ot,onRun:ei,onFinish:oi,onLoginShown:st,onLoginClosed:ht,onLoginSuccess:ct,onLoginError:lt,onAccessTemplateShown:at,onAccessTemplateClosed:vt,onAccessGranted:yt,onAccessDenied:pt,onFlittzPaywallShown:a,onFlittzPaywallClosed:v,onFlittzButtonClick:y,onActivationFormShown:wt,onActivationLoginStepShown:bt,onActivationLoginStepClosed:kt,onActivationLinkStepShown:dt,onActivationLinkStepClosed:gt,onActivationLinkStepSubmitted:ni,onActivationLinkSuccessStepShown:ti,onActivationLinkSuccessStepClosed:ii,onActivationLinkErrorStepShown:ri,onActivationLinkErrorStepClosed:ui,onActivationFormClosed:fi,onNewsdayButtonClick:si},h=[];return{init:function(n){t=CnnXt.Logger;t.debug(u,"Initializing Events Module...");i=n?n:{debug:!0}},fire:function(r,h){var y="fire",l,p,v,w,a,b,k,g;try{if(l={EventData:h},r=="onMeterLevelSet"&&(f=h.level,o=h.method),p=null,v=null,CnnXt.Storage&&CnnXt.Storage.GetLocalConfiguration()&&(p=CnnXt.Storage.GetLocalConfiguration().Site.RegistrationTypeId,v=CnnXt.Common.RegistrationTypes[p]),r=="onLoggedIn"&&(v=h.AuthSystem?h.AuthSystem:"",e=h.MG2AccountData?h.MG2AccountData:""),l.AuthSystem=v,l.AuthProfile=CnnXt.Storage.GetUserProfile(),l.MG2AccountData=e,a=CnnXt.Storage.GetCurrentConversation(),a&&(h&&(h.actionId||h.id)&&(w=h.actionId?__.findWhere(a.Actions,{id:h.actionId}):__.findWhere(a.Actions,{id:h.id})),l.Config=CnnXt.Storage.GetLocalConfiguration(),l.Action=w,l.Conversation=a,l.CampaignName=l.Config?l.Config.Campaign.Name:"",l.CampaignId=a.CampaignId,l.MeterLevel=CnnXt.Common.MeterLevels[f],l.MeterLevelId=f,l.MeterLevelMethod=o),__.isObject(l.EventData)&&((r=="onActionShown"||r=="onActionClosed")&&(l.EventData.ArticlesLeft=a.Props.ArticleLeft,l.EventData.ArticlesViewed=a.Props.views,l.EventData.ZipCodes=CnnXt.Storage.GetActualZipCodes()),r=="onButtonClick"&&(b=l.EventData.target?l.EventData.target.outerHTML:null,k=l.EventData.target?n(l.EventData.target).attr("data-connext-userdefined"):null,l.EventData={DOMEvent:l.EventData,ButtonHTML:b,UserDefinedDataAttr:k,ZipCodes:CnnXt.Storage.GetActualZipCodes(),ArticlesLeft:a?a.Props.ArticleLeft:undefined,ArticlesViewed:a?a.Props.views:undefined}),h&&h.What&&(l.EventData.UserDefinedData=h.What.UserDefinedData?h.What.UserDefinedData:null)),l.Config=CnnXt.Storage.GetLocalConfiguration(),__.isFunction(s[r])){s[r](l);try{__.isFunction(i[r])&&i[r](l)}catch(d){t.exception(u,y,"USER CALLBACK FUNCTION",d)}g=new CustomEvent(r,{detail:l});document.dispatchEvent(g);c.indexOf(r)===-1&&CnnXt.AppInsights.trackEvent(r,l)}else t.debug(u,y,r,"Event function does not exist")}catch(d){t.exception(u,y,d)}}}},ConnextUtils=function(n){function dt(n){var f=!1,t,i,r,u;if(typeof n=="string"&&(t=n.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/),t)){for(i=[],r=1;r<t.length;r++)u=parseInt(t[r]),u>=0&&u<=255&&i.push(u);i.length===4&&(f=v(i))}return f}function a(n){var t=!1;return typeof n=="number"&&isFinite(n)&&(t=s(n&4294967295).join(".")),t}function s(n){return[n>>>24&255,n>>>16&255,n>>>8&255,n>>>0&255]}function v(n){return((n[0]*256+n[1])*256+n[2])*256+n[3]}function gt(n){return n?-1<<32-n:0}function ni(n,t){for(var r=s(n),f=s(t),u=[],i=0;i<r.length;i++)u.push(r[i]&f[i]);return v(u)}var i="Utils",t,e,u={},r,o,f=[],y=function(n){var u="processConfiguration",r,f;try{return t.debug(i,u,"Starting to process configuration...",n),e=n.Site,r={},f=[],r.Settings=__.pick(n,"AccessRules","Active","Code","DefaultMeterLevel","CampaignId","DynamicMeterId","Name","LastPublishDate","Settings","UseParentDomain","ActivationTemplate","DefaultProduct","ReturnUrl","UseActivationFlow"),n.DynamicMeter&&(n.DynamicMeter.Rules=__.sortBy(n.DynamicMeter.Rules,function(n){return n.Priority}),r.DynamicMeter=ft(n.DynamicMeter)),r.Settings&&(r.Settings=p(r.Settings),r.Settings.LoginModal=n.Template?n.Template.Html:"",r.Settings.LoginModalName=n.Template?n.Template.Name:"",r.Settings.LoginModalId=n.Template?n.Template.id:null),r.Site=n.Site,r.Campaign=n.Campaign?w(n.Campaign):{},n.Configuration_WhitelistSets&&n.Configuration_WhitelistSets.forEach(function(n){f.push(n.WhitelistSet)}),r.WhitelistSets=f,t.debug(i,u,"done processing configuration",r),r}catch(o){t.exception(i,u,o)}},p=function(n){var r="checkForLastPublishDate";t.debug(i,r,n);try{return n.LastPublishDate||(t.debug(i,r,"Configuration.Settings.LastPublishDate is null...setting it to todays datetime."),n.LastPublishDate=(new Date).format()),n}catch(u){return t.exception(i,r,u),n}},w=function(n){var u="processCampaignData",r;try{return r=__.pick(n,"id","Name","Conversations"),r.Conversations=b(r.Conversations),t.debug(i,u,"processedCampaign",r),r}catch(f){t.exception(i,u,f)}},b=function(r){var f="processConversationData",e,u;try{return t.debug(i,f,"conversations",r),e={paywallLimit:null,isExpired:!1,expiredReason:null,Date:{started:null,ended:null,expiration:null}},n.each(r,function(n,t){t.Options=k(t.Options);t.Props=e;t.Actions=tt(t.Actions)}),u=__.groupBy(r,"MeterLevelId"),u=__.replaceObjKeysByMap(u,CnnXt.Common.MeterLevels),t.debug(i,f,"Grouped Conversations By Meter Level",u),u}catch(o){t.exception(i,f,o)}},k=function(n){t.debug(i,"processConversationOptions",n);var r=__.filter(n,function(n){return __.contains(CnnXt.Common.ConversationOptionMap.Expiration,n.ConversationOption.ClassId)}),u=__.filter(n,function(n){return __.contains(CnnXt.Common.ConversationOptionMap.Activation,n.ConversationOption.ClassId)}),f=__.filter(n,function(n){return __.contains(CnnXt.Common.ConversationOptionMap.Filter,n.ConversationOption.ClassId)});return{Expirations:d(r),Activation:g(u),Filter:nt(f)}},d=function(n){return t.debug(i,"processExpirationOptions",n),h(n,"Expiration")},g=function(n){return t.debug(i,"processActivationOptions",n),h(n,"Activation")},nt=function(n){return t.debug(i,"processFilterOptions",n),c(n,{Entity:"ConversationOption",EntityParentId:"ParentConversationOptionId",Entity_OptionClass:"Conversation_OptionClass"})},h=function(r,u){var e="processOptionsForClass",o,f;try{return t.debug(i,e,arguments),o=__.groupBy(r,function(n){return n.ConversationOption.ParentConversationOptionId}),f={},n.each(o,function(t,i){var r={};n.each(i,function(n,t){r[t.ConversationOption.DisplayName]=t.Value});f[CnnXt.Common.ConversationOptionNamesMap[u][t]]=r}),t.debug(i,e,"Processed options",f),f}catch(s){return t.exception(i,e,s),{}}},tt=function(r){var u="processConversationActions";t.debug(i,u,r);try{return n.each(r,function(t,i){var u=e.Client.Client_ActionOption_Exceptions;n.each(u,function(n,t){i.ActionOptionValues=__.reject(i.ActionOptionValues,function(n){return n.ActionOptionId==t.ActionOptionId||n.ActionOption.ActionOptionParentId==t.ActionOptionId})});var f=__.filter(i.ActionOptionValues,function(n){return __.contains(CnnXt.Common.ActionOptionMap.Who,n.ActionOption.ClassId)}),o=__.filter(i.ActionOptionValues,function(n){return __.contains(CnnXt.Common.ActionOptionMap.What,n.ActionOption.ClassId)}),s=__.filter(i.ActionOptionValues,function(n){return __.contains(CnnXt.Common.ActionOptionMap.When,n.ActionOption.ClassId)});i.Who=it(f);i.What=rt(o);i.When=ut(s);r[t]=__.omit(i,"ActionOptionValues")}),t.debug(i,u,"Processed actions",r),__.sortBy(r,"Order")}catch(f){t.exception(i,u,f)}},it=function(n){var r="processWhoOptions",u;t.debug(i,r,n);try{return u=c(n,{Entity:"ActionOption",EntityParentId:"ActionOptionParentId",Entity_OptionClass:"Action_OptionClass"}),t.debug(i,r,"Processed who options",u),u}catch(f){t.exception(i,r,f)}},rt=function(r){var e="processWhatOptions";t.debug(i,e,r);try{var u={},s=CnnXt.Utils.getDeviceType(),h=__.groupBy(r,"CriteriaInstanceNumber"),f={},o=[];return!r||!r.length?u:(n.each(h,function(n,t){var i;t.forEach(function(t){t.ActionOption.Name=="TemplateDeviceSettings"&&(i=t);n==1&&(t.ActionOption.Name=="ActionType"&&o.push(t),t.ActionOption.Name=="UserDefinedData"&&o.push(t))});i?f[i.Value]=t:f.Default=t}),f[s]?f[s].forEach(function(n){u[n.ActionOption.DisplayName]=n.Value}):f.Default.forEach(function(n){u[n.ActionOption.DisplayName]=n.Value}),o.forEach(function(n){u[n.ActionOption.DisplayName]=n.Value}),t.debug(i,e,"Processed what options",u),u)}catch(c){t.exception(i,e,c)}},ut=function(r){var f="processWhenOptions",u,e;t.debug(i,f,r);try{return(u={},e={},!r||!r.length)?u:(n.each(r,function(n,t){e[t.ActionOption.DisplayName]=t.Value}),u[CnnXt.Common.WhenClassMap[r[0].ActionOption.ClassId]]=e,t.debug(i,f,"Processed when options",u),u)}catch(o){t.exception(i,f,o)}},c=function(r,u){var e="mapOptionsByClassesAndInstances";t.debug(i,e,arguments);try{var f={},o=[],s=__.groupBy(r,function(n){return n[u.Entity][u.EntityParentId]});return n.each(s,function(t){var i=__.groupBy(s[t],"CriteriaInstanceNumber");n.each(i,function(n){o.push(i[n])})}),o.forEach(function(n){var i={},t=n[0][u.Entity][u.Entity_OptionClass].Name;n.forEach(function(n){var t=n[u.Entity].DisplayName;t=t.replace(n[u.Entity][u.EntityParentId],"");i[t]=n.Value});f[t]&&f[t].length?f[t].push(i):f[t]=[i]}),t.debug(i,e,"Maped Options By Classes And Instances",f),f}catch(h){t.exception(i,e,h)}},ft=function(r){var u="processDynamicMeter";t.debug(i,u,r);try{return n.each(r.Rules,function(t,i){n.each(i.Segments,function(t,r){var o=__.find(r.SegmentOptionValues,function(n){return n.SegmentOption.ClassId!=null}).SegmentOption.Segment_OptionClass.Name,u={},s=e.Client.Client_SegmentOption_Exceptions,f;n.each(s,function(n,u){f=__.reject(r.SegmentOptionValues,function(n){return n.SegmentOptionId==u.SegmentOptionId||n.SegmentOption.SegmentOptionParentId==u.SegmentOptionId});f.length!=r.SegmentOptionValues.length&&(i.Segments[t]=null)});i.Segments[t]!=null&&(n.each(r.SegmentOptionValues,function(n,t){var i=t.SegmentOption.DisplayName;i=i.replace(t.SegmentOption.SegmentOptionParentId,"");u[i]=t.Value}),r.Options=u,r.SegmentType=o,i.Segments[t]=__.omit(r,"SegmentOptionValues"))});i.Segments=__.filter(i.Segments,function(n){return n!=null})}),t.debug(i,u,"Processed dynamicmeter",r),r}catch(f){t.exception(i,u,f)}},et=function(r){var f="mergeConfiguration",e,u;t.debug(i,f,r);try{CnnXt.Storage.SetLocalConfiguration(r);e=CnnXt.Storage.GetCurrentConversations();u={};n.each(e,function(t,i){var f=__.findByKey(r.Campaign.Conversations[t],{id:i.id});f&&(u[t]=n.extend({},f),u[t].Props=i.Props)});CnnXt.Storage.SetCurrentConversations(u);t.debug(i,f,"Done",u)}catch(o){t.exception(i,f,o)}},ot=function(){var i=n("#ConnextSiteCode").val(),r=n("#ConnextConfigCode").val(),t=n("#ConnextCustomConfiguration").prop("checked");t&&(CnnXt.Storage.ClearConfigSettings(),CnnXt.Storage.SetSiteCode(i),CnnXt.Storage.SetConfigCode(r.toUpperCase()),CnnXt.Storage.SetIsCustomConfiguration(t))},st=function(r,u){var e="resolveQualifiersFor",f,h;try{if(f=!0,t.debug(i,e,r),!r)return f;if(r.HiddenFieldCriteria&&f&&r.HiddenFieldCriteria.forEach(function(n){f&&(t.debug(i,e,"Checking HiddenFieldCriteria: ",n),CnnXt.Utils.JSEvaluate(CnnXt.Utils.GetHiddenFormFieldValue(n.Id),n.Qualifier,n.Val,"HiddenFormField")||(f=!1),t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n))}),r.GeoCriteria&&f)try{r.GeoCriteria.forEach(function(n){if(f){t.debug(i,e,"Checking GeoCriteria: ",n);var r=CnnXt.Storage.GetActualZipCodes();r&&n.Type!==undefined&&r.forEach(function(t){if(~n.Zip.indexOf(t))f=n.Type.toUpperCase()=="IN";else if(n.Zip.indexOf("*")>=0){var i=n.Zip.split(",")||n.Zip.split(""),r=i.filter(function(n){var i=n.split(""),r=t.split("");return r.length!=i.length?!1:i.every(function(n,t){return i[t]==="*"?!0:n===r[t]})});f=r.length>0?n.Type.toUpperCase()=="IN":n.Type.toUpperCase()!="IN"}else f=n.Type.toUpperCase()!="IN"});t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n)}})}catch(s){t.exception(i,e,s);f=!1}if(r.JavascriptCriteria&&f)try{r.JavascriptCriteria.forEach(function(r){var o,u,s;if(f){t.debug(i,e,"Checking JavascriptCriteria: ",r);o=r.Eval;try{u=eval(o)}catch(h){t.warn(i,e,h)}n.isArray(u)?(u=u.map(function(n){return n.toString().trim().toLowerCase()}),f=r.Qualifier=="In"||r.Qualifier=="NotIn"?u.indexOf(r.Val.toLowerCase())>=0?r.Qualifier=="In":r.Qualifier=="NotIn":r.Qualifier=="=="):(u!==undefined&&u!==""&&(u=u.toString().toLowerCase()),r.Qualifier=="In"||r.Qualifier=="NotIn"?u==undefined?f=r.Qualifier=="NotIn":(s=r.Delimiter?new RegExp(r.Delimiter.replace(/space/g," "),"g"):/[ ,;]/g,array=u.split(s),f=array.indexOf(r.Val.toLowerCase())>=0?r.Qualifier=="In":r.Qualifier=="NotIn"):CnnXt.Utils.JSEvaluate(u,r.Qualifier,r.Val,"JavascriptCriteria")||(f=!1));t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",r)}})}catch(s){t.exception(i,e,"Evaluating javascript criteria.",s);f=!1}if(r.ScreenSizeCriteria&&f&&r.ScreenSizeCriteria.forEach(function(n){f&&(t.debug(i,e,"Checking ScreenSizeCriteria: ",n),CnnXt.Utils.JSEvaluate(CnnXt.Utils.getDeviceType(),n.Qualifier,n.Value,"ScreenSizeCriteria")||(f=!1),t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n))}),r.UrlCriteria&&f&&r.UrlCriteria.forEach(function(n){f&&(t.debug(i,e,"Checking UrlCriteria",n),CnnXt.Utils.JSEvaluate(CnnXt.Utils.getUrlParam(n.Eval),n.Qualifier,n.Value,"UrlCriteria")||(f=!1),t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n))}),r.URLMaskCriteria&&f&&r.URLMaskCriteria.forEach(function(n){if(f){t.debug(i,e,"Checking UrlCriteria",n);var o=window.location.href,r=o.replace(/#$/,""),s=r.length,u=n.Value.replace(/\*$/,""),h=u.length;r.indexOf(u)==0&&s>h&&n.Qualifier=="=="||r.indexOf(u)!=0&&n.Qualifier=="!="||(f=!1);t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n)}}),r.SubDomainCriteria&&f&&r.SubDomainCriteria.forEach(function(n){if(f){t.debug(i,e,"Checking SubDomainCriteria",n);var r=n.Value.toUpperCase(),u=window.location.hostname.toUpperCase(),o=n.Qualifier.toUpperCase();o=="=="^u.split(".").reverse().indexOf(r)>1&&(f=!1);t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n)}}),r.MetaKeywordCriteria&&f&&r.MetaKeywordCriteria.forEach(function(n){var r;if(f){t.debug(i,e,"Checking MetaKeywordCriteria: ",n);var o=CnnXt.Utils.getMetaTagsWithKeywords(),u=!1,s="\\b"+n.Value+"\\b",h=new RegExp(s);for(r=0;r<o.length;r++)if(h.test(o[r].content)){t.debug(i,e,"Found keyword",n.Value);u=!0;break}u&&n.Qualifier=="!="&&(f=!1);u||(f=n.Qualifier=="!="?!0:!1);t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n)}}),r.UserStateCriteria&&f&&r.UserStateCriteria.forEach(function(n){if(f){t.debug(i,e,"Checking UserStateCriteria",n);var r=CnnXt.User.getUserState();r||(r="Logged Out");CnnXt.Utils.JSEvaluate(r,n.Qualifier,n.Value,"UserStateCriteria")||(f=!1);t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n)}}),r.AdBlockCriteria&&f&&r.AdBlockCriteria.forEach(function(n){if(f){t.debug(i,e,"Checking AdBlockCriteria",n);var r=CnnXt.Utils.detectAdBlock();r&&n.Value=="Detected"||(r||n.Value!="Not Detected")&&(f=!1);t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n)}}),r.FlittzStatusCriteria&&f&&(CnnXt.GetOptions().integrateFlittz&&window.Flittz?(h=window.Flittz.FlittzUserStatus,r.FlittzStatusCriteria.forEach(function(n){f&&(t.debug(i,e,"Checking FlittzStatusCriteria",n),CnnXt.Utils.JSEvaluate(CnnXt.Common.FlittzStatusesMap[h],n.Qualifier,n.Value,"FlittzStatusCriteria")||(f=!1),t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n))})):(f=!1,t.debug(i,e,"Criteria was "+(f?"":"not")+" passed. No Flittz integration",r.FlittzStatusCriteria))),r.EZPayCriteria&&f&&r.EZPayCriteria.forEach(function(n){var u,r,o;f&&(t.debug(i,e,"Checking EZPayCriteria",n),u=CnnXt.User.getUserState(),u!=="Logged Out"?(r=CnnXt.Storage.GetUserData(),r&&r.Subscriptions?(o=r.Subscriptions[0],o.IsEZPay.toString()!=n.Value&&(f=!1)):f=!1):f=!1,t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n))}),r.ExpireDateCriteria&&f&&r.ExpireDateCriteria.forEach(function(n){var o,r,u,s;f&&(t.debug(i,e,"Checking ExpireDateCriteria",n),o=CnnXt.User.getUserState(),o!=="Logged Out"?(r=CnnXt.Storage.GetUserData(),r&&r.Subscriptions?(u=r.Subscriptions[0],u.ExpirationDate&&(s=CnnXt.Utils.GetTimeByType(u.ExpirationDate,n["Expire Date Type"]),CnnXt.Utils.JSEvaluate(s,n.Qualifier,n.Value,"ExpireDateCriteria")||(f=!1))):f=!1):f=!1,t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n))}),r.MeterViewsCriteria&&f){var c=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure),l=CnnXt.Common.ConvoArticleCountObj.article_count,o=CnnXt.Storage.GetCookie(c);o?r.MeterViewsCriteria.forEach(function(n){if(f){t.debug(i,e,"Checking MeterViewsCriteria",n);var r,s=JSON.parse(o);__.isEmpty(s)?(r=0,CnnXt.Utils.JSEvaluate(r,n.Qualifier,n.Val,"MeterViewsCriteria")||(f=!1)):s[u.meterId]?(r=s[u.meterId]["_"+l],CnnXt.Utils.JSEvaluate(r,n.Qualifier,n.Val,"MeterViewsCriteria")||(f=!1)):f=!1}t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n)}):f=!1}if(r.ConversationViewsCriteria&&f){var c=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure),l=CnnXt.Common.ConvoArticleCountObj.article_count,o=CnnXt.Storage.GetCookie(c);o?r.ConversationViewsCriteria.forEach(function(n){var r,s,h;f&&(t.debug(i,e,"Checking ConversationViewsCriteria",n),s=JSON.parse(o),__.isEmpty(s)?(r=0,CnnXt.Utils.JSEvaluate(r,n.Qualifier,n.Val,"MeterViewsCriteria")||(f=!1)):s[u.meterId]?(h=s[u.meterId][u.conversationId],h?(r=h[l],CnnXt.Utils.JSEvaluate(r,n.Qualifier,n.Val,"ConversationViewsCriteria")||(f=!1)):f=!1):f=!1);t.debug(i,e,"Criteria was "+(f?"":"not")+" passed",n)}):f=!1}return f}catch(s){return t.exception(i,e,s),!1}},ht=function(r,u){var s="resolvePromiseQualifier",e=n.Deferred(),h,o;f.push(e);try{r.PromiseCriteria?(h=[],r.PromiseCriteria.forEach(function(n){h.push(eval(n.Name))}),t.debug(i,s,'Setup "Q all" for promise criterias'),o=null,u&&(o=setTimeout(function(){t.debug(i,s,"Criterias rejected on timeout");e.reject()},u)),n.when.apply(n,h).then(function(){var n,u;t.debug(i,s,'"Q all" results',arguments);n=arguments;arguments.length||(arguments=[null]);u=Array.prototype.every.call(r.PromiseCriteria,function(r,u){var f=n[u],h=r.Value;return CnnXt.Utils.JSEvaluate(f,r.Qualifier,h,"Promise")?!0:(t.debug(i,s,"Criteria "+r.Name+" not passed"),o&&clearTimeout(o),e.reject(),!1)});u&&(t.debug(i,s,"All criterias passed"),o&&clearTimeout(o),e.resolve())},function(){t.debug(i,s,"Criteria rejected");o&&clearTimeout(o);e.reject()})):e.resolve()}catch(c){t.exception(i,s,c);e.reject()}return e.promise()},ct=function(){var n="breakPromise";try{t.debug(i,n,"Promises ",f);f.forEach(function(n){n.state()==="pending"&&n.reject()});f=[]}catch(r){t.exception(i,n,r)}},lt=function(){var f="handleDebugDetails",r,u;try{r=n('<link href="https://mg2assetsdev.blob.core.windows.net/connext/assets/connext-debug-panels.min.css" type="text/css" rel="stylesheet">');n("head").append(r);u=__.template('<div class="debug_details opened" style="left: 0;"><div class="debug_details_icon">&nbsp;<\/div><div class="debug_details_content"><h4>Debug Details<\/h4><ul><li class="debug_details_header hide_on_mobile"><label>Meter Level: <strong id="ddMeterLevel">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>Meter Set: <strong id="ddMeterSet">...<\/strong><\/label><label>Campaign: <strong id="ddCampaign">...<\/strong><\/label><label>Conversation: <strong id="ddCurrentConversation">...<\/strong><\/label><label>Article Views: <strong id="ddCurrentConversationArticleViews">...<\/strong><\/label><label>Articles Left: <strong id="ddCurrentConversationArticleLeft">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>View Time: <strong id="ddViewTime">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>Current Zip: <strong id="ddZipCode">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>Auth Time: <strong id="ddAuthTime">...<\/strong><\/label><label>Processing Time: <strong id="ddProcessingTime">...<\/strong><\/label><label>Total Time: <strong id="ddTotalProcessingTime">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>Note: <strong id="ddNote">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><div id="ConnextCustomConfigurationDiv"><label for="ConnextSiteCode">Site code: <\/label><input type="text" id="ConnextSiteCode"><label for="ConnextConfigCode">Config code: <\/label><input type="text" id="ConnextConfigCode"><a href="#" class="more highlight margin_top_15" id="ConnextSetCustomConfiguration">Set configuration<\/a><\/div><label class="overlay_label check" for="ConnextCustomConfiguration">Use custom configuration: <\/label> <input type="checkbox" id="ConnextCustomConfiguration"><label class="overlay_label check" for="ConnextCustomConfiguration">Unique Articles Count: <\/label> <input type="checkbox" id="uniqueArticles"><\/li><li class="debug_details_header" > <label class="overlay_label check">AnonymousId: <\/label> <input type="text" id="connext_anonymousId" style="\r\n    width: 47px; */\r\n    padding:;\r\n    padding: 5px 1px;\r\n"><a href="#" class="more highlight margin_top_15" id="connext_anonymousIdApplyBtn" style="\r\n    padding: 4px 13px;\r\n    width: 35px;\r\n    margin-left: 10px;\r\n    display: inline;\r\n">Set<\/a><\/li><li class="debug_details_header hide_on_mobile"><label for="ConnextCustomTimeChk" class="overlay_label check">Custom Time: <\/label> <input type="checkbox" id="ConnextCustomTimeChk"><div id="ConnextCustomTimeDiv"><input type="text" id="ConnextCustomTimeTxt" placeholder="MM/DD/YYYY" value="" name="name" class="text_input hint"><a href="#" class="more highlight margin_top_15" id="ConnextSetCustomTimeBtn">Set<\/a><\/div><\/li><li class="debug_details_header hide_on_mobile"><a href="#" class="more highlight margin_top_15" id="connextClearAllData">Clear All Data<\/a><\/li><\/ul><\/div><\/div>');n("body").append(u);n("#ConnextSetCustomConfiguration").on("click",ot);n(".debug_details_icon").on("click",at);n("#connextClearAllData").on("click",vt);pt();yt();n.jStorage.get("uniqueArticles")&&n("#uniqueArticles").attr("checked","checked");n("#ConnextCustomConfiguration").on("change",function(){var t=n(this);t.prop("checked")?n("#ConnextCustomConfigurationDiv").show():(n("#ConnextCustomConfigurationDiv").hide(),CnnXt.Storage.SetIsCustomConfiguration(!1))});n("#ConnextCustomTimeChk").on("change",function(){var t=n(this);t.prop("checked")?n("#ConnextCustomTimeDiv").show():(n("#ConnextCustomTimeDiv").hide(),n.jStorage.deleteKey("CustomTime"))});n("#uniqueArticles").on("change",function(){var t=n(this);n.jStorage.set("uniqueArticles",t.prop("checked"))});n("#ConnextSetCustomTimeBtn").on("click",function(t){t.preventDefault();n.jStorage.set("CustomTime",n("#ConnextCustomTimeTxt").val())})}catch(e){t.exception(i,f,e)}},at=function(r){var f="handleDebugDetailsDisplayClick",u;try{r.preventDefault();u=n(this).parent("div");u.toggleClass("opened")}catch(e){t.exception(i,f,e)}},vt=function(n){var r="clearAllSettings";try{n.preventDefault();t.debug(i,r,"clearAllSettings");CnnXt.Storage.GetLocalConfiguration()&&(CnnXt.API.ServerStorageDeleteViewsByUserId(),CnnXt.API.ClearServerCache(),CnnXt.Storage.ResetConversationViews(CnnXt.Storage.GetCurrentConversation(),Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain),CnnXt.Storage.SetRegistrationType({}),CnnXt.Storage.ClearConfigSettings())}catch(u){t.exception(i,r,u)}},yt=function(){CnnXt.Storage.GetIsCustomConfiguration()?n("#ConnextCustomConfigurationDiv").show():n("#ConnextCustomConfigurationDiv").hide()},pt=function(){var r="handleCustomTime";try{n.jStorage.get("CustomTime")?(n("#ConnextCustomTimeChk").prop("checked",!0),n("#ConnextCustomTimeTxt").text(n.jStorage.get("CustomTime")),n("#ConnextCustomTimeDiv").show()):(n("#ConnextCustomTimeChk").prop("checked",!1),n("#ConnextCustomTimeDiv").hide(),n("#ConnextCustomTimeTxt").val(new Date))}catch(u){t.exception(i,r,u)}},wt=function(n){return n.replace(/([a-zA-Z])[^a-zA-Z]*$/,function(n){var t=n.charCodeAt(0);switch(t){case 90:return"A";case 122:return"a";default:return String.fromCharCode(++t)}})},bt=function(){var n,t;r={};t=window.navigator.userAgent.toLowerCase();r.ios=function(){return r.iphone()||r.ipod()||r.ipad()};r.iphone=function(){return!r.windows()&&n("iphone")};r.ipod=function(){return n("ipod")};r.ipad=function(){return n("ipad")};r.android=function(){return!r.windows()&&n("android")};r.androidPhone=function(){return r.android()&&n("mobile")};r.androidTablet=function(){return r.android()&&!n("mobile")};r.blackberry=function(){return n("blackberry")||n("bb10")||n("rim")};r.blackberryPhone=function(){return r.blackberry()&&!n("tablet")};r.blackberryTablet=function(){return r.blackberry()&&n("tablet")};r.windows=function(){return n("windows")};r.windowsPhone=function(){return r.windows()&&n("phone")};r.windowsTablet=function(){return r.windows()&&n("touch")&&!r.windowsPhone()};r.fxos=function(){return(n("(mobile;")||n("(tablet;"))&&n("; rv:")};r.fxosPhone=function(){return r.fxos()&&n("mobile")};r.fxosTablet=function(){return r.fxos()&&n("tablet")};r.meego=function(){return n("meego")};r.cordova=function(){return window.cordova&&location.protocol==="file:"};r.nodeWebkit=function(){return typeof process=="object"};r.mobile=function(){return r.androidPhone()||r.iphone()||r.ipod()||r.windowsPhone()||r.blackberryPhone()||r.fxosPhone()||r.meego()};r.tablet=function(){return r.ipad()||r.androidTablet()||r.blackberryTablet()||r.windowsTablet()||r.fxosTablet()};r.desktop=function(){return!r.tablet()&&!r.mobile()};n=function(n){return t.indexOf(n)!==-1};r.mobile()?u.deviceType="Mobile":r.tablet()?u.deviceType="Tablet":r.desktop()&&(u.deviceType="Desktop");r.ios()?u.OS="IOS":r.windows()?u.OS="windows":r.android()?u.OS="android":r.blackberry()?u.OS="blackberry":r.fxos()&&(u.OS="fxos");u.Browser=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))!=-1?"Opera":navigator.userAgent.indexOf("Chrome")!=-1?"Chrome":navigator.userAgent.indexOf("Safari")!=-1?"Safari":navigator.userAgent.indexOf("Firefox")!=-1?"Firefox":navigator.userAgent.indexOf("MSIE")!=-1||!!document.documentMode==!0?"IE":"unknown";u.URL=window.location.href},kt=function(n){var t=CnnXt.Common.StorageKeys.connext_check_domain_write,i=!1;return Cookies.set(t,"Done!",{domain:n}),i=!!Cookies.get(t),Cookies.set(t,"null",{domain:n,expires:-1}),i},l=function(n){var u="prepareValueToCompare",r;try{return __.isNumber(n)||__.isBoolean(n)?n:__.isString(n)?n==="''"?"":n.toLowerCase()==="true"?!0:n.toLowerCase()==="false"?!1:n.toLowerCase()==="null"?null:n.toLowerCase()==="undefined"?undefined:(r=Number(n),__.isNaN(r)?n.toLowerCase():r):__.isObject(n)?n.toString().toLowerCase():n}catch(f){t.exception(i,u,"value: "+n,f)}};return{init:function(){t=CnnXt.Logger;t.debug(i,"Initializing Utils Module...");bt();String.prototype.replaceAt=function(n,t){return this.substr(0,n)+t+this.substr(n+t.length)}},Now:function(){try{return n.jStorage.get("CustomTime")?new Date(Date.parse(n.jStorage.get("CustomTime"))):new Date}catch(r){t.exception(i,"Now",r)}},ProcessConfiguration:function(n){return y(n)},MergeConfiguration:function(n){et(n)},CreateDebugDetailPanel:function(){lt()},ResolveQualifiersFor:st,ResolvePromiseQualifiers:ht,AddParameterToURL:function(n,t){return n+((n.split("?")[1]?"&":"?")+t)},GetUrlParam:function(n){for(var u=window.location.search.substring(1),i,r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]==n)return unescape(i[1]);return null},GetQueryStringParams:function(n){var u=window.location.search.slice(1).split("&"),i={},f=!1,e={},r,t;for(__.isArray(n)&&(f=!0,n.forEach(function(n){e[n]=!0})),r=u.length-1;r>=0;r--)if(t=[],u[r])if(t=u[r].split("="),f){if(e[t[0]])try{i[t[0]]=decodeURIComponent(t.slice(1).join("="))}catch(o){i[t[0]]=""}}else try{i[t[0]]=decodeURIComponent(t.slice(1).join("="))}catch(o){i[t[0]]=""}return i},GetActivationUrlParams:function(){return CnnXt.Utils.GetQueryStringParams(["email","productCode","returnUrl","confirmationNumber","accountNumber","lastName"])},GetProductCode:function(){var u=CnnXt.GetOptions(),r=(CnnXt.Storage.GetLocalConfiguration()||{}).Settings,f=CnnXt.Utils.GetActivationUrlParams(),n=null;return n=f.productCode,n||(n=u.productCode),n||(n=r?r.DefaultProduct:null),t.debug(i,"GetProductCode","Product code: ",n),n},ParseCustomDate:function(n,t){if(t=t||"dd.mm.yyyy",!n)return new Date;var r=n.match(/(\d+)/g),u=0,i={};return t.replace(/(yyyy|dd|mm)/g,function(n){i[n]=u++}),new Date(r[i.yyyy],r[i.mm]-1,r[i.dd])},ParseCustomDates:function(n){var t=null;return __.isString(n)&&(t=n.replace(/(\d+)([a-zA-Z,()\\";?]+)/,"$1 "),t=Date.parse(t)),new Date(t)},Diff:function(n,t){var i=+n-+t;return parseInt(i/864e5)},GetUrl:function(){return location.protocol+"//"+location.host+location.pathname},GetHiddenFormFieldValue:function(r){try{var u=n("#"+r).val();return t.debug(i,"GetHiddenFormFieldValue","hidValue",u),u}catch(f){return t.exception(i,"GetHiddenFormFieldValue",f),""}},JSEvaluate:function(n,r,u){try{var s=arguments[3]?arguments[3]+" ---- ":"",f="",e=l(n),o=l(u),h=CnnXt.Utils.FixQualifier(r);return f+=__.isString(e)?"'"+e+"'":e,f+=h,f+=__.isString(o)?"'"+o+"'":o,eval(f)?(t.debug(i,"JSEvaluate --- <<<<< "+f," >>>>> ---- PASSES"),!0):(t.debug(i,s+"JSEvaluate --- <<<<< "+f," >>>>> ---- FAILS"),!1)}catch(c){return t.exception(i,"JSEvaluate",c),!1}},GetNextLetter:function(n){return wt(n)},FixQualifier:function(n){try{var r=CnnXt.Common.QualifierMap[n];return r?r:n}catch(u){return t.exception(i,"FixQualifier",u),n}},getFileName:function(){var n=arguments[0]?arguments[0]:window.location.href;return n.substring(n.lastIndexOf("/")+1)},getCurPageName:function(){return location.pathname.substring(1)},HangleMatherTool:function(){var t=n("#connext_anonymousId"),i=n("#connext_anonymousIdApplyBtn");localStorage._matherAnonId&&t.val(localStorage._matherAnonId);i.on("click",function(){var n=t.val();n&&(localStorage._matherAnonId=n)})},getParam:function(n){for(var u=window.location.search.substring(1),i,r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]==n)return unescape(i[1]);return null},hasParam:function(n){for(var f=window.location.search.substring(1),i,u=f.split("&"),r,t=0;t<u.length;t++)if(i=u[t].split("="),i[0]==n)return r=unescape(i[1]),r.length>0&&typeof r=="string"?!0:!1;return!1},EncryptAccessToken:function(){for(var n,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i="",r=0;r<64;r++)n=Math.floor(Math.random()*t.length),i+=t.substring(n,n+1);return i},getScreenSize:function(){var t=n(window).width();return window.screen&&(t=window.screen.width),t},getDeviceType:function(){return u.deviceType},DetectEnvironment:function(){var n="prod";return~location.hostname.indexOf("localhost")?n="localhost":~location.hostname.indexOf("dev.")?n="dev":~location.hostname.indexOf("test.")?n="test":~location.hostname.indexOf("test20.")?n="test20":~location.hostname.indexOf("demo.")?n="demo":~location.hostname.indexOf("stage.")?n="stage":~location.hostname.indexOf("preprod.")&&(n="preprod"),n},GetViewedArticlesCookiesName:function(){var n=CnnXt.Storage.GetLocalConfiguration(),t=CnnXt.Common.StorageKeys.connext_viewstructure+"_"+n.Site.SiteCode.toUpperCase()+"_"+n.Settings.Code.toUpperCase()+"_"+CnnXt.GetOptions().environment.toUpperCase();return n.Settings.UseParentDomain||(t="sub_"+t),t},GetCookieName:function(n){var t=CnnXt.Storage.GetLocalConfiguration();return t?(n=n+"_"+t.Site.SiteCode.toUpperCase()+"_"+t.Settings.Code.toUpperCase()+"_"+CnnXt.GetOptions().environment.toUpperCase(),t.Settings.UseParentDomain||(n="sub_"+n),n):n},GetViewedArticlesCookiesOLDName:function(){var n=CnnXt.Storage.GetLocalConfiguration(),t=CnnXt.Common.StorageKeys.viewedArticles+"_site="+n.Site.SiteCode+"_environment="+CnnXt.GetOptions().environment+"_config="+n.Settings.Code+"_conversation="+conversationId;return n.Settings.UseParentDomain==invert&&(t="sub_"+t),t},GetLocalStorageNamePrefix:function(){var n=CnnXt.GetOptions().siteCode+"_"+CnnXt.GetOptions().environment+"_"+CnnXt.GetOptions().configCode;return CnnXt.GetOptions().attr&&(n+="_"+CnnXt.GetOptions().attr),CnnXt.GetOptions().settingsKey&&(n+="_"+CnnXt.GetOptions().settingsKey),n},GetCookieNamePostfix:function(){return"_"+CnnXt.GetOptions().siteCode+"_"+CnnXt.GetOptions().configCode+"_"+CnnXt.GetOptions().environment},AddParameterToURL:function(n,t,i){var r=t+"="+i;return n=n.replace(/#$/,""),n+((n.split("?")[1]?"&":"?")+r)},AddReturnUrlParamToLink:function(n){if(!~n.indexOf("returnUrl=")){var t=CnnXt.Utils.GetReturnUrl();t=CnnXt.Utils.AddParameterToURL(t,"clearUserState",!0);n=CnnXt.Utils.AddParameterToURL(n,"returnUrl",t)}return n},GetReturnUrl:function(){var t=(CnnXt.Storage.GetLocalConfiguration()||{}).Settings,n="";return n||(n=CnnXt.Utils.GetQueryStringParams(["returnUrl"]).returnUrl),n||(n=t.ReturnUrl),n||(n=window.location.href.split("?")[0]),n},getUrlParam:function(n){var t="",i=document.location.search.substr(1),r=i.split("&");return r.every(function(i){var r=i.split("=");return r[0]==n?(t=r[1],!1):!0}),t},AddQueryParamsToAllLinks:function(t){var i=t.find("[href]:not([data-dismiss])");i.each(function(t,i){var u=n(i),r=u.attr("href");r=CnnXt.Utils.AddReturnUrlParamToLink(r);u.attr("href",r)})},getSubdomains:function(){var n=document.location.origin.split("."),t;return n.pop(),n.pop(),n.length&&(t=n[0].substring(n[0].lastIndexOf("/")+1),t==="www"?n.shift():n[0]=t),n},getMetaTagsWithKeywords:function(){return n("meta[name=keywords]")},detectAdBlock:function(){var n=!1,f=document.getElementById("TestAdBlock"),r,u;return f.offsetHeight===0&&(n=!0),r=document.getElementById("06db9294"),r.offsetHeight===0&&(n=!0),u=document.getElementById("295f89b1"),u.className!=="adstestloaded"&&(n=!0),t.debug(i,"detectAdBlock","detected: ",n),n},getQueryParamByName:function(n,t){t||(t=window.location.href);n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},GetUserMeta:function(){return u},GenerateGuid:function(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},ConvertObjectKeysToUpperCase:function(t){return n.each(t,function(n,i){delete t[n];t[n.toUpperCase()]=i}),t},GetIP:function(){return o?o:localStorage.ConnextIP},SetIP:function(n){localStorage.ConnextIP=n;o=n},ShapeUserData:function(n){var t,i,r;return n&&n.DigitalAccess&&n.DigitalAccess.AccessLevel&&__.isString(n.DigitalAccess.AccessLevel)&&(n.DigitalAccess.AccessLevel={IsPremium:n.DigitalAccess.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Premium,IsUpgrade:n.DigitalAccess.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Upgrade,IsPurchase:n.DigitalAccess.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Purchase}),n.EncryptedCustomerRegistrationId&&(n.IgmRegID=n.EncryptedCustomerRegistrationId),n.CookieContent&&__.isArray(n.CookieContent)&&(t=__.findWhere(n.CookieContent,{Name:"igmContent"}),t&&(n.IgmContent=t.Content),i=__.findWhere(n.CookieContent,{Name:"igmRegId"}),i&&(n.IgmRegID=i.Content),r=__.findWhere(n.CookieContent,{Name:"igmAuth"}),r&&(n.IgmAuth=r.Content)),n},GetUserAuthData:function(){var u="GetUserAuthData",n;try{var r=CnnXt.Storage.GetUserData(),n=r?r.MasterId:null;return n?{CustomRegId:n,MasterId:n,Mode:0}:(n=r?r.IgmRegID:null,n)?{CustomRegId:n,MasterId:n,Mode:1}:{}}catch(f){t.exception(i,u,f)}},GetTimeByType:function(n,t){var i=moment(),r=new Date(n);return moment(r).diff(i,CnnXt.Common.TimeTypeMap[t])},AddTimeInervalToDate:function(n,t){var i=0,u,r;if(n=parseInt(n),!n)return i;switch(t){case"s":i=n*1e3;break;case"m":i=n*6e4;break;case"h":i=n*36e5;break;case"d":i=n*864e5;break;case"w":i=n*6048e5;break;default:i=0}return u=new Date,r=new Date(u.valueOf()),r.setMilliseconds(r.getMilliseconds()+i),r},CalculateDomain:function(n){var t=null,f=window.location.host,r,u,i;if(~f.indexOf("localhost"))t="localhost";else if(n){r=f.split(".");u=2;do{for(t="",i=u;i>0;i--)t+="."+r[r.length-i];u++}while(!kt(t))}else t=window.location.host;return t},GetSiteConfigEnvString:function(){var n=CnnXt.GetOptions(),t=n.siteCode,i=n.configCode,r=n.environment;return"_"+t+"_"+i+"_"+r},IPWithinRangeCIDR:function(n,t){for(var u,f=CnnXt.Utils.GetIPsRangeByCIDR(t),e=f[0],o=f[1],i=[n.split("."),e.split("."),o.split(".")],r=0;r<i.length;r++){for(u=0;u<i[r].length;u++)i[r][u]=parseInt(i[r][u]);i[r]=(i[r][0]<<24)+(i[r][1]<<16)+(i[r][2]<<8)+i[r][3]}return i[0]>=i[1]&&i[0]<=i[2]?!0:!1},GetIPsRangeByCIDR:function(n){var e=!1,t,r,i,u,f;return typeof n=="string"&&(t=n.match(/^(\d+\.\d+\.\d+\.\d+)\/(\d+)$/),t&&(r=dt(t[1]),i=parseInt(t[2]),typeof r=="number"&&i>=0&&i<=32&&(u=gt(i),f=ni(r,u),e=[a(f),a(f-u-1)]))),e},GetDynamicMeterIdByKey:function(n){if((typeof n).toLowerCase()!="string")return n;switch(n.toLowerCase()){case"free":return"1";case"metered":return"2";case"premium":return"3";default:return n}},GetErrorMessageFromAPIResponse:function(r,u){var o="GetErrorMessageFromAPIResponse",e,f;try{return!r||!r.Message?u:(e=n.parseJSON(r.Message),f=u,n.isArray(e.Errors)?(f="",e.Errors.forEach(function(n){f+=__.isString(n)?n+" ":n.Message+" "})):f=e.Message,f)}catch(s){return t.debug(i,o,"can't get errorMessage from API response",r),u}},BreakConversationPromises:ct}},ConnextStorage=function(n){var i="Storage",t,o,f=function(r){var o="getLocalStorage",u,f;try{return u=r,CnnXt.Common.StorageKeys[r]&&(u=CnnXt.Common.StorageKeys[r]),f=CnnXt.Utils.GetLocalStorageNamePrefix()+u,n.jStorage.get(f)}catch(e){t.exception(i,o,e);r=="configuration"&&(CnnXt.Api.meta.storageException=e)}},e=function(r,u){var o="setLocalStorage",f,e;try{return f=r,CnnXt.Common.StorageKeys[r]&&(f=CnnXt.Common.StorageKeys[r]),e=CnnXt.Utils.GetLocalStorageNamePrefix()+f,n.jStorage.set(e,u)}catch(s){t.exception(i,o,s)}},h=function(r){var e="removeLocalStorage",u,f;try{return u=r,CnnXt.Common.StorageKeys[r]&&(u=CnnXt.Common.StorageKeys[r]),f=CnnXt.Utils.GetLocalStorageNamePrefix()+u,n.jStorage.deleteKey(f)}catch(o){t.exception(i,e,o)}},r=function(n){var u="getCookie",r;try{return r=CnnXt.Common.StorageKeys[n]||n,t.debug(i,u,"cookieKey",r),Cookies.get(r)}catch(f){t.exception(i,u,f)}},l=[],b=function(n,r){var u="listenStorageChange";try{l[n]=localStorage.getItem(n);setInterval(function(){try{if(localStorage.getItem(n)!=l[n])return l[n]=localStorage.getItem(n),r()}catch(f){t.exception(i,u,f)}},1e3)}catch(f){t.exception(i,u,f)}},k=function(){b("janrainCaptureToken",function(){CnnXt.Storage.SetUserState(null);CnnXt.Storage.SetUserZipCodes(null);CnnXt.Activation.IsActivationFlowRunning()?CnnXt.User.CheckAccess().always(function(){CnnXt.Activation.Run({runAfterSuccessfulLogin:!0})}):CnnXt.Run()})},u=function(n,r,u,f){var e="setCookie",s,o;t.debug(i,e,arguments);try{return s=!f,o=CnnXt.Storage.GetDomain(s),u?(t.debug(i,e,"HasExpiration","key",n,"expiration",u),Cookies.set(CnnXt.Common.StorageKeys[n]||n,r,{expires:u,domain:o})):Cookies.set(CnnXt.Common.StorageKeys[n]||n,r,{domain:o})}catch(h){t.exception(i,e,h)}},s=function(n){var r="removeCookie",u,f;try{t.debug(i,r,n);u=CnnXt.Storage.GetDomain();f=CnnXt.Storage.GetDomain(!0);Cookies.set(CnnXt.Common.StorageKeys[n]||n,"null",{domain:u,expires:-1});Cookies.set(CnnXt.Common.StorageKeys[n]||n,"null",{domain:f,expires:-1})}catch(e){t.exception(i,r,e)}},v=function(n){var d="incrementView",e,f,a,w,l;try{var b=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain,v=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure),p=CnnXt.Common.MeteredArticleCountObj.active_convo_id,h=CnnXt.Common.ConvoArticleCountObj.article_count,c=CnnXt.Common.ConvoArticleCountObj.device_article_count,y=CnnXt.Common.ConvoArticleCountObj.start_date,k=r(v);k?(e=JSON.parse(k),f=e[o.level],f?(a=f[n.id],f[p]=n.id,f["_"+h]=f["_"+h]?f["_"+h]+1:1,f["_"+c]=f["_"+c]?f["_"+c]+1:1,a?(a[h]=a[h]+1,a[c]=a[c]+1,a[y]=n.Props.Date.started):(f[n.id]={},f[n.id][h]=1,f[n.id][c]=1,f[n.id][y]=n.Props.Date.started)):(e[o.level]={},e[o.level]["_"+h]=1,e[o.level]["_"+c]=1,e[o.level][p]=n.id,e[o.level][n.id]={},e[o.level][n.id][h]=1,e[o.level][n.id][c]=1,e[o.level][n.id][y]=n.Props.Date.started),s(v),u(v,JSON.stringify(e),new Date("9999-01-01"),b)):(w={},l=w[o.level]={},l["_"+h]=1,l["_"+c]=1,l[p]=n.id,l[n.id]={},l[n.id][h]=1,l[n.id][c]=1,l[n.id][y]=n.Props.Date.started,s(v),u(v,JSON.stringify(w),new Date("9999-01-01"),b))}catch(g){t.exception(i,d,g)}},c=function(){var e="getViewsData";try{var o=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain,n=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure),u=r(n),f;return u&&(f=JSON.parse(u)),{parserViews:f,cookieName:n,useCurDomain:o}}catch(s){t.exception(i,e,s)}},d=function(n){var i=0;for(var t in n)/^(0|[1-9]\d*)$/.test(t)&&n[t]!=null&&(typeof n[t]).toLowerCase()=="object"&&(i+=n[t][CnnXt.Common.ConvoArticleCountObj.article_count]?n[t][CnnXt.Common.ConvoArticleCountObj.article_count]:0);return i},y=function(n,r){var f="mapServerStorageViewsToDynamicMeterViews",u={};try{u["_"+CnnXt.Common.ConvoArticleCountObj.article_count]=n.ArticleCount;u["_"+CnnXt.Common.ConvoArticleCountObj.device_article_count]=n.DeviceArticleCount;u[CnnXt.Common.MeteredArticleCountObj.active_convo_id]=n.ActiveConversationId;n.Conversations&&n.Conversations.forEach(function(n){if(u[n.Id]={},u[n.Id][CnnXt.Common.ConvoArticleCountObj.article_count]=n.ViewCount,u[n.Id][CnnXt.Common.ConvoArticleCountObj.device_article_count]=n.DeviceViewCount,u[n.Id][CnnXt.Common.ConvoArticleCountObj.start_date]=n.StartDate,n.Actions&&r){var t=CnnXt.Common.TimeRepeatableActionsCS.repeat_after,i=CnnXt.Common.TimeRepeatableActionsCS.count;r[n.Id]={};n.Actions.forEach(function(u){r[n.Id][u.Id]={};r[n.Id][u.Id][t]=u.RepeatAfter;r[n.Id][u.Id][i]=u.Count})}})}catch(e){t.exception(i,f,e)}return u},g=function(n){var p="processViewData",o,s,r,f,a;try{if(o=c(),n.AllowedIpSet&&CnnXt.Storage.SetWhitelistSetIdCookie({Id:n.AllowedIpSet.Id,Expiration:n.AllowedIpSet.Expiration},new Date(n.AllowedIpSet.Expiration)),s={},r={},n.DynamicMeterViews)for(f in n.DynamicMeterViews)n.DynamicMeterViews.hasOwnProperty(f)&&(a=CnnXt.Utils.GetDynamicMeterIdByKey(f),n.DynamicMeterViews[f]&&(s[a]=y(n.DynamicMeterViews[f],r)));if(__.keys(r).length){var h=CnnXt.Storage.GetLocalConfiguration(),v=!1,l=CnnXt.Common.StorageKeys.connext_time_repeatable_actions;h&&h.Settings&&(v=h.Settings.UseParentDomain);v?(l+=CnnXt.Utils.GetCookieNamePostfix(),u(l,JSON.stringify(r),new Date("9999-01-01"),!1)):e(l,r)}u(o.cookieName,JSON.stringify(s),new Date("9999-01-01"),o.useCurDomain)}catch(w){t.exception(i,p,w)}},ut=function(n){var l="processLinkedDevicesViewData",o,e,f,s,r,h;try{if(o=c(),e=o.parserViews,n.DynamicMeterViews)for(f in n.DynamicMeterViews)n.DynamicMeterViews.hasOwnProperty(f)&&(s=CnnXt.Utils.GetDynamicMeterIdByKey(f),n.DynamicMeterViews[f]&&(e[s]?(r=e[s],h=n.DynamicMeterViews[f],h.Conversations&&h.Conversations.forEach(function(n){if(r[n.Id]){var t=n.ViewCount-n.DeviceViewCount+r[n.Id][CnnXt.Common.ConvoArticleCountObj.device_article_count];r[n.Id][CnnXt.Common.ConvoArticleCountObj.article_count]=t>0?t:n.ViewCount}else r[n.Id]={},r[n.Id][CnnXt.Common.ConvoArticleCountObj.article_count]=n.ViewCount,r[n.Id][CnnXt.Common.ConvoArticleCountObj.device_article_count]=n.DeviceViewCount,r[n.Id][CnnXt.Common.ConvoArticleCountObj.start_date]=n.StartDate}),r["_"+CnnXt.Common.ConvoArticleCountObj.article_count]=d(r)):e[s]=y(n.DynamicMeterViews[f])));u(o.cookieName,JSON.stringify(e),new Date("9999-01-01"),o.useCurDomain)}catch(a){t.exception(i,l,a)}},nt=function(){var u="checkViewCookies";try{var f=c(),e=f.parserViews,r=n.Deferred();e?r.resolve():CnnXt.API.GetViewData().done(function(n){n&&g(n);tt();r.resolve()}).fail(function(){r.resolve()})}catch(o){t.exception(i,u,o)}return r.promise()},ft=function(){return r(CnnXt.Common.StorageKeys.connext_updateArticleCount+CnnXt.Utils.GetCookieNamePostfix())},tt=function(){var n=new Date;return n.setHours(n.getHours()+CnnXt.GetOptions().ViewsUpdateFromServerPeriod),u(CnnXt.Common.StorageKeys.connext_updateArticleCount+CnnXt.Utils.GetCookieNamePostfix(),1,n)},a=function(n){var o="getArticleCookie",e,r,u,f;try{e=c();r=e.parserViews;for(u in r)if(r[u]!=null&&(typeof r[u]).toLowerCase()=="object")for(f in r[u])if(f==n)return r[u][f]}catch(s){t.exception(i,o,s)}},it=function(){var e="getCookies",r,u,n,f;try{for(r=document.cookie.split(";"),u={},n=0;n<r.length;n++)f=r[n].split("="),u[f[0]]=unescape(f[1]);return u}catch(o){t.exception(i,e,o)}},rt=function(){var n="resetViews";try{var r=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain,f=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure);u(f,JSON.stringify({}),new Date("9999-01-01"),r)}catch(e){t.exception(i,n,e)}},p=function(){Cookies.remove(CnnXt.Common.StorageKeys.userToken);Cookies.remove(CnnXt.Common.StorageKeys.accessToken);Cookies.remove("userToken");Cookies.remove("userMasterId");localStorage.removeItem("janrainCaptureProfileData");localStorage.removeItem("janrainCaptureReturnExperienceData");n.jStorage.deleteKey(CnnXt.Common.StorageKeys.user.zipCodes);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.user.state);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.user.data);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.connext_user_profile);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.connext_user_data);CnnXt.Storage.SetUserState("Logged Out");s("ExternalUserId");s("connext_user_profile");s("connext_user_data")},w=function(n){var v="resetConversationArticleCount";try{var y=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain,c=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure),s=CnnXt.Common.ConvoArticleCountObj.article_count,h=CnnXt.Common.ConvoArticleCountObj.device_article_count,l=r(c);if(l){var a=JSON.parse(l),f=a[o.level],e=f[n.id];f&&e&&(f["_"+s]=f["_"+s]-e[s],f["_"+h]=f["_"+h]-e[h],e[s]=0,e[h]=0);u(c,JSON.stringify(a),new Date("9999-01-01"),y)}CnnXt.Storage.SetViewedArticles([],n.id);CnnXt.Storage.ResetRepeatablesInConversation(n);CnnXt.Storage.RemoveTimeRepeatableActionData(n.id)}catch(p){t.exception(i,v,p)}};return{init:function(){t=CnnXt.Logger;t.debug(i,"Initializing Storage Module...");k()},GetLocalConfiguration:function(){return f("configuration")},SetLocalConfiguration:function(n){return localStorage.setItem("IsLocalConfig",!0),e("configuration",n)},GetUserState:function(){return n.jStorage.get(CnnXt.Common.StorageKeys.user.state)},SetUserState:function(t){return n.jStorage.set(CnnXt.Common.StorageKeys.user.state,t)},GetUserZipCodes:function(){return f(CnnXt.Common.StorageKeys.user.zipCodes)},SetCalculatedZipCode:function(r){var u="SetCalculatedZipCode";try{r.split(" ").length==2&&(r=r.split(" ")[0]);n.jStorage.set(CnnXt.Common.StorageKeys.customZip,r)}catch(f){t.exception(i,u,f)}},SetUserZipCodes:function(n){return e(CnnXt.Common.StorageKeys.user.zipCodes,n)},GetActualZipCodes:function(){var r="GetActualZipCodes";try{return CnnXt.User.isUserHasHighState()?f(CnnXt.Common.StorageKeys.user.zipCodes)||[]:[n.jStorage.get(CnnXt.Common.StorageKeys.customZip)]}catch(u){t.exception(i,r,u)}},GetLastPublishDate:function(){return r(CnnXt.Utils.GetCookieName("lastPublishDate"))},SetLastPublishDate:function(n,t){var i=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain;return u(CnnXt.Utils.GetCookieName("lastPublishDate"),n,t,i)},GetCurrentConversations:function(){var n=f(CnnXt.Common.StorageKeys.conversations.current);return n?n:{}},SetCurrentConversations:function(n){return e(CnnXt.Common.StorageKeys.conversations.current,n)},GetCampaignData:function(){return f(CnnXt.Common.StorageKeys.configuration)?f(CnnXt.Common.StorageKeys.configuration).Campaign:null},GetCurrentConversationViewCount:function(){var e=CnnXt.Storage.GetCurrentConversation(),n=null,u;if(n=e?e.id:CnnXt.Storage.GetActiveConversationId(),!n)return 0;var f=o.level,h=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure),s=r(h);if(s)try{if(u=JSON.parse(s),u[f])return u[f][n]?u[f][n][CnnXt.Common.ConvoArticleCountObj.article_count]:0}catch(c){return t.exception(i,"GetCurrentConversationViewCount",c),0}return 0},GetCurrenDynamicMeterViewCount:function(){var u=CnnXt.GetOptions().currentMeterLevel,e=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure),f=r(e),n;if(f)try{if(n=JSON.parse(f),n[u])return n[u]["_"+CnnXt.Common.ConvoArticleCountObj.article_count]}catch(o){return t.exception(i,"GetCurrenDynamicMeterViewCount",o),0}return 0},GetViewedArticles:function(n){var i=CnnXt.Common.StorageKeys.viewedArticles,t=f(i);if(t)return t[n]},SetViewedArticles:function(n,t){var r=CnnXt.Common.StorageKeys.viewedArticles,i=f(r);i==null&&(i={});i[t]=n;e(r,i)},UpdateViewedArticles:function(r){var s="UpdateViewedArticles";try{var u=CnnXt.Storage.GetViewedArticles(r.id),h=CnnXt.Utils.GetUrl(),f=CnnXt.GetOptions(),e;if(u==null&&(u=[]),f.articlesCounter&&f.articlesCounter.params&&f.articlesCounter.params.length){var c=f.articlesCounter.params,l=location.hostname,o=l+"_";c.forEach(function(n){var t=CnnXt.Utils.getQueryParamByName(n);t&&(o+=n+"="+t)});e=MD5(o)}else e=MD5(h);u.indexOf(e)>-1?!n.jStorage.get("uniqueArticles")&&CnnXt.GetOptions().debug&&v(r):(u.push(e),v(r),CnnXt.Storage.SetViewedArticles(u,r.id))}catch(a){t.exception(i,s,a)}},ResetConversationViews:function(n){var r="ResetConversationViews";try{n?(n.Props.views=0,CnnXt.Storage.SetViewedArticles([],n.id),w(n),CnnXt.API.ServerStorageResetConversationViews(n.id)):(e(CnnXt.Common.StorageKeys.viewedArticles,{}),rt())}catch(u){t.exception(i,r,u)}},GetRepeatablesInConv:function(n){var u="GetRepeatablesInConv",r;try{return f(CnnXt.Common.StorageKeys.repeatablesInConv)||e(CnnXt.Common.StorageKeys.repeatablesInConv,{}),r=f(CnnXt.Common.StorageKeys.repeatablesInConv),f(CnnXt.Common.StorageKeys.repeatablesInConv)[n]||(r[n]=0,e(CnnXt.Common.StorageKeys.repeatablesInConv,r)),f(CnnXt.Common.StorageKeys.repeatablesInConv)[n]}catch(o){t.exception(i,u,o)}},UpdateRepeatablesInConv:function(n){var u="UpdateRepeatablesInConv",r;try{f(CnnXt.Common.StorageKeys.repeatablesInConv)||e(CnnXt.Common.StorageKeys.repeatablesInConv,{});r=f(CnnXt.Common.StorageKeys.repeatablesInConv);r[n]=r[n]+1;e(CnnXt.Common.StorageKeys.repeatablesInConv,r)}catch(o){t.exception(i,u,o)}},ResetRepeatablesInConversation:function(n){var u="ClearRepeatablesInConversation",r;try{r=f(CnnXt.Common.StorageKeys.repeatablesInConv);r&&n&&n.Actions&&(n.Actions.forEach(function(n){n.id&&r[n.id]&&(r[n.id]=0)}),e(CnnXt.Common.StorageKeys.repeatablesInConv,r))}catch(o){t.exception(i,u,o)}},ClearRepeatablesData:function(){var n="ResetRepeatablesData";try{e(CnnXt.Common.StorageKeys.repeatablesInConv,{})}catch(r){t.exception(i,n,r)}},ClearConfigSettings:function(){var u="ClearConfigSettings",r;try{r=CnnXt.Storage.GetCurrentConversation();r&&CnnXt.Storage.SetViewedArticles([],r.id)}catch(f){t.exception(i,u,f)}h(CnnXt.Common.StorageKeys.conversations.current);h(CnnXt.Common.StorageKeys.conversations.previous);h(CnnXt.Common.StorageKeys.viewedArticles);h(CnnXt.Common.StorageKeys.configurationSiteCode);h(CnnXt.Common.StorageKeys.configurationConfigCode);h(CnnXt.Common.StorageKeys.configurationIsCustom);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.user.state);h(CnnXt.Common.StorageKeys.user.zipCodes);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.connext_user_profile);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.connext_user_data);h(CnnXt.Common.StorageKeys.customZip);h(CnnXt.Common.StorageKeys.repeatablesInConv);localStorage.removeItem("_matherAnonId");h(CnnXt.Common.StorageKeys.configuration)},ClearUser:function(){p()},Logout:function(){p();s(CnnXt.Common.StorageKeys.igmRegID);s(CnnXt.Common.StorageKeys.igmContent);s(CnnXt.Common.StorageKeys.igmAuth)},SetAccessToken:function(n){return u("accessToken",n)},GetAccessToken:function(){return t.debug(i,"GetAccessToken",CnnXt.Common.StorageKeys.accessToken),r("accessToken")},GetCurrentConversation:function(){return f("CurrentConversation")},SetCurrentConversation:function(n){e("CurrentConversation",n)},SetUserToken:function(n){return u("userToken",n,365)},GetUserToken:function(){return r("userToken")},SetigmRegID:function(n){var t=new Date;return t.setDate(t.getDate()+30),u(CnnXt.Common.StorageKeys.igmRegID,n,t)},GetigmRegID:function(){return Cookies.get(CnnXt.Common.StorageKeys.igmRegID)},SetIgmContent:function(n){var t=new Date;return t.setDate(t.getDate()+30),u(CnnXt.Common.StorageKeys.igmContent,n,t)},GetIgmContent:function(){return r(CnnXt.Common.StorageKeys.igmContent)},SetIgmAuth:function(n){var t=new Date;return t.setDate(t.getDate()+1),u(CnnXt.Common.StorageKeys.igmAuth,n,t)},GetIgmAuth:function(){return r(CnnXt.Common.StorageKeys.igmAuth)},SetExternalUserId:function(n){var t=new Date;return t.setDate(t.getDate()+30),u("ExternalUserId",n,t)},GetExternalUserId:function(){return Cookies.get("ExternalUserId")},SetUserRegId:function(n){return u("userMasterId",n,365)},GetUserRegId:function(){return r("userMasterId")},GetWhitelistInfoboxCookie:function(){var n="GetWhitelistInfoboxCookie";try{return r(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistInfobox))}catch(u){t.exception(i,n,u)}},SetWhitelistInfoboxCookie:function(n){var f="SetWhitelistInfoboxCookie";try{var e=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain,o=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistInfobox),r=new Date;return r.setDate(r.getDate()+30),u(o,n,r,e)}catch(s){t.exception(i,f,s)}},RemoveWhitelistInfoboxCookie:function(){var n="RemoveWhitelistInfoboxCookie";try{return s(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistInfobox))}catch(r){t.exception(i,n,r)}},GetNeedHidePinTemplateCookie:function(){var n="GetNeedHidePinTemplateCookie";try{return r(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.NeedHidePinTemplate))}catch(u){t.exception(i,n,u)}},SetNeedHidePinTemplateCookie:function(n){var f="SetNeedHidePinTemplateCookie";try{var e=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain,o=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.NeedHidePinTemplate),r=new Date;return r.setDate(r.getDate()+1),u(o,n,r,e)}catch(s){t.exception(i,f,s)}},RemoveNeedHidePinTemplateCookie:function(){var n="RemoveNeedHidePinTemplateCookie";try{return s(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.NeedHidePinTemplate))}catch(r){t.exception(i,n,r)}},GetWhitelistSetIdCookie:function(){var n="GetWhitelistSetIdCookie";try{return r(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistSet))}catch(u){t.exception(i,n,u)}},SetWhitelistSetIdCookie:function(n,r){var o="SetWhitelistSetIdCookie",f,e;try{return f=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain,e=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistSet),u(e,n,r,f)}catch(s){t.exception(i,o,s)}},RemoveWhitelistSetIdCookie:function(){var n="RemoveWhitelistSetIdCookie";try{return s(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistSet))}catch(r){t.exception(i,n,r)}},GetJanrainUser:function(){var n=localStorage.getItem(CnnXt.Common.StorageKeys.janrainUserProfile);try{return JSON.parse(n)}catch(r){return t.exception(i,"GetJanrainUser",r),null}},SetSiteCode:function(n){e(CnnXt.Common.StorageKeys.configurationSiteCode,n)},GetSiteCode:function(){return f(CnnXt.Common.StorageKeys.configurationSiteCode)},SetConfigCode:function(n){e(CnnXt.Common.StorageKeys.configurationConfigCode,n)},GetConfigCode:function(){return f(CnnXt.Common.StorageKeys.configurationConfigCode)},SetIsCustomConfiguration:function(n){e(CnnXt.Common.StorageKeys.configurationIsCustom,n)},SetUserLastUpdateDate:function(n){e(CnnXt.Common.StorageKeys.connext_userLastUpdateDate,n)},GetUserLastUpdateDate:function(){return e(CnnXt.Common.StorageKeys.connext_userLastUpdateDate)},GetIsCustomConfiguration:function(){return f(CnnXt.Common.StorageKeys.configurationIsCustom)},GetGuid:function(){return r(CnnXt.Common.StorageKeys.connext_user_Id)},SetGuid:function(n){return u(CnnXt.Common.StorageKeys.connext_user_Id,n)},GetUserData:function(){return n.jStorage.get(CnnXt.Common.StorageKeys.connext_user_data)},SetUserData:function(t){return n.jStorage.set(CnnXt.Common.StorageKeys.connext_user_data,t)},GetUserProfile:function(){var t=n.jStorage.get(CnnXt.Common.StorageKeys.connext_user_profile);return t||null},SetUserProfile:function(t){return n.jStorage.set(CnnXt.Common.StorageKeys.connext_user_profile,t)},GetConnextPaywallCookie:function(){return r(CnnXt.Common.StorageKeys.connext_paywallFired)},SetConnextPaywallCookie:function(n){var t=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain;return u(CnnXt.Common.StorageKeys.connext_paywallFired,n,null,t)},SetAccountDataExpirationCookie:function(n){var t=new Date;return t.setDate(t.getDate()+1),Cookies.set("Connext_AccountDataExpirationCookie",n,{expires:t})},GetAccountDataExpirationCookie:function(){return Cookies.get("Connext_AccountDataExpirationCookie")},WrongPin:function(){var i=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain,r=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.PinAttempts),n=CnnXt.Storage.GetPinAttempts(),t;return n?n++:n=1,t=new Date,t.setMinutes(t.getMinutes()+15),u(r,n,t,i)},GetPinAttempts:function(){var n=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.PinAttempts);return r(n)},ResetPinAttemptsCookie:function(){var n=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.PinAttempts);s(n)},SetRegistrationType:function(t){n.jStorage.set(CnnXt.Common.StorageKeys.connext_auth_type,t)},GetRegistrationType:function(){return n.jStorage.get(CnnXt.Common.StorageKeys.connext_auth_type)||{}},GetDeviceViews:function(n){var t=a(n);return t?t[CnnXt.Common.ConvoArticleCountObj.device_article_count]:undefined},GetViews:function(n){var t=a(n);return t?t[CnnXt.Common.ConvoArticleCountObj.article_count]:undefined},GetConversationStartDate:function(n){var u="GetConversationStartDate",r;try{return r=a(n),r?r[CnnXt.Common.ConvoArticleCountObj.start_date]:null}catch(f){return t.exception(i,u,f),null}},CheckViewCookies:function(){return nt()},GetViewsData:function(){return c()},SetMeter:function(n){o=n},GetMeter:function(){return o},GetDomain:function(n){var t=null,i=n?CnnXt.Common.StorageKeys.connext_root_domain:CnnXt.Common.StorageKeys.connext_domain;return t=f(i),t||(t=CnnXt.Utils.CalculateDomain(n),e(i,t)),t},ResetConversationArticleCount:function(n){return w(n)},GetActiveConversationId:function(n){n||(n=o.level);var t=c();return t.parserViews&&t.parserViews[n]&&t.parserViews[n][CnnXt.Common.MeteredArticleCountObj.active_convo_id]?t.parserViews[n][CnnXt.Common.MeteredArticleCountObj.active_convo_id]:0},SetActiveConversationId:function(n,t){var r,i,f,e;t||(t=o.level);r=c();i=r.parserViews?r.parserViews:{};i[t]=i[t]?i[t]:{};i[t][CnnXt.Common.MeteredArticleCountObj.active_convo_id]=n;f=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain;e=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure);u(e,JSON.stringify(i),new Date("9999-01-01"),f)},GetTimeRepeatableActionData:function(n){try{var e=CnnXt.Storage.GetLocalConfiguration(),h=!1,u=null,o=null,s=CnnXt.Common.StorageKeys.connext_time_repeatable_actions;return e&&e.Settings&&(h=e.Settings.UseParentDomain),h?(s+=CnnXt.Utils.GetCookieNamePostfix(),u=JSON.parse(r(s)||"{}")):u=f(s),n?u&&u[n.ConversationId]&&u[n.ConversationId][n.id]&&(o={date:u[n.ConversationId][n.id][CnnXt.Common.TimeRepeatableActionsCS.repeat_after],count:u[n.ConversationId][n.id][CnnXt.Common.TimeRepeatableActionsCS.count]}):o=u,o}catch(c){return t.exception(i,"GetTimeRepeatableActionData",c),null}},SetTimeRepeatableActionData:function(n){try{var f=CnnXt.Storage.GetLocalConfiguration(),h=!1,r=null,o=CnnXt.Common.StorageKeys.connext_time_repeatable_actions;f&&f.Settings&&(h=f.Settings.UseParentDomain);r=CnnXt.Storage.GetTimeRepeatableActionData()||{};r[n.ConversationId]||(r[n.ConversationId]={});r[n.ConversationId][n.id]||(r[n.ConversationId][n.id]={});var s={},c=r[n.ConversationId][n.id][CnnXt.Common.TimeRepeatableActionsCS.count]||0,l=CnnXt.Utils.AddTimeInervalToDate(n.When.Time.RepeatAfterTime,n.When.Time.RepeatAfterTimeType);s[CnnXt.Common.TimeRepeatableActionsCS.repeat_after]=l;s[CnnXt.Common.TimeRepeatableActionsCS.count]=c+1;r[n.ConversationId][n.id]=s;h?(o+=CnnXt.Utils.GetCookieNamePostfix(),u(o,JSON.stringify(r),new Date("9999-01-01"),!1)):e(o,r)}catch(a){t.exception(i,"SetTimeRepeatableActionData",a)}},RemoveTimeRepeatableActionData:function(n){try{var o=CnnXt.Storage.GetLocalConfiguration(),c=!1,r=CnnXt.Common.StorageKeys.connext_time_repeatable_actions,f=null;o&&o.Settings&&(c=o.Settings.UseParentDomain);n?(f=CnnXt.Storage.GetTimeRepeatableActionData(),f&&delete f[n],c?(r+=CnnXt.Utils.GetCookieNamePostfix(),u(r,JSON.stringify(f),new Date("9999-01-01"),!1)):e(r,f)):(h(r),s(r+CnnXt.Utils.GetCookieNamePostfix()))}catch(l){t.exception(i,"RemoveTimeRepeatableActionData",l)}},UpdateWhitelistSetCookieName:function(){var e="UpdateWhitelistSetCookieName",u,f,n;try{u=CnnXt.Common.StorageKeys.WhitelistSet;f=CnnXt.Utils.GetCookieName(u);r(f)==undefined&&r(u)!=undefined&&(n=JSON.parse(r(u)),n.Id&&n.Expiration&&(CnnXt.Storage.SetWhitelistSetIdCookie({Id:n.Id,Expiration:n.Expiration},new Date(n.Expiration)),s(u)))}catch(o){t.exception(i,e,o)}},UpdateWhitelistInfoboxCookieName:function(){var f="UpdateWhitelistInfoboxCookieName",n,u;try{n=CnnXt.Common.StorageKeys.WhitelistInfobox;u=CnnXt.Utils.GetCookieName(n);r(u)==undefined&&r(n)!=undefined&&(CnnXt.Storage.SetWhitelistInfoboxCookie(!0),s(n))}catch(e){t.exception(i,f,e)}},UpdateNeedHidePinTemplateCookieName:function(){var f="UpdateNeedHidePinTemplateCookieName",n,u;try{n=CnnXt.Common.StorageKeys.NeedHidePinTemplate;u=CnnXt.Utils.GetCookieName(n);r(u)==undefined&&r(n)!=undefined&&(CnnXt.Storage.SetNeedHidePinTemplateCookie(!0),s(n))}catch(e){t.exception(i,f,e)}},GetCookie:function(n){return r(n)},GetLocalViewData:function(){var h="getLocalViewData",r,l,c,n,s,e;t&&t.debug(i,h,"Get local view data");try{var o={},u=CnnXt.Storage.GetViewsData(),f=CnnXt.Storage.GetTimeRepeatableActionData();if(o.AllowedIpSet=CnnXt.Storage.GetWhitelistSetIdCookie()?JSON.parse(CnnXt.Storage.GetWhitelistSetIdCookie()):undefined,o.DynamicMeterViews={},u!=undefined&&u.parserViews!=undefined)for(r in u.parserViews){l=CnnXt.Common.MeterLevels[r]!=undefined?CnnXt.Common.MeterLevels[r]:r;c=[];for(n in u.parserViews[r])if(/^-?(0|[1-9]\d*)$/.test(n)&&u.parserViews[r][n]!=null&&(typeof u.parserViews[r][n]).toLowerCase()=="object"){if(s=null,f&&f[n]){s=[];for(e in f[n])/^(0|[1-9]\d*)$/.test(e)&&f[n][e]!=null&&(typeof f[n][e]).toLowerCase()=="object"&&s.push({Id:+e,RepeatAfter:f[n][e][CnnXt.Common.TimeRepeatableActionsCS.repeat_after],Count:f[n][e][CnnXt.Common.TimeRepeatableActionsCS.count]})}c.push({Id:+n,ViewCount:u.parserViews[r][n][CnnXt.Common.ConvoArticleCountObj.device_article_count],StartDate:u.parserViews[r][n][CnnXt.Common.ConvoArticleCountObj.start_date],Actions:s})}o.DynamicMeterViews[l]={ActiveConversationId:u.parserViews[r][CnnXt.Common.MeteredArticleCountObj.active_convo_id],Conversations:c}}return t&&t.debug(i,h,"Local view data is found",o),o}catch(a){return t&&t.exception(i,h,a),{}}},SetCookie:function(n,t,i,r){u(n,t,i,r)},GetCookies:function(){return it()}}},CookieMigration=function(n){var i="CookieMigration",t,r=function(){var h="migrateDataFromPrevVersionStructure",s,c,e,a,n,f,o,r;try{if(s=CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure),CnnXt.Storage.GetCookie(s))return;if(s=CnnXt.Utils.GetCookieName("connext_viewstructure"),c=CnnXt.Storage.GetCookie(s),!c)return;if(e=JSON.parse(c),CnnXt.Storage.SetCookie(s,e,new Date("2018-04-30")),e=={})return;a=!CnnXt.Storage.GetLocalConfiguration().Settings.UseParentDomain;n={};for(f in e)if(o=f.indexOf("_device")>0?f.split("_")[0]:f,r=u(o),r!=0)if(n[r]=n[r]?n[r]:{},n[r][o]=n[r][o]?n[r][o]:{},f.indexOf("_device")>0){n[r][o][CnnXt.Common.ConvoArticleCountObj.device_article_count]=e[f];try{n[r]["_"+CnnXt.Common.ConvoArticleCountObj.device_article_count]=n[r]["_"+CnnXt.Common.ConvoArticleCountObj.device_article_count]?parseInt(n[r]["_"+CnnXt.Common.ConvoArticleCountObj.device_article_count]):parseInt(e[f])}catch(l){t.exception(i,"cannot parse meterlevel viewsCount",h,l)}}else{n[r][o][CnnXt.Common.ConvoArticleCountObj.article_count]=e[f];try{n[r]["_"+CnnXt.Common.ConvoArticleCountObj.article_count]=n[r]["_"+CnnXt.Common.ConvoArticleCountObj.article_count]?parseInt(n[r]["_"+CnnXt.Common.ConvoArticleCountObj.article_count]):parseInt(e[f])}catch(l){t.exception(i,"cannot parse meterlevel viewsCount",h,l)}}CnnXt.Storage.SetCookie(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.connext_viewstructure),n,new Date("9999-01-01"),a)}catch(l){t.exception(i,h,l)}},u=function(n){var t=CnnXt.Storage.GetCampaignData().Conversations,i,r;if(!t)return 0;for(i in t)if(t.hasOwnProperty(i)&&t[i])for(r in t[i])if(t[i][r].id==n)return t[i][r].MeterLevelId;return 0},f=function(){var r="clearOldCookies";try{String.prototype.startsWith||(String.prototype.startsWith=function(n,t){return t=t||0,this.indexOf(n,t)===t});n.each(CnnXt.Storage.GetCookies(),function(n){var t=n.toString(),i,r;t.startsWith(" ")&&(t=t.trim());t=decodeURIComponent(t);(t.startsWith("Connext_ViewedArticles")||t.startsWith("sub_Connext_ViewedArticles"))&&(Cookies.remove(t),i=location.host.split("."),r="."+i[i.length-2]+"."+i[i.length-1],Cookies.remove(t,{domain:r}))})}catch(u){t.exception(i,r,u)}},e=function(){f();r()};return{init:function(){t=CnnXt.Logger;t.debug(i,"Initializing CookieMigration Module...")},Migrate:e}},ConnextAPI=function(n){var i="API",t,s,u,h="api/",f={GetConfiguration:__.template("configuration/siteCode/<%- siteCode %>/configCode/<%- configCode %>?publishDate=<%- publishDate %>"),GetUserByEmailAndPassword:__.template("user/authorize"),GetUserByMasterId:__.template("user/masterId/<%- id %>"),GetUserByToken:__.template("user/token/<%- token %>"),EmailPreferences:"user/emailPreference",GetUserLastUpdateDate:__.template("user/getLastUpdateDate?masterId=<%-masterId%>"),CheckAccess:__.template("checkAccess/<%- masterId %>"),GetUserByEncryptedMasterId:__.template("user/encryptedMasterId?encryptedMasterId=<%- encryptedMasterId %>"),ClearServerCache:__.template("clear/siteCode/<%-siteCode%>/configCode/<%-configCode%>"),viewsData:"views",ServerStorageDeleteViewsByUserId:__.template("views/user/delete?"),ServerStorageResetConversationViews:__.template("views/user/delete?"),CreateUser:__.template("user/create"),ActivateByAccountNumber:__.template("user/ActivateByAccountNumber"),ActivateByConfirmationNumber:__.template("user/ActivateByConfirmationNumber"),ActivateByZipCodeAndHouseNumber:__.template("user/ActivateByZipCodeAndHouseNumber"),ActivateByZipCodeAndPhoneNumber:__.template("user/ActivateByZipCodeAndPhoneNumber"),SyncUser:__.template("user/sync"),GetDictionaryValue:__.template("dictionary/<%- ValueName %>"),CheckDigitalAccess:__.template("user/masterId/<%- masterId %>/DigitalAccess?mode=<%- mode %>"),GetClientIpInfo:"utils/ipInfo"},r={publishFile:{url:"",responceCode:"",publishDate:"",ex:""},config:{isExistsInLocalStorage:"",localPublishDate:""},clientUrl:"",reason:""},e=function(r){var e="Get",o,h;try{return o=u+f[r.method](r.options.payload),h="",t.debug(i,e,"calling...",o,"args",r),r.options.meta&&(h=JSON.stringify(r.options.meta)),n.ajax({headers:{"Site-Code":s.siteCode,"Paper-Code":CnnXt.GetOptions().paperCode,"Product-Code":CnnXt.Utils.GetProductCode(),"x-test":"test","Access-Control-Allow-Origin":"*",Environment:CnnXt.GetOptions().environment,settingsKey:CnnXt.GetOptions().settingsKey,attr:CnnXt.GetOptions().attr,metaData:h,Version:CnnXt.GetVersion(),"Source-System":"Plugin"},url:o,type:"GET",dataType:"json",success:function(n,u,f){if(n&&f.status!=204){if(t.debug(i,e,"<< SUCCESS RESULT>>","textStatus",u,"data",n),__.isFunction(r.options.onSuccess))r.options.onSuccess(n)}else t.debug(i,e,"<< SUCCESS NULL RESULT >>","textStatus",u,"data",n),__.isFunction(r.options.onNull)&&r.options.onNull()},error:function(n){if(t.debug(i,e,"Ajax.Error",n),__.isFunction(r.options.onError)){var u=JSON.parse(n.responseText);r.options.onError(u)}},complete:function(){__.isFunction(r.options.onComplete)&&r.options.onComplete()}})}catch(c){t.exception(i,e,c);__.isFunction(r.options.onError)&&r.options.onError()}},o=function(r){var e="Post",o,h;try{return o=u+f[r.method](r.options.payload),h="",t.debug(i,e,"calling...",o,"args",r),r.options.meta&&(h=JSON.stringify(r.options.meta)),n.ajax({headers:{"Site-Code":s.siteCode,"Paper-Code":CnnXt.GetOptions().paperCode,"Product-Code":CnnXt.Utils.GetProductCode(),"Config-Code":CnnXt.Storage.GetLocalConfiguration().Settings.Code,"x-test":"test","Access-Control-Allow-Origin":"*",Environment:CnnXt.GetOptions().environment,settingsKey:CnnXt.GetOptions().settingsKey,attr:CnnXt.GetOptions().attr,metaData:h,Version:CnnXt.GetVersion(),"Source-System":"Plugin"},url:o,type:"POST",data:r.options.payload,dataType:"json",success:function(n,u,f){if(n&&f.status!=204){if(t.debug(i,e,"<< SUCCESS RESULT >>","textStatus",u,"data",n),__.isFunction(r.options.onSuccess))r.options.onSuccess(n)}else t.debug(i,e,"<< SUCCESS NULL RESULT >>","textStatus",u,"data",n),__.isFunction(r.options.onNull)&&r.options.onNull()},error:function(n){if(t.debug(i,e,"Ajax.Error",n),__.isFunction(r.options.onError)){var u=JSON.parse(n.responseText);r.options.onError(u)}},complete:function(){__.isFunction(r.options.onComplete)&&r.options.onComplete()}})}catch(c){t.exception(i,e,c);__.isFunction(r.options.onError)&&r.options.onError()}},c=function(r){var e="GetNewsletters",o;try{return o=u+f.EmailPreferences,o+="?email="+r.options.email+"&emailPreferenceId="+r.options.id,t.debug(i,e,"calling...",o,"args",r),n.ajax({headers:{"Site-Code":"MNG","Access-Control-Allow-Origin":"*",Environment:CnnXt.GetOptions().environment,settingsKey:CnnXt.GetOptions().settingsKey,Version:CnnXt.GetVersion(),"Source-System":"Plugin"},url:o,type:"GET",dataType:"json",success:function(n,u,f){n&&f.status!=204?(t.debug(i,e,"<< SUCCESS RESULT >>","textStatus",u,"data",n),__.isFunction(r.options.onSuccess)&&r.options.onSuccess()):(t.debug(i,e,"<< SUCCESS NULL RESULT >>","textStatus",u,"data",n),__.isFunction(r.options.onNull)&&r.options.onNull())},error:function(n){if(t.debug(i,e,"Ajax.Error",n),__.isFunction(r.options.onError))r.options.onError(n)},complete:function(){__.isFunction(r.options.onComplete)&&r.options.onComplete()}})}catch(s){t.exception(i,e,s);__.isFunction(r.options.onError)&&r.options.onError()}},l=function(){var r="clearServerCache",e={siteCode:CnnXt.GetOptions().siteCode,configCode:CnnXt.GetOptions().configCode},o=u+f.ClearServerCache(e);return t.debug(i,r,"calling...",o,"payload",e),n.ajax({headers:{attr:CnnXt.GetOptions().attr},url:o,type:"POST",dataType:"json",success:function(n,u){t.debug(i,r,"<< SUCCESS >>","textStatus",u,"data",n)},error:function(n){t.debug(i,r,"Ajax.Error",n)}})};return{init:function(n){t=CnnXt.Logger;t.debug(i,"Initializing API Module...");s=n;u=s.api+h},GetConfiguration:function(n){return r.clientUrl=document.location.href,r.userAgent=navigator.userAgent,r.guid=CnnXt.Storage.GetGuid(),r.localConfig=localStorage.getItem("IsLocalConfig"),n.meta=r,e({method:"GetConfiguration",options:n})},GetUserByEmailAndPassword:function(n){return o({method:"GetUserByEmailAndPassword",options:n})},ClearServerCache:l,CheckAccess:function(n){return e({method:"CheckAccess",options:n})},GetUserByMasterId:function(n){return e({method:"GetUserByMasterId",options:n})},GetUserLastUpdateDate:function(n){return e({method:"GetUserLastUpdateDate",options:n})},GetUserByEncryptedMasterId:function(n){return e({method:"GetUserByEncryptedMasterId",options:n})},CreateUser:function(n){return o({method:"CreateUser",options:n})},ActivateByAccountNumber:function(n){return o({method:"ActivateByAccountNumber",options:n})},ActivateByZipCodeAndHouseNumber:function(n){return o({method:"ActivateByZipCodeAndHouseNumber",options:n})},ActivateByZipCodeAndPhoneNumber:function(n){return o({method:"ActivateByZipCodeAndPhoneNumber",options:n})},ActivateByConfirmationNumber:function(n){return o({method:"ActivateByConfirmationNumber",options:n})},SyncUser:function(n){return o({method:"SyncUser",options:n})},SendViewData:function(r){var e="SendViewData",o=u+f.viewsData;return t.debug(i,e,"calling...",o,"data",r),n.ajax({url:o,headers:{Environment:CnnXt.GetOptions().environment,"Content-Type":"application/json"},type:"POST",data:JSON.stringify(r),dataType:"json",success:function(n,r){t.debug(i,e,"<< SUCCESS >>","textStatus",r,"data",n)},error:function(n){t.debug(i,e,"Ajax.Error",n)}})},GetViewData:function(){var r="GetViewData",o={userId:Fprinting().getDeviceId(),configCode:CnnXt.GetOptions().configCode,siteCode:CnnXt.GetOptions().siteCode,settingsKey:CnnXt.GetOptions().settingsKey},e=u+f.viewsData;return t.debug(i,r,"calling...",e),n.ajax({url:e,headers:{Environment:CnnXt.GetOptions().environment},type:"GET",data:o,success:function(n,u){t.debug(i,r,"<< SUCCESS >>","textStatus",u,"data",n)},error:function(n){t.debug(i,r,"Ajax.Error",n)}})},ServerStorageDeleteViewsByUserId:function(){var r={userId:CnnXt.GetOptions().deviceId,masterId:CnnXt.User.getMasterId(),configCode:CnnXt.GetOptions().configCode,siteCode:CnnXt.GetOptions().siteCode,settingsKey:CnnXt.GetOptions().settingsKey},e=u+f.ServerStorageDeleteViewsByUserId(r);return t.debug(i,"ServerStorageDeleteViewsByUserId","calling...",e,"data",r),n.ajax({url:e,headers:{Environment:CnnXt.GetOptions().environment},type:"GET",data:r})},ServerStorageResetConversationViews:function(r){var e="ServerStorageResetConversationViews",o={userId:CnnXt.GetOptions().deviceId,conversationId:r,configCode:CnnXt.GetOptions().configCode,siteCode:CnnXt.GetOptions().siteCode,settingsKey:CnnXt.GetOptions().settingsKey},s=u+f.ServerStorageResetConversationViews(o);return t.debug(i,e,"calling...",s,"data",o),n.ajax({url:s,headers:{Environment:CnnXt.GetOptions().environment},type:"GET",data:o,success:function(n,r){t.debug(i,e,"<< SUCCESS >>","textStatus",r,"data",n)},error:function(n){t.debug(i,e,"Ajax.Error",n)}})},meta:r,GetLastPublishDateS3:function(){var u="GetLastPublishDateS3",f;try{return f=CnnXt.Common.S3RootUrl[s.environment]+"data/last_publish/"+s.siteCode+".json?_="+(new Date).getTime(),t.debug(i,u,"jsonURL",f),r.publishFile.url=f,n.ajax({crossDomain:!0,contentType:"application/json; charset=utf-8",async:!0,url:f,success:function(n,f){t.debug(i,u,"<< SUCCESS >>","textStatus",f,"data",n);r.publishFile.responceCode=200},error:function(n){t.debug(i,u,"Ajax.Error",n);r.publishFile.responceCode=a.status;r.reason=CnnXt.Common.DownloadConfigReasons.getPublishFailed}})}catch(e){t.exception(i,u,e);r.reason=CnnXt.Common.DownloadConfigReasons.getPublishFailed;r.publishFile.ex=e}},NewsletterSubscribe:function(n){return c({method:"NewsletterSubscribe",options:n})},GetProductCode:function(){return e({method:"GetDictionaryValue",options:{payload:{ValueName:"productCode"}}})},CheckDigitalAccess:function(n){return e({method:"CheckDigitalAccess",options:n})},GetClientIpInfo:function(){var t=CnnXt.Common.APIUrl[CnnXt.GetOptions().environment]+h+f.GetClientIpInfo;return n.ajax({url:t,type:"GET"})}}},ConnextUser=function(n){var i="User",t,s,f={},y=!1,h={},a,c,it,u,p,r,b,k,e={},d="UserName or Password invalid. Please try again or click on the Forgot/Reset Password link to update your password, or create an account if you have never registered an email address with us.",v={show:function(n){try{c&&c.info(n).show()}catch(r){t.exception(i,"NOTIFICATION.show",r)}},hide:function(){try{c&&c.hide()}catch(n){t.exception(i,"NOTIFICATION.hide",n)}},showAndHide:function(n,r){try{c&&(c.info(n),b=setTimeout(function(){c.find(".alert").remove()},r))}catch(u){t.exception(i,"NOTIFICATION.showAndHide",u)}}},o={LoginButton:"[data-mg2-submit=login]:visible",LoginAlert:"[data-mg2-alert=login]:visible",JanrainLoginBtn:"[data-mg2-submit=janrainLogin]:visible",InputUsername:"[data-mg2-alert=login] [data-mg2-input=Email]",InputPassword:"[data-mg2-alert=login] [data-mg2-input=Password]",ActionShowLogin:"[data-mg2-action=login]",LogoutButton:"[data-mg2-action=logout]",SubscribeButton:'[data-mg2-action="submit"]',SubmitZipCode:'[data-mg2-action="Zipcode"]',ConnextRun:'[data-mg2-action="connextRun"]',OpenNewsletterWidget:'[data-mg2-action="openNewsletterWidget"]',LoginModal:'<div data-mg2-alert="login" data-template-id="23" data-display-type="modal" data-width="400" id="mg2-login-modal"  tabindex="-1" class="Mg2-connext modal fade in"><div class="modal-body picker-bg"><i class="fa fa-times closebtn" data-dismiss="modal" aria-label="Close" aria-hidden="true"><\/i><form><h1 class="x-editable-text text-center h3">LOGIN<\/h1><p class="x-editable-text text-center m-b-2" >to save access to articles or get newsletters, allerts or recomendations  all for free<\/p><label class="textColor4 x-editable-text" >E-mail<\/label><input type="email" data-mg2-input="Email" class="text" name="email" value=""   data-mg2-input="Email" /><label class="textColor4 x-editable-text">Password<\/label><input type="password" data-mg2-input="Password" class="text" name="password" value=""  data-mg2-input="Password" /><a href="" data-mg2-submit="login" class="input submit x-editable-text" title="Login">Login<\/a><\/form><\/div><\/div>',CheckAccessPopup:'<div class="Mg2-connext modal fade in" id="CheckAccessPopup" data-display-type="modal" data-width="300" tabindex="-1"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body">We noticed that your access status has changed. Page will be reloaded based on your new access permissions<\/div><div class="modal-footer text-center"><button type="button" id="ConnextRunBtn" class="btn btn-default" data-dismiss="modal">OK<\/button><\/div><\/div><\/div><\/div>'},rt=function(){var r="Init";try{t.debug(i,"Initializing User Module...");o.LoginModal=s.LoginModal;ut();n("body").on("click",o.LogoutButton,function(n){n.preventDefault();var r=o.LogoutButton+".CLICK";t.debug(i,r,n);ht()});n("body").on("click",'[data-dismiss="alert"]',function(){c.find(".alert").remove();clearTimeout(b)});n("body").on("click",o.SubscribeButton,function(r){var f;r.preventDefault();f=o.SubscribeButton+".CLICK";t.debug(i,f,r);try{var e=n(this),u=e.attr("href"),s=e.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val();u=CnnXt.Utils.AddParameterToURL(u,"email",s);e.attr("href",u);window.location.href=u}catch(h){t.exception(i,f,h)}});n("body").on("click",o.SubmitZipCode,function(r){var e;r.preventDefault();e=o.SubmitZipCode+".CLICK";t.debug(i,e,r);try{var f=n(this),u=f.attr("href"),s=f.parents(".Mg2-connext").find('[data-mg2-input="Zipcode"]').val();u=CnnXt.Utils.AddParameterToURL(u,"zipcode",s);f.attr("href",u);f[0].hasAttribute("target")?window.open(u,"_blank"):window.location.href=u}catch(h){t.exception(i,e,h)}});n("body").on("click",o.OpenNewsletterWidget,function(r){var e,u,f;r.preventDefault();e=o.OpenNewsletterWidget+".CLICK";t.debug(i,e,r);try{u=n(this);f={};u.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val()!=undefined&&u.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val()!==""&&(f.email=u.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val());u.data("category-ids-list")!=undefined&&(f.categoryIdsList=u.data("category-ids-list").toString().split(",").map(function(n){return parseInt(n,10)}));u.data("newsletter-ids-list")!=undefined&&(f.newsletterIdsList=u.data("newsletter-ids-list").toString().split(",").map(function(n){return parseInt(n,10)}));u.data("view-mode")!=undefined&&(f.viewMode=u.data("view-mode"));mg2WidgetAPI.openNewsletter(f)}catch(s){t.exception(i,e,s)}});n("body").on("click",".Mg2-btn-forgot",function(r){var e;r.preventDefault();e="Forgot password btn.CLICK";t.debug(i,e,r);try{var f=n(this),u=f.attr("href"),o=f.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val();u=CnnXt.Utils.AddReturnUrlParamToLink(u);u=CnnXt.Utils.AddParameterToURL(u,"email",o);f.attr("href",u);f[0].hasAttribute("target")?window.open(u,"_blank"):window.location.href=u}catch(s){t.exception(i,e,s)}});n("body").on("click dblclick",o.LoginButton,function(r){var u,e,s;r.preventDefault();u=o.LoginButton+".CLICK";t.debug(i,u,r);try{a=n(o.LoginButton).loader();c=n(o.LoginAlert).jalert();a.on();f.MG2?(e=n(o.InputUsername+":visible").val(),s=n(o.InputPassword+":visible").val(),wt(e,s)):JanrainAuthenticate(n("[data-mg2-input=Username]:visible").val(),n("[data-mg2-input=Password]:visible").val())}catch(h){t.exception(i,u,h)}});n("body").on("click",o.JanrainLoginBtn,function(r){var u,f,e;r.preventDefault();u=o.JanrainLoginBtn+".CLICK";t.debug(i,u,r);try{window.janrain?(f=n("[data-mg2-input=Email]:visible").val(),e=n("[data-mg2-input=Password]:visible").val(),janrain.capture.ui.modal.open(),n("#capture_signIn_traditionalSignIn_emailAddress").val(f),n("#capture_signIn_traditionalSignIn_password").val(e),n("#capture_signIn_traditionalSignIn_signInButton").click()):t.warn("No janrain global object found!")}catch(s){t.exception(i,u,s)}});n("body").on("click",o.ActionShowLogin,function(r){var h,u,e;r.preventDefault();h=o.ActionShowLogin+".Click";t.debug(i,h,"IS_LOGGED_IN",y);try{if(f.MG2){u=n(o.LoginModal);u.addClass("in");u.attr("id","mg2-login-modal");u.css("display","block");CnnXt.Utils.AddQueryParamsToAllLinks(u);u.connextmodal({backdrop:"true"});u.resize();e={LoginModalId:s.LoginModalId,LoginModalName:s.LoginModalName,LoginModalHtml:s.LoginModal,jQueryElement:u};u.on("keydown",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(e.closeEvent=CnnXt.Common.CLOSE_CASES.EscButton)}).on("hidden.bs.modal",function(){(e.closeEvent==null||e.closeEvent==undefined)&&(e.closeEvent=CnnXt.Common.CLOSE_CASES.ClickOutside);CnnXt.Event.fire("onLoginClosed",e)});u.find("[data-dismiss=banner], [data-dismiss=info-box], [data-dismiss=inline], [data-dismiss=modal]").on("click",function(){e.closeEvent=CnnXt.Common.CLOSE_CASES.CloseButton;CnnXt.Event.fire("onButtonClick",e)})}else f.GUP?at(window):f.Janrain?window.janrain?janrain.capture.ui.modal.open():t.warn("No janrain global object found!"):f.Auth0&&(Auth0Lock?tt():t.warn("No Auth0 global object found!"));CnnXt.Event.fire("onLoginShown",e)}catch(c){t.exception(i,h,c)}})}catch(u){t.exception(i,r,u)}},ut=function(){var r="setAuthType",u,e;try{if(t.debug(i,r,"Setting auth type...",s),s.Site.RegistrationTypeId==1)t.debug(i,r,"Use MG2 auth system"),f.MG2=!0;else if(s.Site.RegistrationTypeId==2)t.debug(i,r,"Use Janrain auth system"),f.Janrain=!0,a=n(o.LoginButton).loader(),c=n(o.LoginAlert).jalert();else if(s.Site.RegistrationTypeId==3)t.debug(i,r,"Use GUP auth system"),f.GUP=!0;else if(s.Site.RegistrationTypeId==4){if(t.debug(i,r,"Use Auth0 auth system"),f.Auth0=!0,u=CnnXt.GetOptions().authSettings,!u&&!_.isObject(u.auth0Lock))throw CnnXt.Common.ERROR.NO_AUTH0_LOCK;e=u.auth0Lock;e.on("authenticated",function(n){t.debug(i,"lock.on: authenticated",n);e.getUserInfo(n.accessToken,function(n,r){if(n){t.debug(i,"lock.getUserInfo",n);CnnXt.Storage.SetUserProfile("");CnnXt.Event.fire("onLoginError",{ErrorMessage:__.isString(n)?n:""});return}t.debug(i,"lock.getUserInfo",r);CnnXt.Storage.SetUserProfile(r);CnnXt.Activation.IsActivationFlowRunning()?CnnXt.User.CheckAccess().always(function(){CnnXt.Activation.Run({runAfterSuccessfulLogin:!0})}):CnnXt.Run()})})}else if(s.Site.RegistrationTypeId==5)t.debug(i,r,"Use Custom auth system"),f[CnnXt.Common.RegistrationTypes[5]]=!0;else throw CnnXt.Common.ERROR.UNKNOWN_REG_TYPE;pt()}catch(h){h.custom?t.warn(h.message):t.exception(i,r,h)}},ft=function(){var c="checkAccess",s=n.Deferred(),v=n.Deferred(),a=n.Deferred();return t.debug(i,c,"Checking user access..."),!f.Custom&&e&&e.MasterId?CnnXt.API.GetUserLastUpdateDate({payload:{masterId:e.MasterId},onSuccess:function(n){(CnnXt.Storage.GetUserLastUpdateDate()==null||new Date(CnnXt.Storage.GetUserLastUpdateDate())<new Date(n))&&(CnnXt.Storage.SetUserState(null),CnnXt.Storage.SetUserData(null),CnnXt.Storage.SetUserLastUpdateDate(n));v.resolve()},onNull:function(){v.resolve()},onError:function(){v.resolve()}}):v.resolve(),v.promise().then(function(){if(kt(),CnnXt.Storage.GetAccountDataExpirationCookie()||(CnnXt.Storage.SetUserState(null),CnnXt.Storage.SetUserData(null)),r=CnnXt.Storage.GetUserState(),f.MG2&&(CnnXt.Storage.GetigmRegID()?r==u.NotLoggedIn&&(r=null):(r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r))),f.Custom)try{Connext.GetOptions().authSettings.CalculateAuthStatusFunc().done(function(n){if(__.values(u).indexOf(n)==-1)throw CnnXt.Common.ERROR.UNKNOWN_USER_STATE;r=n;CnnXt.Storage.SetUserState(r);CnnXt.Storage.SetAccountDataExpirationCookie(!0);r==u.NotLoggedIn||CnnXt.Storage.GetUserProfile()?a.resolve():Connext.GetOptions().authSettings.GetAuthProfileFunc().done(function(n){try{CnnXt.Storage.SetUserProfile(n);var r={};n.MasterId?(r.MasterId=n.MasterId,k=n.MasterId):t.debug(i,c,"authProfile.MasterId is undefined");n.DisplayName?r.DisplayName=n.DisplayName:t.debug(i,c,"authProfile.DisplayName is undefined");Object.getOwnPropertyNames(r).length>0&&CnnXt.Storage.SetUserData(r);a.resolve()}catch(f){t.exception(i,c,f);CnnXt.Storage.SetUserState(u.NotLoggedIn);a.resolve()}}).fail(function(n){t.debug(i,c,"customAuth.GetAuthProfileFunc.fail",n);CnnXt.Storage.SetUserState(u.NotLoggedIn);a.resolve()})}).fail(function(n){t.debug(i,c,"customAuth.GetAuthProfileFunc.fail",n);CnnXt.Storage.SetUserState(u.NotLoggedIn);a.resolve()})}catch(v){v.custom?t.warn(v.message):t.exception(i,c,v);CnnXt.Storage.SetUserState(u.NotLoggedIn);a.resolve()}else a.resolve();a.promise().then(function(){var a,y;if(r==null||r==undefined||f.Auth0||(f.Janrain&&(window.localStorage.getItem("janrainCaptureToken")?r==u.NotLoggedIn&&(r=null):(r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r))),r==u.NotLoggedIn?(CnnXt.Storage.ClearUser(),CnnXt.Storage.SetUserState(u.NotLoggedIn),s.reject("onNotAuthorized")):(e=CnnXt.Storage.GetUserData(),n(o.ActionShowLogin).hide(),n(o.LogoutButton).show(),r==u.LoggedIn?(f.Janrain?a="Janrain":f.MG2?a="MG2":f.GUP?a="GUP":f.Custom&&(a="Custom"),s.reject("onAuthorized")):w()&&(y=g(),s.reject(y))),r!=null&&s.resolve(!0)),!f.Custom&&(r==null||r==undefined||f.GUP||f.Auth0))try{h.Start=new Date;r=u.NotLoggedIn;CnnXt.Storage.SetUserState(r);CnnXt.Storage.SetAccountDataExpirationCookie(!0);st().done(function(e){if(t.debug(i,c,"User data",e),!e)throw CnnXt.Common.ERROR.NO_USER_DATA;if(k=e,f.MG2)CnnXt.API.GetUserByEncryptedMasterId({payload:{encryptedMasterId:e},onSuccess:function(t){f.Auth0?t.AuthSystem="Auth0":f.GUP&&(t.AuthSystem="GUP");l("MasterId",t);h.Done=new Date;s.resolve(!0);n(o.ActionShowLogin).hide();n(o.LogoutButton).show()},onNull:function(){h.Done=new Date;s.reject("GetUserByMasterId.onNull")},onError:function(){h.Done=new Date;s.reject("GetUserMasterId.onError")}});else if(f.Janrain)CnnXt.API.GetUserByMasterId({payload:{id:e},onSuccess:function(n){n.AuthSystem="Janrain";l("externalId",n);h.Done=new Date;s.resolve(!0)},onNull:function(){h.Done=new Date;s.reject("GetUserByToken.onNull")},onError:function(){h.Done=new Date;s.reject("GetUserByToken.onError")}});else if(f.Auth0)r=u.LoggedIn,CnnXt.Storage.SetUserState(r),CnnXt.Storage.GetUserData()?(l("externalId",CnnXt.Storage.GetUserData()),s.resolve(!0)):CnnXt.API.GetUserByMasterId({payload:{id:e},onSuccess:function(n){n.AuthSystem="Auth0";l("externalId",n);h.Done=new Date;s.resolve(!0)},onNull:function(){h.Done=new Date;s.reject("GetUserByExternalId.onNull")},onError:function(){h.Done=new Date;s.reject("GetUserByExternalId.onError")}});else if(f.GUP){var a=yt(e);h.Done=new Date;t.debug(i,c,"getUserData.done -- gupUserHasAccess",a);s.resolve(!0);t.debug(i,c,"getUserData.done","Has GUP Data",e)}else CnnXt.Event.fire("onCriticalError",{"function":"getUserData.done",error:"Unknown Registration Type"})}).fail(function(n){t.debug(i,c,"getUserData.fail -- error",n);h.Done=new Date;s.reject()})}catch(v){v.custom?t.warn(v.message):t.exception(i,c,v);h.Done=new Date;s.reject()}})}),s.promise()},l=function(o,s){var l="processSuccessfulLogin",h,a,y,c,s;t.debug(i,l,"Process successful login",o,s);try{r=u.LoggedIn;s.IgmAuth=s.IgmAuth||CnnXt.Storage.GetIgmAuth();s.IgmContent=s.IgmContent||CnnXt.Storage.GetIgmContent();s.IgmRegID=s.IgmRegID||CnnXt.Storage.GetigmRegID();e=CnnXt.Utils.ShapeUserData(s);h=CnnXt.Storage.GetUserData();h&&e&&(e.IgmContent=e.IgmContent?e.IgmContent:h.IgmContent,e.IgmRegID=e.IgmRegID?e.IgmRegID:h.IgmRegID,e.MasterId=e.MasterId?e.MasterId:h.MasterId,e.UserToken=e.UserToken?e.UserToken:h.UserToken);CnnXt.Storage.SetUserData(e);CnnXt.Storage.SetAccountDataExpirationCookie(!0);t.debug(i,l,"type",o,"USER_DATA",e);nt(!0);et(e)?v.show("NoSubscriptionData"):(_.isObject(e.Subscriptions)||(e.Subscriptions=JSON.parse(e.Subscriptions)),a=null,a=e.Subscriptions.OwnedSubscriptions?__.map(e.Subscriptions.OwnedSubscriptions,function(n){return n.BillingAddress&&n.BillingAddress.ZipCode?n.BillingAddress.ZipCode:n.DeliveryAddress?n.DeliveryAddress.ZipCode:null}):__.map(e.Subscriptions,function(n){return n.BillingAddress&&n.BillingAddress.ZipCode?n.BillingAddress.ZipCode:n.PostalCode}),CnnXt.Storage.SetUserZipCodes(a));f.MG2?(e.IgmRegID&&CnnXt.Storage.SetigmRegID(e.IgmRegID),e.IgmContent&&CnnXt.Storage.SetIgmContent(e.IgmContent),e.IgmAuth&&CnnXt.Storage.SetIgmAuth(e.IgmAuth)):f.Janrain||f.GUP||f.Auth0||CnnXt.Event.fire("onCriticalError",{"function":"processAuthentication",error:"Unknown Registration Type"});ot(e);n("#ddZipCode").text(CnnXt.Storage.GetActualZipCodes().toString());w()&&(y=n("body").data("modalmanager"),y&&(c=y.getOpenModals(),t.debug(i,l,"openModals",c),c.length>0&&c[0].isShown&&(v.show("AuthSuccess"),setTimeout(function(){c[0].$element.modal("hide")},1500))));s={UserId:Fprinting().getDeviceId(),ConfigCode:CnnXt.GetOptions().configCode,SiteCode:CnnXt.GetOptions().siteCode,SettingsKey:CnnXt.GetOptions().settingsKey,ViewData:CnnXt.Storage.GetLocalViewData()};CnnXt.User.getMasterId()&&(s.masterId=CnnXt.User.getMasterId());CnnXt.Storage.SetUserState(r)}catch(p){t.exception(i,l,p)}},et=function(n){return!n.Subscriptions||__.isArray(n.Subscriptions)&&!n.Subscriptions.length||__.isObject(n.Subscriptions)&&(!n.Subscriptions.OwnedSubscriptions||!n.Subscriptions.OwnedSubscriptions.length)},ot=function(f){var e="defineUserState";try{f.DigitalAccess&&_.isEmpty(f.DigitalAccess.Errors)?f.Subscriptions&&f.Subscriptions.length!=0?f.DigitalAccess.AccessLevel.IsPremium?(r=u.Subscribed,n(".Mg2-pin-modal").connextmodal("hide"),n(".Mg2-pin-infobox").hide()):f.DigitalAccess.AccessLevel.IsUpgrade?r=u.SubscribedNotEntitled:f.DigitalAccess.AccessLevel.IsPurchase&&(r=u.NoActiveSubscription):r=u.LoggedIn:r=u.LoggedIn;t.debug(i,e,"Defined user state",r)}catch(o){t.exception(i,e,o)}},w=function(){var n=!1;if(u)switch(r){case u.Subscribed:case u.SubscribedNotEntitled:case u.NoActiveSubscription:n=!0}return n},g=function(){var n="onNotAuthorized";switch(r){case u.LoggedIn:n="onAuthorized";break;case u.Subscribed:n="onHasAccess";break;case u.SubscribedNotEntitled:n="onHasAccessNotEntitled";break;case u.NoActiveSubscription:n="onHasNoActiveSubscription"}return n},st=function(){var o="getUserData",e=n.Deferred(),c,s,h,l;try{return f.MG2?(c=CnnXt.Storage.GetigmRegID(),c?e.resolve(c):e.reject("No MG2 UserToken")):f.Janrain?window.JANRAIN?window.localStorage.getItem("janrainCaptureToken")?(t.debug(i,o,"Janrain Loaded"),s=ct(),t.debug(i,o,"janrainProfile",s),s.uuid?(r=u.LoggedIn,CnnXt.Storage.SetUserState(r),e.resolve(s.uuid)):e.reject("No Janrain Profile Data")):(r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),e.reject("Janrain Logged out User")):(r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),e.reject("Janrain object is not exist")):f.GUP?vt().then(function(n){t.debug(i,o,"getCurrentGUPUser.then (data)",n);n&&e.resolve(n)}).fail(function(n){t.debug(i,o,"getCurrentGUPUser",n);e.reject()}):f.Auth0?(h=CnnXt.GetOptions().authSettings,h||_.isObject(h.auth0Lock)||(t.warn("No auth0Lock object in the authSettings!"),r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),CnnXt.Storage.ClearUser(),e.reject(null)),l=h.auth0Lock,l.checkSession({scope:"openid profile email",redirect_uri:window.location.origin},function(n,f){!n&&f&&f.accessToken?f.idTokenPayload&&f.idTokenPayload.sub?(CnnXt.Storage.SetUserProfile(f.idTokenPayload),e.resolve(f.idTokenPayload.sub)):l.getUserInfo(f.accessToken,function(n,f){!n&&f&&f.sub?(CnnXt.Storage.SetUserProfile(f),t.debug(i,o,"CHECK SSO - true",f),e.resolve(f.sub)):(t.debug(i,o,"checkSession - error",n),r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),CnnXt.Storage.ClearUser(),e.reject(null))}):(t.debug(i,o,"checkSession - error",n),r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),CnnXt.Storage.ClearUser(),e.reject(null))})):(CnnXt.Event.fire("onCriticalError",{"function":"getUserData",error:"Unknown Registration Type"}),e.reject("Unknown Registration Type"),t.debug(i,o,"Unknown Registration Type",f)),e.promise()}catch(a){t.exception(i,o,a)}},ht=function(){var n="logoutUser";try{t.debug(i,n,"Logout!");nt(!1);CnnXt.Storage.SetUserState(u.NotLoggedIn);CnnXt.Run()}catch(r){t.exception(i,n,r)}},ct=function(){var r="getJanrainProfileData",n;try{return n=window.localStorage.getItem("janrainCaptureProfileData"),t.debug(i,r,"Get Janrain profile data",n),n==null&&(n=window.localStorage.getItem("janrainCaptureReturnExperienceData")),n?JSON.parse(n):!1}catch(u){return t.exception(i,r,u),!1}},lt=function(n){var r="janrainAuthenticationCallback";try{if(t.debug(i,r,n),!n.userData.uuid)throw CnnXt.Common.ERROR.NO_JANRAIN_DATA;CnnXt.API.GetUserByMasterId({payload:{id:n.userData.uuid},onSuccess:function(n){n.AuthSystem="Janrain";l("Form",n)},onError:function(n){t.exception(i,r,n)}})}catch(u){u.custom?t.warn(u.message):t.exception(i,r,u)}},at=function(){var n=500,r=600,u=screen.width/2-n/2,f=screen.height/2-r/2,e=window.open(p.LoginServiceBasePath+"authenticate/?window-mode=popup","_blank","toolbar=no, scrollbars=yes, resizable=no, width="+n+", height="+r+", top="+f+", left="+u);e.onunload=function(n){t.debug(i,"<< GUP >>",n)};return},vt=function(){return n.ajax({type:"POST",url:p.UserServiceBasePath+"user/?callback=?",contentType:"application/json; charset=utf-8",dataType:"json",async:!0})},yt=function(f){var e="authenticateGUPUser";try{return t.debug(i,e,arguments),!f.meta.isAnonymous&&f.response.user?f.response.user.hasMarketAccess?(t.debug(i,e,"GUP User <<IS>> LOGGED IN, AND has market access"),r=u.Subscribed,CnnXt.Storage.SetUserState(r),n(".Mg2-pin-modal").connextmodal("hide"),n(".Mg2-pin-infobox").hide(),!0):(t.debug(i,e,"GUP User <<IS>> LOGGED IN, but doesnt have marketAccess"),r=u.LoggedIn,CnnXt.Storage.SetUserState(r),!1):(t.debug(i,e,"GUP User <<NOT>> LOGGED IN"),r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),!1)}catch(o){return t.exception(i,e,o),r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),!1}},pt=function(){var n="registerEventlisteners";try{if(f.GUP)window.jQuery(window).on("focus.gup_login_popup",function(){t.debug("focus.gup_login_popup")})}catch(r){t.exception(i,n,r)}},nt=function(f){var s="handleUILoggedInStatus",e;try{e=n(o.ActionShowLogin);y=f;r=f?u.LoggedIn:u.NotLoggedIn;t.debug(i,s,"USER_STATE",r);y?(n(o.LogoutButton).show(),n(o.ActionShowLogin).hide(),e.text(e.data("mg2-logged-in"))):(e.text(e.data("mg2-logged-out")),CnnXt.Storage.ClearUser(),n(o.LogoutButton).hide(),n(o.ActionShowLogin).show(),n("#ddZipCode").text(CnnXt.Storage.GetActualZipCodes().toString()))}catch(h){t.exception(i,s,h)}},wt=function(r,u){var f="MG2Authenticate";try{if(!r)return c.find(".alert").remove(),v.showAndHide("Please enter email",1e4),a.off(),t.debug(i,f,"No email"),!1;if(!u)return c.find(".alert").remove(),v.showAndHide("Please enter password",1e4),a.off(),t.debug(i,f,"No password"),!1;t.debug(i,f,"Login");CnnXt.API.GetUserByEmailAndPassword({payload:{Email:r,Password:u},onSuccess:function(t){t.Email=r;t.AuthSystem="MG2";l("Form",t);CnnXt.Event.fire("onLoginSuccess",{MG2AccountData:e,AuthProfile:CnnXt.Storage.GetUserProfile(),AuthSystem:e.AuthSystem});n(o.ActionShowLogin).hide();n(o.LogoutButton).show();CnnXt.Run()},onNull:function(){v.show("NotAuthenticated")},onError:function(n){var t=bt(n);CnnXt.Event.fire("onLoginError",{ErrorMessage:t});c.find(".alert").remove();v.showAndHide(t,1e4)},onComplete:function(){a.off()}})}catch(s){t.exception(i,f,s)}},bt=function(n){var u="getMessageFromErrorResponse",r="GenericAuthFailed",f;if(n&&n.Message){try{t.debug(i,u,"Try parse error message");f=JSON.parse(n.Message);r=f.Message;r=="UserName or Password invalid."&&(r=d)}catch(e){return t.exception(i,u,"parse response JSON",e),d}t.debug(i,u,"Error message:",r)}return r},dt=function(){return n.ajax({type:"POST",url:p.UserServiceBasePath+"user/logout/?callback=?",contentType:"application/json; charset=utf-8",dataType:"json",async:!0})},tt=function(){var u="showAuth0Login",n;try{if(n=CnnXt.GetOptions().authSettings,!n&&!_.isObject(n.auth0Lock))throw CnnXt.Common.ERROR.NO_AUTH0_LOCK;n.auth0Lock.show()}catch(r){r.custom?t.warn(r.message):t.exception(i,u,r)}},kt=function(){var n="clearUserStateIfWasRedirect";try{t.debug(i,n);CnnXt.Utils.getUrlParam("clearUserState")&&(CnnXt.Storage.SetUserData(null),CnnXt.Storage.SetUserState(null))}catch(r){t.exception(i,n,r)}};return{init:function(n){t=CnnXt.Logger;s=n?n:{};u=CnnXt.Common.USER_STATES;r=u.NotLoggedIn;rt();s.Site.RegistrationTypeId==3&&(p={UserServiceBasePath:s.Settings?s.Settings.GUPAccountService:"",LoginServiceBasePath:s.Settings?s.Settings.GUPAccountLoginUrl:""})},CheckAccess:function(){return ft().done(function(n){t.debug(i,"CheckAccess","User.CheckAccess.Done",n)}).fail(function(){t.debug(i,"CheckAccess","User.CheckAccess.Fail")}).always(function(){var r=Connext.Storage.GetLocalConfiguration().Site.RegistrationTypeId,t=CnnXt.Common.RegistrationTypes[r],f=g(),i=CnnXt.Storage.GetUserState();i!=u.NotLoggedIn&&i!=null&&CnnXt.Event.fire("onLoggedIn",{AuthSystem:t,AuthProfile:CnnXt.Storage.GetUserProfile(),MG2AccountData:Connext.Storage.GetUserData()});CnnXt.Event.fire(f,{AuthSystem:t,AuthProfile:CnnXt.Storage.GetUserProfile(),MG2AccountData:Connext.Storage.GetUserData()});n("#ddZipCode").text(CnnXt.Storage.GetActualZipCodes().toString())})},GetAuthTiming:function(){return h},JanrainLoaded:function(){it=!0;t.debug(i,"JanrainLoaded")},onLoginSuccess:function(n){t.debug(i,"onLoginSuccess",n);lt(n)},getUserState:function(){return CnnXt.Storage.GetUserState()},onLogout:function(){t.debug(i,"onLogout");y=!1;CnnXt.Storage.ClearUser()},getMasterId:function(){return CnnXt.Storage.GetUserData()?CnnXt.Storage.GetUserData().IgmRegID?CnnXt.Storage.GetUserData().IgmRegID:CnnXt.Storage.GetUserData().MasterId:null},isUserHasHighState:w,processSuccessfulLogin:l,showAuth0Login:tt}},ConnextMeterCalculation=function(n){function s(r){var f="evalArticleAge",u=n.Deferred(),e,o;try{t.debug(i,f,"--- Testing ---",r);e=d(r.Options);o=r.Options.Qualifier=="="?"==":r.Options.Qualifier;eval(e+o+r.Options.Val)?u.resolve():u.reject()}catch(s){t.exception(i,f,s);u.reject(!1)}return u.promise()}function h(r){var o="evalUrlParam",u=n.Deferred(),f,e;try{t.debug(i,o,"--- Testing ---",r);f=CnnXt.Utils.GetUrlParam(r.Options.ParamName);e=CnnXt.Common.QualifierMap[r.Options.Qualifier];f!=null?eval("'"+f.toUpperCase()+"'"+e+"'"+r.Options.Val.toUpperCase()+"'")?u.resolve():u.reject():e=="=="?u.reject():u.resolve()}catch(s){t.exception(i,o,s);u.reject()}return u.promise()}function c(r){var o="evalHiddenField",u=n.Deferred(),e,f,s,h;try{t.debug(i,o,"--- Testing ---",r);e=!1;f=r.Options.Selector.trim()?n(r.Options.Selector+"[type='hidden']"):null;f&&f.length>0&&(s=n(f[0]).val(),h=CnnXt.Common.QualifierMap[r.Options.Qualifier],e=eval("'"+s.toUpperCase()+"'"+h+"'"+r.Options.Val.toUpperCase()+"'"));e?u.resolve():u.reject()}catch(c){t.exception(i,o,c);u.reject(!1)}return u.promise()}function l(r){var f="evalSubdomain",u=n.Deferred();try{t.debug(i,f,"--- Testing ---",r);var e=r.Options.Val.toUpperCase(),o=window.location.hostname.toUpperCase(),s=r.Options.Qualifier.toUpperCase();s=="IN"^o.split(".").reverse().indexOf(e)>1?u.reject():u.resolve()}catch(h){t.exception(i,f,h);u.reject(!1)}return u.promise()}function a(r){var o="evalGeo",u=!1,f=n.Deferred(),e;try{t.debug(i,o,"--- Testing ---",r);e=CnnXt.Storage.GetActualZipCodes();e&&r.Options.GeoQalifier!==undefined&&e.forEach(function(n){if(~r.Options.Zipcodes.indexOf(n))u=r.Options.GeoQalifier.toUpperCase()=="IN";else if(r.Options.Zipcodes.indexOf("*")>=0){var t=r.Options.Zipcodes.split(",")||r.Options.Zipcodes.split(""),i=t.filter(function(t){var i=t.split(""),r=n.split("");return r.length!=i.length?!1:i.every(function(n,t){return i[t]==="*"?!0:n===r[t]})});u=i.length>0?r.Options.GeoQalifier.toUpperCase()=="IN":r.Options.GeoQalifier.toUpperCase()!="IN"}else u=r.Options.GeoQalifier.toUpperCase()!="IN"})}catch(s){t.exception(i,o,s);f.reject(!1)}return u?f.resolve():f.reject(),f.promise()}function v(r){var o="evalJSVar",e=n.Deferred(),f,s,u,c,l;try{t.debug(i,o,"--- Testing ---",r);f=!0;s=r.Options.VarName;try{u=eval(s)}catch(h){t.warn(i,o,h);e.reject()}n.isArray(u)?(u=u.map(function(n){return n.toString().trim().toLowerCase()}),f=r.Options.Qualifier=="Contains"||r.Options.Qualifier=="Does Not Contain"?u.indexOf(r.Options.Val.toLowerCase())>=0?r.Options.Qualifier=="Contains":r.Options.Qualifier=="Does Not Contain":r.Options.Qualifier=="Equals"):(u&&(u=u.toString().toLowerCase()),r.Options.Qualifier=="Contains"||r.Options.Qualifier=="Does Not Contain"?u==undefined?f=r.Options.Qualifier=="Does Not Contain":(c=r.Options.Delimiter?new RegExp(r.Options.Delimiter.replace(/space/g," "),"g"):/[ ,;]/g,l=u.split(c),f=l.indexOf(r.Options.Val.toLowerCase())>=0?r.Options.Qualifier=="Contains":r.Options.Qualifier=="Does Not Contain"):CnnXt.Utils.JSEvaluate(u,r.Options.Qualifier,r.Options.Val,"JavascriptCriteria")||(f=!1));f?e.resolve():e.reject()}catch(h){t.exception(i,o,h);e.reject()}return e.promise()}function y(r){var o="evalUserState",u=n.Deferred(),f,e;try{t.debug(i,o,"--- Testing ---",r);f=CnnXt.User.getUserState();f==null&&(f="Logged Out");e=!0;CnnXt.Utils.JSEvaluate(f,r.Options.Qualifier,r.Options["User State"],"UserStateCriteria")||(e=!1);e?u.resolve():u.reject()}catch(s){t.exception(i,o,s);u.reject()}return u.promise()}function p(r){var f="evalAdBlock",u=n.Deferred(),e,o;try{t.debug(i,f,"--- Testing ---",r);e=CnnXt.Utils.detectAdBlock();o=r.Options["Ad Block"].toUpperCase();o=="DETECTED"^e?u.reject():u.resolve()}catch(s){t.exception(i,f,s);u.reject()}return u.promise()}function w(r){var f="evalUrlMask",u=n.Deferred();try{t.debug(i,f,"--- Testing ---",r);var e=!1,o=window.location.href.replace(/#$/,""),s=r.Options.Val.replace(/\*$/,"");e=~o.indexOf(s)&&r.Options.Qualifier=="Equals"?!0:~o.indexOf(s)||r.Options.Qualifier!="Not Equals"?!1:!0;e?u.resolve():u.reject()}catch(h){t.exception(i,f,h);u.reject()}return u.promise()}function b(r){var o="evalMeta",f=n.Deferred(),e;try{t.debug(i,o,"--- Testing ---",r);var u=!1,s=CnnXt.Utils.getMetaTagsWithKeywords(),h="\\b"+r.Options.Val+"\\b",c=new RegExp(h);for(e=0;e<s.length;e++)if(c.test(s[e].content)){t.debug(i,o,"Found keyword",r.Options.Val);u=!0;break}u&&r.Options.Qualifier=="Not Equal"&&(u=!1);u||r.Options.Qualifier!="Not Equal"||(u=!0);u?f.resolve():f.reject()}catch(l){t.exception(i,o,l);f.reject()}return f.promise()}function k(r){var e="evalFlittzStatus",u=n.Deferred(),f,o;try{t.debug(i,e,"--- Testing ---",r);f=!0;CnnXt.GetOptions().integrateFlittz&&window.Flittz?(o=window.Flittz.FlittzUserStatus,CnnXt.Utils.JSEvaluate(CnnXt.Common.FlittzStatusesMap[o],r.Options.Qualifier,r.Options["Flittz Status"],"FlittzStatusCriteria")||(f=!1)):f=!1;f?u.resolve():u.reject()}catch(s){t.exception(i,e,s);u.reject()}return u.promise()}function d(u){var f="getArticleAge",o,e;try{if(t.debug(i,f,u),__.isNumber(r.articleAge)&&!isNaN(r.articleAge))return t.debug(i,f,"Article Age Already Deterimed...using Cached value"),r.articleAge;o=__.isNothing(u.Format)?CnnXt.Common.DefaultArticleFormat:u.Format;t.debug(i,f,"Using Format: ",o);e=u.Selector.indexOf("$")>-1?eval(u.Selector):n(u.Selector).text();t.debug(i,f,"articleDateData",e);var h=CnnXt.Utils.ParseCustomDates(e,o),c=CnnXt.Utils.Now(),s=CnnXt.Utils.Diff(c,h);return t.debug(i,f,"Date Used for Compare: "+e,"Article Age In Days:: ("+s+")"),r.articleAge=s,r.articleAge}catch(l){return t.exception(i,f,l),!1}}function g(r,f){var o="evalPromise",s=n.Deferred(),h,e;try{u.push(s);h=[];r.forEach(function(n){h.push(eval(n.Options.PromiseName))});t.debug(i,o,'Setup "Q all" for promise segments');e=null;f&&(e=setTimeout(function(){t.debug(i,o,"segments rejected on timeout");s.reject()},f));n.when.apply(n,h).then(function(){var n,u;t.debug(i,o,'"Q all" results',arguments);n=arguments;n.length||(n=[null]);u=Array.prototype.every.call(r,function(r,u){var f=n[u],h=r.Options.Val;return((f===null||f===undefined)&&(f=""),!CnnXt.Utils.JSEvaluate(f,r.Options.Qualifier,h,"Promise"))?(t.debug(i,o,"segment "+r.Options.Name+" not passed"),e&&clearTimeout(e),s.reject(),!1):!0});u&&(t.debug(i,o,"All segments passed"),e&&clearTimeout(e),s.resolve())},function(){t.debug(i,o,"segment rejected");e&&clearTimeout(e);s.reject()})}catch(c){t.exception(i,o,c);s.reject()}return s.promise()}var i="MeterCalculation",t,f={ArticleAge:s,HiddenField:c,Subdomain:l,Geo:a,Url:h,JSVar:v,Meta:b,UserState:y,AdBlock:p,URLMask:w,FlittzStatus:k},r={},u=[],e=function(r){var u="calculateMeterLevel",e=n.Deferred();try{t.debug(i,u,"Calculating meter level....",r);n.each(r,function(r,e){var o,s;t.debug(i,u,"rules.each",r,e);e.EvaluationPromise=n.Deferred();e.Passed=!1;o=!0;n.each(e.Segments,function(n,r){t.debug(i,u,"segments.each",n,r);o?r.SegmentType!="Promise"&&f[r.SegmentType](r).done(function(){t.debug(i,u,"Segment["+r.id+"] --- PASSED",r)}).fail(function(){o=!1;t.debug(i,u,"Segment["+r.id+"] --- FAILED",r)}):t.debug(i,u,"Previous Segment Failed, Not processing rest of segments.")});o?(s=__.filter(e.Segments,function(n){return n.SegmentType=="Promise"}),s&&s.length?g(s,CnnXt.GetOptions().DynamicMeterPromiseTimeout).done(function(){t.debug(i,u,"All Segments Passed, Using ["+e.Name+"] Rule ",e);e.Passed=!0}).always(function(){e.EvaluationPromise.resolve()}):(t.debug(i,u,"All Segments Passed, for ["+e.Name+"] Rule ",e),e.Passed=!0,e.EvaluationPromise.resolve())):e.EvaluationPromise.resolve()});n.when.apply(n,__.map(r,function(n){return n.EvaluationPromise.promise()})).done(function(){var n=__.filter(r,function(n){return n.Passed==!0});n&&n.length!=0?e.resolve(__.sortBy(n,"Priority")[0]):e.reject()})}catch(o){t.exception(i,u,o);e.reject()}return e.promise()},o=function(){var n="breakDMPromise";try{t.debug(i,n,"DMPromises ",u);u.forEach(function(n){n.state()==="pending"&&n.reject()});u=[]}catch(r){t.exception(i,n,r)}};return{init:function(){t=CnnXt.Logger;t.debug(i,"Initializing MeterCalculation Module...")},CalculateMeterLevel:function(n){return e(n)},BreakDMPromises:o}},ConnextCampaign=function(n){var i="Campaign",a="{{ArticleLeft}}",v={GoToSelf:"Self",Recalculate:"Recalc"},e=0,t,r,u,y,p=function(f,e){var s="processCampaign";try{if(t.debug(i,s,"Starting process campaign...",e,f),!f)throw CnnXt.Common.ERROR.NO_METER_LEVEL_SET;if(!e)throw CnnXt.Common.ERROR.NO_CAMPAIGN;u=f;g(f).done(function(u){if(r=u,r)t.debug(i,s,"Conversation To Process",r),n("#ddCurrentConversation").text(r?r.Name:"..."),w(r);else{CnnXt.Storage.SetCurrentConversation(null);CnnXt.Storage.SetActiveConversationId(0);b();throw CnnXt.Common.ERROR.NO_CONVO_FOUND;}})}catch(o){o.custom?t.warn(o.message):t.exception(i,s,o);CnnXt.Event.fire("onCriticalError",o)}},w=function(n){var f="processConversation",u,e;try{t.debug(i,f,"Starting process conversation...",n);CnnXt.Storage.UpdateViewedArticles(n);ut(n,CnnXt.Storage.GetCurrentConversationViewCount(n.id));CnnXt.Storage.SetCurrentConversation(r);u=c(n);e=c(n,!0);d(n,e,u);CnnXt.Storage.SetCurrentConversation(n);CnnXt.Event.fire("onConversationDetermined",n);k(n);u.length>0?(t.debug(i,f,"ACTIONS DETERMINGED ---> ",u),CnnXt.Action.ProcessActions(u)):t.warn("No 'Actions' to execute.")}catch(o){t.exception(i,f,o)}},b=function(){CnnXt.Storage.UpdateViewedArticles({id:-1,Props:{Date:{started:null}}})},k=function(n){var r;if(!n||!n.Options||!n.Options.Activation||!n.Options.Activation.Activate)return!1;r=n.Options.Activation.Activate;t.debug(i,"proccessActivationFlow","Proccess activation flow for conversation",r);CnnXt.Activation.init(r)},d=function(r,u,e){var o=99999,s=__.where(u,{ActionTypeId:3}),h=[];t.debug(i,"calculateArticleLeft","Try to find paywalls");s.length>0?(t.debug(i,"paywalls found",s),n.each(s,function(t,i){var r=-1;i.Who.ViewsCriteria&&n.each(i.Who.ViewsCriteria,function(n,t){t.Qualifier=="=="||t.Qualifier==">="?r=t.Val>r?t.Val:r:t.Qualifier==">"&&(r=parseInt(t.Val)+1>r?parseInt(t.Val)+1:r);h.push(r)});i.Who.ConversationViewsCriteria&&n.each(i.Who.ConversationViewsCriteria,function(n,t){t.Qualifier==="=="||t.Qualifier===">="?r=t.Val>r?t.Val:r:t.Qualifier===">"&&(r=parseInt(t.Val)+1>r?parseInt(t.Val)+1:r);h.push(r)});o>r&&(o=r)}),o=o===-1?99999:__.min(h),r.Props.ArticleLeft=o===99999?"unlimited":o-f(),r.Props.ArticleLeft<0&&(r.Props.ArticleLeft=0),n.each(e,function(n,t){t.What.Html&&(t.What.Html=t.What.Html.replace(a,r.Props.ArticleLeft))})):r.Props.ArticleLeft="unlimited";r.Props.paywallLimit=o==99999?Infinity:o;n("#ddCurrentConversationArticleLeft").text(r.Props.ArticleLeft)},g=function(){var f="getCurrentConversation",o=n.Deferred(),r;t.debug(i,f,"Get conversation for a processing");try{return r=it(u),e=0,r&&s(r)?(t.debug(i,f,"Found stored valid conversation",r),o.resolve(r)):(t.debug(i,f,"Found new valid conversation",r),h(r).done(function(n){o.resolve(n)})),o.promise()}catch(c){return t.exception(i,f,c),null}},s=function(r){var e="isConversationValid",u=r.Options.Expirations,h,l,a,v,f,p,c,o,s;t.debug(i,e,"Check conversation expirations",u);try{if(r.Props.isExpired)return t.debug(i,e,"Current conversation was previously set to expired."),!1;if(u.Time){var w=CnnXt.Utils.Now(),b=new Date(Date.parse(r.Props.Date.expiration)),k=w>=b;if(k)return t.debug(i,e,"Current conversation has expired base on date..."),r.Props.isExpired=!0,r.Props.expiredReason="Time",u.Time["Reset Article Views"]=="Yes"&&CnnXt.Storage.ResetConversationArticleCount(r),!1}else t.debug(i,e,"No expiration time set for this conversation.");if(u.UserState&&((h=u.UserState,h["User State"]==CnnXt.User.getUserState())||h["User State"]=="Logged In"&&CnnXt.User.getUserState()=="Subscribed"))return r.Props.isExpired=!0,r.Props.expiredReason="UserState",u.UserState["Reset Article Views"]=="Yes"&&CnnXt.Storage.ResetConversationArticleCount(r),!1;if(u.Register&&CnnXt.GetOptions().integrateFlittz&&window.Flittz&&window.Flittz.FlittzUserStatus=="FlittzLoggedIn")return r.Props.isExpired=!0,r.Props.expiredReason="Register",u.Register["Reset Article Views"]=="Yes"&&CnnXt.Storage.ResetConversationArticleCount(r),!1;if(u.FlittzStatus&&(l=u.FlittzStatus["Flittz Status"],CnnXt.GetOptions().integrateFlittz&&window.Flittz&&(a=CnnXt.Common.FlittzStatusesMap[window.Flittz.FlittzUserStatus],l==a)))return r.Props.isExpired=!0,r.Props.expiredReason="FlittzStatus",u.FlittzStatus["Reset Article Views"]=="Yes"&&CnnXt.Storage.ResetConversationArticleCount(r),!1;if(u.JSVar){t.debug(i,e,"Checking Javascript Expiration Criteria: ",u);v=u.JSVar.JSVarName;try{f=eval(v)}catch(y){t.warn(i,e,y)}if(n.isArray(f)){if(f=f.map(function(n){return n.toString().trim().toLowerCase()}),u.JSVar.JSVarQualifier=="In"||u.JSVar.JSVarQualifier=="NotIn")if(f.indexOf(u.JSVar.JSVarValue.toLowerCase())>=0){if(u.JSVar.JSVarQualifier=="In")return r.Props.isExpired=!0,r.Props.expiredReason="JSVar",u.JSVar["Reset Article Views"]=="Yes"&&CnnXt.Storage.ResetConversationArticleCount(r),!1}else if(u.JSVar.JSVarQualifier=="NotIn")return r.Props.isExpired=!0,r.Props.expiredReason="JSVar",u.JSVar["Reset Article Views"]=="Yes"&&CnnXt.Storage.ResetConversationArticleCount(r),!1}else if(f&&(f=f.toString().toLowerCase()),u.JSVar.JSVarQualifier=="In"||u.JSVar.JSVarQualifier=="NotIn"){for(p=u.JSVar.JSVarDelimiter?new RegExp(u.JSVar.JSVarDelimiter.replace(/space/g," "),"g"):/[ ,;]/g,c=f.split(p),o=!1,s=0;s<c.length;s++)c[s]==u.JSVar.JSVarValue.toLowerCase()&&(o=!0);if(u.JSVar.JSVarQualifier=="In"&&o||u.JSVar.JSVarQualifier=="NotIn"&&!o)return r.Props.isExpired=!0,r.Props.expiredReason="JSVar",u.JSVar["Reset Article Views"]=="Yes"&&CnnXt.Storage.ResetConversationArticleCount(r),!1}else if(CnnXt.Utils.JSEvaluate(f,u.JSVar.JSVarQualifier,u.JSVar.JSVarValue,"JavascriptCriteria"))return r.Props.isExpired=!0,r.Props.expiredReason="JSVar",u.JSVar["Reset Article Views"]=="Yes"&&CnnXt.Storage.ResetConversationArticleCount(r),!1}return!0}catch(y){return t.exception(i,e,y),!0}},h=function(r){var p="getConversation",l=n.Deferred(),a=n.Deferred(),y,c,f;try{return y=null,c={},r&&(y=r.Props.expiredReason,c=r.Options.Expirations[y]),!r||c&&c.nextConversation==v.Recalculate?nt().done(function(n){f=n;a.resolve()}).fail(function(){f=null;a.resolve()}):c&&c.nextConversation&&(f=tt(c.nextConversation),a.resolve()),a.promise().done(function(){f&&rt(f);e++;!f||f&&s(f)?l.resolve(f):e>o(u).length?(t.warn("Exceeded the number of calculations of conversation! Please, check your conversations."),l.resolve(null)):h(f).done(function(n){l.resolve(n)})}),l.promise()}catch(w){t.exception(i,p,w)}},nt=function(){var e="getFilteredConversation",r=n.Deferred(),f=o(u);return f.length?(f.forEach(function(t){t.EvaluationDeferred=n.Deferred();t.Passed=!1;var i={conversationId:t.id,meterId:t.MeterLevelId};CnnXt.Utils.ResolveQualifiersFor(t.Options.Filter,i)?CnnXt.Utils.ResolvePromiseQualifiers(t.Options.Filter,CnnXt.GetOptions().ConversationPromiseTimeout).done(function(){t.Passed=!0}).always(function(){t.EvaluationDeferred.resolve()}):t.EvaluationDeferred.resolve()}),n.when.apply(n,__.map(f,function(n){return n.EvaluationDeferred.promise()})).done(function(){var n=__.filter(f,function(n){return n.Passed==!0}),u;n&&n.length!=0?(u=__.sortBy(n,"Order")[0],t.debug(i,e,"Filtered conversation",u),r.resolve(u)):r.reject()})):r.reject(),r.promise()},tt=function(n){var r,f;return t.debug(i,"getNextConversation","Go to conversation",n),r=o(u),f=null,r.length&&n&&(f=__.findByKey(r,{id:n})),f},c=function(r,u){var e="determineConversationActions";try{t.debug(i,e,"Begin determine conversation actions",r.Actions);var o=[],h=!1,c=f(),s=n.extend(!0,[],r.Actions);return u&&(s=__.where(s,{ActionTypeId:3})),n.each(s,function(n,f){var l,s,a;if(t.debug(i,e,"Actions.EACH",f),f.ActionTypeId!==3||!h){l=!0;try{s=f.Who;s.ViewsCriteria&&!u?(_.isArray(s.ViewsCriteria)||(s.ViewsCriteria=[s.ViewsCriteria]),s.ViewsCriteria.forEach(function(n){t.debug(i,e,"Checking ViewsCriteria",n);CnnXt.Utils.JSEvaluate(parseInt(c),n.Qualifier,parseInt(n.Val),"ArticleView")||(l=!1)})):s.ViewsCriteria&&u&&(l=!0);l&&(a={conversationId:r.id,meterId:r.MeterLevelId},u&&delete s.ConversationViewsCriteria,l=CnnXt.Utils.ResolveQualifiersFor(s,a))}catch(v){l=!1;t.exception(i,e,v)}!l||CnnXt.Action.ActionInPendingExecutionTime(f)||CnnXt.Action.ActionLimitIsExceeded(f)?t.debug(i,e,"%%%%% ACTION FAILED %%%%%",f):(t.debug(i,e,"===== ACTION PASSED =====",f),f.ActionTypeId!==3||u||(h=!0),u&&(f=__.findWhere(r.Actions,{id:f.id})),o.push(f))}}),t.debug(i,e,"End determine conversation actions",o),o}catch(l){t.exception(i,e,l)}},it=function(n){var u="getStoredConversationByMeterLevel",r,f;try{return t.debug(i,u,"meterLevel",n),r=null,f=CnnXt.Storage.GetCurrentConversations(),f&&(r=f[n]),t.debug(i,u,"Found stored conversations for meter level",n,r),r}catch(e){return t.exception(i,u,e),!1}},o=function(n){var u="getAllConversationsMeterLevel",r;try{return t.debug(i,u,"meterLevel",n),r=CnnXt.Storage.GetCampaignData().Conversations[n],r||(t.debug(i,u,"No Conversation for "+n+" meter level"),r=[]),t.debug(i,u,"Found conversations for meter level",n,r),__.sortBy(r,"Order")}catch(f){return t.exception(i,u,f),[]}},l=function(n){var f="saveCurrentConversation",r;t.debug(i,f,n);try{r=CnnXt.Storage.GetCurrentConversations();r[u]=n;CnnXt.Storage.SetCurrentConversations(r);CnnXt.Storage.SetActiveConversationId(n.id)}catch(e){t.exception(i,f,e)}},rt=function(n){var f="setDefaultConversationProps",r,u;t.debug(i,f,n);try{var s=CnnXt.Utils.Now(),e=CnnXt.Storage.GetConversationStartDate(n.id),o=CnnXt.Storage.GetCurrentConversations();if(n.Props.Date.started=e&&(!o||__.isEmpty(o))?new Date(e):s,n.Options.Expirations.Time){r=n.Props.Date.started;n.Props.isExpired=!1;n.Props.Date.expiration=new Date(r);u=n.Props.Date.expiration;switch(n.Options.Expirations.Time.key){case"m":u.setMinutes(r.getMinutes()+parseInt(n.Options.Expirations.Time.val));break;case"h":u.setHours(r.getHours()+parseInt(n.Options.Expirations.Time.val));break;case"d":u.setDate(r.getDate()+parseInt(n.Options.Expirations.Time.val));break;case"w":u.setDate(r.getDate()+parseInt(n.Options.Expirations.Time.val)*7);break;case"M":u.setMonth(r.getMonth()+parseInt(n.Options.Expirations.Time.val));break;case"y":u.setFullYear(r.getFullYear()+parseInt(n.Options.Expirations.Time.val))}}else t.debug(i,f,"No expiration time set for this conversation.");l(n)}catch(h){t.exception(i,f,h)}},ut=function(n,r){var u="updateArticleViewCount";t.debug(i,u);try{n.Props.views=__.isNumber(arguments[0])?r:f();l(n)}catch(e){t.exception(i,u,e)}},f=function(){return CnnXt.Storage.GetCurrentConversationViewCount()};return{init:function(n){t=CnnXt.Logger;y=n;t.debug(i,"Initializing Campaign Module...")},ProcessCampaign:p,GetCurrentConversationProps:function(){try{return r.Props}catch(n){return t.exception(i,"GetCurrentConversationProps",n),null}},GetCurrentConversation:function(){return r},GetCurrentConversationViewCount:f}},ConnextAction=function(n){function ft(){var r="clearActionsSchedule";try{p&&(t.debug(i,r,"Clear all planned actions",e),e.forEach(function(t){switch(t.type){case"timer":clearTimeout(t.item);break;case"viewportChecker":t.item.destroy();break;case"hover":n(t.selector).off("mouseenter",t.handle)}}),e=[],CnnXt.MeterCalculation.BreakDMPromises(),CnnXt.Utils.BreakConversationPromises(),vt())}catch(u){t.exception(i,r,u)}}function v(){return t.debug(i,"getArticleCost"),sessionStorage.getItem("ArticleCost")}function k(t){var f=n(t.target),r=f.parents(".Mg2-connext"),i,u;r.length&&(i=n(r[0]).attr("id"),i&&(u=parseInt(i.split("-")[1]),t.actionId=u));CnnXt.Event.fire("onButtonClick",t)}function ct(t){var f=n(t.target),r=f.parents(".Mg2-connext"),i,u;r.length&&(i=n(r[0]).attr("id"),i&&(u=parseInt(i.split("-")[1]),t.actionId=u));CnnXt.Event.fire("onNewsdayButtonClick",t);CnnXt.Event.fire("onButtonClick",t)}function lt(n){var f="actionInPendingExecutionTime";try{var r=CnnXt.Storage.GetTimeRepeatableActionData(n),e=new Date,u=!1;return r&&r.date&&(u=e<new Date(r.date)),u}catch(o){return t.exception(i,f,o),!1}}function at(n){var f="actionLimitIsExceeded",r,u;try{return r=CnnXt.Storage.GetTimeRepeatableActionData(n),u=!1,r&&r.count&&(u=n.When&&n.When.Time&&n.When.Time.RepeatableConv?r.count>=n.When.Time.RepeatableConv:!1),u}catch(e){return t.exception(i,f,e),!1}}var i="Action",t,y="ConneXt_Action_Id-",r,h,o,p=!1,c=[],e=[],u={CloseButton:"closeButton",CloseSpan:"closeSpan",ClickOutside:"clickOutside",EscButton:"escButton"},d="[data-fz-btn=smartAuth]",w,f={Banner:1,Modal:2,Paywall:3,Inline:4,SmallInfoBox:6,JSCall:7,Newsletter:11,Activation:12},g=function(r){var u="processActions";t.debug(i,u,r);try{n.each(r,function(n,r){t.debug(i,u,"Actions.EACH",n,r);r&&r.What&&r.What.Html?__.isArray(r.Who.PromiseCriteria)?(t.debug(i,u,"Promises array was found"),nt(r.Who.PromiseCriteria).then(function(){t.debug(i,u,"Promise criterias were resolved");l(r)},function(){t.debug(i,u,"Promise criterias were rejected")})):l(r):r&&r.What&&r.What.Type==f.JSCall?l(r):t.warn(i,u,"ACTION has no html",r)})}catch(e){t.exception(i,u,e)}},nt=function(r){var f="resolvePromiseCriterias",u,e;t.debug(i,f,r);u=n.Deferred();c.push(u);try{e=[];r.forEach(function(n){e.push(eval(n.Name))});t.debug(i,f,'Setup "Q all" for promise criterias');n.when.apply(n,e).then(function(){arguments.length||(arguments=[null]);t.debug(i,f,'"Q all" results',arguments);Array.prototype.forEach.call(arguments,function(n,t){var i=r[t],f=n,e=i.Value;CnnXt.Utils.JSEvaluate(f,i.Qualifier,e,"Promise")||u.reject()});u.resolve()},function(){u.reject()})}catch(o){t.exception(i,f,o);u.reject()}return u.promise()},l=function(r){var e="handleAction",s,o,u;t.debug(i,e,"Setup action",r);try{t.debug(i,e,"Action type",r.What.Type);r.What.Type!=f.JSCall?(s=r.What.CSS,o=r.What.Html.trim(),o=st(o),u=n(o),u.prop("id",y+r.id),u.addClass("hide"),u.prepend('<style id="'+r.id+'-mg2style">'+s+"<\/style>"),n("#themeLink").length==0?n("body").append(u):n("#themeLink").before(u)):t.debug(i,e,"Action type is JS Call");r.inProgress=!1;tt(r)}catch(h){t.exception(i,e,h)}},a=function(e){var s="executeAction",o,c,p,l,a,v,k,w;t.debug(i,s,"Starting executing action...",e);try{if(e.What.Type==f.Paywall&&(t.debug(i,s,"Action type is paywall. So we hide a content."),et(e)),e.closeEvent=null,o=n("#"+y+e.id),o.removeClass("hide"),t.debug(i,s,"Action type",e.What.Type,e),e.What.Type==f.Banner&&(a=e.What.Location?e.What.Location:"top",v={},v[a]="0px",o.css(a,"-2500px").removeClass("hide"),k=o.outerHeight(),o.css(a,"-"+k+"px").animate(v,function(){})),e.What.Type==f.Modal){o.addClass("in");o.connextmodal({backdrop:"true"});o.resize();o.css("display","block");e.What["Transparent backdrop"]=="True"||e.What["Transparent backdrop"]=="true"?n(".connext-modal-backdrop.fade.in").addClass("transparent"):n(".connext-modal-backdrop.fade.in").removeClass("transparent");n(o).one("keydown",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(e.closeEvent=u.EscButton)}).one("hidden",function(){e.closeEvent==null||e.closeEvent==undefined?(e.closeEvent=u.ClickOutside,e.actionDom=o[0].innerHTML,CnnXt.Event.fire("onActionClosed",e)):(e.closeEvent===u.EscButton||e.closeEvent===u.CloseButton)&&(e.actionDom=o[0].innerHTML,CnnXt.Event.fire("onActionClosed",e))})}if(e.What.Type==f.Paywall){if(l=o.data("display-type"),t.debug(i,s,"Paywall display type",l),l=="inline"){if(r=e.What.Selector,h=e.What.Position,n(r).length==0)return t.warn(i,s,"Not found element by current content selector",r),o.remove(),!1;o.remove();c=n(r).width();p=String(c).length<4?String(c)[0]+"00":String(c)[0]+String(c)[1]+"00";o.addClass("Mg2-inline-scale-"+p);h=="before"?n(r).prepend(o):n(r).append(o);n(window,r).resize(function(){var t=n(r).width(),i=String(t).length<4?String(t)[0]+"00":String(t)[0]+String(t)[1]+"00",u=o.attr("class").replace(/\b\sMg2-inline-scale-\d+\b/g,"");o.attr("class",u);o.addClass("Mg2-inline-scale-"+i)})}else if(l=="modal"){o.addClass("in");e.What.NotClosable_paywall=="True"||e.What.NotClosable_paywall=="true"?(o.find(".closebtn").attr("data-dismiss","notclosablepaywall"),o.connextmodal({backdrop:"static",keyboard:!1})):o.connextmodal({backdrop:"true"});e.What.Transparent_backdrop_paywall=="True"||e.What.Transparent_backdrop_paywall=="true"?n(".connext-modal-backdrop.fade.in").addClass("transparent"):n(".connext-modal-backdrop.fade.in").removeClass("transparent");o.resize();o.css("display","block");n(o).one("keydown",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(e.closeEvent=u.EscButton)}).one("hidden",function(){if(e.closeEvent==null||e.closeEvent==undefined){if(e.What.NotClosable_paywall=="True"||e.What.NotClosable_paywall=="true")return!1;e.closeEvent=u.ClickOutside;e.actionDom=o;CnnXt.Event.fire("onActionClosed",e)}else(e.closeEvent===u.EscButton||e.closeEvent===u.CloseButton)&&(e.actionDom=o[0].innerHTML,CnnXt.Event.fire("onActionClosed",e))})}else l=="banner"?(a="bottom",v={},v[a]="0px",o.css(a,"-2500px").removeClass("hide"),k=o.outerHeight(),o.css(a,"-"+k+"px").animate(v,function(){})):t.debug(i,s,"Can't determine display type for paywall.");n("#ConneXt_Action_Id-"+e.id).find(d).click(function(n){e.Conversation=CnnXt.Campaign.GetCurrentConversation();e.Conversation.Campaign=CnnXt.Storage.GetCampaignData();e.ButtonArgs=n;e.ActionDom=o[0].innerHTML;CnnXt.GetOptions().integrateFlittz&&CnnXt.Event.fire("onFlittzButtonClick",e)})}if(e.What.Type==f.Inline){if(r=e.What.Selector,h=e.What.Position,n(r).length==0)return t.warn(i,s,"Not found element by current content selector",r),o.remove(),!1;c=n(r).width();p=String(c).length<4?String(c)[0]+"00":String(c)[0]+String(c)[1]+"00";o.addClass("Mg2-inline-scale-"+p);h=="before"?n(r).prepend(o):n(r).append(o);n(window,r).resize(function(){var t=n(r).width(),i=String(t).length<4?String(t)[0]+"00":String(t)[0]+String(t)[1]+"00",u=o.attr("class").replace(/\b\sMg2-inline-scale-\d+\b/g,"");o.attr("class",u);o.addClass("Mg2-inline-scale-"+i)})}if(e.What.Type==f.SmallInfoBox&&o.removeClass("hide"),e.What.Type==f.JSCall){n("#ConneXt_Action_Id-"+e.id).remove();try{if(e.What.Javascript!=undefined)try{eval(e.What.Javascript)}catch(b){t.warn(i,s,b)}}catch(b){t.exception(i,s,"Custom JS Call",b)}}if(e.What.Type==f.Newsletter)if(l=o.data("display-type"),t.debug(i,s,"Newsletter display type",l),l=="inline"){if(r=e.What.Selector,n(r).length==0)return t.warn(i,s,"Not found element by current content selector",r),o.remove(),!1;c=n(r).width();p=String(c).length<4?String(c)[0]+"00":String(c)[0]+String(c)[1]+"00";o.addClass("Mg2-inline-scale-"+p);n(r).append(o);n(window,r).resize(function(){var t=n(r).width(),i=String(t).length<4?String(t)[0]+"00":String(t)[0]+String(t)[1]+"00",u=o.attr("class").replace(/\b\sMg2-inline-scale-\d+\b/g,"");o.attr("class",u);o.addClass("Mg2-inline-scale-"+i)})}else if(l=="modal"){o.addClass("in");o.connextmodal({backdrop:"true"});o.resize();o.css("display","block");n(o).one("keydown",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(e.closeEvent=u.EscButton)}).one("hidden",function(){e.closeEvent==null||e.closeEvent==undefined?(e.closeEvent=u.ClickOutside,e.actionDom=o[0].innerHTML,CnnXt.Event.fire("onActionClosed",e)):(e.closeEvent===u.EscButton||e.closeEvent===u.CloseButton)&&(e.actionDom=o[0].innerHTML,CnnXt.Event.fire("onActionClosed",e))})}w=o.attr("id");n("#"+w+" [data-dismiss=banner], #"+w+" [data-dismiss=info-box], #"+w+" [data-dismiss=inline], #"+w+"  [data-dismiss=modal]").one("click",function(r){r.preventDefault();var h=n(this),f=h.attr("href");f!="#"&&f?(h[0].hasAttribute("target")?(t.debug(i,s,"Open in a new window",f),window.open(f,"_blank")):(t.debug(i,s,"Open in the current window",f),window.location.href=f),CnnXt.Event.fire("onButtonClick",e)):(e.closeEvent=u.CloseButton,h.closest(".Mg2-connext").addClass("hide"),e.actionDom=o[0].innerHTML,t.debug(i,s,"Click by link without href",f),n(e.What.Html).hasClass("modal")||CnnXt.Event.fire("onActionClosed",e))});n("#"+w+" [data-dismiss=notclosablepaywall]").one("click",function(r){r.preventDefault();var f=n(this),u=f.attr("href");if(u!="#"&&u)f[0].hasAttribute("target")?(t.debug(i,s,"Open in a new window",u),window.open(u,"_blank")):(t.debug(i,s,"Open in the current window",u),window.location.href=u),CnnXt.Event.fire("onButtonClick",e);else return!1});e.What.Type!=f.JSCall&&(e.actionDom=o[0].innerHTML);CnnXt.Event.fire("onActionShown",e);e.When&&e.When.Time&&CnnXt.Storage.SetTimeRepeatableActionData(e)}catch(b){b.custom?t.warn(b.message):t.exception(i,s,b)}},yt=function(n){return function(t){return t&&this===t.target,n.apply(this,arguments)}},tt=function(n){var r="registerActionEvents";t.debug(i,r,n);try{n.When||(t.debug(i,r,"Action has no When object. So we set default values"),n.When={Time:{Delay:0}});n.When&&n.When.Time?(t.debug(i,r,"Action has When.Time object."),n.count=0,it(n)):n.When&&n.When.Hover?(t.debug(i,r,"Action has When.Hover object."),ut(n)):n.When&&n.When.EOS?(t.debug(i,r,"Action has When.EOS object."),rt(n)):t.warn("No action to register")}catch(u){t.exception(i,r,u)}},it=function(n){var r="setTimedAction",u;t.debug(i,r,"Set action start by time",arguments);try{u=setTimeout(function(){a(n);n.count++;CnnXt.Storage.UpdateRepeatablesInConv(n.id)},n.When.Time.Delay);e.push({item:u,type:"timer"});t.debug(i,r,"Action will be execute after: ",n.When.Time.Delay+"ms")}catch(f){t.exception(i,r,f)}},rt=function(r){var u="SetEosEvent",f,o;t.debug(i,u,"Set action start by EOS",arguments);try{r.count=0;f="#ConneXt_Action_Id-"+r.id;o=setTimeout(function(){var t=n(r.When.EOS.Selector).viewportChecker({offset:10,classToAdd:"visible-"+r.id,callbackFunctionBeforeAddClass:function(t){if(!t.hasClass("visible-"+r.id)){var i=CnnXt.Storage.GetRepeatablesInConv(r.id);n(f).is(":not(:visible)")&&r.When.EOS.Repeatable>r.count&&r.When.EOS.RepeatableConv>i&&(r.inProgress||(r.inProgress=!0,a(r),r.count++,r.inProgress=!1,CnnXt.Storage.UpdateRepeatablesInConv(r.id)))}},callbackFunction:function(t){n(t).removeClass("visible"+r.id)},repeat:!0,scrollHorizontal:!1});e.push({item:t,type:"viewportChecker"})},r.When.EOS.Delay);e.push({item:o,type:"timer"})}catch(s){t.exception(i,u,s)}},ut=function(r){var u="setHoverEvent",f,o;t.debug(i,u,"Set action start by hover",arguments);try{f=r.When.Hover.Delay?r.When.Hover.Delay:0;o=setTimeout(function(){function i(i){if(i.stopPropagation(),__.isNumber(parseInt(r.When.Hover.Repeatable))&&__.isNumber(parseInt(r.When.Hover.RepeatableConv))){var f=CnnXt.Storage.GetRepeatablesInConv(r.id);if(n(u).is(":not(:visible)"))t<r.When.Hover.Repeatable&&r.When.Hover.RepeatableConv>f&&(a(r),t++,CnnXt.Storage.UpdateRepeatablesInConv(r.id));else return!1}return!1}var t=0,u="#ConneXt_Action_Id-"+r.id;n(r.When.Hover.Selector).on("mouseenter",i).children().mouseover(function(){if(r.When.Hover.IncludeChildren=="False")return!1});e.push({selector:r.When.Hover.Selector,type:"hover",handler:i})},f);e.push({item:o,type:"timer"})}catch(s){t.exception(i,u,s)}},et=function(t){var e,a;CnnXt.Logger.debug(i,"hideContent",arguments);try{e=new RegExp(/script|style|meta/i);o=t.What.Effect;r=t.What.Selector;var c=t.What.Terminator,h=t.What.PrevChars,u=0,l=n(r)[0],f=n(r).clone();f.find(".Mg2-connext[data-display-type=inline]").remove();f.find(".Mg2-connext[data-display-type=info-box]").remove();f.find(".Mg2-connext[data-display-type=banner]").remove();w=f[0].innerHTML;a=l.childNodes;o&&i(l,a);n(".flittz").removeClass("blurry-text");n(".flittz").removeClass("trimmed-text");n(".trimmed-text").remove();function i(n,t){for(var r,f,v,y,a=0;a<t.length;a++)if(r=t[a],u>=h)o=="blur"?r.classList?(r.classList.add("blurry-text"),s(r)):(f=document.createElement("span"),f.innerHTML=r.textContent,f.classList.add("blurry-text"),s(f),r.parentNode.insertBefore(f,r),n.removeChild(r)):r.classList?r.classList.add("trimmed-text"):(f=document.createElement("span"),f.innerHTML=r.textContent,f.classList.add("trimmed-text"),r.parentNode.insertBefore(f,r),n.removeChild(r));else if(r.tagName)e.test(r.tagName)||i(r,r.childNodes);else if(u+=r.length,h<=u){var b=u-h,l=r.textContent.substr(0,r.textContent.length-b),p=Math.min(l.length,l.lastIndexOf(" ")),w;for(p!=-1?(l=l.substr(0,p)+c,w=r.textContent.substr(p)):(w=r.textContent.substr(l.length),l+=c),r.textContent=l,v=document.createElement("span"),v.innerHTML=w,v.classList.add(o=="blur"?"blurry-text":"trimmed-text"),s(v),n.insertBefore(v,t[a+1]),y=a+1;y<t.length;y++)r=t[y],r.classList&&(e.test(r.tagName)||(r.classList.add(o=="blur"?"blurry-text":"trimmed-text"),s(r)))}}}catch(v){throw CnnXt.Logger.exception(CnnXt.Common.ERROR.HIDE_CONTENT);}},s=function(r){var e="mixContent",u,f;try{if(n(r).children().length==0){if(u=n(r).text(),u)for(f=0;f<u.length;f++)u=u.replaceAt(f,CnnXt.Utils.GetNextLetter(u[f]));n(r).text(u)}else n.each(n(r).children(),function(n,t){s(t)})}catch(o){t.exception(i,e,o)}},ot=function(){var u="showContent";try{t&&t.debug(i,u);n(r).html(w)}catch(f){t.exception(i,u,f)}},b=function(n){var e="getDaysToExpire",r,u,f;t.debug(i,e,n);try{return r=CnnXt.Utils.Now(),u=new Date(n.Props.Date.expiration),f=n.Options.Expirations.Time.key=="d"||n.Options.Expirations.Time.key=="w"||n.Options.Expirations.Time.key=="m"||n.Options.Expirations.Time.key=="y"?parseInt((u-r)/864e5)+1:parseInt((u-r)/864e5),f<=0?"less than 1":f}catch(o){t.exception(i,e,o)}},st=function(r){var f="handleDynamicHtml";t.debug(i,f,arguments);try{var u=CnnXt.Campaign.GetCurrentConversationProps(),e=CnnXt.Campaign.GetCurrentConversation(),s=r.replace(/{{(.*?)}}/g,function(n){var o="FixedHtml",f="User",h,c,s,r,l;switch(n){case"{{FreeViewsLeft}}":return h=eval(u.paywallLimit-u.views),parseInt(h)<0&&(h=0),t.debug(i,o,"Replace FreeViewsLeft to",h),h;case"{{CurrentViewCount}}":return t.debug(i,o,"Replace CurrentViewCount to",u.views),u.views;case"{{ExpireTimeLeft}}":return t.debug(i,o,"Replace FreeViewsLeft to",b(e)),b(e);case"{{ArticleCost}}":return t.debug(i,o,"Replace ArticleCost to",v()),v()?v():"";case"{{UserFullName}}":try{if(c=CnnXt.Storage.GetUserState(),s=CnnXt.Storage.GetLocalConfiguration().Site.RegistrationTypeId,t.debug(i,o,"Replace UserFullName"),c){if(c=="Logged Out")return f;if(c!=="Logged Out"){if(c!=="Logged In"&&s===1)return r=CnnXt.Storage.GetUserData(),r?(l=null,r.OwnedSubscriptions?l=r.OwnedSubscriptions[0].FullName:r.Subscriptions&&(l=r.Subscriptions.OwnedSubscriptions[0].FirstName+" "+r.Subscriptions.OwnedSubscriptions[0].LastName),l||f):f;if(s===2)return r=CnnXt.Storage.GetJanrainUser(),r?r.displayName||f:f;if(s===3,s===4)return r=CnnXt.Storage.GetUserProfile(),r?r.name||r.nickname||f:f;if(s===5&&(r=CnnXt.Storage.GetUserData(),r))return r.DisplayName}}else return f}catch(a){return t.exception(i,o,a),f}}}),o=n(s);return CnnXt.Utils.AddQueryParamsToAllLinks(o),o[0].outerHTML}catch(h){return t.exception(i,f,h),r}},ht=function(){n("body").on("click",'[data-mg2-action="click"]',k);n("body").on("click",'[data-mg2-action="login"], [data-mg2-action="connextRun"], [data-mg2-action="submit"], [data-mg2-action="Zipcode"], [data-mg2-action="openNewsletterWidget"],[data-mg2-action="activation"]',function(n){n.preventDefault();k(n)});n("body").on("click",'[data-mg2-action="click-Newsday"]',ct)},vt=function(){var n="breakActionsPromises";try{t.debug(i,n,"ActionPromises ",c);c.forEach(function(n){n.state()==="pending"&&n.reject()});c=[]}catch(r){t.exception(i,n,r)}};return{init:function(){t=CnnXt.Logger;t.debug(i,"Initializing Action Module...");ht();p=!0},ProcessActions:g,IntegrateProduct:ot,ActionInPendingExecutionTime:lt,ActionLimitIsExceeded:at,ClearActionsSchedule:ft}},ConnextWhitelist=function(n){function k(n,t){var o="compareIPs",e,r,f;try{return(e=/^([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$/,!n||!t)?!1:(r=!1,f=!1,e.test(t)&&(~t.indexOf("/")?f=!0:r=!0),r)?n===t:f?CnnXt.Utils.IPWithinRangeCIDR(n,t):!1}catch(s){return i.exception(u,o,s),!1}}function c(i){var u=CnnXt.Storage.GetWhitelistInfoboxCookie(),f=CnnXt.Storage.GetNeedHidePinTemplateCookie(),r;if(!f&&i&&i.length){if(i[0].InfoBoxHtml&&u)t=n(".Mg2-pin-infobox"),t&&t.length||(n("body").append(i[0].InfoBoxHtml),t=n(".Mg2-pin-infobox")),r=l(),r||a(t),t.show(),y(),h=!1,CnnXt.ConnextContinueProcessing(e);else if(i[0].ModalHtml&&!u){t=n(".Mg2-pin-modal");t&&t.length||(n("body").append(i[0].ModalHtml),t=n(".Mg2-pin-modal"));r=l();r||a(t);t.on("show.bs.modal",function(){y();h=!1});t.addClass("in");t.connextmodal({backdrop:"true"});t.resize()}else CnnXt.ConnextContinueProcessing(e);d()}else CnnXt.ConnextContinueProcessing(e)}function y(){var n=p();CnnXt.Event.fire("onAccessTemplateShown",n)}function o(n){if(!h){var t=p();t.closeEvent=n;CnnXt.Event.fire("onAccessTemplateClosed",t);h=!0}}function p(){return{WhitelistSets:e.WhitelistSets,FoundInWhithelistSet:r,UserIP:s}}var u="Whitelist",i,s="",r=null,f={CloseButton:"closeButton",ClickOutside:"clickOutside",AccessGranted:"accessGranted",EscButton:"escButton"},h=!0,t,e,w=100,v=function(n,t){n&&n.ipAddress&&(s=n.ipAddress,r=[],t&&t.WhitelistSets&&t.WhitelistSets.forEach(function(n){n&&__.isArray(n.IPs)&&n.IPs.forEach(function(t){k(s,t.IP)&&r.push(n)})}));r.length?r[0].CodesAreNotRequired?CnnXt.Event.fire("onAccessGranted",{message:"Success! Now you have full access",status:200}):c(r):c(r)},b=function(t){var f="checkClientIp";return i.debug(u,f,"Check client IP"),e=t,n.ajax({url:CnnXt.Common.IPInfo,type:"GET",success:function(n){i.debug(u,f,"success",n);v(n,t)},error:function(){i.debug(u,f,"IPInfo call failed. Calling API to get info");CnnXt.API.GetClientIpInfo().done(function(n){i.debug(u,f,"success",n);v(n,t)}).fail(function(n){i.debug(u,f,"error",n);c(r)})}})},l=function(){var n=CnnXt.Storage.GetPinAttempts(),t=!0;return n&&n>=5&&(t=!1),t},a=function(n){var t=n.find(".Mg2-pin__message");t.text("You exceeded maximum amount of attempts. You will be allowed to try again in 15 minutes.").addClass("Mg2-pin__message_error").show();n.find(".Mg2-pin__input").hide();n.find(".Mg2-pin__button").hide()},d=function(){function c(t,f,e){for(var c,l=CnnXt.GetOptions().api+"api/whitelist/check",h=[],o=0;o<r.length;o++)h.push(r[o].id);c={code:t,SetIds:h,Ip:s};n.ajax({method:"POST",url:l,data:c}).done(function(n){i.debug(u,"Check PIN","Success",n);CnnXt.Storage.SetWhitelistSetIdCookie({Id:n.WhitelistSetId,Expiration:n.expires},new Date(n.expires));v(f,{message:"Success! Now you have full access",status:200});var t={UserId:Fprinting().getDeviceId(),ConfigCode:CnnXt.GetOptions().configCode,SiteCode:CnnXt.GetOptions().siteCode,SettingsKey:CnnXt.GetOptions().settingsKey,ViewData:CnnXt.Storage.GetLocalViewData()};CnnXt.User.getMasterId()&&(t.masterId=CnnXt.User.getMasterId());CnnXt.API.SendViewData(t)}).fail(function(n){var t=n.responseText?JSON.parse(n.responseText).Message:n.statusText,r=n.responseText?JSON.parse(n.responseText).ErrorCode:"";i.debug(u,"Check PIN","Success",n);y(f,{message:t,status:r},e)})}function v(t,i){t.text(i.message).addClass("Mg2-pin__message_success").show();setTimeout(function(){n(".Mg2-pin-modal").connextmodal("hide");n(".Mg2-pin-infobox").hide();CnnXt.CloseTemplates(CnnXt.IntegrateProduct)},1e3);CnnXt.Event.fire("onAccessGranted",i);o(f.AccessGranted)}function y(n,t,i){t.status==w&&CnnXt.Storage.WrongPin();n.text(t.message).addClass("Mg2-pin__message_error").show();i.val("");CnnXt.Event.fire("onAccessDenied",t)}var t=n(".Mg2-pin-modal"),h=n(".Mg2-pin-infobox");n(".Mg2-pin__button").on("click",function(){var r=n(this).parents(".Mg2-pin"),u=l(),t,i;if(!u){a(r);return}t=r.find('.Mg2-pin__input[type="password"]');i=r.find(".Mg2-pin__message");i.hide().removeClass("Mg2-pin__message_error Mg2-pin__message_success");t.removeClass("Mg2-pin__input_error");t.val().length?c(t.val(),i,t):(t.addClass("Mg2-pin__input_error"),i.text("Please enter code").addClass("Mg2-pin__message_error").show())});t.on("keydown",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(t.closeEvent=f.EscButton)}).on("hidden",function(){CnnXt.Storage.SetWhitelistInfoboxCookie(!0);t.closeEvent==null||t.closeEvent==undefined?o(f.ClickOutside):t.closeEvent==f.EscButton&&o(f.EscButton);CnnXt.Storage.GetWhitelistSetIdCookie()||CnnXt.ConnextContinueProcessing(e)}).on("click","[data-dismiss]",function(){n(this).hasClass("proceed-without-pin")&&CnnXt.Storage.SetNeedHidePinTemplateCookie(!0);t.closeEvent=f.CloseButton;o(f.CloseButton)});h.on("click","[data-dismiss]",function(n){n.preventDefault();h.hide();o(f.CloseButton)}).on("click",".proceed-without-pin",function(){CnnXt.Storage.SetNeedHidePinTemplateCookie(!0)})};return{init:function(){i=CnnXt.Logger;CnnXt.Storage.UpdateWhitelistSetCookieName();CnnXt.Storage.UpdateWhitelistInfoboxCookieName();CnnXt.Storage.UpdateNeedHidePinTemplateCookieName();i.debug(u,"Initializing Whitelist Module...")},checkClientIp:b}},ConnextAppInsights=function(n){var t={debug:n.noop,warn:n.noop,exception:n.noop},i="AppInsights",r=null,u=function(n,r){t=CnnXt.Logger;try{t.debug(i,"Initializing AppInsights Module...");var u=window.appInsights||function(n){function i(n){t[n]=function(){var i=arguments;t.queue=t.queue||[];t.queue.push(function(){t[n].apply(t,i);t.context})}}var t={config:n},u=document,e=window,o="script",s="AuthenticatedUserContext",h="start",c="stop",l="Track",a=l+"Event",v=l+"Page",y=u.createElement(o),r,f;y.src=n.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js";u.getElementsByTagName(o)[0].parentNode.appendChild(y);try{t.cookie=u.cookie}catch(p){}for(t.queue=[],t.version="1.0",r=["Event","Exception","Metric","PageView","Trace","Dependency"];r.length;)i("track"+r.pop());return i("set"+s),i("clear"+s),i(h+a),i(c+a),i(h+v),i(c+v),i("flush"),n.disableExceptionTracking||(r="onerror",i("_"+r),f=e[r],e[r]=function(n,i,u,e,o){var s=f&&f(n,i,u,e,o);return s!==!0&&t["_"+r](n,i,u,e,o),s}),t}({instrumentationKey:CnnXt.Common.APPInsightKeys[CnnXt.GetOptions().environment],disableExceptionTracking:!0,appUserId:n,accountId:r});window.appInsights=u;u.queue||(u.queue=[]);u.queue.push(function(){u.context.addTelemetryInitializer(function(n){var t=n.data.baseData;if(n.data.baseType==="RemoteDependencyData")return t.data.indexOf("connext")!==-1||t.target.indexOf("auth0")!==-1})});u.setAuthenticatedUserContext(n,r);u.trackPageView()}catch(f){t.warn(i,"Error of app insights initialization",f)}},f=function(n,r){var f="trackEvent",u;try{u=o(n,r);t.debug(i,f,"Event name: ",n,"App Insights data",u);appInsights.trackEvent(n,u)}catch(e){t.exception(i,f,e)}},e=function(n){var t=CnnXt.Storage.GetLocalConfiguration(),r=CnnXt.Storage.GetCurrentConversation(),i=CnnXt.Utils.GetUserMeta(),u=CnnXt.Storage.GetUserData(),f=CnnXt.Storage.GetMeter();n=n||{};var e=CnnXt.Storage.GetJanrainUser(),o=CnnXt.Storage.GetUserProfile(),s=CnnXt.Storage.GetUserData();return{cnvid:r?r.id:null,cnvn:r?r.Name:"",mlm:f?f.method:"",ml:CnnXt.GetOptions().currentMeterLevel,artlft:r?r.Props.ArticleLeft:null,artc:CnnXt.Storage.GetCurrentConversationViewCount(),cmid:t&&t.Campaign?t.Campaign.id:null,cmn:t&&t.Campaign?t.Campaign.Name:"",dmid:t&&t.DynamicMeter?t.DynamicMeter.id:null,dmn:t&&t.DynamicMeter?t.DynamicMeter.Name:"",cnfc:t&&t.Settings?t.Settings.Code:"",cnfn:t&&t.Settings?t.Settings.Name:"",sc:t&&t.Site?t.Site.SiteCode:"",at:t&&t.Site?CnnXt.Common.RegistrationTypes[t.Site.RegistrationTypeId]:"",crid:u?u.MasterId:null,igmrid:u?u.IgmRegID:null,us:CnnXt.Storage.GetUserState(),em:o?o.email:e?e.email:s?s.Email:"",ip:CnnXt.Utils.GetIP(),zc:CnnXt.Storage.GetActualZipCodes(),did:CnnXt.GetOptions().deviceId,dt:i?i.deviceType:"",os:i?i.OS:"",brw:i?i.Browser:"",url:i?i.URL:"",attr:CnnXt.GetOptions().attr,stk:CnnXt.GetOptions().settingsKey}},o=function(n,t){var i=t.EventData,u=CnnXt.Storage.GetLocalConfiguration(),r={cnfc:u&&u.Settings?u.Settings.Code:"",sc:u&&u.Site?u.Site.SiteCode:"",stk:CnnXt.GetOptions().settingsKey};switch(n){case"onDynamicMeterFound":r.dmn=i;break;case"onCampaignFound":r.cmn=i.Name;r.cmid=i.id;break;case"onMeterLevelSet":r.mlm=i.method;r.ml=i.level;r.rid=i.rule?i.rule.id:null;r.rn=i.rule?i.rule.Name:null;break;case"onConversationDetermined":r.cnvid=i.id;r.cnvn=i.Name;r.ml=i.MeterLevelId;r.vws=i.Props.views;r.artlft=i.Props.ArticleLeft;break;case"onLoginShown":r.lgmdid=i?i.LoginModalId:null;break;case"onLoginClosed":r.lgmdid=i?i.LoginModalId:null;r.clev=i?i.closeEvent:null;break;case"onLoginError":r.errmsg=i?i.ErrorMessage:"";break;case"onAuthorized":case"onHasAccess":case"onHasAccessNotEntitled":case"onHasNoActiveSubscription":case"onLoginSuccess":r.crid=i.MG2AccountData?i.MG2AccountData.MasterId:null;r.igmRegId=i.MG2AccountData?i.MG2AccountData.IgmRegID:null;r.as=i.MG2AccountData?i.MG2AccountData.AuthSystem:null;break;case"onLoggedIn":r.crid=i.MG2AccountData?i.MG2AccountData.MasterId:null;r.igmRegId=i.MG2AccountData?i.MG2AccountData.IgmRegID:null;r.as=i.MG2AccountData?i.MG2AccountData.AuthSystem:null;r.us=CnnXt.Storage.GetUserState();break;case"onActionShown":r.actid=i.id;r.actn=i.Name;r.actt=i.ActionTypeId;r.usdfdt=i.UserDefinedData;r.artc=i.ArticlesViewed;break;case"onActionClosed":r.actid=i.id;r.actn=i.Name;r.actt=i.ActionTypeId;r.usdfdt=i.UserDefinedData;r.artc=i.ArticlesViewed;r.clev=i.closeEvent;break;case"onButtonClick":r.udfat=i.UserDefinedDataAttr;r.actid=t.Action?t.Action.id:null;r.actn=t.Action?t.Action.Name:null;r.actt=t.Action?t.Action.ActionTypeId:null;r.btnhtml=i.ButtonHTML||"";break;case"onFinish":r=e(t)}return r};return{init:u,trackEvent:f,getUserId:function(){return r}}},ConnextActivation=function(n){function ht(n){n.preventDefault();d()}function ct(i){i.preventDefault();n(t.SubSteps.FailActivation).hide();n(t.SubSteps.ActivateForm).show();u=o.Activate;CnnXt.Event.fire("onActivationLinkErrorStepClosed",{ActivationSettings:e,closeEvent:h.MoveToActivate});CnnXt.Event.fire("onActivationLinkStepShown",{ActivationSettings:e})}function k(){s=!1}function lt(){i.closeEvent=h.CloseButton}function ei(){window.addEventListener("resize",function(){s&&setTimeout(function(){y()},25)})}var f="Activation",r,s=!1,i,tt=!1,e="",l,h={CloseButton:"closeButton",CloseSpan:"closeSpan",ClickOutside:"clickOutside",EscButton:"escButton",MoveToActivate:"moveToLinkStep",MoveToSuccess:"moveToSuccessStep",MoveToFail:"moveToErrorStep"},o={Authenticate:"Authenticate",Activate:"Activate",Success:"Success",Fail:"Fail"},v,u,t={Modal:"[data-connext-dynamic-size]",Step:"data-connext-template-step",Steps:{Authenticate:'[data-connext-template-step="Authenticate"]',Activate:'[data-connext-template-step="Activate"]'},SubStep:"data-connext-template-substep",SubSteps:{Login:'[data-connext-template-substep="Login"]',Registration:'[data-connext-template-substep="Registration"]',SubscribeLink:'[data-connext-template-substep="SubscribeLink"]',UpgradeLink:'[data-connext-template-substep="UpgradeLink"]',ActivateForm:'[data-connext-template-substep="ActivateForm"]',SuccessActivation:'[data-connext-template-substep="Success"]',FailActivation:'[data-connext-template-substep="Fail"]'},Run:'[data-mg2-action="activation"]',Buttons:{ConnextRun:'[data-mg2-action="connextRun"]:visible',BackStep:'[data-mg2-acton="backStep"]:visible'},Inputs:{common:"[data-connext-input]",visible:"[data-connext-input]:visible",Email:'[data-connext-input="Email"]:visible',AllEmails:'[data-connext-input="Email"]',Password:'[data-connext-input="Password"]:visible',SearchOptions:'[data-connext-input="SearchOption"]:visible',LastName:'[data-connext-input="LastName"]:visible',AccountNumber:'[data-connext-input="AccountNumber"]:visible',ZipCode:'[data-connext-input="ZipCode"]:visible',HouseNumber:'[data-connext-input="HouseNumber"]:visible',PhoneNumber:'[data-connext-input="PhoneNumber"]:visible',ConfirmationNumber:'[data-connext-input="ConfirmationNumber"]'},Links:'[redirect="true"]',CloseButton:'[data-connext-role="close"]',ErrorMessages:{LoginSubstep:'[data-connext-template-substep="LoginFormError"]',RegistrationSubStep:'[data-connext-template-substep="RegistrationFormError"]',Activation:'[data-connext-template-substep="ActivateFormError"]'},AuthSystems:{Janrain:".janrain-close-modal",Auth0:".auth0-lock-close-button"}},a={emailInUse:"There is already an account associated with this email address. Please enter a new email address. ",emailAndPassRequired:"Please enter email and password. ",fieldsRequired:"Please fill out all the required fields. ",invalidCredits:"There was an error with your E-Mail/Password combination. Please try again. ",generalAjaxError:"Sorry, there's a server problem or a problem with the network. ",noSubscriptions:"Subscriptions not found. ",requiredEmail:"Email is required. ",requiredPassword:"Password is required. ",linkingFailed:"I'm sorry, an error occurred and we can't complete this process.  Please contact customer service for assistance. ",digitalAccessNeedUpgrade:"I'm sorry, your subscription does not give you access to this content. Please <a data-connext-link='Upgrade' redirect='true'>upgrade<\/a> to get access. ",digitalAccessNeedPurchase:"I'm sorry, your subscription does not give you access to this content. Please <a data-connext-link='Subscribe' redirect='true'>subscribe<\/a> to get access. "},it={ActivateByAccountNumber:"ActivateByAccountNumber",ActivateByZipCodeAndHouseNumber:"ActivateByZipCodeAndHouseNumber",ActivateByZipCodeAndPhoneNumber:"ActivateByZipCodeAndPhoneNumber",ActivateBySubscriptionId:"ActivateBySubscriptionId",ActivateByConfirmationNumber:"ActivateByConfirmationNumber"},c={Authenticate:420,Activate:672},d=function(n){var t="run";if(r.debug(f,t,"Run activation flow"),s&&!(n&&n.runAfterSuccessfulLogin)){r.debug(f,t,"Activation flow has already run... Breake!");return}if(y(),ot())w().always(st);else{if(u==null)return!1;s=!0;rt();u==o.Activate&&w();ut();u==o.Authenticate?ui[v]():p()}},at=function(){window.janrain?janrain.capture.ui.modal.open():r.warn("No janrain global object found!")},vt=function(){CnnXt.User.showAuth0Login()},y=function(){var n=Connext.Storage.GetUserState();n==null&&(n=l.NotLoggedIn);n==l.NotLoggedIn?(u=o.Authenticate,i.attr("data-width",c.Authenticate),i.css("width",c.Authenticate).css("margin-left","-"+c.Authenticate/2+"px")):n==l.Subscribed?(u=null,s=!1):(u=o.Activate,i.attr("data-width",c.Activate),i.css("width",c.Activate).css("margin-left","-"+c.Activate/2+"px"));r.debug(f,"calculateCurrentStep","current step",u)},rt=function(){var e;r.debug(f,"hideInactiveSteps");e=i.find("["+t.Step+"]");e.each(function(i,r){var f=n(r);f.attr(t.Step)==u?f.show():f.hide()})},yt=function(n){y();u!=null||n?u==null&&n&&(CnnXt.Run(),CnnXt.Event.fire("onActivationLoginStepClosed",{ActivationSettings:e,closeEvent:h.MoveToActivate})):ft();rt();n&&u==o.Activate&&(CnnXt.Event.fire("onActivationLoginStepClosed",{ActivationSettings:e,closeEvent:h.MoveToActivate}),ot()?(ft(),w().always(st)):(CnnXt.Event.fire("onActivationLinkStepShown",{ActivationSettings:e}),w()))},ut=function(){var u="showLinksByUserStatus",e=i.find(t.SubSteps.SubscribeLink),o=i.find(t.SubSteps.UpgradeLink),n=Connext.Storage.GetUserState();n==l.SubscribedNotEntitled?(r.debug(f,u,"Open upgrade link",n),e.hide(),o.show()):(r.debug(f,u,"Open subscribe link",n),o.hide(),e.show())},p=function(){var a=CnnXt.GetOptions(),l;r.debug(f,"showActivationTemplate",a);!a.silentmode&&e.IsActivationOnly?(i.find('.connext-actflow-close-wrapper, [data-connext-role="close"]').remove(),l={backdrop:"static",keyboard:!1}):l={backdrop:"true"};i.attr("data-width",c[u]).css("margin-left","-"+c[u]/2+"px");i.addClass("in").show();i.connextmodal(l);i.resize();CnnXt.Event.fire("onActivationFormShown",{ActivationSettings:e});i.find(t.SubSteps.SuccessActivation).hide();i.find(t.SubSteps.FailActivation).hide();u==o.Authenticate?CnnXt.Event.fire("onActivationLoginStepShown",{ActivationSettings:e}):u==o.Activate&&(i.find(t.SubSteps.ActivateForm).show(),CnnXt.Event.fire("onActivationLinkStepShown",{ActivationSettings:e}));pt();i.closeEvent=null;i.find('[data-connext-role="close"]').on("click",function(){var r=n(this),t=r.attr("href");t&&t!=="#"&&(r[0].hasAttribute("target")?window.open(t,"_blank"):window.location.href=t);i.closeEvent=h.CloseButton});i.on("keyup",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(i.closeEvent=h.EscButton,s=!1)}).one("hidden",function(){s=!1;i.closeEvent||(i.closeEvent=h.ClickOutside);var n={ActivationSettings:e,closeEvent:i.closeEvent};u==o.Authenticate&&CnnXt.Event.fire("onActivationLoginStepClosed",n);u==o.Activate&&CnnXt.Event.fire("onActivationLinkStepClosed",n);u==o.Success&&(n.ActivateStatus="success",CnnXt.Event.fire("onActivationLinkSuccessStepClosed",n),ri());u==o.Fail&&(n.ActivateStatus="error",CnnXt.Event.fire("onActivationLinkErrorStepClosed",n));CnnXt.Event.fire("onActivationFormClosed",n)})},pt=function(){var e=CnnXt.Utils.GetActivationUrlParams(),s;r.debug(f,"processActivationUrlParams",e);u==o.Authenticate&&e.email&&i.find(t.Inputs.AllEmails).val(e.email);e.confirmationNumber&&i.find(t.Inputs.ConfirmationNumber).val(e.confirmationNumber);s=i.find(t.Links);s.each(function(t,i){var u=n(i),r=u.attr("href"),f;r=CnnXt.Utils.AddReturnUrlParamToLink(r);u.attr("data-connext-link")=="Upgrade"?(f=CnnXt.Utils.GetProductCode(),f?(r=CnnXt.Utils.AddParameterToURL(r,"product",f),u.attr("href",r)):CnnXt.API.GetProductCode().then(function(n){r=CnnXt.Utils.AddParameterToURL(r,"product",n);u.attr("href",r)},function(){u.attr("href",r)})):u.attr("href",r)})},ft=function(){i.connextmodal("toggle")},et=function(n){var i={Email:n.Email,Password:n.Password};return nt(t.ErrorMessages.LoginSubstep,!1),CnnXt.API.GetUserByEmailAndPassword({payload:i,onSuccess:function(n){bt(n,"onSuccess",i)},onError:function(){nt(t.ErrorMessages.LoginSubstep,a.invalidCredits)}})},wt=function(n){var i={Email:n.Email,Password:n.Password,DisplayName:n.DisplayName};return CnnXt.API.CreateUser({payload:i,onSuccess:function(){et(n)},onError:function(n){var i=CnnXt.Utils.GetErrorMessageFromAPIResponse(n,a.generalAjaxError);nt(t.ErrorMessages.RegistrationSubStep,i)}})},bt=function(n,t){var i="successLogin";try{n.Email=t.email;n.AuthSystem="MG2";CnnXt.User.processSuccessfulLogin("Form",n);ei();yt(!0);ut()}catch(u){r.exception(f,i,u)}},w=function(){var u="syncUser",t,i;try{return t=CnnXt.Storage.GetLocalConfiguration(),t&&t.Site.RegistrationTypeId!==CnnXt.Common.AuthSystem.MG2?(i={CustomRegId:CnnXt.Utils.GetUserAuthData().CustomRegId},CnnXt.API.SyncUser({payload:i})):n.Deferred().resolve()}catch(e){return r.exception(f,u,e),n.Deferred().reject()}},kt=function(n){var t=n;return r.debug(f,"activate",t.SearchOption,t),g(t)},ot=function(){var t="checkAvailabilityToAutoLinking",n;try{return(n=CnnXt.Utils.GetActivationUrlParams(),u!=o.Activate)?!1:n.accountNumber&&n.lastName?!0:n.confirmationNumber&&n.lastName?!0:!1}catch(i){r.exception(f,t,i)}},st=function(){var t="doAutoLinking",n;try{n=CnnXt.Utils.GetActivationUrlParams();n.accountNumber&&n.lastName?(r.debug(f,t,"We have account number and last name in the url params. So we do auto linking",n),gt(n.accountNumber,n.lastName)):n.confirmationNumber&&n.lastName&&(r.debug(f,t,"We have confirmation number and last name in the url params. So we do auto linking",n),dt(n.confirmationNumber,n.lastName))}catch(i){r.exception(f,t,i)}},dt=function(n,t){var i;r.debug(f,"autoLinkingByConfirmationNumber",n,t);i={ConfirmationNumber:n,LastName:t,SearchOption:it.ActivateByConfirmationNumber,autoLink:!0};g(i)},gt=function(n,t){var i;r.debug(f,"autoLinkingByAccountNumber",n,t);i={AccountNumber:n,LastName:t,SearchOption:it.ActivateByAccountNumber,autoLink:!0};g(i)},g=function(n){var i="linkAccount",u,t;try{return u=n.SearchOption,t=CnnXt.Utils.GetUserAuthData(),n.CustomRegId=t.CustomRegId,n.Mode=t.Mode,CnnXt.Event.fire("onActivationLinkStepSubmitted",{ActivationSettings:e,Payload:n,ActivateBy:n.SearchOption}),r.debug(f,i,n.SearchOption,n),CnnXt.API[u]({payload:n,onSuccess:function(t){ni(t,n)},onError:function(t){b(t,n.SearchOption,n.autoLink)}})}catch(o){r.exception(f,i,o)}},ni=function(n,t){if(r.debug(f,"checkAccessAfterLinking",n),__.isString(n))try{n=JSON.parse(n)}catch(i){b(n,t.SearchOption,t.autoLink)}n.errorCode||!n.Success?b(n,t.SearchOption,t.autoLink):ti().then(function(){ii(n,t.SearchOption,t.autoLink)},function(i){b(n,t.SearchOption,t.autoLink,i)})},ti=function(){var i="checkDigitalAccess",t=n.Deferred(),u=CnnXt.Utils.GetUserAuthData(),e={masterId:u.MasterId,mode:u.Mode};return r.debug(f,i,"payload",e),CnnXt.API.CheckDigitalAccess({payload:e,onSuccess:function(n){if(n){if(__.isString(n))try{var u=JSON.parse(n);u&&__.isArray(u.Errors)&&__.findWhere(u.Errors,{Code:400})&&t.reject()}catch(e){r.debug(f,i,"Parse error",n);t.reject()}__.isString(n.AccessLevel)&&(n.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Premium&&t.resolve(),n.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Upgrade&&t.reject({needUpgrade:!0}),n.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Purchase&&t.reject({needPurchase:!0}));__.isObject(n.AccessLevel)&&(n.AccessLevel.IsPremium&&t.resolve(),n.AccessLevel.IsUpgrade&&t.reject({needUpgrade:!0}),n.AccessLevel.IsPurchase&&t.reject({needPurchase:!0}))}t.reject()},onNull:function(){t.reject()},onError:function(){t.reject()}}),t.promise()},ii=function(i,r,f){s=!1;u=o.Success;f&&p();n(".connext-actflow-close-wrapper .closebtn").attr("data-mg2-action","connextRun");n(t.SubSteps.ActivateForm).hide();n(t.Steps.Activate).show();n(t.Steps.Authenticate).hide();n(t.SubSteps.SuccessActivation).show();CnnXt.Event.fire("onActivationLinkStepClosed",{ActivationSettings:e,closeEvent:h.MoveToSuccess});CnnXt.Event.fire("onActivationLinkSuccessStepShown",{ActivationSettings:e,Response:i,ActivateBy:r});v!="MG2"&&CnnXt.Storage.SetUserData(null);CnnXt.Storage.SetUserState(null)},b=function(i,r,f,s){var c,l,v,y,w;u=o.Fail;f&&p();n(t.SubSteps.ActivateForm).hide();n(t.Steps.Activate).show();n(t.Steps.Authenticate).hide();n(t.SubSteps.FailActivation).show();c="";c=s&&s.needUpgrade?a.digitalAccessNeedUpgrade:s&&s.needPurchase?a.digitalAccessNeedPurchase:a.linkingFailed;n(t.SubSteps.FailActivation).find('[data-connext-role="linkingErrorMessage"] span').html(c);s&&s.needUpgrade&&(l=n(t.SubSteps.UpgradeLink).find('[data-connext-link="Upgrade"]').attr("href"),v=n(t.SubSteps.FailActivation).find('[data-connext-link="Upgrade"]'),v.attr("href",l));s&&s.needPurchase&&(y=n(t.SubSteps.SubscribeLink).find('[data-connext-link="Subscribe"]').attr("href"),w=n(t.SubSteps.FailActivation).find('[data-connext-link="Subscribe"]'),w.attr("href",y));u=o.Fail;CnnXt.Event.fire("onActivationLinkStepClosed",{ActivationSettings:e,closeEvent:h.MoveToFail});CnnXt.Event.fire("onActivationLinkErrorStepShown",{ActivationSettings:e,Response:i,ActivateBy:r})},nt=function(t,i){var r=n(t);if(r.length==0)return!1;i?(r.html(i),r.show()):r.hide()},ri=function(){v!="MG2"&&CnnXt.Storage.SetUserData(null);CnnXt.Storage.SetUserState(null);CnnXt.Run()},ui={MG2:p,Auth0:vt,Janrain:at},fi=function(){if(!tt){tt=!0;n("body").off("click",t.Buttons.BackStep,ct).on("click",t.Buttons.BackStep,ct);n("body").off("click",t.AuthSystems.Auth0,k).on("click",t.AuthSystems.Auth0,k);n("body").off("click",t.AuthSystems.Janrain,k).on("click",t.AuthSystems.Janrain,k);n("body").off("click",t.Buttons.ConnextRun,lt).on("click",t.Buttons.ConnextRun,lt);n("body").off("click",t.Run,ht).on("click",t.Run,ht)}};return{init:function(t){var u="initialization";try{r=CnnXt.Logger;e=t;fi();l=CnnXt.Common.USER_STATES;e.ActivationFormHtml&&e.ActivationFormHtml&&(e.ActivationFormHtml=e.ActivationFormHtml.trim());i=n(e.ActivationFormHtml);v=CnnXt.Common.RegistrationTypes[CnnXt.Storage.GetLocalConfiguration().Site.RegistrationTypeId];r.debug(f,"Initializing Activation Module...");y()}catch(o){r.warn(f,u,"ERROR OF INITIALIZATION ACTIVATION FLOW",o)}},Run:function(n){e.IsActivationOnly?CnnXt.User.CheckAccess().always(function(){d(n)}):d(n)},Login:et,Register:wt,Activate:kt,IsActivationFlowRunning:function(){return s}}},CnnXt=function(n){function g(){var r,n,f,e,u,o,s;t.debug(i,"initAdBlockElement","Adding html element for check Ad blocker");r=document.createElement("div");r.innerHTML="&nbsp;";r.className="adsbox";r.id="TestAdBlock";r.style.position="absolute";r.style.bottom="0px";r.style.zIndex="-1";document.body.appendChild(r);n=document.createElement("IMG");f="06db9294";n.id=f;n.style.width="100px";n.style.height="100px";n.style.top="-1000px";n.style.left="-1000px";n.style.position="absolute";document.body.appendChild(n);e="//asset.pagefair.com/adimages/textlink-ads.jpg";n.src=e;u=document.createElement("SCRIPT");o="295f89b1";u.id=o;u.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(u);s="//d1wa9546y9kg0n.cloudfront.net/index.js";u.src=s;u.onload=function(){u.className="adstestloaded"}}var b="1.14.2",c=null,i="Core",t,e={},f=!1,r,k={debug:!1,silentmode:!1,integrateFlittz:!1,environment:"prod",settingsKey:null,configSettings:{EnforceUniqueArticles:!1},authSettings:null,loadType:"ajax",BatchCount:5,ViewsUpdateFromServerPeriod:24,ConversationPromiseTimeout:5e3,DynamicMeterPromiseTimeout:5e3},a=!1,u,o,s=!1,v=5e3,h=!1,d=function(){try{var u="init";if(t=CnnXt.Logger,!window.jQuery)throw CnnXt.Common.ERROR.NO_JQUERY;CnnXt.Logger.setDebug(r.debug);t.debug(i,"Initializing ConneXt...");r.configCode=r.configCode.toUpperCase();a?CnnXt.Run():(e.PluginStartTime=new Date,g(),rt(ut),a=!0)}catch(n){n.custom?t.warn(n.message):t.exception(i,u,n)}},nt=function(u){var s="closeAllTemplates",e,f,o;t.debug(i,s,"Close all ConneXt Templates");n(".Mg2-connext.paywall.flittz:visible").length>0&&r.integrateFlittz&&(e={},e.actionDom=n(".Mg2-connext.paywall.flittz:visible")[0],CnnXt.Event.fire("onFlittzPaywallClosed",e));n(".Mg2-connext[data-display-type=inline]").remove();n(".Mg2-connext[data-display-type=info-box]").remove();n(".Mg2-connext[data-display-type=banner]").remove();f=n(".Mg2-connext.modal:visible");o=f.length;f.length>0?f.each(function(t,i){n(i).on("hidden.bs.modal",function(){n(this).off("hidden.bs.modal");o--;__.isFunction(u)&&o===0&&u()});n(i).connextmodal("hide")}):__.isFunction(u)&&u();t.debug(i,s,"All ConneXt Templates have been closed.")},tt=function(){t.debug(i,"IntegrateProduct","Show the article content");n(".blurry-text").removeClass("blurry-text");n(".trimmed-text").removeClass("trimmed-text");CnnXt.Action.IntegrateProduct()},it=function(n,t){n.ipAddress&&CnnXt.Utils.SetIP(n.ipAddress);n.zipCode?CnnXt.Storage.SetCalculatedZipCode(n.zipCode):CnnXt.Storage.SetCalculatedZipCode("00000");__.isFunction(t)&&t()},rt=function(r){var u="getZipCode",f;t.debug(i,u,"Getting a zip code");try{f=n.jStorage.get(CnnXt.Common.StorageKeys.customZip);f?(t.debug(i,u,"We have zip code in the local storage",f),__.isFunction(r)&&r()):(t.debug(i,u,"Calculate a zip code by IP"),n.ajax({url:CnnXt.Common.IPInfo,type:"GET",success:function(n){it(n,r)},error:function(){t.debug(i,u,"Geolocation call failed. We set zipcode by default as 00000");CnnXt.Storage.SetCalculatedZipCode("00000");__.isFunction(r)&&r()}}))}catch(e){t.exception(i,u,"We set zipcode by default as 00000",e);CnnXt.Storage.SetCalculatedZipCode("00000");__.isFunction(r)&&r()}},ut=function(){var u="checkRequirements",f;t.debug(i,u,"Checking requirements...",r);try{if(r=n.extend(!0,k,r),!r.siteCode)throw CnnXt.Common.ERROR.NO_SITE_CODE;if(!r.configCode)throw CnnXt.Common.ERROR.NO_CONFIG_CODE;if(r.integrateFlittz&&(r.silentmode=!0),r.runSettings&&(t.debug(i,u,"Run settings have been found",r.runSettings),r.silentmode=!0,t.debug(i,u,"If we have run settings - we set up silent mode in true",r),r.runSettings.runPromise&&__.isFunction(r.runSettings.runPromise.then)?(r.runSettings.hasValidPromise=!0,_.isFunction(r.runSettings.onRunPromiseResolved)||(r.runSettings.onRunPromiseResolved=n.noop),_.isFunction(r.runSettings.onRunPromiseRejected)||(r.runSettings.onRunPromiseRejected=n.noop)):(r.runSettings.hasValidPromise=!1,t.debug(i,u,"No or invalid promise object in the 'runSettings'")),_.isNumber(r.runSettings.runOffset)||(t.debug(i,u,"We have not run offset, so we set the 'runSettings.runOffset' by default",v),r.runSettings.runOffset=v)),CnnXt.Utils.init(),f=CnnXt.Utils.GetUserMeta().deviceType,t.debug(i,u,"Device type is",f),f=="Mobile"?n("body").addClass("mobile"):f=="Tablet"&&n("body").addClass("tablet"),CnnXt.Utils.GetUserMeta().OS=="IOS"&&n("body").addClass("ios-fix-body-styles"),r.loadType=="ajax"&&(n("body").find(".mg2-Connext").remove(),n("body").find(".debug_details").remove()),r.debug){t.debug(i,u,"We are working in the debug mode");CnnXt.Utils.CreateDebugDetailPanel();t.debug(i,u,"Override the options on custom");var o=CnnXt.Storage.GetSiteCode(),s=CnnXt.Storage.GetConfigCode(),h=CnnXt.Storage.GetIsCustomConfiguration();n("#ConnextSiteCode").val(o);n("#ConnextConfigCode").val(s);n("#ConnextCustomConfiguration").prop("checked",h);h&&(r.siteCode=o,r.configCode=s)}y();r.runSettings&&et()}catch(e){e.custom?t.warn(e.message):t.exception(i,u,"The settings exception",e)}},ft=function(){t.debug(i,"reInit","First init: ",!f);CnnXt.CloseTemplates(function(){if(CnnXt.IntegrateProduct(),f){var n=CnnXt.Storage.GetLocalConfiguration();n.Settings.Site||(n.Settings.Site=n.Site);l(n)}else y()})},y=function(){var n="setDefaults",f,u;t.debug(i,n,"Setup environment and main modules");try{if(r.environment==null)for(f=location.hostname,u=0;u<CnnXt.Common.Environments.length;u++)if(f.indexOf(CnnXt.Common.Environments[u])>=0){r.environment=CnnXt.Common.Environments[u];break}r.environment==null&&(r.environment="prod");r.api=CnnXt.Common.APIUrl[r.environment];t.debug(i,n,"OPTIONS.API",r.api);CnnXt.API.init(r);CnnXt.Storage.init();CnnXt.Event.init(r);CnnXt.Event.fire("onInit",null);Fprinting().init().done(function(u){t.debug(i,n,"Fprinting is done",u);r.deviceId=u}).always(function(){try{var u=CnnXt.Storage.GetUserData()?CnnXt.Storage.GetUserData().MasterId?CnnXt.Storage.GetUserData().MasterId:CnnXt.Storage.GetUserData().IgmRegID:null;CnnXt.AppInsights.init(r.deviceId,u)}catch(f){CnnXt.AppInsights.init();t.exception(i,n,f)}ot();CnnXt.Utils.HangleMatherTool()})}catch(e){t.exception(i,n,e)}},et=function(){var n="setupRunSettings";t.debug(i,n,"Setup run settings",r.runSettings);try{r.runSettings.hasValidPromise&&(t.debug(i,n,"Setup run settings promise"),r.runSettings.runPromise.then(function(u){if(!s){r.runSettings.onRunPromiseResolved(u);CnnXt.Run()}clearTimeout(o);t.debug(i,n,"Promise has been resolved",u)},function(u){if(!s){r.runSettings.onRunPromiseRejected(u);CnnXt.Run()}clearTimeout(o);t.debug(i,n,"Promise has been rejected",u)}),t.debug(i,n,"Promise has been setup",r.runSettings));t.debug(i,n,"Setup run settings timeout");o=setTimeout(function(){s||CnnXt.Run();t.debug(i,n,"Timeout has been expired")},r.runSettings.runOffset)}catch(u){t.exception(i,n,"Setup run settings",u)}},ot=function(){var f="defineConfiguration";t.debug(i,f,"Defining ConneXt configuration...");CnnXt.API.GetLastPublishDateS3().done(function(e){try{u=JSON.parse(e);u=CnnXt.Utils.ConvertObjectKeysToUpperCase(u);t.debug(i,f,"S3_DATA is parsed",u)}catch(o){t.exception(i,f,"S3_DATA Parse",o)}u[r.configCode]?(t.debug(i,f,"Configuration code is found in the publish file"),st().done(function(u){try{h=!0;u?(t.debug(i,f,"CONFIGURATION WAS FOUND",u),u.Settings=n.extend(!0,r.configSettings,u.Settings),u.Settings.Site=u.Site,c=u,CnnXt.Storage.SetLocalConfiguration(c),CnnXt.Event.fire("onDebugNote","Init is done!"),!r.silentmode||u.Settings.UseActivationFlow?l(u):t.debug(i,f,"ConneXt was ranned in the silent mode, so we stop a process here")):(t.warn("No Config Settings Found"),CnnXt.Event.fire("onDebugNote","No Config Settings Found."))}catch(e){t.exception(i,f,e)}}).fail(function(){h=!0;t.warn("Error getting Config Settings. No Config Settings Found");CnnXt.Event.fire("onDebugNote","Error getting Config Settings. No Config Settings Found")})):(h=!0,t.warn("Configuration code is not found in the publish file"),CnnXt.Event.fire("onDebugNote","Configuration code is not found in the publish file."))})},st=function(){var f="getConfiguration",h,l;t.debug(i,f,"Getting configuration...");try{var e=n.Deferred(),o=CnnXt.Storage.GetLocalConfiguration(),s=new Date;if(s.setMonth(s.getMonth()+1),s=new Date(s),o){t.debug(i,f,"Found Local Configuration",o);CnnXt.API.meta.config.isExistsInLocalStorage=!0;var c=CnnXt.Storage.GetLastPublishDate(),v=CnnXt.Utils.ParseCustomDate(n.jStorage.get("CustomTime")),y=new Date(c);CnnXt.API.meta.config.localPublishDate=c;h=u[r.configCode];l=pt(u,o.Settings.LastPublishDate);l?(CnnXt.API.meta.reason=CnnXt.Common.DownloadConfigReasons.oldConfig,t.debug(i,f,"Stored configuration is old",o),CnnXt.Event.fire("onDebugNote","Current config is old."),p(h).done(function(n){t.debug(i,f,"A new configuration from server",n);CnnXt.Utils.MergeConfiguration(n);CnnXt.Storage.SetLastPublishDate(n.Settings.LastPublishDate,s);__.isObject(h)&&h.Reset&&(CnnXt.Storage.ResetConversationViews(null,n.Settings.UseParentDomain),CnnXt.Storage.RemoveTimeRepeatableActionData(),CnnXt.Storage.ClearRepeatablesData(),CnnXt.Storage.RemoveWhitelistSetIdCookie(),CnnXt.Storage.RemoveWhitelistInfoboxCookie(),CnnXt.Storage.RemoveNeedHidePinTemplateCookie(),CnnXt.Storage.SetCurrentConversations({}),CnnXt.Storage.SetCurrentConversation(null),CnnXt.Storage.ResetPinAttemptsCookie());e.resolve(n)}).fail(function(n){t.debug(i,f,"getConfigurationFromServer",n);e.reject(n)})):(CnnXt.Storage.SetLastPublishDate(o.Settings.LastPublishDate,s),t.debug(i,f,"Stored configuration is not old",o),e.resolve(o))}else CnnXt.API.meta.config.isExistsInLocalStorage=!1,CnnXt.API.meta.reason=CnnXt.Common.DownloadConfigReasons.noLocalConfig,p(u[r.configCode]).done(function(n){t.debug(i,f,"A new configuration from server",n);ht(n,s);e.resolve(n)}).fail(function(n){t.debug(i,f,"getConfigurationFromServer",n);e.reject(n)})}catch(a){t.exception(i,f,a);e.reject(a)}return e.promise()},bt=function(){var n=u[r.configCode];__.isObject(n)&&n.Reset&&CnnXt.Storage.ResetConversationViews(null,newConfiguration.Settings.UseParentDomain)},ht=function(r,u){var f="storeConfigurationFromServer";t.debug(i,f,"Get configuration from server",arguments);try{n.jStorage.deleteKey(CnnXt.Common.StorageKeys.conversations.current);ct(r);CnnXt.Storage.SetLocalConfiguration(r);CnnXt.Storage.SetLastPublishDate(r.Settings.LastPublishDate,u)}catch(e){t.exception(i,f,e)}},ct=function(r){var u=CnnXt.Storage.GetRegistrationType();u&&u.Id&&u.IsOverride?(t.debug(i,"overrideRegistrationType","Override registration type on",u),r.Site.RegistrationTypeId=u.Id):(n("#OverrideAuthType").prop("checked",!1),n("#selAuthType").val(r.Site.RegistrationTypeId))},l=function(n){var r="processConfiguration",u;t.debug(i,r,arguments);try{n.Settings.Active?(t.debug(i,r,"Configuration is active"),n.Settings.UseActivationFlow?(f||(CnnXt.User.init(n.Settings),u={ActivationFormName:n.Settings.ActivationTemplate.Name,ActivationFormHtml:n.Settings.ActivationTemplate.Html,IsActivationOnly:!0},CnnXt.Activation.init(u)),at(n)):(f||(CnnXt.MeterCalculation.init(),CnnXt.User.init(n.Settings),CnnXt.Campaign.init(n.Settings),CnnXt.Action.init(n.Settings),CnnXt.Whitelist.init()),lt(n))):(t.warn("Configuration is inactive"),CnnXt.Event.fire("onDebugNote","Configuration is inactive"))}catch(e){t.exception(i,r,e)}},lt=function(r){var u="processUsualConfiguration";t.debug(i,u,"Processing usual configuration",arguments);try{f=!0;r||(r=c);e.StartProcessingTime=new Date;vt(r.Site);CnnXt.Event.fire("onDynamicMeterFound",r.DynamicMeter.Name);CnnXt.Event.fire("onCampaignFound",r.Campaign);CnnXt.CookieMigration.init();CnnXt.CookieMigration.Migrate();n.when(CnnXt.Storage.CheckViewCookies()).then(function(){CnnXt.User.CheckAccess().always(function(){var f;CnnXt.Storage.GetWhitelistSetIdCookie()||CnnXt.Whitelist.checkClientIp(r);f=CnnXt.User.GetAuthTiming();t.debug(i,u,"User.CheckAccess.Always","UserAuthTime",f);var o=(new Date).getMilliseconds(),s=o-e.StartProcessingTime.getMilliseconds(),h=o-e.PluginStartTime.getMilliseconds();n("#ddProcessingTime").text(s+"ms");n("#ddTotalProcessingTime").text(h+"ms")})})}catch(o){t.exception(i,u,o)}},at=function(n){var u="processActivationOnlyConfiguration";t.debug(i,u,"Processing activation only configuration",n);try{(!r.silentmode||f)&&CnnXt.Activation.Run();f=!0}catch(e){t.exception(i,u,e)}},vt=function(u){var f;t.debug(i,"appendSiteTheme","Append site theme",u);u.SiteTheme.ThemeUrl&&u.SiteTheme.ThemeUrl!=="default"?(f=CnnXt.Common.CSSPluginUrl[r.environment],n("#themeLink").length==0&&(n("body > link").length==0?n("body").append('<link href="" id ="themeLink" rel="stylesheet" type="text/css">'):n('<link href="" id ="themeLink" rel="stylesheet" type="text/css">').insertAfter(n("body > link").last())),n("#themeLink").attr("href",f+u.SiteTheme.ThemeUrl)):u.SiteTheme.ThemeUrl&&u.SiteTheme.ThemeUrl==="default"&&n("#themeLink").remove()},yt=function(n){var f="connextContinueProcessing",u;t.debug(i,f,"Continue processing ConneXt...",n);CnnXt.MeterCalculation.CalculateMeterLevel(n.DynamicMeter.Rules).done(function(n){u=n.MeterLevelId;t.debug(i,f,"Determined meter level",u,n);CnnXt.Event.fire("onMeterLevelSet",{method:"Dynamic",level:u,rule:n})}).fail(function(){u=n.Settings.DefaultMeterLevel;t.debug(i,f,"Failed to determined Meter Level... using default",u);CnnXt.Event.fire("onMeterLevelSet",{method:"Default",level:u})}).always(function(){t.debug(i,f,"METER CALCULATION --- ALWAYS CALLED",u);r.currentMeterLevel=u;CnnXt.Campaign.ProcessCampaign(CnnXt.Common.MeterLevels[u],n.Campaign);wt()})},p=function(u){var e="getConfigurationFromServer",f,o;t.debug(i,e,u);f=n.Deferred();o=u&&u.Date?encodeURIComponent(u.Date):undefined;try{CnnXt.API.GetConfiguration({payload:{siteCode:r.siteCode,configCode:r.configCode,publishDate:o},onSuccess:function(n){var t=CnnXt.Utils.ProcessConfiguration(n);f.resolve(t)},onNull:function(){f.reject("Configuration is not found")},onError:function(){f.reject("Error getting configuration data")}})}catch(s){t.exception(i,e,s)}return f.promise()},pt=function(n,u){var e="isConfigurationOld",o,s,f,h;t.debug(i,e,"s3Data",n,"OPTIONS.configCode",r.configCode,"configurationLastPublishDate",u);try{if(__.isObject(n)){if(s=n[r.configCode.toUpperCase()],o=s&&s.Date?s.Date:s,o)return __.isObject(o)?(t.debug(i,e,".json file has a configCode property and its an object",o),f=new Date(Date.parse(o.Date)),CnnXt.API.meta.config.publisfDate=f,f.setSeconds(f.getSeconds()-10),h=new Date(Date.parse(u)),f>h?(t.debug(i,e,"Server date is << AFTER >>"),!0):(t.debug(i,e,"Server date is << NOT AFTER >>"),!1)):(t.debug(i,e,".json file has a property same as this configCode",o),f=new Date(Date.parse(o)),f.setSeconds(f.getSeconds()-10),h=new Date(Date.parse(u)),f>h?(t.debug(i,e,"Server date is << AFTER >>"),!0):(t.debug(i,e,"Server date is << NOT AFTER >>"),!1));CnnXt.API.meta.config.publisfDate=null;CnnXt.API.meta.config.ex="s3Data does not have the current configCode as a key "+r.configCode;CnnXt.API.meta.reason=CnnXt.Common.DownloadConfigReasons.noConfigCodeinPublish;throw CnnXt.Common.ERROR.CONFIG_HAS_NOT_PUBLISHED;}else{CnnXt.API.meta.config.publisfDate=null;CnnXt.API.meta.config.ex="s3Data is not an object";CnnXt.API.meta.reason=CnnXt.Common.DownloadConfigReasons.parsePublishFailed;throw CnnXt.Common.ERROR.S3DATA_IS_INVALID;}}catch(c){return c.custom?t.warn(c.message):t.exception(i,e,c),!0}},wt=function(){var t,n;!CnnXt.Storage.GetWhitelistSetIdCookie()&&(CnnXt.Campaign.GetCurrentConversationViewCount()>1&&CnnXt.Campaign.GetCurrentConversationViewCount()%CnnXt.GetOptions().BatchCount==0||CnnXt.Storage.GetCurrenDynamicMeterViewCount()>1&&CnnXt.Storage.GetCurrenDynamicMeterViewCount()%CnnXt.GetOptions().BatchCount==0)&&(t={UserId:CnnXt.GetOptions().deviceId,ConfigCode:CnnXt.GetOptions().configCode,SiteCode:CnnXt.GetOptions().siteCode,SettingsKey:CnnXt.GetOptions().settingsKey,ViewData:CnnXt.Storage.GetLocalViewData()},CnnXt.User.getMasterId()&&(n=CnnXt.User.getMasterId(),n=decodeURIComponent(n),t.masterId=n),CnnXt.API.SendViewData(t));CnnXt.Event.fire("onFinish")},w=function(){h?(CnnXt.Action.ClearActionsSchedule(),CnnXt.CloseTemplates(function(){CnnXt.IntegrateProduct();s=!0;clearTimeout(o);var n=CnnXt.Storage.GetLocalConfiguration();n?l(n):t.warn(i,"Run","configuration is not found!!")})):(t.debug(i,"Run","Connext is not initialized yet, wait 100ms"),setTimeout(w,100))};return{init:function(n){return r=n?n:{},d(),Connext={DisplayName:CnnXt.DisplayName,CloseTemplates:CnnXt.CloseTemplates,IntegrateProduct:CnnXt.IntegrateProduct,Run:CnnXt.Run,GetVersion:CnnXt.GetVersion,GetCurrentVersion:CnnXt.GetCurrentVersion,GetOptions:CnnXt.GetOptions,StartTracing:CnnXt.Logger.startTracing.bind(CnnXt.Logger),StopTracing:CnnXt.Logger.stopTracing.bind(CnnXt.Logger),GetSessionLogs:CnnXt.Logger.getSessionLogs,Storage:{GetCurrentConversationViewCount:CnnXt.Storage.GetCurrentConversationViewCount,GetCurrenDynamicMeterViewCount:CnnXt.Storage.GetCurrenDynamicMeterViewCount,GetLastPublishDate:CnnXt.Storage.GetLastPublishDate,GetSiteCode:function(){return CnnXt.Storage.GetLocalConfiguration().Site.SiteCode},GetConfigCode:function(){return CnnXt.Storage.GetLocalConfiguration().Settings.Code},GetLocalConfiguration:CnnXt.Storage.GetLocalConfiguration,GetCurrentConversations:CnnXt.Storage.GetCurrentConversations,GetCurrentConversation:CnnXt.Storage.GetCurrentConversation,GetCurrentMeterLevel:function(){return r.currentMeterLevel},GetCampaignData:CnnXt.Storage.GetCampaignData,GetRegistrationType:function(){return CnnXt.Storage.GetLocalConfiguration().Site.RegistrationTypeId},GetViewedArticles:function(){var n=CnnXt.Storage.GetCurrentConversation();return n?CnnXt.Storage.GetViewedArticles(n.id):[]},GetArticlesLeft:function(){var n=CnnXt.Storage.GetCurrentConversation();return n?n.Props.ArticleLeft:undefined},GetUserState:CnnXt.Storage.GetUserState,GetUserZipCodes:CnnXt.Storage.GetUserZipCodes,GetActualZipCodes:CnnXt.Storage.GetActualZipCodes,GetJanrainUser:CnnXt.Storage.GetJanrainUser,GetUserData:CnnXt.Storage.GetUserData,GetUserProfile:CnnXt.Storage.GetUserProfile,GetConnextPaywallCookie:CnnXt.Storage.GetConnextPaywallCookie,ClearUser:CnnXt.Storage.ClearUser}},t.debug(i,"Init","Connext object has been created"),Connext},Logger:ConnextLogger(n),Whitelist:ConnextWhitelist(n),MeterCalculation:ConnextMeterCalculation(n),Campaign:ConnextCampaign(n),Action:ConnextAction(n),Activation:ConnextActivation(n),Common:ConnextCommon(),Utils:ConnextUtils(n),API:ConnextAPI(n),Event:ConnextEvents(n),Storage:ConnextStorage(n),User:ConnextUser(n),AppInsights:ConnextAppInsights(n),CloseTemplates:nt,IntegrateProduct:tt,Run:function(){CnnXt.Event.fire("onRun");w()},ReInit:ft,GetVersion:function(){return b},GetCurrentVersion:function(){return"Version: "+window.connextVersion+", Build: "+window.connextBuild},GetOptions:function(){return r},ShowContent:function(){CnnXt.Action.ShowContent()},ConnextContinueProcessing:yt,DisplayName:ConnextCommon().DisplayName,CookieMigration:CookieMigration(n)}}(jQuery),Connext={init:CnnXt.init};