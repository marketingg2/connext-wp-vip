var JSON,MD5;if(!function(n){"use strict";var t=function(n,t){this.init(n,t)};t.prototype={constructor:t,init:function(t,i){var u=this,r;this.options=i;this.$element=n(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",n.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote,function(){var t=n.Event("loaded");u.$element.trigger(t)});r=typeof this.options.manager=="function"?this.options.manager.call(this):this.options.manager;r=r.appendModal?r:n(r).modalmanager().data("modalmanager");r.appendModal(this)},toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=n.Event("show");this.isShown||(this.$element.trigger(t),t.isDefaultPrevented())||(this.escape(),this.tab(),this.options.loading&&this.loading())},hide:function(t){(t&&t.preventDefault(),t=n.Event("hide"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented())&&(this.isShown=!1,this.escape(),this.tab(),this.isLoading&&this.loading(),n(document).off("focusin.modal"),this.$element.removeClass("in").removeClass("animated").removeClass(this.options.attentionAnimation).removeClass("modal-overflow").attr("aria-hidden",!0),n.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},layout:function(){var i=this.options.height?"height":"max-height",r=this.options.height||this.options.maxHeight,t,u;this.options.width?(this.$element.css("width",this.options.width),t=this,this.$element.css("margin-left",function(){return/%/ig.test(t.options.width)?-(parseInt(t.options.width)/2)+"%":-(n(this).width()/2)+"px"})):(this.$element.css("width",""),this.$element.css("margin-left",""));this.$element.find(".modal-body").css("overflow","").css(i,"");r&&this.$element.find(".modal-body").css("overflow","auto").css(i,r);u=n(window).height()-10<this.$element.height();u||this.options.modalOverflow?this.$element.css("margin-top",0).addClass("modal-overflow"):this.$element.css("margin-top",0-this.$element.height()/2).removeClass("modal-overflow")},tab:function(){var t=this;if(this.isShown&&this.options.consumeTab)this.$element.on("keydown.tabindex.modal","[data-tabindex]",function(i){var r,f,u;i.keyCode&&i.keyCode==9&&(r=[],f=Number(n(this).data("tabindex")),t.$element.find("[data-tabindex]:enabled:visible:not([readonly])").each(function(){r.push(Number(n(this).data("tabindex")))}),r.sort(function(n,t){return n-t}),u=n.inArray(f,r),i.shiftKey?u==0?t.$element.find("[data-tabindex="+r[r.length-1]+"]").focus():t.$element.find("[data-tabindex="+r[u-1]+"]").focus():u<r.length-1?t.$element.find("[data-tabindex="+r[u+1]+"]").focus():t.$element.find("[data-tabindex="+r[0]+"]").focus(),i.preventDefault())});else this.isShown||this.$element.off("keydown.tabindex.modal")},escape:function(){var n=this;if(this.isShown&&this.options.keyboard){this.$element.attr("tabindex")||this.$element.attr("tabindex",-1);this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&n.hide()})}else this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,i=setTimeout(function(){t.$element.off(n.support.transition.end);t.hideModal()},500);this.$element.one(n.support.transition.end,function(){clearTimeout(i);t.hideModal()})},hideModal:function(){var n=this.options.height?"height":"max-height",t=this.options.height||this.options.maxHeight;t&&this.$element.find(".modal-body").css("overflow","").css(n,"");this.$element.hide().trigger("hidden")},removeLoading:function(){this.$loading.remove();this.$loading=null;this.isLoading=!1},loading:function(t){var i,r,u;t=t||function(){};i=this.$element.hasClass("fade")?"fade":"";this.isLoading?this.isLoading&&this.$loading?(this.$loading.removeClass("in"),u=this,n.support.transition&&this.$element.hasClass("fade")?this.$loading.one(n.support.transition.end,function(){u.removeLoading()}):u.removeLoading()):t&&t(this.isLoading):(r=n.support.transition&&i,this.$loading=n('<div class="loading-mask '+i+'">').append(this.options.spinner).appendTo(this.$element),r&&this.$loading[0].offsetWidth,this.$loading.addClass("in"),this.isLoading=!0,r?this.$loading.one(n.support.transition.end,t):t())},focus:function(){var n=this.$element.find(this.options.focusOn);n=n.length?n:this.$element;n.focus()},attention:function(){if(this.options.attentionAnimation){this.$element.removeClass("animated").removeClass(this.options.attentionAnimation);var n=this;setTimeout(function(){n.$element.addClass("animated").addClass(n.options.attentionAnimation)},0)}this.focus()},destroy:function(){var t=n.Event("destroy");(this.$element.trigger(t),t.isDefaultPrevented())||(this.$element.off(".connextmodal").removeData("modal").removeClass("in").attr("aria-hidden",!0),this.$parent!==this.$element.parent()?this.$element.appendTo(this.$parent):this.$parent.length||(this.$element.remove(),this.$element=null),this.$element.trigger("destroyed"))}};n.fn.connextmodal=function(i,r){return this.each(function(){var f=n(this),u=f.data("modal"),e=n.extend({},n.fn.connextmodal.defaults,f.data(),typeof i=="object"&&i);u||f.data("modal",u=new t(this,e));typeof i=="string"?u[i].apply(u,[].concat(r)):e.show&&u.show()})};n.fn.connextmodal.defaults={keyboard:!0,backdrop:!0,loading:!1,show:!0,width:null,height:null,maxHeight:null,modalOverflow:!1,consumeTab:!0,focusOn:null,replace:!1,resize:!1,attentionAnimation:!1,manager:"body",spinner:'<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"><\/div><\/div><\/div>',backdropTemplate:'<div class="connext-modal-backdrop" />'};n.fn.connextmodal.Constructor=t;n(function(){n(document).off("click.modal").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var i=n(this),r=i.attr("href"),u=n(i.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),f=u.data("modal")?"toggle":n.extend({remote:!/#/.test(r)&&r},u.data(),i.data());t.preventDefault();u.connextmodal(f).one("hide",function(){i.focus()})})})}(window.jQuery),!function(n){"use strict";function t(n){return function(t){if(t&&this===t.target)return n.apply(this,arguments)}}var r=function(n,t){this.init(n,t)},i;r.prototype={constructor:r,init:function(t,i){if(this.$element=n(t),this.options=n.extend({},n.fn.modalmanager.defaults,this.$element.data(),typeof i=="object"&&i),this.stack=[],this.backdropCount=0,this.options.resize){var r,u=this;n(window).on("resize.modal",function(){r&&clearTimeout(r);r=setTimeout(function(){for(var n=0;n<u.stack.length;n++)u.stack[n].isShown&&u.stack[n].layout()},10)})}},createModal:function(t,i){n(t).modal(n.extend({manager:this},i))},appendModal:function(i){this.stack.push(i);var r=this;i.$element.on("show.modalmanager",t(function(){var t=function(){i.isShown=!0;var t=n.support.transition&&i.$element.hasClass("fade");r.$element.toggleClass("modal-open",r.hasOpenModal()).toggleClass("page-overflow",n(window).height()<r.$element.height());i.$parent=i.$element.parent();i.$container=r.createContainer(i);i.$element.appendTo(i.$container);r.backdrop(i,function(){i.$element.show();t&&i.$element[0].offsetWidth;i.layout();i.$element.addClass("in").attr("aria-hidden",!1);var u=function(){r.setFocus();i.$element.trigger("shown")};t?i.$element.one(n.support.transition.end,u):u()})};i.options.replace?r.replace(t):t()}));i.$element.on("hidden.modalmanager",t(function(){if(r.backdrop(i),r.destroyModal(i),i.$element.parent().length)if(i.$backdrop){var t=n.support.transition&&i.$element.hasClass("fade");t&&i.$element[0].offsetWidth;n.support.transition&&i.$element.hasClass("fade")?i.$backdrop.one(n.support.transition.end,function(){i.destroy()}):i.destroy()}else i.destroy();else r.destroyModal(i)}));i.$element.on("destroyed.modalmanager",t(function(){r.destroyModal(i)}))},getOpenModals:function(){for(var t=[],n=0;n<this.stack.length;n++)this.stack[n].isShown&&t.push(this.stack[n]);return t},hasOpenModal:function(){return this.getOpenModals().length>0},setFocus:function(){for(var t,n=0;n<this.stack.length;n++)this.stack[n].isShown&&(t=this.stack[n]);t&&t.focus()},destroyModal:function(n){n.$element.off(".modalmanager");n.$backdrop&&this.removeBackdrop(n);this.stack.splice(this.getIndexOfModal(n),1);var t=this.hasOpenModal();this.$element.toggleClass("modal-open",t);t||this.$element.removeClass("page-overflow");this.removeContainer(n);this.setFocus()},getModalAt:function(n){return this.stack[n]},getIndexOfModal:function(n){for(var t=0;t<this.stack.length;t++)if(n===this.stack[t])return t},replace:function(i){for(var r,u=0;u<this.stack.length;u++)this.stack[u].isShown&&(r=this.stack[u]);r?(this.$backdropHandle=r.$backdrop,r.$backdrop=null,i&&r.$element.one("hidden",t(n.proxy(i,this))),r.hide()):i&&i()},removeBackdrop:function(n){n.$backdrop.remove();n.$backdrop=null},createBackdrop:function(t,i){var r;return this.$backdropHandle?(r=this.$backdropHandle,r.off(".modalmanager"),this.$backdropHandle=null,this.isLoading&&this.removeSpinner()):r=n(i).addClass(t).appendTo(this.$element),r},removeContainer:function(n){n.$container.remove();n.$container=null},createContainer:function(r){var u;if(u=n('<div class="modal-scrollable">').css("z-index",i("modal",this.getOpenModals().length)).appendTo(this.$element),r&&r.options.backdrop!="static")u.on("click.modal",t(function(){r.hide()}));else if(r)u.on("click.modal",t(function(){r.attention()}));return u},backdrop:function(t,r){var e=t.$element.hasClass("fade")?"fade":"",o=t.options.backdrop&&this.backdropCount<this.options.backdropLimit,u,f;t.isShown&&o?(u=n.support.transition&&e&&!this.$backdropHandle,t.$backdrop=this.createBackdrop(e,t.options.backdropTemplate),t.$backdrop.css("z-index",i("backdrop",this.getOpenModals().length)),u&&t.$backdrop[0].offsetWidth,t.$backdrop.addClass("in"),this.backdropCount+=1,u?t.$backdrop.one(n.support.transition.end,r):r()):!t.isShown&&t.$backdrop?(t.$backdrop.removeClass("in"),this.backdropCount-=1,f=this,n.support.transition&&t.$element.hasClass("fade")?t.$backdrop.one(n.support.transition.end,function(){f.removeBackdrop(t)}):f.removeBackdrop(t)):r&&r()},removeSpinner:function(){this.$spinner&&this.$spinner.remove();this.$spinner=null;this.isLoading=!1},removeLoading:function(){this.$backdropHandle&&this.$backdropHandle.remove();this.$backdropHandle=null;this.removeSpinner()},loading:function(t){var r,f,u;t=t||function(){};this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",n(window).height()<this.$element.height());this.isLoading?this.isLoading&&this.$backdropHandle?(this.$backdropHandle.removeClass("in"),u=this,n.support.transition?this.$backdropHandle.one(n.support.transition.end,function(){u.removeLoading()}):u.removeLoading()):t&&t(this.isLoading):(this.$backdropHandle=this.createBackdrop("fade",this.options.backdropTemplate),this.$backdropHandle[0].offsetWidth,r=this.getOpenModals(),this.$backdropHandle.css("z-index",i("backdrop",r.length+1)).addClass("in"),f=n(this.options.spinner).css("z-index",i("modal",r.length+1)).appendTo(this.$element).addClass("in"),this.$spinner=n(this.createContainer()).append(f).on("click.modalmanager",n.proxy(this.loading,this)),this.isLoading=!0,n.support.transition?this.$backdropHandle.one(n.support.transition.end,t):t())}};i=function(){var i,t={};return function(r,u){if(typeof i=="undefined"){var f=n('<div class="modal hide" />').appendTo("body"),e=n('<div class="connext-modal-backdrop hide" />').appendTo("body");t.modal=+f.css("z-index");t.backdrop=+e.css("z-index");i=t.modal-t.backdrop;f.remove();e.remove();e=f=null}return t[r]+i*u}}();n.fn.modalmanager=function(t,i){return this.each(function(){var f=n(this),u=f.data("modalmanager");u||f.data("modalmanager",u=new r(this,t));typeof t=="string"&&u[t].apply(u,[].concat(i))})};n.fn.modalmanager.defaults={backdropLimit:999,resize:!0,spinner:'<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"><\/div><\/div><\/div>',backdropTemplate:'<div class="connext-modal-backdrop" />'};n.fn.modalmanager.Constructor=r;n(function(){n(document).off("show.bs.modal").off("hidden.bs.modal")})}(jQuery),typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function(n){"use strict";var t=n.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1||t[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4");}(jQuery);+function(n){"use strict";function i(i){return this.each(function(){var u=n(this),r=u.data("bs.affix"),f=typeof i=="object"&&i;r||u.data("bs.affix",r=new t(this,f));typeof i=="string"&&r[i]()})}var t=function(i,r){this.options=n.extend({},t.DEFAULTS,r);this.$target=n(this.options.target).on("scroll.bs.affix.data-api",n.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",n.proxy(this.checkPositionWithEventLoop,this));this.$element=n(i);this.affixed=null;this.unpin=null;this.pinnedOffset=null;this.checkPosition()},r;t.VERSION="3.3.7";t.RESET="affix affix-top affix-bottom";t.DEFAULTS={offset:0,target:window};t.prototype.getState=function(n,t,i,r){var u=this.$target.scrollTop(),f=this.$element.offset(),e=this.$target.height();if(i!=null&&this.affixed=="top")return u<i?"top":!1;if(this.affixed=="bottom")return i!=null?u+this.unpin<=f.top?!1:"bottom":u+e<=n-r?!1:"bottom";var o=this.affixed==null,s=o?u:f.top,h=o?e:t;return i!=null&&u<=i?"top":r!=null&&s+h>=n-r?"bottom":!1};t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var n=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-n};t.prototype.checkPositionWithEventLoop=function(){setTimeout(n.proxy(this.checkPosition,this),1)};t.prototype.checkPosition=function(){var i,e,o;if(this.$element.is(":visible")){var s=this.$element.height(),r=this.options.offset,f=r.top,u=r.bottom,h=Math.max(n(document).height(),n(document.body).height());if(typeof r!="object"&&(u=f=r),typeof f=="function"&&(f=r.top(this.$element)),typeof u=="function"&&(u=r.bottom(this.$element)),i=this.getState(h,s,f,u),this.affixed!=i){if(this.unpin!=null&&this.$element.css("top",""),e="affix"+(i?"-"+i:""),o=n.Event(e+".bs.affix"),this.$element.trigger(o),o.isDefaultPrevented())return;this.affixed=i;this.unpin=i=="bottom"?this.getPinnedOffset():null;this.$element.removeClass(t.RESET).addClass(e).trigger(e.replace("affix","affixed")+".bs.affix")}i=="bottom"&&this.$element.offset({top:h-s-u})}};r=n.fn.affix;n.fn.affix=i;n.fn.affix.Constructor=t;n.fn.affix.noConflict=function(){return n.fn.affix=r,this};n(window).on("load",function(){n('[data-spy="affix"]').each(function(){var r=n(this),t=r.data();t.offset=t.offset||{};t.offsetBottom!=null&&(t.offset.bottom=t.offsetBottom);t.offsetTop!=null&&(t.offset.top=t.offsetTop);i.call(r,t)})})}(jQuery),function(){var y=this,at=y._,s={},r=Array.prototype,g=Object.prototype,vt=Function.prototype,nt=r.push,t=r.slice,u=r.concat,e=g.toString,yt=g.hasOwnProperty,tt=r.forEach,it=r.map,rt=r.reduce,ut=r.reduceRight,ft=r.filter,et=r.every,ot=r.some,h=r.indexOf,st=r.lastIndexOf,pt=Array.isArray,ht=Object.keys,p=vt.bind,n=function(t){if(t instanceof n)return t;if(!(this instanceof n))return new n(t);this._wrapped=t},i,w,b,o,c,k,l,a,f,ct,lt,v;typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=n),exports._=n):y._=n;n.VERSION="1.6.0";i=n.each=n.forEach=function(t,i,r){var e,u,f;if(t==null)return t;if(tt&&t.forEach===tt)t.forEach(i,r);else if(t.length===+t.length){for(u=0,f=t.length;u<f;u++)if(i.call(r,t[u],u,t)===s)return}else for(e=n.keys(t),u=0,f=e.length;u<f;u++)if(i.call(r,t[e[u]],e[u],t)===s)return;return t};n.map=n.collect=function(n,t,r){var u=[];return n==null?u:it&&n.map===it?n.map(t,r):(i(n,function(n,i,f){u.push(t.call(r,n,i,f))}),u)};w="Reduce of empty array with no initial value";n.reduce=n.foldl=n.inject=function(t,r,u,f){var e=arguments.length>2;if(t==null&&(t=[]),rt&&t.reduce===rt)return f&&(r=n.bind(r,f)),e?t.reduce(r,u):t.reduce(r);if(i(t,function(n,t,i){e?u=r.call(f,u,n,t,i):(u=n,e=!0)}),!e)throw new TypeError(w);return u};n.reduceRight=n.foldr=function(t,r,u,f){var o=arguments.length>2,e,s;if(t==null&&(t=[]),ut&&t.reduceRight===ut)return f&&(r=n.bind(r,f)),o?t.reduceRight(r,u):t.reduceRight(r);if(e=t.length,e!==+e&&(s=n.keys(t),e=s.length),i(t,function(n,i,h){i=s?s[--e]:--e;o?u=r.call(f,u,t[i],i,h):(u=t[i],o=!0)}),!o)throw new TypeError(w);return u};n.find=n.detect=function(n,t,i){var r;return b(n,function(n,u,f){if(t.call(i,n,u,f))return r=n,!0}),r};n.filter=n.select=function(n,t,r){var u=[];return n==null?u:ft&&n.filter===ft?n.filter(t,r):(i(n,function(n,i,f){t.call(r,n,i,f)&&u.push(n)}),u)};n.reject=function(t,i,r){return n.filter(t,function(n,t,u){return!i.call(r,n,t,u)},r)};n.every=n.all=function(t,r,u){r||(r=n.identity);var f=!0;return t==null?f:et&&t.every===et?t.every(r,u):(i(t,function(n,t,i){if(!(f=f&&r.call(u,n,t,i)))return s}),!!f)};b=n.some=n.any=function(t,r,u){r||(r=n.identity);var f=!1;return t==null?f:ot&&t.some===ot?t.some(r,u):(i(t,function(n,t,i){if(f||(f=r.call(u,n,t,i)))return s}),!!f)};n.contains=n.include=function(n,t){return n==null?!1:h&&n.indexOf===h?n.indexOf(t)!=-1:b(n,function(n){return n===t})};n.invoke=function(i,r){var u=t.call(arguments,2),f=n.isFunction(r);return n.map(i,function(n){return(f?r:n[r]).apply(n,u)})};n.pluck=function(t,i){return n.map(t,n.property(i))};n.where=function(t,i){return n.filter(t,n.matches(i))};n.findWhere=function(t,i){return n.find(t,n.matches(i))};n.max=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var f=-Infinity,e=-Infinity;return i(t,function(n,t,i){var o=r?r.call(u,n,t,i):n;o>e&&(f=n,e=o)}),f};n.min=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var f=Infinity,e=Infinity;return i(t,function(n,t,i){var o=r?r.call(u,n,t,i):n;o<e&&(f=n,e=o)}),f};n.shuffle=function(t){var u,f=0,r=[];return i(t,function(t){u=n.random(f++);r[f-1]=r[u];r[u]=t}),r};n.sample=function(t,i,r){return i==null||r?(t.length!==+t.length&&(t=n.values(t)),t[n.random(t.length-1)]):n.shuffle(t).slice(0,Math.max(0,i))};o=function(t){return t==null?n.identity:n.isFunction(t)?t:n.property(t)};n.sortBy=function(t,i,r){return i=o(i),n.pluck(n.map(t,function(n,t,u){return{value:n,index:t,criteria:i.call(r,n,t,u)}}).sort(function(n,t){var i=n.criteria,r=t.criteria;if(i!==r){if(i>r||i===void 0)return 1;if(i<r||r===void 0)return-1}return n.index-t.index}),"value")};c=function(n){return function(t,r,u){var f={};return r=o(r),i(t,function(i,e){var o=r.call(u,i,e,t);n(f,o,i)}),f}};n.groupBy=c(function(t,i,r){n.has(t,i)?t[i].push(r):t[i]=[r]});n.indexBy=c(function(n,t,i){n[t]=i});n.countBy=c(function(t,i){n.has(t,i)?t[i]++:t[i]=1});n.sortedIndex=function(n,t,i,r){var f;i=o(i);for(var s=i.call(r,t),u=0,e=n.length;u<e;)f=u+e>>>1,i.call(r,n[f])<s?u=f+1:e=f;return u};n.toArray=function(i){return i?n.isArray(i)?t.call(i):i.length===+i.length?n.map(i,n.identity):n.values(i):[]};n.size=function(t){return t==null?0:t.length===+t.length?t.length:n.keys(t).length};n.first=n.head=n.take=function(n,i,r){if(n!=null)return i==null||r?n[0]:i<0?[]:t.call(n,0,i)};n.initial=function(n,i,r){return t.call(n,0,n.length-(i==null||r?1:i))};n.last=function(n,i,r){if(n!=null)return i==null||r?n[n.length-1]:t.call(n,Math.max(n.length-i,0))};n.rest=n.tail=n.drop=function(n,i,r){return t.call(n,i==null||r?1:i)};n.compact=function(t){return n.filter(t,n.identity)};k=function(t,r,f){return r&&n.every(t,n.isArray)?u.apply(f,t):(i(t,function(t){n.isArray(t)||n.isArguments(t)?r?nt.apply(f,t):k(t,r,f):f.push(t)}),f)};n.flatten=function(n,t){return k(n,t,[])};n.without=function(i){return n.difference(i,t.call(arguments,1))};n.partition=function(n,t,r){t=o(t);var u=[],f=[];return i(n,function(n){(t.call(r,n)?u:f).push(n)}),[u,f]};n.uniq=n.unique=function(t,r,u,f){n.isFunction(r)&&(f=u,u=r,r=!1);var s=u?n.map(t,u,f):t,o=[],e=[];return i(s,function(i,u){(r?u&&e[e.length-1]===i:n.contains(e,i))||(e.push(i),o.push(t[u]))}),o};n.union=function(){return n.uniq(n.flatten(arguments,!0))};n.intersection=function(i){var r=t.call(arguments,1);return n.filter(n.uniq(i),function(t){return n.every(r,function(i){return n.contains(i,t)})})};n.difference=function(i){var f=u.apply(r,t.call(arguments,1));return n.filter(i,function(t){return!n.contains(f,t)})};n.zip=function(){for(var i=n.max(n.pluck(arguments,"length").concat(0)),r=new Array(i),t=0;t<i;t++)r[t]=n.pluck(arguments,""+t);return r};n.object=function(n,t){var r,i,u;if(n==null)return{};for(r={},i=0,u=n.length;i<u;i++)t?r[n[i]]=t[i]:r[n[i][0]]=n[i][1];return r};n.indexOf=function(t,i,r){if(t==null)return-1;var u=0,f=t.length;if(r)if(typeof r=="number")u=r<0?Math.max(0,f+r):r;else return u=n.sortedIndex(t,i),t[u]===i?u:-1;if(h&&t.indexOf===h)return t.indexOf(i,r);for(;u<f;u++)if(t[u]===i)return u;return-1};n.lastIndexOf=function(n,t,i){var u,r;if(n==null)return-1;if(u=i!=null,st&&n.lastIndexOf===st)return u?n.lastIndexOf(t,i):n.lastIndexOf(t);for(r=u?i:n.length;r--;)if(n[r]===t)return r;return-1};n.range=function(n,t,i){arguments.length<=1&&(t=n||0,n=0);i=arguments[2]||1;for(var r=Math.max(Math.ceil((t-n)/i),0),u=0,f=new Array(r);u<r;)f[u++]=n,n+=i;return f};l=function(){};n.bind=function(i,r){var u,f;if(p&&i.bind===p)return p.apply(i,t.call(arguments,1));if(!n.isFunction(i))throw new TypeError;return u=t.call(arguments,2),f=function(){var e,n;return(this instanceof f)?(l.prototype=i.prototype,e=new l,l.prototype=null,n=i.apply(e,u.concat(t.call(arguments))),Object(n)===n)?n:e:i.apply(r,u.concat(t.call(arguments)))}};n.partial=function(i){var r=t.call(arguments,1);return function(){for(var f=0,t=r.slice(),u=0,e=t.length;u<e;u++)t[u]===n&&(t[u]=arguments[f++]);while(f<arguments.length)t.push(arguments[f++]);return i.apply(this,t)}};n.bindAll=function(r){var u=t.call(arguments,1);if(u.length===0)throw new Error("bindAll must be passed function names");return i(u,function(t){r[t]=n.bind(r[t],r)}),r};n.memoize=function(t,i){var r={};return i||(i=n.identity),function(){var u=i.apply(this,arguments);return n.has(r,u)?r[u]:r[u]=t.apply(this,arguments)}};n.delay=function(n,i){var r=t.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},i)};n.defer=function(i){return n.delay.apply(n,[i,1].concat(t.call(arguments,1)))};n.throttle=function(t,i,r){var u,f,s,e=null,o=0,h;return r||(r={}),h=function(){o=r.leading===!1?0:n.now();e=null;s=t.apply(u,f);u=f=null},function(){var c=n.now(),l;return o||r.leading!==!1||(o=c),l=i-(c-o),u=this,f=arguments,l<=0?(clearTimeout(e),e=null,o=c,s=t.apply(u,f),u=f=null):e||r.trailing===!1||(e=setTimeout(h,l)),s}};n.debounce=function(t,i,r){var u,f,e,s,o,h=function(){var c=n.now()-s;c<i?u=setTimeout(h,i-c):(u=null,r||(o=t.apply(e,f),e=f=null))};return function(){e=this;f=arguments;s=n.now();var c=r&&!u;return u||(u=setTimeout(h,i)),c&&(o=t.apply(e,f),e=f=null),o}};n.once=function(n){var i=!1,t;return function(){return i?t:(i=!0,t=n.apply(this,arguments),n=null,t)}};n.wrap=function(t,i){return n.partial(i,t)};n.compose=function(){var n=arguments;return function(){for(var t=arguments,i=n.length-1;i>=0;i--)t=[n[i].apply(this,t)];return t[0]}};n.after=function(n,t){return function(){if(--n<1)return t.apply(this,arguments)}};n.keys=function(t){var i,r;if(!n.isObject(t))return[];if(ht)return ht(t);i=[];for(r in t)n.has(t,r)&&i.push(r);return i};n.values=function(t){for(var r=n.keys(t),u=r.length,f=new Array(u),i=0;i<u;i++)f[i]=t[r[i]];return f};n.pairs=function(t){for(var r=n.keys(t),u=r.length,f=new Array(u),i=0;i<u;i++)f[i]=[r[i],t[r[i]]];return f};n.invert=function(t){for(var u={},r=n.keys(t),i=0,f=r.length;i<f;i++)u[t[r[i]]]=r[i];return u};n.functions=n.methods=function(t){var i=[];for(var r in t)n.isFunction(t[r])&&i.push(r);return i.sort()};n.extend=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)n[i]=t[i]}),n};n.pick=function(n){var f={},e=u.apply(r,t.call(arguments,1));return i(e,function(t){t in n&&(f[t]=n[t])}),f};n.omit=function(i){var e={},o=u.apply(r,t.call(arguments,1));for(var f in i)n.contains(o,f)||(e[f]=i[f]);return e};n.defaults=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)n[i]===void 0&&(n[i]=t[i])}),n};n.clone=function(t){return n.isObject(t)?n.isArray(t)?t.slice():n.extend({},t):t};n.tap=function(n,t){return t(n),n};a=function(t,i,r,u){var l,v,h,c,f,o,s;if(t===i)return t!==0||1/t==1/i;if(t==null||i==null)return t===i;if(t instanceof n&&(t=t._wrapped),i instanceof n&&(i=i._wrapped),l=e.call(t),l!=e.call(i))return!1;switch(l){case"[object String]":return t==String(i);case"[object Number]":return t!=+t?i!=+i:t==0?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if(typeof t!="object"||typeof i!="object")return!1;for(v=r.length;v--;)if(r[v]==t)return u[v]==i;if(h=t.constructor,c=i.constructor,h!==c&&!(n.isFunction(h)&&h instanceof h&&n.isFunction(c)&&c instanceof c)&&"constructor"in t&&"constructor"in i)return!1;if(r.push(t),u.push(i),f=0,o=!0,l=="[object Array]"){if(f=t.length,o=f==i.length,o)while(f--)if(!(o=a(t[f],i[f],r,u)))break}else{for(s in t)if(n.has(t,s)&&(f++,!(o=n.has(i,s)&&a(t[s],i[s],r,u))))break;if(o){for(s in i)if(n.has(i,s)&&!f--)break;o=!f}}return r.pop(),u.pop(),o};n.isEqual=function(n,t){return a(n,t,[],[])};n.isEmpty=function(t){if(t==null)return!0;if(n.isArray(t)||n.isString(t))return t.length===0;for(var i in t)if(n.has(t,i))return!1;return!0};n.isElement=function(n){return!!(n&&n.nodeType===1)};n.isArray=pt||function(n){return e.call(n)=="[object Array]"};n.isObject=function(n){return n===Object(n)};i(["Arguments","Function","String","Number","Date","RegExp"],function(t){n["is"+t]=function(n){return e.call(n)=="[object "+t+"]"}});n.isArguments(arguments)||(n.isArguments=function(t){return!!(t&&n.has(t,"callee"))});typeof/./!="function"&&(n.isFunction=function(n){return typeof n=="function"});n.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))};n.isNaN=function(t){return n.isNumber(t)&&t!=+t};n.isBoolean=function(n){return n===!0||n===!1||e.call(n)=="[object Boolean]"};n.isNull=function(n){return n===null};n.isUndefined=function(n){return n===void 0};n.has=function(n,t){return yt.call(n,t)};n.noConflict=function(){return y._=at,this};n.identity=function(n){return n};n.constant=function(n){return function(){return n}};n.property=function(n){return function(t){return t[n]}};n.matches=function(n){return function(t){if(t===n)return!0;for(var i in n)if(String(n[i])!==String(t[i]))return!1;return!0}};n.times=function(n,t,i){for(var u=Array(Math.max(0,n)),r=0;r<n;r++)u[r]=t.call(i,r);return u};n.random=function(n,t){return t==null&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};n.now=Date.now||function(){return(new Date).getTime()};f={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};f.unescape=n.invert(f.escape);ct={escape:new RegExp("["+n.keys(f.escape).join("")+"]","g"),unescape:new RegExp("("+n.keys(f.unescape).join("|")+")","g")};n.each(["escape","unescape"],function(t){n[t]=function(n){return n==null?"":(""+n).replace(ct[t],function(n){return f[t][n]})}});n.result=function(t,i){if(t==null)return void 0;var r=t[i];return n.isFunction(r)?r.call(t):r};n.mixin=function(t){i(n.functions(t),function(i){var r=n[i]=t[i];n.prototype[i]=function(){var t=[this._wrapped];return nt.apply(t,arguments),v.call(this,r.apply(n,t))}})};lt=0;n.uniqueId=function(n){var t=++lt+"";return n?n+t:t};n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var d=/(.)^/,wt={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},bt=/\\|'|\r|\n|\t|\u2028|\u2029/g;n.template=function(t,i,r){var f,e;r=n.defaults({},r,n.templateSettings);var h=new RegExp([(r.escape||d).source,(r.interpolate||d).source,(r.evaluate||d).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(h,function(n,i,r,f,e){return u+=t.slice(o,e).replace(bt,function(n){return"\\"+wt[n]}),i&&(u+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),f&&(u+="';\n"+f+"\n__p+='"),o=e+n.length,n});u+="';\n";r.variable||(u="with(obj||{}){\n"+u+"}\n");u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{f=new Function(r.variable||"obj","_",u)}catch(s){s.source=u;throw s;}return i?f(i,n):(e=function(t){return f.call(this,t,n)},e.source="function("+(r.variable||"obj")+"){\n"+u+"}",e)};n.chain=function(t){return n(t).chain()};n.findByKey=function(t,i){if(n.isEmpty(i))return first?void 0:[];var r;return n.each(t,function(n,u){for(var f in i)if(i[f]==n[f])return r=t[u],!0}),r};n.omitByKey=function(t,i){if(n.isEmpty(i))return first?void 0:[];var r=[];return n.each(t,function(n,u){var f,e,o;for(f in i)if(e=i[f],o=n[f],i[f]!=n[f])return r.push(t[u]),!0}),r};n.findAllByKey=function(t,i){var u=arguments[2]?arguments[2]:!1,r;return n.isEmpty(i)?first?void 0:[]:(r=[],n.each(t,function(n,f){for(var e in i)u,i[e]==n[e]&&r.push(t[f])}),r)};n.hasKeyVal=function(t,i){return n.where(t,i).length>0?!0:!1};n.replaceKey=function(t,i,r){return n.map(t,function(t){var u={};return n.each(t,function(n,t){t==i?u[r]=n:u[t]=n}),u})};n.replaceObjKeysByMap=function(t,i){var r=[t];return n.each(i,function(t,i){r=n.replaceKey(r,i,t)}),r[0]};n.addDisplayOrder=function(t,i){var r=[];return n.each(t,function(t,u){var f={};f[i]=u+1;r.push(n.extend(t,f))}),r};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};n.capitalizeKeys=function(t){var i=[];return n.each(t,function(t){var r={};n.each(t,function(n,t){r[t.capitalize()]=n});i.push(r)}),i};n.uniqueByKey=function(i,f){var o=u.apply(r,t.call(arguments,2)),e=[];return n.each(i,function(t){var i={};i[f]=t[f];n.hasKeyVal(e,i)||t[f]===null||(o.length>0?e.push(n.pick(t,o)):e.push(t))}),e};n.pickKeysFromObjArray=function(i){var f=[],e=u.apply(r,t.call(arguments,1));return n.each(i,function(t){f.push(n.pick(t,e))}),f};n.dedupeByKey=function(t,i){return n.each(t,function(t){console.log("OBJ1 ---->  ",t);n.each(i,function(n){console.log("obj1 key - > ",t[key]," obj2 key -> ",n[key])})}),[]};n.differenceByKey=function(t,i,r,u){var f=[],e=[];return n.each(t,function(t){var o={};o[u]=t[r];n.hasKeyVal(i,o)?f.push(t):e.push(t)}),{Matches:f,NoMatches:e}};n.groupByFilter=function(i,f){var o=u.apply(r,t.call(arguments,3)),e={};return n.each(i,function(t,i){console.log("#### group.each",t,i);console.log("XXXX group.each filter",e[t.filter]);n.isArray(e[t.filter])?(console.log("array","group[filter]",t[f],"val",t),e[t.filter].push(t)):(console.log("not array","group[filter]",t[f],"val",t),e[t.filter]=new Array(t))}),e};n.sortedGroupBy=function(t,i,r){var o=arguments[3]?arguments[3]:"_",u=n.uniqueByKey(t,i),f,e;return u=n.sortBy(u,r),f={},e={},console.log("underscore.sortedGroupby","unique",u),n.each(u,function(r){e[i]=r[i];f[o+String(r[i])]=n.findAllByKey(t,e)}),f};n.isNothing=function(t){return n.isEmpty(t)||n.isNull(t)||t===""?!0:!1};v=function(t){return this._chain?n(t).chain():t};n.mixin(n);i(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=r[t];n.prototype[t]=function(){var n=this._wrapped;return i.apply(n,arguments),(t=="shift"||t=="splice")&&n.length===0&&delete n[0],v.call(this,n)}});i(["concat","join","slice"],function(t){var i=r[t];n.prototype[t]=function(){return v.call(this,i.apply(this._wrapped,arguments))}});n.extend(n.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}});typeof define=="function"&&define.amd&&define("underscore",[],function(){return n})}.call(this);JSON||(JSON={}),function(){"use strict";function i(n){return n<10?"0"+n:n}function o(n){return e.lastIndex=0,e.test(n)?'"'+n.replace(e,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function u(i,f){var s,l,h,a,v=n,c,e=f[i];e&&typeof e=="object"&&typeof e.toJSON=="function"&&(e=e.toJSON(i));typeof t=="function"&&(e=t.call(f,i,e));switch(typeof e){case"string":return o(e);case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(n+=r,c=[],Object.prototype.toString.apply(e)==="[object Array]"){for(a=e.length,s=0;s<a;s+=1)c[s]=u(s,e)||"null";return h=c.length===0?"[]":n?"[\n"+n+c.join(",\n"+n)+"\n"+v+"]":"["+c.join(",")+"]",n=v,h}if(t&&typeof t=="object")for(a=t.length,s=0;s<a;s+=1)typeof t[s]=="string"&&(l=t[s],h=u(l,e),h&&c.push(o(l)+(n?": ":":")+h));else for(l in e)Object.prototype.hasOwnProperty.call(e,l)&&(h=u(l,e),h&&c.push(o(l)+(n?": ":":")+h));return h=c.length===0?"{}":n?"{\n"+n+c.join(",\n"+n)+"\n"+v+"}":"{"+c.join(",")+"}",n=v,h}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,r,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(i,f,e){var o;if(n="",r="",typeof e=="number")for(o=0;o<e;o+=1)r+=" ";else typeof e=="string"&&(r=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.stringify");return u("",{"":i})});typeof JSON.parse!="function"&&(JSON.parse=function(n,t){function r(n,i){var f,e,u=n[i];if(u&&typeof u=="object")for(f in u)Object.prototype.hasOwnProperty.call(u,f)&&(e=r(u,f),e!==undefined?u[f]=e:delete u[f]);return t.call(n,i,u)}var i;if(n=String(n),f.lastIndex=0,f.test(n)&&(n=n.replace(f,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse");})}(),function(n){var i=window.Cookies,t=window.Cookies=n();t.noConflict=function(){return window.Cookies=i,t}}(function(){function n(){for(var n=0,r={},t,i;n<arguments.length;n++){t=arguments[n];for(i in t)r[i]=t[i]}return r}function t(i){function r(t,u,f){var o,s;if(arguments.length>1){f=n({path:"/"},r.defaults,f);typeof f.expires=="number"&&(s=new Date,s.setMilliseconds(s.getMilliseconds()+f.expires*864e5),f.expires=s);try{o=JSON.stringify(u);/^[\{\[]/.test(o)&&(u=o)}catch(y){}return t!="igmRegID"&&t!="igmContent"&&(u=i.write?i.write(u,t):encodeURIComponent(String(u)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent)),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape),document.cookie=[t,"=",u,f.expires&&"; expires="+f.expires.toUTCString(),f.path&&"; path="+f.path,f.domain&&"; domain="+f.domain,f.secure?"; secure":""].join("")}t||(o={});for(var l=document.cookie?document.cookie.split("; "):[],a=/(%[0-9A-Z]{2})+/g,c=0;c<l.length;c++){var v=l[c].split("="),h=v[0].replace(a,decodeURIComponent),e=v.slice(1).join("=");e.charAt(0)==='"'&&(e=e.slice(1,-1));try{if(e=i.read?i.read(e,h):i(e,h)||e.replace(a,decodeURIComponent),this.json)try{e=JSON.parse(e)}catch(y){}if(t===h){o=e;break}t||(o[h]=e)}catch(y){}}return o}return r.get=r.set=r,r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,i){r(t,"",n(i,{expires:-1}))},r.withConverter=t,r}return t(function(){})});MD5=function(n){function a(n,t){return n<<t|n>>>32-t}function o(n,t){var f,e,r,u,i;return(r=n&2147483648,u=t&2147483648,f=n&1073741824,e=t&1073741824,i=(n&1073741823)+(t&1073741823),f&e)?i^2147483648^r^u:f|e?i&1073741824?i^3221225472^r^u:i^1073741824^r^u:i^r^u}function yt(n,t,i){return n&t|~n&i}function pt(n,t,i){return n&i|t&~i}function wt(n,t,i){return n^t^i}function bt(n,t,i){return t^(n|~i)}function s(n,t,i,r,u,f,e){return n=o(n,o(o(yt(t,i,r),u),e)),o(a(n,f),t)}function h(n,t,i,r,u,f,e){return n=o(n,o(o(pt(t,i,r),u),e)),o(a(n,f),t)}function c(n,t,i,r,u,f,e){return n=o(n,o(o(wt(t,i,r),u),e)),o(a(n,f),t)}function l(n,t,i,r,u,f,e){return n=o(n,o(o(bt(t,i,r),u),e)),o(a(n,f),t)}function kt(n){for(var r,u=n.length,o=u+8,s=(o-o%64)/64,e=(s+1)*16,i=Array(e-1),f=0,t=0;t<u;)r=(t-t%4)/4,f=t%4*8,i[r]=i[r]|n.charCodeAt(t)<<f,t++;return r=(t-t%4)/4,f=t%4*8,i[r]=i[r]|128<<f,i[e-2]=u<<3,i[e-1]=u>>>29,i}function v(n){for(var i="",r="",u,t=0;t<=3;t++)u=n>>>t*8&255,r="0"+u.toString(16),i=i+r.substr(r.length-2,2);return i}function dt(n){var i,r,t;for(n=n.replace(/rn/g,"n"),i="",r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i+=String.fromCharCode(t):t>127&&t<2048?(i+=String.fromCharCode(t>>6|192),i+=String.fromCharCode(t&63|128)):(i+=String.fromCharCode(t>>12|224),i+=String.fromCharCode(t>>6&63|128),i+=String.fromCharCode(t&63|128));return i}var e=Array(),f,ht,ct,lt,at,t,i,r,u,y=7,p=12,w=17,b=22,k=5,d=9,g=14,nt=20,tt=4,it=11,rt=16,ut=23,ft=6,et=10,ot=15,st=21,vt;for(n=dt(n),e=kt(n),t=1732584193,i=4023233417,r=2562383102,u=271733878,f=0;f<e.length;f+=16)ht=t,ct=i,lt=r,at=u,t=s(t,i,r,u,e[f+0],y,3614090360),u=s(u,t,i,r,e[f+1],p,3905402710),r=s(r,u,t,i,e[f+2],w,606105819),i=s(i,r,u,t,e[f+3],b,3250441966),t=s(t,i,r,u,e[f+4],y,4118548399),u=s(u,t,i,r,e[f+5],p,1200080426),r=s(r,u,t,i,e[f+6],w,2821735955),i=s(i,r,u,t,e[f+7],b,4249261313),t=s(t,i,r,u,e[f+8],y,1770035416),u=s(u,t,i,r,e[f+9],p,2336552879),r=s(r,u,t,i,e[f+10],w,4294925233),i=s(i,r,u,t,e[f+11],b,2304563134),t=s(t,i,r,u,e[f+12],y,1804603682),u=s(u,t,i,r,e[f+13],p,4254626195),r=s(r,u,t,i,e[f+14],w,2792965006),i=s(i,r,u,t,e[f+15],b,1236535329),t=h(t,i,r,u,e[f+1],k,4129170786),u=h(u,t,i,r,e[f+6],d,3225465664),r=h(r,u,t,i,e[f+11],g,643717713),i=h(i,r,u,t,e[f+0],nt,3921069994),t=h(t,i,r,u,e[f+5],k,3593408605),u=h(u,t,i,r,e[f+10],d,38016083),r=h(r,u,t,i,e[f+15],g,3634488961),i=h(i,r,u,t,e[f+4],nt,3889429448),t=h(t,i,r,u,e[f+9],k,568446438),u=h(u,t,i,r,e[f+14],d,3275163606),r=h(r,u,t,i,e[f+3],g,4107603335),i=h(i,r,u,t,e[f+8],nt,1163531501),t=h(t,i,r,u,e[f+13],k,2850285829),u=h(u,t,i,r,e[f+2],d,4243563512),r=h(r,u,t,i,e[f+7],g,1735328473),i=h(i,r,u,t,e[f+12],nt,2368359562),t=c(t,i,r,u,e[f+5],tt,4294588738),u=c(u,t,i,r,e[f+8],it,2272392833),r=c(r,u,t,i,e[f+11],rt,1839030562),i=c(i,r,u,t,e[f+14],ut,4259657740),t=c(t,i,r,u,e[f+1],tt,2763975236),u=c(u,t,i,r,e[f+4],it,1272893353),r=c(r,u,t,i,e[f+7],rt,4139469664),i=c(i,r,u,t,e[f+10],ut,3200236656),t=c(t,i,r,u,e[f+13],tt,681279174),u=c(u,t,i,r,e[f+0],it,3936430074),r=c(r,u,t,i,e[f+3],rt,3572445317),i=c(i,r,u,t,e[f+6],ut,76029189),t=c(t,i,r,u,e[f+9],tt,3654602809),u=c(u,t,i,r,e[f+12],it,3873151461),r=c(r,u,t,i,e[f+15],rt,530742520),i=c(i,r,u,t,e[f+2],ut,3299628645),t=l(t,i,r,u,e[f+0],ft,4096336452),u=l(u,t,i,r,e[f+7],et,1126891415),r=l(r,u,t,i,e[f+14],ot,2878612391),i=l(i,r,u,t,e[f+5],st,4237533241),t=l(t,i,r,u,e[f+12],ft,1700485571),u=l(u,t,i,r,e[f+3],et,2399980690),r=l(r,u,t,i,e[f+10],ot,4293915773),i=l(i,r,u,t,e[f+1],st,2240044497),t=l(t,i,r,u,e[f+8],ft,1873313359),u=l(u,t,i,r,e[f+15],et,4264355552),r=l(r,u,t,i,e[f+6],ot,2734768916),i=l(i,r,u,t,e[f+13],st,1309151649),t=l(t,i,r,u,e[f+4],ft,4149444226),u=l(u,t,i,r,e[f+11],et,3174756917),r=l(r,u,t,i,e[f+2],ot,718787259),i=l(i,r,u,t,e[f+9],st,3951481745),t=o(t,ht),i=o(i,ct),r=o(r,lt),u=o(u,at);return vt=v(t)+v(i)+v(r)+v(u),vt.toLowerCase()},function(){"use strict";function it(){var u=!1,n;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval");u=!0;window.localStorage.removeItem("_tmptest")}catch(f){}if(u)try{window.localStorage&&(i=window.localStorage,r="localStorage",o=i.jStorage_update)}catch(e){}else if("globalStorage"in window)try{window.globalStorage&&(i=window.location.hostname=="localhost"?window.globalStorage["localhost.localdomain"]:window.globalStorage[window.location.hostname],r="globalStorage",o=i.jStorage_update)}catch(s){}else if(t=document.createElement("link"),t.addBehavior){t.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(t);try{t.load("jStorage")}catch(h){t.setAttribute("jStorage","{}");t.save("jStorage");t.load("jStorage")}n="{}";try{n=t.getAttribute("jStorage")}catch(l){}try{o=t.getAttribute("jStorage_update")}catch(a){}i.jStorage=n;r="userDataBehavior"}else{t=null;return}nt();y();rt();tt();"addEventListener"in window&&window.addEventListener("pageshow",function(n){n.persisted&&c()},!1)}function g(){var n="{}";if(r=="userDataBehavior"){t.load("jStorage");try{n=t.getAttribute("jStorage")}catch(u){}try{o=t.getAttribute("jStorage_update")}catch(f){}i.jStorage=n}nt();y();tt()}function rt(){r=="localStorage"||r=="globalStorage"?"addEventListener"in window?window.addEventListener("storage",c,!1):document.attachEvent("onstorage",c):r=="userDataBehavior"&&setInterval(c,1e3)}function c(){var n;clearTimeout(k);k=setTimeout(function(){if(r=="localStorage"||r=="globalStorage")n=i.jStorage_update;else if(r=="userDataBehavior"){t.load("jStorage");try{n=t.getAttribute("jStorage_update")}catch(u){}}n&&n!=o&&(o=n,ut())},25)}function ut(){var i=f.parse(f.stringify(n.__jstorage_meta.CRC32)),r,t,u,e;g();r=f.parse(f.stringify(n.__jstorage_meta.CRC32));u=[];e=[];for(t in i)if(i.hasOwnProperty(t)){if(!r[t]){e.push(t);continue}i[t]!=r[t]&&String(i[t]).substr(0,2)=="2."&&u.push(t)}for(t in r)r.hasOwnProperty(t)&&(i[t]||u.push(t));h(u,"updated");h(e,"deleted")}function h(n,t){var i,r,o,f,e;if(n=[].concat(n||[]),t=="flushed"){n=[];for(e in u)u.hasOwnProperty(e)&&n.push(e);t="deleted"}for(i=0,o=n.length;i<o;i++){if(u[n[i]])for(r=0,f=u[n[i]].length;r<f;r++)u[n[i]][r](n[i],t);if(u["*"])for(r=0,f=u["*"].length;r<f;r++)u["*"][r](n[i],t)}}function l(){var n=(+new Date).toString();if(r=="localStorage"||r=="globalStorage")try{i.jStorage_update=n}catch(u){r=!1}else r=="userDataBehavior"&&(t.setAttribute("jStorage_update",n),t.save("jStorage"));c()}function nt(){if(i.jStorage)try{n=f.parse(String(i.jStorage))}catch(t){i.jStorage="{}"}else i.jStorage="{}";p=i.jStorage?String(i.jStorage).length:0;n.__jstorage_meta||(n.__jstorage_meta={});n.__jstorage_meta.CRC32||(n.__jstorage_meta.CRC32={})}function a(){et();try{i.jStorage=f.stringify(n);t&&(t.setAttribute("jStorage",i.jStorage),t.save("jStorage"));p=i.jStorage?String(i.jStorage).length:0}catch(r){}}function e(n){if(typeof n!="string"&&typeof n!="number")throw new TypeError("Key name must be string or numeric");if(n=="__jstorage_meta")throw new TypeError("Reserved key name");return!0}function y(){var u,t,i,f,r=Infinity,e=!1,o=[];if(clearTimeout(d),n.__jstorage_meta&&typeof n.__jstorage_meta.TTL=="object"){u=+new Date;i=n.__jstorage_meta.TTL;f=n.__jstorage_meta.CRC32;for(t in i)i.hasOwnProperty(t)&&(i[t]<=u?(delete i[t],delete f[t],delete n[t],e=!0,o.push(t)):i[t]<r&&(r=i[t]));r!=Infinity&&(d=setTimeout(y,Math.min(r-u,2147483647)));e&&(a(),l(),h(o,"deleted"))}}function tt(){var t,f,r,u,i;if(n.__jstorage_meta.PubSub){for(u=w,i=[],t=f=n.__jstorage_meta.PubSub.length-1;t>=0;t--)r=n.__jstorage_meta.PubSub[t],r[0]>w&&(u=r[0],i.unshift(r));for(t=i.length-1;t>=0;t--)ft(i[t][1],i[t][2]);w=u}}function ft(n,t){if(s[n])for(var i=0,r=s[n].length;i<r;i++)try{s[n][i](n,f.parse(f.stringify(t)))}catch(u){}}function et(){var i,t,r;if(n.__jstorage_meta.PubSub){for(i=+new Date-2e3,t=0,r=n.__jstorage_meta.PubSub.length;t<r;t++)if(n.__jstorage_meta.PubSub[t][0]<=i){n.__jstorage_meta.PubSub.splice(t,n.__jstorage_meta.PubSub.length-t);break}n.__jstorage_meta.PubSub.length||delete n.__jstorage_meta.PubSub}}function ot(t,i){n.__jstorage_meta||(n.__jstorage_meta={});n.__jstorage_meta.PubSub||(n.__jstorage_meta.PubSub=[]);n.__jstorage_meta.PubSub.unshift([+new Date,t,i]);a();l()}function st(n,t){for(var f=n.length,i=t^f,u=0,r;f>=4;)r=n.charCodeAt(u)&255|(n.charCodeAt(++u)&255)<<8|(n.charCodeAt(++u)&255)<<16|(n.charCodeAt(++u)&255)<<24,r=(r&65535)*1540483477+(((r>>>16)*1540483477&65535)<<16),r^=r>>>24,r=(r&65535)*1540483477+(((r>>>16)*1540483477&65535)<<16),i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16)^r,f-=4,++u;switch(f){case 3:i^=(n.charCodeAt(u+2)&255)<<16;case 2:i^=(n.charCodeAt(u+1)&255)<<8;case 1:i^=n.charCodeAt(u)&255;i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16)}return i^=i>>>13,i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16),i^=i>>>15,i>>>0}var v=window.jQuery||window.$||(window.$={}),f={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(n){return String(n).evalJSON()}||v.parseJSON||v.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||v.toJSON};if(typeof f.parse!="function"||typeof f.stringify!="function")throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var n={__jstorage_meta:{CRC32:{}}},i={jStorage:"{}"},t=null,p=0,r=!1,u={},k=!1,o=0,s={},w=+new Date,d,b={isXML:function(n){var t=(n?n.ownerDocument||n:0).documentElement;return t?t.nodeName!=="HTML":!1},encode:function(n){if(!this.isXML(n))return!1;try{return(new XMLSerializer).serializeToString(n)}catch(t){try{return n.xml}catch(i){}}return!1},decode:function(n){var i="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(n){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(n),t},t;return i?(t=i.call("DOMParser"in window&&new DOMParser||window,n,"text/xml"),this.isXML(t)?t:!1):!1}};v.jStorage={version:"0.4.12",set:function(t,i,r){if(e(t),r=r||{},typeof i=="undefined")return this.deleteKey(t),i;if(b.isXML(i))i={_is_xml:!0,xml:b.encode(i)};else{if(typeof i=="function")return undefined;i&&typeof i=="object"&&(i=f.parse(f.stringify(i)))}return n[t]=i,n.__jstorage_meta.CRC32[t]="2."+st(f.stringify(i),2538058380),this.setTTL(t,r.TTL||0),h(t,"updated"),i},get:function(t,i){return(e(t),t in n)?n[t]&&typeof n[t]=="object"&&n[t]._is_xml?b.decode(n[t].xml):n[t]:typeof i=="undefined"?null:i},deleteKey:function(t){return(e(t),t in n)?(delete n[t],typeof n.__jstorage_meta.TTL=="object"&&t in n.__jstorage_meta.TTL&&delete n.__jstorage_meta.TTL[t],delete n.__jstorage_meta.CRC32[t],a(),l(),h(t,"deleted"),!0):!1},setTTL:function(t,i){var r=+new Date;return(e(t),i=Number(i)||0,t in n)?(n.__jstorage_meta.TTL||(n.__jstorage_meta.TTL={}),i>0?n.__jstorage_meta.TTL[t]=r+i:delete n.__jstorage_meta.TTL[t],a(),y(),l(),!0):!1},getTTL:function(t){var r=+new Date,i;return(e(t),t in n&&n.__jstorage_meta.TTL&&n.__jstorage_meta.TTL[t])?(i=n.__jstorage_meta.TTL[t]-r,i||0):0},flush:function(){return n={__jstorage_meta:{CRC32:{}}},a(),l(),h(null,"flushed"),!0},storageObj:function(){function t(){}return t.prototype=n,new t},index:function(){var i=[];for(var t in n)n.hasOwnProperty(t)&&t!="__jstorage_meta"&&i.push(t);return i},storageSize:function(){return p},currentBackend:function(){return r},storageAvailable:function(){return!!r},listenKeyChange:function(n,t){e(n);u[n]||(u[n]=[]);u[n].push(t)},stopListening:function(n,t){if(e(n),u[n]){if(!t){delete u[n];return}for(var i=u[n].length-1;i>=0;i--)u[n][i]==t&&u[n].splice(i,1)}},subscribe:function(n,t){if(n=(n||"").toString(),!n)throw new TypeError("Channel not defined");s[n]||(s[n]=[]);s[n].push(t)},publish:function(n,t){if(n=(n||"").toString(),!n)throw new TypeError("Channel not defined");ot(n,t)},reInit:function(){g()},noConflict:function(n){return delete window.$.jStorage,n&&(window.jStorage=this),this}};it()}(),function(n){n.fn.viewportChecker=function(t){var i={classToAdd:"visible",classToRemove:"invisible",classToAddForFullView:"full-visible",removeClassAfterAnimation:!1,offset:100,repeat:!1,invertBottomOffset:!0,callbackFunction:function(){},scrollHorizontal:!1,callbackFunctionBeforeAddClass:null,scrollBox:window},u,r;return n.extend(i,t),u=this,r={height:n(i.scrollBox).height(),width:n(i.scrollBox).width()},this.checkElements=function(){var t,f;i.scrollHorizontal?(t=Math.max(n("html").scrollLeft(),n("body").scrollLeft(),n(window).scrollLeft()),f=t+r.width):(t=Math.max(n("html").scrollTop(),n("body").scrollTop(),n(window).scrollTop()),f=t+r.height);u.each(function(){var u=n(this),e={},o={};if(u.data("vp-add-class")&&(o.classToAdd=u.data("vp-add-class")),u.data("vp-remove-class")&&(o.classToRemove=u.data("vp-remove-class")),u.data("vp-add-class-full-view")&&(o.classToAddForFullView=u.data("vp-add-class-full-view")),u.data("vp-keep-add-class")&&(o.removeClassAfterAnimation=u.data("vp-remove-after-animation")),u.data("vp-offset")&&(o.offset=u.data("vp-offset")),u.data("vp-repeat")&&(o.repeat=u.data("vp-repeat")),u.data("vp-scrollHorizontal")&&(o.scrollHorizontal=u.data("vp-scrollHorizontal")),u.data("vp-invertBottomOffset")&&(o.scrollHorizontal=u.data("vp-invertBottomOffset")),n.extend(e,i),n.extend(e,o),!u.data("vp-animated")||e.repeat){String(e.offset).indexOf("%")>0&&(e.offset=parseInt(e.offset)/100*r.height);var s=e.scrollHorizontal?u.offset().left:u.offset().top,l=e.scrollHorizontal?s+u.width():s+u.height(),h=Math.round(s)+e.offset,c=e.scrollHorizontal?h+u.width():h+u.height();if(e.invertBottomOffset&&(c-=e.offset*2),h<f&&c>t){if(i.callbackFunctionBeforeAddClass(u),u.removeClass(e.classToRemove),u.addClass(e.classToAdd),e.callbackFunction(u,"add"),l<=f&&s>=t?u.addClass(e.classToAddForFullView):u.removeClass(e.classToAddForFullView),u.data("vp-animated",!0),e.removeClassAfterAnimation)u.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){u.removeClass(e.classToAdd)})}else u.hasClass(e.classToAdd)&&e.repeat&&(u.removeClass(e.classToAdd+" "+e.classToAddForFullView),e.callbackFunction(u,"remove"),u.data("vp-animated",!1))}})},("ontouchstart"in window||"onmsgesturechange"in window)&&n(document).bind("touchmove MSPointerMove pointermove",this.checkElements),n(i.scrollBox).bind("load scroll",this.checkElements),n(window).resize(function(){r={height:n(i.scrollBox).height(),width:n(i.scrollBox).width()};u.checkElements()}),this.checkElements(),this}}(jQuery),function(n){n.fn.jalert=function(t){var i=this,f=n('<div class="alert alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><span><\/span><\/div>'),e=n.extend({},{type:"success",useTitles:!1},t),r=function(n){f.find("> span").html(n);i.append(f)},u=function(n){var t=n=="error"?"danger":n;f.addClass("alert-"+t)};return this.error=function(n){return r(n),u("error"),i},this.success=function(n){return r(n),u("success"),i},this.info=function(n){return r(n),u("info"),i},this.warning=function(n){return r(n),u("warning"),i},this.hide=function(n){return i.slideUp(n),i},this.show=function(){return i.css("display","none"),i.removeClass("hide fade"),i.slideDown(),i},this.autohide=function(n){setTimeout(function(){i.slideUp()},n?n:5e3)},this}}(jQuery),function(n){n.fn.loader=function(t){var r=this,u=n.extend({},{location:"in",img:'<img src="https://s3.amazonaws.com/mg2.paywall.dev/img/ajax-loading.gif" style="margin: 7px auto" />',loaderId:"loader"},t),f=n(u.img).prop("id",u.loaderId),e,i;return this.on=function(){try{i=r.children("span").length?r.children("span"):r;e=i.html();i[0].hasAttribute("data-mg2-submit")&&i.attr("data-mg2-submit","");u.location=="in"&&i.html(f)}catch(n){}},this.off=function(){try{i[0].hasAttribute("data-mg2-submit")&&i.attr("data-mg2-submit","login");i.html(e);f.remove()}catch(n){}},this}}(jQuery);!function(n,t,i){"use strict";"function"==typeof define&&define.amd?define(i):"undefined"!=typeof module&&module.exports?module.exports=i():t.exports?t.exports=i():t[n]=i()}("Fingerprint2",this,function(){"use strict";var n=function(t){if(!(this instanceof n))return new n(t);this.options=this.extend(t,{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",detectScreenOrientation:!0,sortPluginsFor:[/palemoon/i],userDefinedFonts:[]});this.nativeForEach=Array.prototype.forEach;this.nativeMap=Array.prototype.map};return n.prototype={extend:function(n,t){if(null==n)return t;for(var i in n)null!=n[i]&&t[i]!==n[i]&&(t[i]=n[i]);return t},get:function(n){var i=this,t={data:[],push:function(n){var r=n.key,t=n.value;"function"==typeof i.options.preprocessor&&(t=i.options.preprocessor(r,t));this.data.push({key:r,value:t})}};t=this.userAgentKey(t);t=this.languageKey(t);t=this.colorDepthKey(t);t=this.pixelRatioKey(t);t=this.hardwareConcurrencyKey(t);t=this.screenResolutionKey(t);t=this.availableScreenResolutionKey(t);t=this.timezoneOffsetKey(t);t=this.sessionStorageKey(t);t=this.localStorageKey(t);t=this.indexedDbKey(t);t=this.addBehaviorKey(t);t=this.openDatabaseKey(t);t=this.cpuClassKey(t);t=this.platformKey(t);t=this.doNotTrackKey(t);t=this.pluginsKey(t);t=this.canvasKey(t);t=this.webglKey(t);t=this.adBlockKey(t);t=this.hasLiedLanguagesKey(t);t=this.hasLiedResolutionKey(t);t=this.hasLiedOsKey(t);t=this.hasLiedBrowserKey(t);t=this.touchSupportKey(t);t=this.customEntropyFunction(t);this.fontsKey(t,function(t){var r=[],u;return i.each(t.data,function(n){var t=n.value;"undefined"!=typeof n.value.join&&(t=n.value.join(";"));r.push(t)}),u=i.x64hash128(r.join("~~~"),31),n(u,t.data)})},customEntropyFunction:function(n){return"function"==typeof this.options.customFunction&&n.push({key:"custom",value:this.options.customFunction()}),n},userAgentKey:function(n){return this.options.excludeUserAgent||n.push({key:"user_agent",value:this.getUserAgent()}),n},getUserAgent:function(){return navigator.userAgent},languageKey:function(n){return this.options.excludeLanguage||n.push({key:"language",value:navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||""}),n},colorDepthKey:function(n){return this.options.excludeColorDepth||n.push({key:"color_depth",value:screen.colorDepth||-1}),n},pixelRatioKey:function(n){return this.options.excludePixelRatio||n.push({key:"pixel_ratio",value:this.getPixelRatio()}),n},getPixelRatio:function(){return window.devicePixelRatio||""},screenResolutionKey:function(n){return this.options.excludeScreenResolution?n:this.getScreenResolution(n)},getScreenResolution:function(n){var t;return t=this.options.detectScreenOrientation&&screen.height>screen.width?[screen.height,screen.width]:[screen.width,screen.height],"undefined"!=typeof t&&n.push({key:"resolution",value:t}),n},availableScreenResolutionKey:function(n){return this.options.excludeAvailableScreenResolution?n:this.getAvailableScreenResolution(n)},getAvailableScreenResolution:function(n){var t;return screen.availWidth&&screen.availHeight&&(t=this.options.detectScreenOrientation?screen.availHeight>screen.availWidth?[screen.availHeight,screen.availWidth]:[screen.availWidth,screen.availHeight]:[screen.availHeight,screen.availWidth]),"undefined"!=typeof t&&n.push({key:"available_resolution",value:t}),n},timezoneOffsetKey:function(n){return this.options.excludeTimezoneOffset||n.push({key:"timezone_offset",value:(new Date).getTimezoneOffset()}),n},sessionStorageKey:function(n){return!this.options.excludeSessionStorage&&this.hasSessionStorage()&&n.push({key:"session_storage",value:1}),n},localStorageKey:function(n){return!this.options.excludeSessionStorage&&this.hasLocalStorage()&&n.push({key:"local_storage",value:1}),n},indexedDbKey:function(n){return!this.options.excludeIndexedDB&&this.hasIndexedDB()&&n.push({key:"indexed_db",value:1}),n},addBehaviorKey:function(n){return document.body&&!this.options.excludeAddBehavior&&document.body.addBehavior&&n.push({key:"add_behavior",value:1}),n},openDatabaseKey:function(n){return!this.options.excludeOpenDatabase&&window.openDatabase&&n.push({key:"open_database",value:1}),n},cpuClassKey:function(n){return this.options.excludeCpuClass||n.push({key:"cpu_class",value:this.getNavigatorCpuClass()}),n},platformKey:function(n){return this.options.excludePlatform||n.push({key:"navigator_platform",value:this.getNavigatorPlatform()}),n},doNotTrackKey:function(n){return this.options.excludeDoNotTrack||n.push({key:"do_not_track",value:this.getDoNotTrack()}),n},canvasKey:function(n){return!this.options.excludeCanvas&&this.isCanvasSupported()&&n.push({key:"canvas",value:this.getCanvasFp()}),n},webglKey:function(n){return this.options.excludeWebGL?n:this.isWebGlSupported()?(n.push({key:"webgl",value:this.getWebglFp()}),n):n},adBlockKey:function(n){return this.options.excludeAdBlock||n.push({key:"adblock",value:this.getAdBlock()}),n},hasLiedLanguagesKey:function(n){return this.options.excludeHasLiedLanguages||n.push({key:"has_lied_languages",value:this.getHasLiedLanguages()}),n},hasLiedResolutionKey:function(n){return this.options.excludeHasLiedResolution||n.push({key:"has_lied_resolution",value:this.getHasLiedResolution()}),n},hasLiedOsKey:function(n){return this.options.excludeHasLiedOs||n.push({key:"has_lied_os",value:this.getHasLiedOs()}),n},hasLiedBrowserKey:function(n){return this.options.excludeHasLiedBrowser||n.push({key:"has_lied_browser",value:this.getHasLiedBrowser()}),n},fontsKey:function(n,t){return this.options.excludeJsFonts?this.flashFontsKey(n,t):this.jsFontsKey(n,t)},flashFontsKey:function(n,t){return this.options.excludeFlashFonts?t(n):this.hasSwfObjectLoaded()&&this.hasMinFlashInstalled()?"undefined"==typeof this.options.swfPath?t(n):void this.loadSwfAndDetectFonts(function(i){n.push({key:"swf_fonts",value:i.join(";")});t(n)}):t(n)},jsFontsKey:function(n,t){var i=this;return setTimeout(function(){var r=["monospace","sans-serif","serif"],u=["Andale Mono","Arial","Arial Black","Arial Hebrew","Arial MT","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Bitstream Vera Sans Mono","Book Antiqua","Bookman Old Style","Calibri","Cambria","Cambria Math","Century","Century Gothic","Century Schoolbook","Comic Sans","Comic Sans MS","Consolas","Courier","Courier New","Garamond","Geneva","Georgia","Helvetica","Helvetica Neue","Impact","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","LUCIDA GRANDE","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Microsoft Sans Serif","Monaco","Monotype Corsiva","MS Gothic","MS Outlook","MS PGothic","MS Reference Sans Serif","MS Sans Serif","MS Serif","MYRIAD","MYRIAD PRO","Palatino","Palatino Linotype","Segoe Print","Segoe Script","Segoe UI","Segoe UI Light","Segoe UI Semibold","Segoe UI Symbol","Tahoma","Times","Times New Roman","Times New Roman PS","Trebuchet MS","Verdana","Wingdings","Wingdings 2","Wingdings 3"],f,y,p;i.options.extendedJsFonts&&(u=u.concat(["Abadi MT Condensed Light","Academy Engraved LET","ADOBE CASLON PRO","Adobe Garamond","ADOBE GARAMOND PRO","Agency FB","Aharoni","Albertus Extra Bold","Albertus Medium","Algerian","Amazone BT","American Typewriter","American Typewriter Condensed","AmerType Md BT","Andalus","Angsana New","AngsanaUPC","Antique Olive","Aparajita","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Arabic Typesetting","ARCHER","ARNO PRO","Arrus BT","Aurora Cn BT","AvantGarde Bk BT","AvantGarde Md BT","AVENIR","Ayuthaya","Bandy","Bangla Sangam MN","Bank Gothic","BankGothic Md BT","Baskerville","Baskerville Old Face","Batang","BatangChe","Bauer Bodoni","Bauhaus 93","Bazooka","Bell MT","Bembo","Benguiat Bk BT","Berlin Sans FB","Berlin Sans FB Demi","Bernard MT Condensed","BernhardFashion BT","BernhardMod BT","Big Caslon","BinnerD","Blackadder ITC","BlairMdITC TT","Bodoni 72","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni MT","Bodoni MT Black","Bodoni MT Condensed","Bodoni MT Poster Compressed","Bookshelf Symbol 7","Boulder","Bradley Hand","Bradley Hand ITC","Bremen Bd BT","Britannic Bold","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Californian FB","Calisto MT","Calligrapher","Candara","CaslonOpnface BT","Castellar","Centaur","Cezanne","CG Omega","CG Times","Chalkboard","Chalkboard SE","Chalkduster","Charlesworth","Charter Bd BT","Charter BT","Chaucer","ChelthmITC Bk BT","Chiller","Clarendon","Clarendon Condensed","CloisterBlack BT","Cochin","Colonna MT","Constantia","Cooper Black","Copperplate","Copperplate Gothic","Copperplate Gothic Bold","Copperplate Gothic Light","CopperplGoth Bd BT","Corbel","Cordia New","CordiaUPC","Cornerstone","Coronet","Cuckoo","Curlz MT","DaunPenh","Dauphin","David","DB LCD Temp","DELICIOUS","Denmark","DFKai-SB","Didot","DilleniaUPC","DIN","DokChampa","Dotum","DotumChe","Ebrima","Edwardian Script ITC","Elephant","English 111 Vivace BT","Engravers MT","EngraversGothic BT","Eras Bold ITC","Eras Demi ITC","Eras Light ITC","Eras Medium ITC","EucrosiaUPC","Euphemia","Euphemia UCAS","EUROSTILE","Exotc350 Bd BT","FangSong","Felix Titling","Fixedsys","FONTIN","Footlight MT Light","Forte","FrankRuehl","Fransiscan","Freefrm721 Blk BT","FreesiaUPC","Freestyle Script","French Script MT","FrnkGothITC Bk BT","Fruitger","FRUTIGER","Futura","Futura Bk BT","Futura Lt BT","Futura Md BT","Futura ZBlk BT","FuturaBlack BT","Gabriola","Galliard BT","Gautami","Geeza Pro","Geometr231 BT","Geometr231 Hv BT","Geometr231 Lt BT","GeoSlab 703 Lt BT","GeoSlab 703 XBd BT","Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed","Gisha","Gloucester MT Extra Condensed","GOTHAM","GOTHAM BOLD","Goudy Old Style","Goudy Stout","GoudyHandtooled BT","GoudyOLSt BT","Gujarati Sangam MN","Gulim","GulimChe","Gungsuh","GungsuhChe","Gurmukhi MN","Haettenschweiler","Harlow Solid Italic","Harrington","Heather","Heiti SC","Heiti TC","HELV","Herald","High Tower Text","Hiragino Kaku Gothic ProN","Hiragino Mincho ProN","Hoefler Text","Humanst 521 Cn BT","Humanst521 BT","Humanst521 Lt BT","Imprint MT Shadow","Incised901 Bd BT","Incised901 BT","Incised901 Lt BT","INCONSOLATA","Informal Roman","Informal011 BT","INTERSTATE","IrisUPC","Iskoola Pota","JasmineUPC","Jazz LET","Jenson","Jester","Jokerman","Juice ITC","Kabel Bk BT","Kabel Ult BT","Kailasa","KaiTi","Kalinga","Kannada Sangam MN","Kartika","Kaufmann Bd BT","Kaufmann BT","Khmer UI","KodchiangUPC","Kokila","Korinna BT","Kristen ITC","Krungthep","Kunstler Script","Lao UI","Latha","Leelawadee","Letter Gothic","Levenim MT","LilyUPC","Lithograph","Lithograph Light","Long Island","Lydian BT","Magneto","Maiandra GD","Malayalam Sangam MN","Malgun Gothic","Mangal","Marigold","Marion","Marker Felt","Market","Marlett","Matisse ITC","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Minion","Minion Pro","Miriam","Miriam Fixed","Mistral","Modern","Modern No. 20","Mona Lisa Solid ITC TT","Mongolian Baiti","MONO","MoolBoran","Mrs Eaves","MS LineDraw","MS Mincho","MS PMincho","MS Reference Specialty","MS UI Gothic","MT Extra","MUSEO","MV Boli","Nadeem","Narkisim","NEVIS","News Gothic","News GothicMT","NewsGoth BT","Niagara Engraved","Niagara Solid","Noteworthy","NSimSun","Nyala","OCR A Extended","Old Century","Old English Text MT","Onyx","Onyx BT","OPTIMA","Oriya Sangam MN","OSAKA","OzHandicraft BT","Palace Script MT","Papyrus","Parchment","Party LET","Pegasus","Perpetua","Perpetua Titling MT","PetitaBold","Pickwick","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Poor Richard","Poster","PosterBodoni BT","PRINCETOWN LET","Pristina","PTBarnum BT","Pythagoras","Raavi","Rage Italic","Ravie","Ribbon131 Bd BT","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Roman","Sakkal Majalla","Santa Fe LET","Savoye LET","Sceptre","Script","Script MT Bold","SCRIPTINA","Serifa","Serifa BT","Serifa Th BT","ShelleyVolante BT","Sherwood","Shonar Bangla","Showcard Gothic","Shruti","Signboard","SILKSCREEN","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sinhala Sangam MN","Sketch Rockwell","Skia","Small Fonts","Snap ITC","Snell Roundhand","Socket","Souvenir Lt BT","Staccato222 BT","Steamer","Stencil","Storybook","Styllo","Subway","Swis721 BlkEx BT","Swiss911 XCm BT","Sylfaen","Synchro LET","System","Tamil Sangam MN","Technical","Teletype","Telugu Sangam MN","Tempus Sans ITC","Terminal","Thonburi","Traditional Arabic","Trajan","TRAJAN PRO","Tristan","Tubular","Tunga","Tw Cen MT","Tw Cen MT Condensed","Tw Cen MT Condensed Extra Bold","TypoUpright BT","Unicorn","Univers","Univers CE 55 Medium","Univers Condensed","Utsaah","Vagabond","Vani","Vijaya","Viner Hand ITC","VisualUI","Vivaldi","Vladimir Script","Vrinda","Westminster","WHITNEY","Wide Latin","ZapfEllipt BT","ZapfHumnst BT","ZapfHumnst Dm BT","Zapfino","Zurich BlkEx BT","Zurich Ex BT","ZWAdobeF"]));u=u.concat(i.options.userDefinedFonts);var b="mmmmmmmmmmlli",k="72px",e=document.getElementsByTagName("body")[0],s=document.createElement("div"),h=document.createElement("div"),c={},l={},a=function(){var n=document.createElement("span");return n.style.position="absolute",n.style.left="-9999px",n.style.fontSize=k,n.style.lineHeight="normal",n.innerHTML=b,n},d=function(n,t){var i=a();return i.style.fontFamily="'"+n+"',"+t,i},g=function(){for(var n,i=[],t=0,u=r.length;t<u;t++)n=a(),n.style.fontFamily=r[t],s.appendChild(n),i.push(n);return i},nt=function(){for(var i,f={},n=0,o=u.length;n<o;n++){for(var e=[],t=0,s=r.length;t<s;t++)i=d(u[n],r[t]),h.appendChild(i),e.push(i);f[u[n]]=e}return f},tt=function(n){for(var i=!1,t=0;t<r.length;t++)if(i=n[t].offsetWidth!==c[r[t]]||n[t].offsetHeight!==l[r[t]])return i;return i},v=g();for(e.appendChild(s),f=0,y=r.length;f<y;f++)c[r[f]]=v[f].offsetWidth,l[r[f]]=v[f].offsetHeight;p=nt();e.appendChild(h);for(var w=[],o=0,it=u.length;o<it;o++)tt(p[u[o]])&&w.push(u[o]);e.removeChild(h);e.removeChild(s);n.push({key:"js_fonts",value:w});t(n)},1)},pluginsKey:function(n){return this.options.excludePlugins||(this.isIE()?this.options.excludeIEPlugins||n.push({key:"ie_plugins",value:this.getIEPlugins()}):n.push({key:"regular_plugins",value:this.getRegularPlugins()})),n},getRegularPlugins:function(){for(var n=[],t=0,i=navigator.plugins.length;t<i;t++)n.push(navigator.plugins[t]);return this.pluginsShouldBeSorted()&&(n=n.sort(function(n,t){return n.name>t.name?1:n.name<t.name?-1:0})),this.map(n,function(n){var t=this.map(n,function(n){return[n.type,n.suffixes].join("~")}).join(",");return[n.name,n.description,t].join("::")},this)},getIEPlugins:function(){var n=[],t;return(Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window)&&(t=["AcroPDF.PDF","Adodb.Stream","AgControl.AgControl","DevalVRXCtrl.DevalVRXCtrl.1","MacromediaFlashPaper.MacromediaFlashPaper","Msxml2.DOMDocument","Msxml2.XMLHTTP","PDF.PdfCtrl","QuickTime.QuickTime","QuickTimeCheckObject.QuickTimeCheck.1","RealPlayer","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","Scripting.Dictionary","SWCtl.SWCtl","Shell.UIHelper","ShockwaveFlash.ShockwaveFlash","Skype.Detection","TDCCtl.TDCCtl","WMPlayer.OCX","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1"],n=this.map(t,function(n){try{return new ActiveXObject(n),n}catch(t){return null}})),navigator.plugins&&(n=n.concat(this.getRegularPlugins())),n},pluginsShouldBeSorted:function(){for(var i,t=!1,n=0,r=this.options.sortPluginsFor.length;n<r;n++)if(i=this.options.sortPluginsFor[n],navigator.userAgent.match(i)){t=!0;break}return t},touchSupportKey:function(n){return this.options.excludeTouchSupport||n.push({key:"touch_support",value:this.getTouchSupport()}),n},hardwareConcurrencyKey:function(n){return this.options.excludeHardwareConcurrency||n.push({key:"hardware_concurrency",value:this.getHardwareConcurrency()}),n},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(n){return!0}},hasLocalStorage:function(){try{return!!window.localStorage}catch(n){return!0}},hasIndexedDB:function(){try{return!!window.indexedDB}catch(n){return!0}},getHardwareConcurrency:function(){return navigator.hardwareConcurrency?navigator.hardwareConcurrency:"unknown"},getNavigatorCpuClass:function(){return navigator.cpuClass?navigator.cpuClass:"unknown"},getNavigatorPlatform:function(){return navigator.platform?navigator.platform:"unknown"},getDoNotTrack:function(){return navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:"unknown"},getTouchSupport:function(){var n=0,t=!1,i;"undefined"!=typeof navigator.maxTouchPoints?n=navigator.maxTouchPoints:"undefined"!=typeof navigator.msMaxTouchPoints&&(n=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent");t=!0}catch(r){}return i="ontouchstart"in window,[n,t,i]},getCanvasFp:function(){var i=[],t=document.createElement("canvas"),n;return t.width=2e3,t.height=200,t.style.display="inline",n=t.getContext("2d"),n.rect(0,0,10,10),n.rect(2,2,6,6),i.push("canvas winding:"+(n.isPointInPath(5,5,"evenodd")===!1?"yes":"no")),n.textBaseline="alphabetic",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.font=this.options.dontUseFakeFontInCanvas?"11pt Arial":"11pt no-real-font-123",n.fillText("Cwm fjordbank glyphs vext quiz, ",2,15),n.fillStyle="rgba(102, 204, 0, 0.2)",n.font="18pt Arial",n.fillText("Cwm fjordbank glyphs vext quiz, ",4,45),n.globalCompositeOperation="multiply",n.fillStyle="rgb(255,0,255)",n.beginPath(),n.arc(50,50,50,0,2*Math.PI,!0),n.closePath(),n.fill(),n.fillStyle="rgb(0,255,255)",n.beginPath(),n.arc(100,50,50,0,2*Math.PI,!0),n.closePath(),n.fill(),n.fillStyle="rgb(255,255,0)",n.beginPath(),n.arc(75,100,50,0,2*Math.PI,!0),n.closePath(),n.fill(),n.fillStyle="rgb(255,0,255)",n.arc(75,75,75,0,2*Math.PI,!0),n.arc(75,75,25,0,2*Math.PI,!0),n.fill("evenodd"),i.push("canvas fp:"+t.toDataURL()),i.join("~")},getWebglFp:function(){var n,o=function(t){return n.clearColor(0,0,0,1),n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),"["+t[0]+", "+t[1]+"]"},h=function(n){var t,i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic");return i?(t=n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT),0===t&&(t=2),t):null},s,i,u,f,e;if(n=this.getWebglCanvas(),!n)return null;var t=[],r=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,r);s=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);n.bufferData(n.ARRAY_BUFFER,s,n.STATIC_DRAW);r.itemSize=3;r.numItems=3;i=n.createProgram();u=n.createShader(n.VERTEX_SHADER);n.shaderSource(u,"attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}");n.compileShader(u);f=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(f,"precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}");n.compileShader(f);n.attachShader(i,u);n.attachShader(i,f);n.linkProgram(i);n.useProgram(i);i.vertexPosAttrib=n.getAttribLocation(i,"attrVertex");i.offsetUniform=n.getUniformLocation(i,"uniformOffset");n.enableVertexAttribArray(i.vertexPosArray);n.vertexAttribPointer(i.vertexPosAttrib,r.itemSize,n.FLOAT,!1,0,0);n.uniform2f(i.offsetUniform,1,1);n.drawArrays(n.TRIANGLE_STRIP,0,r.numItems);null!=n.canvas&&t.push(n.canvas.toDataURL());t.push("extensions:"+n.getSupportedExtensions().join(";"));t.push("webgl aliased line width range:"+o(n.getParameter(n.ALIASED_LINE_WIDTH_RANGE)));t.push("webgl aliased point size range:"+o(n.getParameter(n.ALIASED_POINT_SIZE_RANGE)));t.push("webgl alpha bits:"+n.getParameter(n.ALPHA_BITS));t.push("webgl antialiasing:"+(n.getContextAttributes().antialias?"yes":"no"));t.push("webgl blue bits:"+n.getParameter(n.BLUE_BITS));t.push("webgl depth bits:"+n.getParameter(n.DEPTH_BITS));t.push("webgl green bits:"+n.getParameter(n.GREEN_BITS));t.push("webgl max anisotropy:"+h(n));t.push("webgl max combined texture image units:"+n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS));t.push("webgl max cube map texture size:"+n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE));t.push("webgl max fragment uniform vectors:"+n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS));t.push("webgl max render buffer size:"+n.getParameter(n.MAX_RENDERBUFFER_SIZE));t.push("webgl max texture image units:"+n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS));t.push("webgl max texture size:"+n.getParameter(n.MAX_TEXTURE_SIZE));t.push("webgl max varying vectors:"+n.getParameter(n.MAX_VARYING_VECTORS));t.push("webgl max vertex attribs:"+n.getParameter(n.MAX_VERTEX_ATTRIBS));t.push("webgl max vertex texture image units:"+n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS));t.push("webgl max vertex uniform vectors:"+n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS));t.push("webgl max viewport dims:"+o(n.getParameter(n.MAX_VIEWPORT_DIMS)));t.push("webgl red bits:"+n.getParameter(n.RED_BITS));t.push("webgl renderer:"+n.getParameter(n.RENDERER));t.push("webgl shading language version:"+n.getParameter(n.SHADING_LANGUAGE_VERSION));t.push("webgl stencil bits:"+n.getParameter(n.STENCIL_BITS));t.push("webgl vendor:"+n.getParameter(n.VENDOR));t.push("webgl version:"+n.getParameter(n.VERSION));try{e=n.getExtension("WEBGL_debug_renderer_info");e&&(t.push("webgl unmasked vendor:"+n.getParameter(e.UNMASKED_VENDOR_WEBGL)),t.push("webgl unmasked renderer:"+n.getParameter(e.UNMASKED_RENDERER_WEBGL)))}catch(c){}return n.getShaderPrecisionFormat?(t.push("webgl vertex shader high float precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision),t.push("webgl vertex shader high float precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).rangeMin),t.push("webgl vertex shader high float precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).rangeMax),t.push("webgl vertex shader medium float precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision),t.push("webgl vertex shader medium float precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).rangeMin),t.push("webgl vertex shader medium float precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).rangeMax),t.push("webgl vertex shader low float precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).precision),t.push("webgl vertex shader low float precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).rangeMin),t.push("webgl vertex shader low float precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_FLOAT).rangeMax),t.push("webgl fragment shader high float precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision),t.push("webgl fragment shader high float precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).rangeMin),t.push("webgl fragment shader high float precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).rangeMax),t.push("webgl fragment shader medium float precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision),t.push("webgl fragment shader medium float precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).rangeMin),t.push("webgl fragment shader medium float precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).rangeMax),t.push("webgl fragment shader low float precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).precision),t.push("webgl fragment shader low float precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).rangeMin),t.push("webgl fragment shader low float precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_FLOAT).rangeMax),t.push("webgl vertex shader high int precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).precision),t.push("webgl vertex shader high int precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).rangeMin),t.push("webgl vertex shader high int precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_INT).rangeMax),t.push("webgl vertex shader medium int precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).precision),t.push("webgl vertex shader medium int precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).rangeMin),t.push("webgl vertex shader medium int precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_INT).rangeMax),t.push("webgl vertex shader low int precision:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).precision),t.push("webgl vertex shader low int precision rangeMin:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).rangeMin),t.push("webgl vertex shader low int precision rangeMax:"+n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.LOW_INT).rangeMax),t.push("webgl fragment shader high int precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).precision),t.push("webgl fragment shader high int precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).rangeMin),t.push("webgl fragment shader high int precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_INT).rangeMax),t.push("webgl fragment shader medium int precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).precision),t.push("webgl fragment shader medium int precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).rangeMin),t.push("webgl fragment shader medium int precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_INT).rangeMax),t.push("webgl fragment shader low int precision:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).precision),t.push("webgl fragment shader low int precision rangeMin:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).rangeMin),t.push("webgl fragment shader low int precision rangeMax:"+n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.LOW_INT).rangeMax),t.join("~")):t.join("~")},getAdBlock:function(){var n=document.createElement("div"),t;n.innerHTML="&nbsp;";n.className="adsbox";t=!1;try{document.body.appendChild(n);t=0===document.getElementsByClassName("adsbox")[0].offsetHeight;document.body.removeChild(n)}catch(i){t=!1}return t},getHasLiedLanguages:function(){if("undefined"!=typeof navigator.languages)try{var n=navigator.languages[0].substr(0,2);if(n!==navigator.language.substr(0,2))return!0}catch(t){return!0}return!1},getHasLiedResolution:function(){return screen.width<screen.availWidth||screen.height<screen.availHeight},getHasLiedOs:function(){var n,r=navigator.userAgent.toLowerCase(),i=navigator.oscpu,t=navigator.platform.toLowerCase(),u;return(n=r.indexOf("windows phone")>=0?"Windows Phone":r.indexOf("win")>=0?"Windows":r.indexOf("android")>=0?"Android":r.indexOf("linux")>=0?"Linux":r.indexOf("iphone")>=0||r.indexOf("ipad")>=0?"iOS":r.indexOf("mac")>=0?"Mac":"Other",u="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,u&&"Windows Phone"!==n&&"Android"!==n&&"iOS"!==n&&"Other"!==n)?!0:"undefined"!=typeof i&&((i=i.toLowerCase(),i.indexOf("win")>=0&&"Windows"!==n&&"Windows Phone"!==n)||i.indexOf("linux")>=0&&"Linux"!==n&&"Android"!==n||i.indexOf("mac")>=0&&"Mac"!==n&&"iOS"!==n||0===i.indexOf("win")&&0===i.indexOf("linux")&&i.indexOf("mac")>=0&&"other"!==n)?!0:t.indexOf("win")>=0&&"Windows"!==n&&"Windows Phone"!==n||(t.indexOf("linux")>=0||t.indexOf("android")>=0||t.indexOf("pike")>=0)&&"Linux"!==n&&"Android"!==n||(t.indexOf("mac")>=0||t.indexOf("ipad")>=0||t.indexOf("ipod")>=0||t.indexOf("iphone")>=0)&&"Mac"!==n&&"iOS"!==n||0===t.indexOf("win")&&0===t.indexOf("linux")&&t.indexOf("mac")>=0&&"other"!==n||"undefined"==typeof navigator.plugins&&"Windows"!==n&&"Windows Phone"!==n},getHasLiedBrowser:function(){var n,t=navigator.userAgent.toLowerCase(),u=navigator.productSub,i,r;if((n=t.indexOf("firefox")>=0?"Firefox":t.indexOf("opera")>=0||t.indexOf("opr")>=0?"Opera":t.indexOf("chrome")>=0?"Chrome":t.indexOf("safari")>=0?"Safari":t.indexOf("trident")>=0?"Internet Explorer":"Other",("Chrome"===n||"Safari"===n||"Opera"===n)&&"20030107"!==u)||(i=eval.toString().length,37===i&&"Safari"!==n&&"Firefox"!==n&&"Other"!==n)||39===i&&"Internet Explorer"!==n&&"Other"!==n||33===i&&"Chrome"!==n&&"Opera"!==n&&"Other"!==n)return!0;try{throw"a";}catch(f){try{f.toSource();r=!0}catch(e){r=!1}}return!(!r||"Firefox"===n||"Other"===n)},isCanvasSupported:function(){var n=document.createElement("canvas");return!(!n.getContext||!n.getContext("2d"))},isWebGlSupported:function(){if(!this.isCanvasSupported())return!1;var n,t=document.createElement("canvas");try{n=t.getContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(i){n=!1}return!!window.WebGLRenderingContext&&!!n},isIE:function(){return"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent))},hasSwfObjectLoaded:function(){return"undefined"!=typeof swfobject},hasMinFlashInstalled:function(){return swfobject.hasFlashPlayerVersion("9.0.0")},addFlashDivNode:function(){var n=document.createElement("div");n.setAttribute("id",this.options.swfContainerId);document.body.appendChild(n)},loadSwfAndDetectFonts:function(n){var t="___fp_swf_loaded",i,r,u;window[t]=function(t){n(t)};i=this.options.swfContainerId;this.addFlashDivNode();r={onReady:t};u={allowScriptAccess:"always",menu:"false"};swfobject.embedSWF(this.options.swfPath,i,"1","1","9.0.0",!1,r,u,{})},getWebglCanvas:function(){var t=document.createElement("canvas"),n=null;try{n=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(i){}return n||(n=null),n},each:function(n,t,i){var r,f,u;if(null!==n)if(this.nativeForEach&&n.forEach===this.nativeForEach)n.forEach(t,i);else if(n.length===+n.length){for(r=0,f=n.length;r<f;r++)if(t.call(i,n[r],r,n)==={})return}else for(u in n)if(n.hasOwnProperty(u)&&t.call(i,n[u],u,n)==={})return},map:function(n,t,i){var r=[];return null==n?r:this.nativeMap&&n.map===this.nativeMap?n.map(t,i):(this.each(n,function(n,u,f){r[r.length]=t.call(i,n,u,f)}),r)},x64Add:function(n,t){n=[n[0]>>>16,65535&n[0],n[1]>>>16,65535&n[1]];t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var i=[0,0,0,0];return i[3]+=n[3]+t[3],i[2]+=i[3]>>>16,i[3]&=65535,i[2]+=n[2]+t[2],i[1]+=i[2]>>>16,i[2]&=65535,i[1]+=n[1]+t[1],i[0]+=i[1]>>>16,i[1]&=65535,i[0]+=n[0]+t[0],i[0]&=65535,[i[0]<<16|i[1],i[2]<<16|i[3]]},x64Multiply:function(n,t){n=[n[0]>>>16,65535&n[0],n[1]>>>16,65535&n[1]];t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var i=[0,0,0,0];return i[3]+=n[3]*t[3],i[2]+=i[3]>>>16,i[3]&=65535,i[2]+=n[2]*t[3],i[1]+=i[2]>>>16,i[2]&=65535,i[2]+=n[3]*t[2],i[1]+=i[2]>>>16,i[2]&=65535,i[1]+=n[1]*t[3],i[0]+=i[1]>>>16,i[1]&=65535,i[1]+=n[2]*t[2],i[0]+=i[1]>>>16,i[1]&=65535,i[1]+=n[3]*t[1],i[0]+=i[1]>>>16,i[1]&=65535,i[0]+=n[0]*t[3]+n[1]*t[2]+n[2]*t[1]+n[3]*t[0],i[0]&=65535,[i[0]<<16|i[1],i[2]<<16|i[3]]},x64Rotl:function(n,t){return t%=64,32===t?[n[1],n[0]]:t<32?[n[0]<<t|n[1]>>>32-t,n[1]<<t|n[0]>>>32-t]:(t-=32,[n[1]<<t|n[0]>>>32-t,n[0]<<t|n[1]>>>32-t])},x64LeftShift:function(n,t){return t%=64,0===t?n:t<32?[n[0]<<t|n[1]>>>32-t,n[1]<<t]:[n[1]<<t-32,0]},x64Xor:function(n,t){return[n[0]^t[0],n[1]^t[1]]},x64Fmix:function(n){return n=this.x64Xor(n,[0,n[0]>>>1]),n=this.x64Multiply(n,[4283543511,3981806797]),n=this.x64Xor(n,[0,n[0]>>>1]),n=this.x64Multiply(n,[3301882366,444984403]),n=this.x64Xor(n,[0,n[0]>>>1])},x64hash128:function(n,t){n=n||"";t=t||0;for(var h=n.length%16,c=n.length-h,f=[0,t],e=[0,t],r=[0,0],u=[0,0],o=[2277735313,289559509],s=[1291169091,658871167],i=0;i<c;i+=16)r=[255&n.charCodeAt(i+4)|(255&n.charCodeAt(i+5))<<8|(255&n.charCodeAt(i+6))<<16|(255&n.charCodeAt(i+7))<<24,255&n.charCodeAt(i)|(255&n.charCodeAt(i+1))<<8|(255&n.charCodeAt(i+2))<<16|(255&n.charCodeAt(i+3))<<24],u=[255&n.charCodeAt(i+12)|(255&n.charCodeAt(i+13))<<8|(255&n.charCodeAt(i+14))<<16|(255&n.charCodeAt(i+15))<<24,255&n.charCodeAt(i+8)|(255&n.charCodeAt(i+9))<<8|(255&n.charCodeAt(i+10))<<16|(255&n.charCodeAt(i+11))<<24],r=this.x64Multiply(r,o),r=this.x64Rotl(r,31),r=this.x64Multiply(r,s),f=this.x64Xor(f,r),f=this.x64Rotl(f,27),f=this.x64Add(f,e),f=this.x64Add(this.x64Multiply(f,[0,5]),[0,1390208809]),u=this.x64Multiply(u,s),u=this.x64Rotl(u,33),u=this.x64Multiply(u,o),e=this.x64Xor(e,u),e=this.x64Rotl(e,31),e=this.x64Add(e,f),e=this.x64Add(this.x64Multiply(e,[0,5]),[0,944331445]);switch(r=[0,0],u=[0,0],h){case 15:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+14)],48));case 14:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+13)],40));case 13:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+12)],32));case 12:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+11)],24));case 11:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+10)],16));case 10:u=this.x64Xor(u,this.x64LeftShift([0,n.charCodeAt(i+9)],8));case 9:u=this.x64Xor(u,[0,n.charCodeAt(i+8)]);u=this.x64Multiply(u,s);u=this.x64Rotl(u,33);u=this.x64Multiply(u,o);e=this.x64Xor(e,u);case 8:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+7)],56));case 7:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+6)],48));case 6:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+5)],40));case 5:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+4)],32));case 4:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+3)],24));case 3:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+2)],16));case 2:r=this.x64Xor(r,this.x64LeftShift([0,n.charCodeAt(i+1)],8));case 1:r=this.x64Xor(r,[0,n.charCodeAt(i)]);r=this.x64Multiply(r,o);r=this.x64Rotl(r,31);r=this.x64Multiply(r,s);f=this.x64Xor(f,r)}return f=this.x64Xor(f,[0,n.length]),e=this.x64Xor(e,[0,n.length]),f=this.x64Add(f,e),e=this.x64Add(e,f),f=this.x64Fmix(f),e=this.x64Fmix(e),f=this.x64Add(f,e),e=this.x64Add(e,f),("00000000"+(f[0]>>>0).toString(16)).slice(-8)+("00000000"+(f[1]>>>0).toString(16)).slice(-8)+("00000000"+(e[0]>>>0).toString(16)).slice(-8)+("00000000"+(e[1]>>>0).toString(16)).slice(-8)}},n.VERSION="1.5.1",n});var Fprinting=function(){function u(){var r=jQuery.Deferred(),u=t(n.cookieName),f;return u==null||u==""?e().Desktop?new Fingerprint2({excludeIndexedDB:!0,excludeLanguage:!0,excludeScreenResolution:!0,excludeAdBlock:!0,excludeDoNotTrack:!0,preprocessor:function(t,i){return n.optionsWithCustomLogic[t]!=undefined?n.optionsWithCustomLogic[t](i):i}}).get(function(n){i(n);r.resolve(n)}):(f=o(),i(f),r.resolve(f)):r.resolve(u),r.promise()}function f(t,i){var r=new Date,u;r.setTime(r.getTime()+n.expireDays*864e5);u="expires="+r.toUTCString();document.cookie=t+"="+i+";"+u+";path=/"}function t(n){for(var t,r=n+"=",f=decodeURIComponent(document.cookie),u=f.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}function i(t){f(n.cookieName,t)}function e(){function t(n){return i.indexOf(n)!==-1}var i=window.navigator.userAgent.toLowerCase(),n={};return n.ios=function(){return n.iphone()||n.ipod()||n.ipad()},n.iphone=function(){return!n.windows()&&t("iphone")},n.ipod=function(){return t("ipod")},n.ipad=function(){return t("ipad")},n.android=function(){return!n.windows()&&t("android")},n.androidPhone=function(){return n.android()&&t("mobile")},n.androidTablet=function(){return n.android()&&!t("mobile")},n.blackberry=function(){return t("blackberry")||t("bb10")||t("rim")},n.blackberryPhone=function(){return n.blackberry()&&!t("tablet")},n.blackberryTablet=function(){return n.blackberry()&&t("tablet")},n.windows=function(){return t("windows")},n.windowsPhone=function(){return n.windows()&&t("phone")},n.windowsTablet=function(){return n.windows()&&t("touch")&&!n.windowsPhone()},n.fxos=function(){return(t("(mobile;")||t("(tablet;"))&&t("; rv:")},n.fxosPhone=function(){return n.fxos()&&t("mobile")},n.fxosTablet=function(){return n.fxos()&&t("tablet")},n.meego=function(){return t("meego")},n.cordova=function(){return window.cordova&&location.protocol==="file:"},n.nodeWebkit=function(){return typeof process=="object"},n.mobile=function(){return n.androidPhone()||n.iphone()||n.ipod()||n.windowsPhone()||n.blackberryPhone()||n.fxosPhone()||n.meego()},n.tablet=function(){return n.ipad()||n.androidTablet()||n.blackberryTablet()||n.windowsTablet()||n.fxosTablet()},n.desktop=function(){return!n.tablet()&&!n.mobile()},{Mobile:n.mobile(),Tablet:n.tablet(),Desktop:n.desktop()}}function o(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()+n()+n()+n()+n()}var r=function(n){return n.replace(/\/[0-9.]{1,}/g,"")},n={cookieName:"anonDeviceId",expireDays:36500,optionsWithCustomLogic:{user_agent:r}};return{init:u,getDeviceId:function(){return t(n.cookieName)}}},ConnextLogger=function(n){var r=!0,t=function(){var i;try{var r=Array.prototype.slice.call(arguments[2]),u=arguments[0],e=arguments[1],o=r.length,f=[],t=[];o>0&&n.each(r,function(n,i){typeof i=="string"?f.push(i):t.push(i)});i=e+f.join(" => ");t.length>0?console[u](i,t):console[u](i)}catch(s){}},i=function(){return r||localStorage.tellMeYourSecrets=="sure"};return{debug:function(){i()&&t("log","Connext >>>> DEBUG <<<<< ",arguments)},log:function(){i()&&t("log","Connext >>>> LOG <<<<< ",arguments)},info:function(){i()&&t("info","Connext >>>> INFO <<<<< ",arguments)},warn:function(){t("warn","Connext >>>> WARN <<<<< ",arguments)},error:function(){i()&&t("exception","MG2Connext >>>> ERROR <<<<< ",arguments)},exception:function(){i()&&t("error","MG2Connext >>>> EXCEPTION <<<<< ",arguments)},setDebug:function(n){r=n}}},ConnextCommon=function(){return{S3RootUrl:{localhost:"https://mg2assetsdev.blob.core.windows.net/connext/dev/",dev:"https://mg2assetsdev.blob.core.windows.net/connext/dev/",test:"https://mg2assetsdev.blob.core.windows.net/connext/test/",demo:"https://prodmg2.blob.core.windows.net/connext/demo/",stage:"https://prodmg2.blob.core.windows.net/connext/stage/",test20:"https://prodmg2.blob.core.windows.net/connext/test20/",prod:"https://prodmg2.blob.core.windows.net/connext/prod/",preprod:"https://prodmg2.blob.core.windows.net/connext/preprod/"},S3LastPublishDatePath:"data/last_publish/<%= siteCode %>.json",CSSPluginUrl:{localhost:"http://localhost:20001/plugin/assets/css/themes/",dev:"https://mg2assetsdev.blob.core.windows.net/connext/dev/1.7/themes/",test:"https://mg2assetsdev.blob.core.windows.net/connext/test/1.7/themes/",stage:"https://prodmg2.blob.core.windows.net/connext/stage/1.7/themes/",demo:"https://prodmg2.blob.core.windows.net/connext/demo/1.7/themes/",test20:"https://prodmg2.blob.core.windows.net/connext/test20/1.7/themes/",prod:"https://cdn.mg2connext.com/prod/1.6/themes/",preprod:"https://cdn.mg2connext.com/preprod/1.6/themes/"},APIUrl:{localhost:"https://stage-mng-proxy-connext.azurewebsites.net/",dev:"https://dev-connext-api.azurewebsites.net/",test:"https://test-connext-api.azurewebsites.net/",stage:"https://stage-mng-proxy-connext.azurewebsites.net/",test20:"https://test20-connext-api.azurewebsites.net/",demo:"https://demo-connext-api.azurewebsites.net/",preprod:"https://preprod-connext-api.azurewebsites.net/",prod:"{{apiUrl}}"},APPInsightKeys:{localhost:"a57959cf-5e4d-4ab3-8a3e-d17f7e2a8bf8",dev:"a57959cf-5e4d-4ab3-8a3e-d17f7e2a8bf8",test:"c35138a3-3d28-4543-9a47-b693ce4d744e",stage:"17780e8e-a865-44bd-a20d-4f50f5f38ddb",test20:"adbc9fed-bb63-4105-8904-61ade12b2006",preprod:"34e4d18d-cb50-44e5-88bc-f26520e5d4c3",demo:"e336d95f-e0ab-48a9-956e-1d79f6fd5fe8",prod:"1819964f-57a2-45c2-b878-c270d7e5d1d9"},Environments:["localhost","dev","test","stage","demo","prod","test20"],IPInfo:window.location.protocol+"//api-mg2.db-ip.com/v2/p14891b727f063924f0d86d8a8e5063678abd2ac/self",StorageKeys:{configuration:"Connext_Configuration",userToken:"Connext_UserToken",janrainUserProfile:"janrainCaptureProfileData",accessToken:"Connext_AccessToken",viewedArticles:"Connext_ViewedArticles",lastPublishDate:"Connext_LastPublishDate",conversations:{current:"Connext_CurrentConversations",previous:"Connext_PreviousConversations"},user:{state:"Connext_UserState",zipCodes:"Connext_UserZipCodes",data:"Connext_userData"},configurationSiteCode:"Connext_Configuration_SiteCode",configurationConfigCode:"Connext_Configuration_ConfigCode",configurationIsCustom:"Connext_Configuration_isCustom",customZip:"CustomZip",repeatablesInConv:"repeatablesInConv",igmRegID:"igmRegID",igmContent:"igmContent",connext_user_Id:"connext_anonymousUserId",WhitelistSet:"WhitelistSet",WhitelistInfobox:"WhitelistInfobox",NeedHidePinTemplate:"NeedHidePinTemplate",connext_user_profile:"connext_user_profile",connext_user_data:"connext_user_data",connext_paywallFired:"connext_paywallFired",connext_auth_type:"connext_auth_type",connext_viewstructure:"connext_viewstructure",connext_userLastUpdateDate:"connext_userLastUpdateDate",device_postfix:"_device",geolocationInfo:"geolocationInfo"},MeterLevels:{1:"Free",2:"Metered",3:"Premium"},ConversationOptionMap:{2:"Time",6:"Register",11:"CustomAction",27:"UserState",32:"JSVar",38:"Activate"},ActionOptionMap:{Who:[5,6,14,16,17,18,19,21,23,24,25,12,27,28,29],What:[2,7,13,20,15,22,26],When:[8,9,10]},WhenClassMap:{8:"Time",9:"EOS",10:"Hover"},DefaultArticleFormat:"MMM Do, YYYY",QualifierMap:{"==":"==","=":"==",Equal:"==",Equals:"==","Not Equal":"!=","Not Equals":"!=","More Than":">","Less Than":">","More Or Equal Than":">=","Less Or Equal Than":"<=",Yes:"true",No:"false","More Than Or Equals To":">=","Less Than Or Equals To":"<="},ERROR:{NO_CONFIG:{code:600,message:"No Configuration Found"},NO_CONVO_FOUND:{code:601,message:"No Conversation found to process."}},DownloadConfigReasons:{noLocalConfig:"localStorage config not found",noLocalPublishDate:"localStorage config found, no publishDate found",getPublishFailed:"localStorage config found, error getting server publishFile",parsePublishFailed:"localStorage config found, server publishFile downloaded, error parsing",noConfigCodeinPublish:"localStorage config found, server publishFile downloaded and parsed, configCode not found",oldConfig:"localStorage config found, server publishFile downloaded and parsed, configCode found, local config is old"},AppInsightEvents:{APICall:"APICall",LoadConnext:"LoadConnext"},RegistrationTypes:{1:"MG2",2:"Janrain",3:"GUP",4:"Auth0",5:"Custom"},DigitalAccessLevels:{Premium:"PREMIUM",Upgrade:"UPGRADE",Purchase:"PURCHASE"},USER_STATES:{NotLoggedIn:"Logged Out",LoggedIn:"Logged In",NoActiveSubscription:"No Active Subscription",SubscribedNotEntitled:"Subscribed Not Entitled",Subscribed:"Subscribed"},ValidationPatterns:{email:/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i,atLeast1Letter1Number:/(?=.*[a-zA-Z])(?=.*[\d])/,atLeast1Letter:/(?=.*[a-zA-Z])/,atLeast1CapitalLetter:/(?=.*[a-zA-Z])/,atLeast1LowerCaseLetter:/(?=.*[a-z])/,atLeast1UpperCaseLetter:/(?=.*[A-Z])/,atLeast1SpecialCharacter:/(?=.*[!@#$%^&*])/,atLeast1Number:/(?=.*[\d])/},TimeTypeMap:{m:"minutes",h:"hours",d:"days",w:"weeks",M:"months",Y:"years"},DisplayName:"ConneXt",InfinityDate:"9999-01-01",CookieExpireDate:"2018-02-28"}},ConnextEvents=function(n){function r(i){var r="onDebugNote";try{h.push(i);n("#ddNote").html(i)}catch(u){t.error(r,"EXCEPTION",u)}}function a(n){var i="onInit";try{t.debug("Fire Default onInit function.",n)}catch(n){t.error(i,"EXCEPTION",n)}}function v(n){var r="onFlittzPaywallShown";try{n.EventData.conversation=CnnXt.Storage.GetCurrentConversation();n.EventData.viewCount=CnnXt.Campaign.GetCurrentConversationViewCount();n.EventData.hasFlittz=i.integrateFlittz;window.CommonFz.PushData("Connext-onFlittzPaywallShown",n);t.debug("Flittz paywall shown",n)}catch(f){t.error(u,r,"EXCEPTION",f)}}function y(n){var r="onFlittzPaywallClosed";try{n.EventData.conversation=CnnXt.Storage.GetCurrentConversation();n.EventData.viewCount=CnnXt.Campaign.GetCurrentConversationViewCount();n.EventData.hasFlittz=i.integrateFlittz;window.CommonFz.PushData("Connext-onFlittzPaywallClosed",n);t.debug("Flittz paywall closed",n)}catch(u){t.error(r,"EXCEPTION",u)}}function p(n){var r="onFlittzButtonClick";try{n.EventData.conversation=CnnXt.Storage.GetCurrentConversation();n.EventData.viewCount=CnnXt.Campaign.GetCurrentConversationViewCount();n.EventData.hasFlittz=i.integrateFlittz;window.CommonFz.PushData("Connext-onFlittzButtonClick",n);t.debug("Click on Flittz button",n)}catch(u){t.error(r,"EXCEPTION",u)}}function w(i){var r="onCriticalError";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onCriticalError function.",i),h.push(i.EventData.message),n("#ddNote").html(i.EventData.message))}catch(u){t.error(r,"EXCEPTION",u)}}function b(i){var r="onDynamicMeterFound";try{t.debug("Fire Default onDynamicMeterFound function.",i);n("#ddMeterSet").html(i.EventData)}catch(f){t.error(u,r,"EXCEPTION",f)}}function k(i){var r="onMeterLevelSet";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onMeterLevelSet function.",i),n("#ddMeterLevel").html(CnnXt.Common.MeterLevels[i.EventData.level]+" ("+i.EventData.method+")"));CnnXt.Storage.SetMeter(i.EventData)}catch(u){t.error(r,"EXCEPTION",u)}}function d(n){var i="onLoggedIn";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onLoggedIn function.",n),r(n))}catch(n){t.error(i,"EXCEPTION",n)}}function g(n){var i="onHasAccess";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onHasAccess function.",n),r(n.EventData))}catch(u){t.error(i,"EXCEPTION",u)}}function nt(n){var i="onHasAccessNotEntitled";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onHasAccessNotEntitled function.",n),r(n.EventData))}catch(u){t.error(i,"EXCEPTION",u)}}function tt(n){var i="onHasNoActiveSubscription";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onHasNoActiveSubscription function.",n),r(n.EventData))}catch(u){t.error(i,"EXCEPTION",u)}}function it(n){var i="onAuthorized";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onAuthorized function.",n),r(n.EventData))}catch(u){t.error(i,"EXCEPTION",u)}}function rt(n){var i="onNotAuthorized";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onNotAuthorized function.",n),r(n.EventData))}catch(u){t.error(i,"EXCEPTION",u)}}function ut(i){var r="onCampaignFound";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onCampaignFound function.",i),n("#ddCampaign").html(i.EventData.Name))}catch(u){t.error(r,"EXCEPTION",u)}}function ft(i){var r="onConversationDetermined";try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onConversationDetermined function.",i),n("#ddCurrentConversation").html(i.EventData.Name),n.jStorage.get("uniqueArticles")?n("#ddCurrentConversationArticleViews").html(CnnXt.Storage.GetViewedArticles(i.EventData.id).length):n("#ddCurrentConversationArticleViews").html(i.EventData.Props.views))}catch(u){t.error(r,"EXCEPTION",u)}}function et(n){var r="onActionShown";try{t.debug("Fire Default onActionShown",n);n&&n.EventData&&n.EventData.actionDom&&n.EventData.actionDom.hasClass("flittz")&&i.integrateFlittz&&CnnXt.Event.fire("onFlittzPaywallShown",n.EventData);n&&n.EventData.ActionTypeId==3&&CnnXt.Storage.SetConnextPaywallCookie(!0);CnnXt.Action.actionStartTime=Date.now()}catch(u){t.error(r,"EXCEPTION",u)}}function ot(i){var u="onActionClosed",r;try{CnnXt.GetOptions().debug&&(t.debug("Fire Default onActionClosed",i),CnnXt.Action.actionEndTime=Date.now(),r=CnnXt.Action.actionEndTime-CnnXt.Action.actionStartTime,n("#ddViewTime")[0].textContent=r+"ms",i&&i.EventData&&i.EventData.When&&i.EventData.When.Time&&CnnXt.Action.SetTimedAction(i.EventData))}catch(f){t.error(u,"EXCEPTION",f)}}function st(n){var i="onButtonClick";try{t.debug("Fire Default onButtonClick",n)}catch(r){t.error(i,"EXCEPTION",r)}}function ht(n){var i="onAccessTemplateShown";try{t.debug("Fire Default onAccessTemplateShown",n)}catch(r){t.error(i,"EXCEPTION",r)}}function ct(n){var i="onAccessTemplateClosed";try{t.debug("Fire Default onAccessTemplateClosed",n)}catch(r){t.error(i,"EXCEPTION",r)}}function lt(n){var i="onAccessGranted";try{t.debug("Fire Default onAccessGranted",n)}catch(r){t.error(i,"EXCEPTION",r)}}function at(n){var i="onAccessDenied";try{t.debug("Fire Default onAccessDenied",n)}catch(r){t.error(i,"EXCEPTION",r)}}function vt(n){var i="onActivationFormShown";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function yt(n){var i="onActivationLoginStepShown";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function pt(n){var i="onActivationLoginStepClosed";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function wt(n){var i="onActivationLinkStepShown";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function bt(n){var i="onActivationLinkStepClosed";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function kt(n){var i="onActivationLinkStepSubmitted";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function dt(n){var i="onActivationLinkSuccessStepShown";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function gt(n){var i="onActivationLinkSuccessStepClosed";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function ni(n){var i="onActivationLinkErrorStepShown";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function ti(n){var i="onActivationLinkErrorStepClosed";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function ii(n){t.debug("Fire Default onNewsdayButtonClick",n);window.setDestUrl&&_.isFunction(window.setDestUrl)&&window.setDestUrl()}function ri(n){var i="onActivationFormClosed";try{t.debug("Fire Default "+i,n)}catch(r){t.error(i,"EXCEPTION",r)}}function ui(){t.debug("Fire Default onRun",event)}function fi(){t.debug("Fire Default onFinish",event)}var u="Events";const c=["onDynamicMeterFound","onCampaignFound","onHasAccess","onHasAccessNotEntitled","onHasNoActiveSubscription","onAuthorized","onDebugNote"];var i,t,e,f=null,o=null,s={onMeterLevelSet:k,onDynamicMeterFound:b,onCampaignFound:ut,onConversationDetermined:ft,onHasAccess:g,onHasAccessNotEntitled:nt,onHasNoActiveSubscription:tt,onCriticalError:w,onAuthorized:it,onLoggedIn:d,onNotAuthorized:rt,onDebugNote:r,onActionShown:et,onActionClosed:ot,onInit:a,onButtonClick:st,onRun:ui,onFinish:fi,onAccessTemplateShown:ht,onAccessTemplateClosed:ct,onAccessGranted:lt,onAccessDenied:at,onFlittzPaywallShown:v,onFlittzPaywallClosed:y,onFlittzButtonClick:p,onActivationFormShown:vt,onActivationLoginStepShown:yt,onActivationLoginStepClosed:pt,onActivationLinkStepShown:wt,onActivationLinkStepClosed:bt,onActivationLinkStepSubmitted:kt,onActivationLinkSuccessStepShown:dt,onActivationLinkSuccessStepClosed:gt,onActivationLinkErrorStepShown:ni,onActivationLinkErrorStepClosed:ti,onActivationFormClosed:ri,onNewsdayButtonClick:ii},h=[],l=function(){var n="Init";try{t.debug(u,n,"Initializing Events...")}catch(i){t.error(n,i)}};return{init:function(n){t=CnnXt.Logger;i=n?n:{debug:!0};l()},fire:function(r,u){var v="fire",h,y,a,p,l,w;try{if(h={EventData:u},r=="onMeterLevelSet"&&(f=u.level,o=u.method),y=null,a=null,Connext.Storage.GetLocalConfiguration()&&(y=Connext.Storage.GetLocalConfiguration().Site.RegistrationTypeId,a=CnnXt.Common.RegistrationTypes[y]),r=="onLoggedIn"&&(a=u.AuthSystem?u.AuthSystem:"",e=u.MG2AccountData?u.MG2AccountData:""),h.AuthSystem=a,h.AuthProfile=CnnXt.Storage.GetUserProfile(),h.MG2AccountData=e,l=CnnXt.Storage.GetCurrentConversation(),l&&(u&&(u.actionId||u.id)&&(p=u.actionId?_.findWhere(l.Actions,{id:u.actionId}):_.findWhere(l.Actions,{id:u.id})),h.Config=CnnXt.Storage.GetLocalConfiguration(),h.Action=p,h.Conversation=l,h.CampaignName=h.Config.Campaign.Name,h.CampaignId=l.CampaignId,h.MeterLevel=CnnXt.Common.MeterLevels[f],h.MeterLevelId=f,h.MeterLevelMethod=o),_.isObject(h.EventData)&&((r=="onActionShown"||r=="onActionClosed")&&(h.EventData.ArticlesLeft=l.Props.ArticleLeft,h.EventData.ArticlesViewed=l.Props.views,h.EventData.ZipCodes=CnnXt.Storage.GetActualZipCodes()),r=="onButtonClick"&&(h.EventData={DOMEvent:h.EventData,ButtonHTML:CnnXt.Utils.GetElementHTML(h.EventData.target),UserDefinedDataAttr:n(h.EventData.target).attr("data-connext-userdefined"),ZipCodes:CnnXt.Storage.GetActualZipCodes(),ArticlesLeft:l?l.Props.ArticleLeft:undefined,ArticlesViewed:l?l.Props.views:undefined}),u&&u.What&&(h.EventData.UserDefinedData=u.What.UserDefinedData?u.What.UserDefinedData:null)),h.Config=CnnXt.Storage.GetLocalConfiguration(),_.isFunction(s[r])){s[r](h);try{_.isFunction(i[r])&&i[r](h)}catch(b){t.error(v,"on","EXCEPTION",b)}w=new CustomEvent(r,{detail:h});document.dispatchEvent(w);c.indexOf(r)===-1&&CnnXt.AppInsights.trackEvent(r,h)}else t.debug(v,r,"Event function does not exist")}catch(b){t.warn(v,"on","EXCEPTION")}}}},ConnextUtils=function(n){function ot(n){var f=!1,t,i,r,u;if(typeof n=="string"&&(t=n.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/),t)){for(i=[],r=1;r<t.length;r++)u=parseInt(t[r]),u>=0&&u<=255&&i.push(u);i.length===4&&(f=h(i))}return f}function s(n){var t=!1;return typeof n=="number"&&isFinite(n)&&(t=o(n&4294967295).join(".")),t}function o(n){return[n>>>24&255,n>>>16&255,n>>>8&255,n>>>0&255]}function h(n){return((n[0]*256+n[1])*256+n[2])*256+n[3]}function st(n){return n?-1<<32-n:0}function ht(n,t){for(var r=o(n),f=o(t),u=[],i=0;i<r.length;i++)u.push(r[i]&f[i]);return h(u)}var r="Utils",i,f,u={},t,e,c=function(n){var u="processConfiguration",t;try{return i.debug(r,u,"starting to process..."),f=n.Site,t={},t.Settings=_.pick(n,"AccessRules","Active","Code","DefaultMeterLevel","CampaignId","DynamicMeterId","Name","LastPublishDate","Settings","UseParentDomain","ActivationTemplate","DefaultProduct","ReturnUrl","UseActivationFlow"),n.DynamicMeter&&(CnnXt.Event.fire("onDynamicMeterFound",n.DynamicMeter.Name),n.DynamicMeter.Rules=_.sortBy(n.DynamicMeter.Rules,function(n){return n.Priority}),t.DynamicMeter=k(n.DynamicMeter)),t.Settings&&(t.Settings=l(t.Settings),t.Settings.LoginModal=n.Template?n.Template.Html:""),t.Site=n.Site,n.Campaign&&(t.Campaign=a(n.Campaign)),t.WhitelistSets=n.WhitelistSets,i.debug(r,u,"done processing configuration",t),t}catch(e){i.log(r,u,"EXCEPTION",e)}},l=function(n){var t="checkForLastPublishDate";try{return n.LastPublishDate||(i.warn(r,t,"Configuration.Settings.LastPublishDate is null...setting it to todays datetime."),n.LastPublishDate=(new Date).format()),n}catch(u){return i.error(r,t,"EXCEPTION",u),n}},a=function(n){var u="processCampaignData",t;try{return i.debug(r,u),t=_.pick(n,"id","Name","Conversations"),t.Conversations=v(t.Conversations),i.debug(r,u,"processedCampaign",t),t}catch(f){i.log(r,u,"EXCEPTION",f)}},v=function(t){var u="processConversationData",f,e;try{return i.debug(r,u,"conversations",t),f={paywallLimit:null,isExpired:!1,expiredReason:null,Date:{started:null,ended:null,expiration:null}},n.each(t,function(t,e){i.debug(r,u,"conversations.EACH",t,e);var s=_.groupBy(e.Options,function(n){return n.ConversationOption.ParentConversationOptionId}),o={};n.each(s,function(t,r){i.info("GROUPEDOPTIONS.EACH",t,r);var u={};n.each(r,function(n,t){u[t.ConversationOption.DisplayName]=t.Value});o[CnnXt.Common.ConversationOptionMap[t]]=u});e.Options={Expirations:o};e.Props=f;e.Actions=y(e.Actions)}),t=_.sortBy(t,"Order"),e=_.groupBy(t,"MeterLevelId"),_.replaceObjKeysByMap(e,CnnXt.Common.MeterLevels)}catch(o){i.error(r,u,"EXCEPTION",o)}},y=function(t){var u="processConversationActions";try{return n.each(t,function(i,r){var u=f.Client.Client_ActionOption_Exceptions;n.each(u,function(n,t){r.ActionOptionValues=_.reject(r.ActionOptionValues,function(n){return n.ActionOptionId==t.ActionOptionId||n.ActionOption.ActionOptionParentId==t.ActionOptionId})});var e=_.filter(r.ActionOptionValues,function(n){return _.contains(CnnXt.Common.ActionOptionMap.Who,n.ActionOption.ClassId)}),o=_.filter(r.ActionOptionValues,function(n){return _.contains(CnnXt.Common.ActionOptionMap.What,n.ActionOption.ClassId)}),s=_.filter(r.ActionOptionValues,function(n){return _.contains(CnnXt.Common.ActionOptionMap.When,n.ActionOption.ClassId)});r.Who=p(e);r.What=w(o);r.When=b(s);t[i]=_.omit(r,"ActionOptionValues")}),_.sortBy(t,"Order")}catch(e){i.error(r,u,"EXCEPTION",e)}},p=function(t){var o="processWhoOptions";try{var u={},f=[],e=_.groupBy(t,function(n){return n.ActionOption.ActionOptionParentId});return n.each(e,function(t){var i=_.groupBy(e[t],"CriteriaInstanceNumber");n.each(i,function(n){f.push(i[n])})}),f.forEach(function(n){var i={},t=n[0].ActionOption.Action_OptionClass.Name;n.forEach(function(n){var t=n.ActionOption.DisplayName;t=t.replace(n.ActionOption.ActionOptionParentId,"");i[t]=n.Value});u[t]&&u[t].length?u[t].push(i):u[t]=[i]}),u}catch(s){i.error(r,o,"EXCEPTION",s)}},w=function(t){var s="processWhatOptions";try{var f={},o=CnnXt.Utils.getDeviceType(),h=_.groupBy(t,"CriteriaInstanceNumber"),u={},e=[];return n.each(h,function(n,t){var i;t.forEach(function(t){t.ActionOption.Name=="TemplateDeviceSettings"&&(i=t);n==1&&(t.ActionOption.Name=="ActionType"&&e.push(t),t.ActionOption.Name=="UserDefinedData"&&e.push(t))});i?u[i.Value]=t:u.Default=t}),u[o]?u[o].forEach(function(n){f[n.ActionOption.DisplayName]=n.Value}):u.Default&&u.Default.forEach(function(n){f[n.ActionOption.DisplayName]=n.Value}),e.forEach(function(n){f[n.ActionOption.DisplayName]=n.Value}),f}catch(c){i.error(r,s,"EXCEPTION",c)}},b=function(t){var e="processWhenOptions",u,f;try{return u={},f={},n.each(t,function(n,t){f[t.ActionOption.DisplayName]=t.Value}),t&&t.length&&(u[CnnXt.Common.WhenClassMap[t[0].ActionOption.ClassId]]=f),u}catch(o){i.error(r,e,"EXCEPTION",o)}},k=function(t){var u="processDynamicMeter";try{return i.debug(r,u,t),n.each(t.Rules,function(t,i){n.each(i.Segments,function(t,r){var o=_.find(r.SegmentOptionValues,function(n){return n.SegmentOption.ClassId!=null}).SegmentOption.Segment_OptionClass.Name,u={},s=f.Client.Client_SegmentOption_Exceptions,e;n.each(s,function(n,u){e=_.reject(r.SegmentOptionValues,function(n){return n.SegmentOptionId==u.SegmentOptionId||n.SegmentOption.SegmentOptionParentId==u.SegmentOptionId});e.length!=r.SegmentOptionValues.length&&(i.Segments[t]=null)});i.Segments[t]!=null&&(n.each(r.SegmentOptionValues,function(n,t){var i=t.SegmentOption.DisplayName;i=i.replace(t.SegmentOption.SegmentOptionParentId,"");u[i]=t.Value}),r.Options=u,r.SegmentType=o,i.Segments[t]=_.omit(r,"SegmentOptionValues"))});i.Segments=_.filter(i.Segments,function(n){return n!=null})}),t}catch(e){i.error(r,u,"EXCEPTION",e)}},d=function(t){var u="mergeConfiguration",e,f;try{i.debug(r,u,"newConfig",t);CnnXt.Storage.SetLocalConfiguration(t);e=CnnXt.Storage.GetCurrentConversations();i.debug(r,u,"CurrentConversations",e);f={};n.each(e,function(e,o){i.debug(r,u,"currentConversations.EACH",e,o);var s=_.findByKey(t.Campaign.Conversations[e],{id:o.id});i.debug(r,u,"currentConversations.EACH","foundStoredConvo",s);s&&(f[e]=n.extend({},s),f[e].Props=o.Props)});CnnXt.Storage.SetCurrentConversations(f)}catch(o){i.error(r,u,"EXCEPTION",o)}},g=function(){var i=n("#ConnextSiteCode").val(),r=n("#ConnextConfigCode").val(),t=n("#ConnextCustomConfiguration").prop("checked");t&&(CnnXt.Storage.ClearConfigSettings(),CnnXt.Storage.SetSiteCode(i),CnnXt.Storage.SetConfigCode(r.toUpperCase()),CnnXt.Storage.SetIsCustomConfiguration(t))},nt=function(){var u="handleDebugDetails",t,f;try{try{t=n("<link>");n("head").append(t);t.attr({rel:"stylesheet",type:"text/css",href:"https://mg2assetsdev.blob.core.windows.net/connext/assets/connext-debug-panels.min.css"});f='<div class="debug_details opened" style="left: 0;"><div class="debug_details_icon">&nbsp;<\/div><div class="debug_details_content"><h4>Debug Details<\/h4><ul><li class="debug_details_header hide_on_mobile"><label>Meter Level: <strong id="ddMeterLevel">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>Meter Set: <strong id="ddMeterSet">...<\/strong><\/label><label>Campaign: <strong id="ddCampaign">...<\/strong><\/label><label>Conversation: <strong id="ddCurrentConversation">...<\/strong><\/label><label>Article Views: <strong id="ddCurrentConversationArticleViews">...<\/strong><\/label><label>Articles Left: <strong id="ddCurrentConversationArticleLeft">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>View Time: <strong id="ddViewTime">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>Current Zip: <strong id="ddZipCode">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>Auth Time: <strong id="ddAuthTime">...<\/strong><\/label><label>Processing Time: <strong id="ddProcessingTime">...<\/strong><\/label><label>Total Time: <strong id="ddTotalProcessingTime">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><label>Note: <strong id="ddNote">...<\/strong><\/label><\/li><li class="debug_details_header hide_on_mobile"><div id="ConnextCustomConfigurationDiv"><label for="ConnextSiteCode">Site code: <\/label><input type="text" id="ConnextSiteCode"><label for="ConnextConfigCode">Config code: <\/label><input type="text" id="ConnextConfigCode"><a href="#" class="more highlight margin_top_15" id="ConnextSetCustomConfiguration">Set configuration<\/a><\/div><label class="overlay_label check" for="ConnextCustomConfiguration">Use custom configuration: <\/label> <input type="checkbox" id="ConnextCustomConfiguration"><label class="overlay_label check" for="ConnextCustomConfiguration">Unique Articles Count: <\/label> <input type="checkbox" id="uniqueArticles"><\/li><li class="debug_details_header" > <label class="overlay_label check">AnonymousId: <\/label> <input type="text" id="connext_anonymousId" style="\r\n    width: 47px; */\r\n    padding:;\r\n    padding: 5px 1px;\r\n"><a href="#" class="more highlight margin_top_15" id="connext_anonymousIdApplyBtn" style="\r\n    padding: 4px 13px;\r\n    width: 35px;\r\n    margin-left: 10px;\r\n    display: inline;\r\n">Set<\/a><\/li><li class="debug_details_header hide_on_mobile"><label for="ConnextCustomTimeChk" class="overlay_label check">Custom Time: <\/label> <input type="checkbox" id="ConnextCustomTimeChk"><div id="ConnextCustomTimeDiv"><input type="text" id="ConnextCustomTimeTxt" placeholder="MM/DD/YYYY" value="" name="name" class="text_input hint"><a href="#" class="more highlight margin_top_15" id="ConnextSetCustomTimeBtn">Set<\/a><\/div><\/li><li class="debug_details_header hide_on_mobile"><a href="#" class="more highlight margin_top_15" id="connextClearAllData">Clear All Data<\/a><\/li><\/ul><\/div><\/div>';n("body").append(f);n("#ConnextSetCustomConfiguration").on("click",g);n(".debug_details_icon").on("click",tt);n("#connextClearAllData").on("click",it);ut();rt();n("#ddZipCode").html(CnnXt.Storage.GetActualZipCodes());n.jStorage.get("uniqueArticles")&&n("#uniqueArticles").attr("checked","checked");n("#ConnextCustomConfiguration").on("change",function(){var t=n(this);t.prop("checked")?n("#ConnextCustomConfigurationDiv").show():(n("#ConnextCustomConfigurationDiv").hide(),CnnXt.Storage.SetIsCustomConfiguration(!1))});n("#ConnextCustomTimeChk").on("change",function(){var t=n(this);t.prop("checked")?n("#ConnextCustomTimeDiv").show():(n("#ConnextCustomTimeDiv").hide(),n.jStorage.deleteKey("CustomTime"))});n("#uniqueArticles").on("change",function(){var t=n(this);n.jStorage.set("uniqueArticles",t.prop("checked"))});n("#ConnextSetCustomTimeBtn").on("click",function(t){t.preventDefault();n.jStorage.set("CustomTime",n("#ConnextCustomTimeTxt").val())})}catch(o){i.error(r,u,"CreateDebugDetailPanel")}}catch(e){i.error(r,u,"EXCEPTION",e)}},tt=function(t){var f="handleDebugDetailsDisplayClick",u;try{t.preventDefault();u=n(this).parent("div");u.toggleClass("opened")}catch(t){i.error(r,f,"EXCEPTION",t)}},it=function(n){var t="clearAllSettings";try{n.preventDefault();i.debug(r,t,"clearAllSettings");CnnXt.Storage.GetLocalConfiguration()&&(CnnXt.API.DeleteViewsByUserId(),CnnXt.API.ClearServerCache(),CnnXt.Storage.ResetConversationViews(CnnXt.Storage.GetCurrentConversation(),CnnXt.GetOptions().configSettings.UseParentDomain),CnnXt.Storage.SetRegistrationType({}),CnnXt.Storage.ClearConfigSettings())}catch(n){i.error(r,t,"EXCEPTION",n)}},rt=function(){CnnXt.Storage.GetIsCustomConfiguration()?n("#ConnextCustomConfigurationDiv").show():n("#ConnextCustomConfigurationDiv").hide()},ut=function(){var t="handleCustomTime";try{n.jStorage.get("CustomTime")?(n("#ConnextCustomTimeChk").prop("checked",!0),n("#ConnextCustomTimeTxt").val(n.jStorage.get("CustomTime")),n("#ConnextCustomTimeDiv").show()):(n("#ConnextCustomTimeChk").prop("checked",!1),n("#ConnextCustomTimeDiv").hide(),n("#ConnextCustomTimeTxt").val(new Date))}catch(u){i.error(r,t,"EXCEPTION",u)}},ft=function(n){return n.replace(/([a-zA-Z])[^a-zA-Z]*$/,function(n){var t=n.charCodeAt(0);switch(t){case 90:return"A";case 122:return"a";default:return String.fromCharCode(++t)}})},et=function(){var n,i;t={};i=window.navigator.userAgent.toLowerCase();t.ios=function(){return t.iphone()||t.ipod()||t.ipad()};t.iphone=function(){return!t.windows()&&n("iphone")};t.ipod=function(){return n("ipod")};t.ipad=function(){return n("ipad")};t.android=function(){return!t.windows()&&n("android")};t.androidPhone=function(){return t.android()&&n("mobile")};t.androidTablet=function(){return t.android()&&!n("mobile")};t.blackberry=function(){return n("blackberry")||n("bb10")||n("rim")};t.blackberryPhone=function(){return t.blackberry()&&!n("tablet")};t.blackberryTablet=function(){return t.blackberry()&&n("tablet")};t.windows=function(){return n("windows")};t.windowsPhone=function(){return t.windows()&&n("phone")};t.windowsTablet=function(){return t.windows()&&n("touch")&&!t.windowsPhone()};t.fxos=function(){return(n("(mobile;")||n("(tablet;"))&&n("; rv:")};t.fxosPhone=function(){return t.fxos()&&n("mobile")};t.fxosTablet=function(){return t.fxos()&&n("tablet")};t.meego=function(){return n("meego")};t.cordova=function(){return window.cordova&&location.protocol==="file:"};t.nodeWebkit=function(){return typeof process=="object"};t.mobile=function(){return t.androidPhone()||t.iphone()||t.ipod()||t.windowsPhone()||t.blackberryPhone()||t.fxosPhone()||t.meego()};t.tablet=function(){return t.ipad()||t.androidTablet()||t.blackberryTablet()||t.windowsTablet()||t.fxosTablet()};t.desktop=function(){return!t.tablet()&&!t.mobile()};n=function(n){return i.indexOf(n)!==-1};t.mobile()?u.deviceType="Mobile":t.tablet()?u.deviceType="Tablet":t.desktop()&&(u.deviceType="Desktop");t.ios()?u.OS="IOS":t.windows()?u.OS="windows":t.android()?u.OS="android":t.blackberry()?u.OS="blackberry":t.fxos()&&(u.OS="fxos");u.Browser=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))!=-1?"Opera":navigator.userAgent.indexOf("Chrome")!=-1?"Chrome":navigator.userAgent.indexOf("Safari")!=-1?"Safari":navigator.userAgent.indexOf("Firefox")!=-1?"Firefox":navigator.userAgent.indexOf("MSIE")!=-1||!!document.documentMode==!0?"IE":"unknown";u.URL=window.location.href};return{init:function(){i=CnnXt.Logger;et();String.prototype.replaceAt=function(n,t){return this.substr(0,n)+t+this.substr(n+t.length)}},Now:function(){try{return n.jStorage.get("CustomTime")?new Date(Date.parse(n.jStorage.get("CustomTime"))):new Date}catch(t){i.error(r,"Now",t)}},ProcessConfiguration:function(n){return c(n)},MergeConfiguration:function(n){d(n)},CreateDebugDetailPanel:function(){nt()},GetUrlParam:function(n){for(var u=window.location.search.substring(1),i,r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]==n)return unescape(i[1]);return null},GetQueryStringParams:function(n){var u=window.location.search.slice(1).split("&"),i={},f=!1,e={},r,t;for(_.isArray(n)&&(f=!0,n.forEach(function(n){e[n]=!0})),r=u.length-1;r>=0;r--)if(t=[],u[r])if(t=u[r].split("="),f){if(e[t[0]])try{i[t[0]]=decodeURIComponent(t.slice(1).join("="))}catch(o){i[t[0]]=""}}else try{i[t[0]]=decodeURIComponent(t.slice(1).join("="))}catch(o){i[t[0]]=""}return i},GetActivationUrlParams:function(){return CnnXt.Utils.GetQueryStringParams(["email","subscriptionNumber","productCode","returnUrl"])},GetProductCode:function(){var i=CnnXt.GetOptions(),t=(CnnXt.Storage.GetLocalConfiguration()||{}).Settings,r=CnnXt.Utils.GetActivationUrlParams(),n=null;return n=r.productCode,n||(n=i.productCode),n||(n=t?t.DefaultProduct:null),n},ParseCustomDate:function(n,t){if(t=t||"dd.mm.yyyy",!n)return new Date;var r=n.match(/(\d+)/g),u=0,i={};return t.replace(/(yyyy|dd|mm)/g,function(n){i[n]=u++}),new Date(r[i.yyyy],r[i.mm]-1,r[i.dd])},ParseCustomDates:function(n){var t=null;return _.isString(n)&&(t=n.replace(/(\d+)([a-zA-Z,()\\";?]+)/,"$1 "),t=Date.parse(t)),new Date(t)},Diff:function(n,t){var i=+n-+t;return parseInt(i/864e5)},GetUrl:function(){return location.protocol+"//"+location.host+location.pathname},GetHiddenFormFieldValue:function(t){try{var u=n("#"+t).val();return i.debug(r,"GetHiddenFormFieldValue","hidValue",u),u}catch(f){return i.error(r,"GetHiddenFormFieldValue",f),""}},JSEvaluate:function(n,t,u){try{var o=arguments[3]?arguments[3]+" ---- ":"",s=arguments[4]?arguments[4]:"string",e=CnnXt.Utils.FixQualifier(t),f=s=="string"?"'"+n+"'"+e+"'"+u+"'":""+n+""+e+""+u+"";return eval(f)?(i.debug(r,"JSEvalute --- <<<<< "+f," >>>>> ---- PASSES"),!0):(i.debug(r,o+"JSEvalute --- <<<<< "+f," >>>>> ---- FAILS"),!1)}catch(h){return i.warn(r,"JSEvaluate",h),!1}},GetNextLetter:function(n){return ft(n)},FixQualifier:function(n){try{var t=CnnXt.Common.QualifierMap[n];return t?t:n}catch(u){return i.error(r,null,"EXCEPTION",u),n}},getFileName:function(){var n=arguments[0]?arguments[0]:window.location.href;return n.substring(n.lastIndexOf("/")+1)},getCurPageName:function(){return location.pathname.substring(1)},HangleMatherTool:function(){var t=n("#connext_anonymousId"),i=n("#connext_anonymousIdApplyBtn");localStorage._matherAnonId&&t.val(localStorage._matherAnonId);i.on("click",function(){var n=t.val();n&&(localStorage._matherAnonId=n)})},getParam:function(n){for(var u=window.location.search.substring(1),i,r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]==n)return unescape(i[1]);return null},hasParam:function(n){for(var f=window.location.search.substring(1),i,u=f.split("&"),r,t=0;t<u.length;t++)if(i=u[t].split("="),i[0]==n)return r=unescape(i[1]),r.length>0&&typeof r=="string"?!0:!1;return!1},EncryptAccessToken:function(){for(var n,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i="",r=0;r<64;r++)n=Math.floor(Math.random()*t.length),i+=t.substring(n,n+1);return i},getScreenSize:function(){var t=n(window).width();return window.screen&&(t=window.screen.width),t},getDeviceType:function(){return u.deviceType},DetectEnvironment:function(){var n="prod";return~location.hostname.indexOf("localhost")?n="localhost":~location.hostname.indexOf("dev.")?n="dev":~location.hostname.indexOf("test.")?n="test":~location.hostname.indexOf("test20.")?n="test20":~location.hostname.indexOf("demo.")?n="demo":~location.hostname.indexOf("stage.")?n="stage":~location.hostname.indexOf("preprod.")&&(n="preprod"),n},GetViewedArticlesCookiesName:function(){var n=CnnXt.Storage.GetLocalConfiguration(),t=CnnXt.Common.StorageKeys.connext_viewstructure+"_"+n.Site.SiteCode.toUpperCase()+"_"+n.Settings.Code.toUpperCase()+"_"+CnnXt.GetOptions().environment.toUpperCase();return n.Settings.UseParentDomain||(t="sub_"+t),t},GetCookieName:function(n){var t=CnnXt.Storage.GetLocalConfiguration();return n=n+"_"+t.Site.SiteCode.toUpperCase()+"_"+t.Settings.Code.toUpperCase()+"_"+CnnXt.GetOptions().environment.toUpperCase(),t.Settings.UseParentDomain||(n="sub_"+n),n},GetViewedArticlesCookiesOLDName:function(){var t=CnnXt.Storage.GetLocalConfiguration(),n=CnnXt.Common.StorageKeys.connext_viewstructure;return t.Settings.UseParentDomain||(n="sub_"+n),n},GetLocalStorageNamePrefix:function(){var n=CnnXt.GetOptions().siteCode+"_"+CnnXt.GetOptions().environment+"_"+CnnXt.GetOptions().configCode;return CnnXt.GetOptions().attr&&(n+="_"+CnnXt.GetOptions().attr),CnnXt.GetOptions().settingsKey&&(n+="_"+CnnXt.GetOptions().settingsKey),n},AddParameterToURL:function(n,t,i){var r=t+"="+i;return n=n.replace(/#$/,""),n+((n.split("?")[1]?"&":"?")+r)},AddReturnUrlParamToLink:function(n){if(!~n.indexOf("returnUrl=")){var t=CnnXt.Utils.GetReturnUrl();t=CnnXt.Utils.AddParameterToURL(t,"clearUserState",!0);n=CnnXt.Utils.AddParameterToURL(n,"returnUrl",t)}return n},GetReturnUrl:function(){var t=(CnnXt.Storage.GetLocalConfiguration()||{}).Settings,n="";return n||(n=CnnXt.Utils.GetQueryStringParams(["returnUrl"]).returnUrl),n||(n=t.ReturnUrl),n||(n=window.location.href.split("?")[0]),n},getUrlParam:function(n){var t="",i=document.location.search.substr(1),r=i.split("&");return r.every(function(i){var r=i.split("=");return r[0]==n?(t=r[1],!1):!0}),t},AddQueryParamsToAllLinks:function(t){var i=t.find("[href]:not([data-dismiss])");i.each(function(t,i){var u=n(i),r=u.attr("href");r=CnnXt.Utils.AddReturnUrlParamToLink(r);u.attr("href",r)})},getSubdomains:function(){var n=document.location.origin.split("."),t;return n.pop(),n.pop(),n.length&&(t=n[0].substring(n[0].lastIndexOf("/")+1),t==="www"?n.shift():n[0]=t),n},getMetaTagsWithKeywords:function(){return n("meta[name=keywords]")},detectAdBlock:function(){var n=!1,t=document.getElementById("TestAdBlock");return t.offsetHeight===0&&(n=!0),n},getQueryParamByName:function(n,t){t||(t=window.location.href);n=n.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)"),i=r.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},GetUserMeta:function(){return u},GenerateGuid:function(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},ConvertObjectKeysToUpperCase:function(t){return n.each(t,function(n,i){delete t[n];t[n.toUpperCase()]=i}),t},GetIP:function(){return e?e:localStorage.ConnextIP},SetIP:function(n){localStorage.ConnextIP=n;e=n},GetElementHTML:function(t){return n("<div>").append(n(t).clone()).html()},ShapeUserData:function(n){var t,i;return n?(n.DigitalAccess&&_.isString(n.DigitalAccess.AccessLevel)&&(n.DigitalAccess.AccessLevel={IsPremium:n.DigitalAccess.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Premium,IsUpgrade:n.DigitalAccess.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Upgrade,IsPurchase:n.DigitalAccess.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Purchase}),n.EncryptedCustomerRegistrationId&&(n.IgmRegID=EncryptedCustomerRegistrationId),n.CookieContent&&_.isArray(n.CookieContent)&&(t=_.findWhere(n.CookieContent,{Name:"igmContent"}),t&&(n.IgmContent=t.Content),i=_.findWhere(n.CookieContent,{Name:"igmRegId"}),i&&(n.IgmRegID=i.Content)),n):{}},GetTimeByType:function(n,t){var i=moment(),r=new Date(n);return moment(r).diff(i,CnnXt.Common.TimeTypeMap[t])},IPWithinRangeCIDR:function(n,t){for(var u,f=CnnXt.Utils.GetIPsRangeByCIDR(t),e=f[0],o=f[1],i=[n.split("."),e.split("."),o.split(".")],r=0;r<i.length;r++){for(u=0;u<i[r].length;u++)i[r][u]=parseInt(i[r][u]);i[r]=(i[r][0]<<24)+(i[r][1]<<16)+(i[r][2]<<8)+i[r][3]}return i[0]>=i[1]&&i[0]<=i[2]?!0:!1},GetIPsRangeByCIDR:function(n){var e=!1,t,r,i,u,f;return typeof n=="string"&&(t=n.match(/^(\d+\.\d+\.\d+\.\d+)\/(\d+)$/),t&&(r=ot(t[1]),i=parseInt(t[2]),typeof r=="number"&&i>=0&&i<=32&&(u=st(i),f=ht(r,u),e=[s(f),s(f-u-1)]))),e}}},ConnextStorage=function(n){var o="STORAGE",e,l,r=function(t){var f="getLocalStorage",i,r;try{return i=t,CnnXt.Common.StorageKeys[t]&&(i=CnnXt.Common.StorageKeys[t]),r=CnnXt.Utils.GetLocalStorageNamePrefix()+i,n.jStorage.get(r)}catch(u){console.log(o,f,"EXCEPTION",u);t=="configuration"&&(CnnXt.Api.meta.storageException=u)}},u=function(t,i){var f="setLocalStorage",r,u;try{return r=t,CnnXt.Common.StorageKeys[t]&&(r=CnnXt.Common.StorageKeys[t]),u=CnnXt.Utils.GetLocalStorageNamePrefix()+r,n.jStorage.set(u,i)}catch(e){console.log(o,f,"EXCEPTION",e)}},s=function(t){var u="removeLocalStorage",i,r;try{return i=t,CnnXt.Common.StorageKeys[t]&&(i=CnnXt.Common.StorageKeys[t]),r=CnnXt.Utils.GetLocalStorageNamePrefix()+i,n.jStorage.deleteKey(r)}catch(f){console.log(o,u,"EXCEPTION",f)}},t=function(n){var t="getCookie";try{return e.debug(o,t,n,"CnnXt.Common.StorageKeys[key] || key",CnnXt.Common.StorageKeys[n]||n),Cookies.get(CnnXt.Common.StorageKeys[n]||n)}catch(i){console.log(o,t,"EXCEPTION",i)}},h=[],w=function(n,t){h[n]=localStorage.getItem(n);setInterval(function(){if(localStorage.getItem(n)!=h[n])return h[n]=localStorage.getItem(n),t()},1e3)},b=function(){var n="janrain status changed";w("janrainCaptureToken",function(){CnnXt.Storage.SetUserState(null);CnnXt.Storage.SetUserZipCodes(null);CnnXt.Activation.IsActivationFlowRunning()?CnnXt.User.CheckAccess().done(function(t){e.debug(n,"User.CheckAccess.Done",t)}).fail(function(){e.debug(n,"User.CheckAccess.Fail")}).always(function(){CnnXt.Activation.Run({runAfterSuccessfulLogin:!0})}):CnnXt.Run()})},i=function(n,t,i,r){var s="setCookie",u,f;try{return e.debug(o,s),u=window.location.host.split("."),f=window.location.host,f.indexOf("localhost")>-1&&(f="localhost"),!r&&u.length>=2&&(f="."+u[u.length-2]+"."+u[u.length-1]),i?(e.debug(o,s,"HasExpiration","key",n,"expiration",i),Cookies.set(CnnXt.Common.StorageKeys[n]||n,t,{expires:i,domain:f})):Cookies.set(CnnXt.Common.StorageKeys[n]||n,t,{domain:f})}catch(h){console.log(o,s,"EXCEPTION",h)}},f=function(n,t){var u="removeCookie",i,r;try{return e.debug(o,u),i=window.location.host.split("."),r=window.location.host,r.indexOf("localhost")>-1&&(r="localhost"),!t&&i.length>=2&&(r="."+i[i.length-2]+"."+i[i.length-1]),Cookies.set(CnnXt.Common.StorageKeys[n]||n,"null",{domain:r,expires:-1})}catch(f){console.log(o,u,"EXCEPTION",f)}},k=function(){for(var t,i=document.cookie.split(";"),r={},n=0;n<i.length;n++)t=i[n].split("="),r[t[0]]=unescape(t[1]);return r},a=function(n){var o=!CnnXt.GetOptions().configSettings.UseParentDomain,u=CnnXt.Utils.GetViewedArticlesCookiesName(),s=t(u),r,e;if(s)try{r=JSON.parse(s);r[n]=r[n]?r[n]+1:1;r[n+CnnXt.Common.StorageKeys.device_postfix]=r[n+CnnXt.Common.StorageKeys.device_postfix]?r[n+CnnXt.Common.StorageKeys.device_postfix]+1:1;f(u);i(u,JSON.stringify(r),new Date(CnnXt.Common.InfinityDate),o)}catch(h){}else e={},e[n]=1,f(u),i(u,JSON.stringify(e),new Date(CnnXt.Common.InfinityDate),o)},d=function(){var u=c(),t=u.parsedViews,r=n.Deferred();return t?r.resolve():CnnXt.API.GetViewData().done(function(n){var o,e,f,s;if(n){n.AllowedIpSet&&CnnXt.Storage.SetWhitelistSetIdCookie({Id:n.AllowedIpSet.Id,Expiration:n.AllowedIpSet.Expiration},new Date(n.AllowedIpSet.Expiration));t={};o=Connext.Storage.GetLocalConfiguration();e=o.Campaign.Conversations;for(meterLevelKey in CnnXt.Common.MeterLevels)f=CnnXt.Common.MeterLevels[meterLevelKey],n[f]&&n[f].Conversations&&(s=n[f].Conversations,s.forEach(function(n){n.Id&&n.ViewCount&&(t[n.Id]=n.ViewCount,t[n.Id+CnnXt.Common.StorageKeys.device_postfix]=n.DeviceViewCount);e&&e[f]&&e[f].forEach(function(t){t.id==n.Id&&(t.Props.Date.started=n.StartDate)})}));o.Campaign.Conversations=e;i(u.cookieName,JSON.stringify(t),new Date(CnnXt.Common.InfinityDate),u.userCurDomain);CnnXt.Storage.SetLocalConfiguration(o)}r.resolve()}).fail(function(n){r.resolve();console.log(n.error())}),r.promise()},c=function(){var r=!CnnXt.GetOptions().configSettings.UseParentDomain,u=CnnXt.Utils.GetViewedArticlesCookiesName(),e=CnnXt.Utils.GetViewedArticlesCookiesOLDName(),n,o=t(u),f=t(e);return f&&(n=JSON.parse(f),i(e,JSON.stringify(n),new Date(CnnXt.Common.CookieExpireDate),r)),o?n=JSON.parse(o):f&&i(u,JSON.stringify(n),new Date(CnnXt.Common.InfinityDate),r),{parsedViews:n,cookieName:u,userCurDomain:r}},v=function(n){var i=c(),t=i.parsedViews;for(key in t)if(key==n)return t[key]},y=function(n,r){var s=!r,e=CnnXt.Utils.GetViewedArticlesCookiesName(),h=t(e),o,c,l;if(n){if(h)try{o=JSON.parse(h);o[n]=0;o[n+CnnXt.Common.StorageKeys.device_postfix]=0;f(e);i(e,JSON.stringify(o),new Date(CnnXt.Common.InfinityDate),s);c=CnnXt.Common.StorageKeys.viewedArticles+"_"+n;u(c,[])}catch(a){}}else l={},f(e,!s),i(e,JSON.stringify(l),new Date(CnnXt.Common.InfinityDate),s)},g=function(t){var i=CnnXt.Storage.GetViewedArticles(t),e=CnnXt.Utils.GetUrl(),r=CnnXt.GetOptions(),u;if(i==null&&(i=[]),r.articlesCounter&&r.articlesCounter.params&&r.articlesCounter.params.length){var o=r.articlesCounter.params,s=location.hostname,f=s+"_";o.forEach(function(n){var t=CnnXt.Utils.getQueryParamByName(n);t&&(f+=n+"="+t)});u=MD5(f)}else u=MD5(e);i.indexOf(u)>-1?!n.jStorage.get("uniqueArticles")&&CnnXt.GetOptions().debug&&a(t):(i.push(u),a(t),CnnXt.Storage.SetViewedArticles(i,t))},nt=function(n){var i,f,r,u;if(!CnnXt.Storage.GetCurrentConversation()&&!n)return null;if(i=n,i==null&&(i=CnnXt.Storage.GetCurrentConversation().id),f=CnnXt.Utils.GetViewedArticlesCookiesName(),r=t(f),r)try{if(u=JSON.parse(r),u[i])return u[i]}catch(e){return 0}return 0},tt=function(n){var i=CnnXt.Common.StorageKeys.viewedArticles,t=r(i);if(t)return t[n]},it=function(n,t){var f=CnnXt.Common.StorageKeys.viewedArticles,i=r(f);i==null&&(i={});i[t]=n;u(f,i)},rt=function(n,t){n?(n.Props.views=0,CnnXt.Storage.SetViewedArticles([],n.id),y(n.id,t)):(u(CnnXt.Common.StorageKeys.viewedArticles,{}),y(null,t))},p=function(){Cookies.remove(CnnXt.Common.StorageKeys.userToken);Cookies.remove(CnnXt.Common.StorageKeys.accessToken);Cookies.remove("userToken");Cookies.remove("userMasterId");localStorage.removeItem("janrainCaptureProfileData");localStorage.removeItem("janrainCaptureReturnExperienceData");n.jStorage.deleteKey(CnnXt.Common.StorageKeys.user.zipCodes);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.user.state);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.user.data);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.connext_user_profile);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.connext_user_data);CnnXt.Storage.SetUserState("Logged Out");f("ExternalUserId");f("connext_user_profile");f("connext_user_data")};return{init:function(){e=CnnXt.Logger;e.debug(o,"Init");b()},GetLocalConfiguration:function(){return r("configuration")},SetLocalConfiguration:function(n){return localStorage.setItem("IsLocalConfig",!0),u("configuration",n)},GetUserState:function(){return n.jStorage.get(CnnXt.Common.StorageKeys.user.state)},SetUserState:function(t){return n.jStorage.set(CnnXt.Common.StorageKeys.user.state,t)},GetUserZipCodes:function(){return r(CnnXt.Common.StorageKeys.user.zipCodes)},SetCalculatedZipCode:function(t){var i="SetCalculatedZipCode";try{t.split(" ").length==2&&(t=t.split(" ")[0]);n.jStorage.set(CnnXt.Common.StorageKeys.customZip,t)}catch(r){e.debug(NAME,i,r)}},SetUserZipCodes:function(n){return u(CnnXt.Common.StorageKeys.user.zipCodes,n)},GetActualZipCodes:function(){var t=CnnXt.Storage.GetUserState();return CnnXt.User.isUserHasHighState()?r(CnnXt.Common.StorageKeys.user.zipCodes)||[]:[n.jStorage.get(CnnXt.Common.StorageKeys.customZip)]},GetLastPublishDate:function(){return t(CnnXt.Utils.GetCookieName("lastPublishDate"))},SetLastPublishDate:function(n,t){t||(t=new Date,t.setMonth(t.getMonth()+1),t=new Date(t));var r=!Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain;return i(CnnXt.Utils.GetCookieName("lastPublishDate"),n,t,r)},GetCurrentConversations:function(){var n=r(CnnXt.Common.StorageKeys.conversations.current);return n?n:{}},SetCurrentConversations:function(n){return u(CnnXt.Common.StorageKeys.conversations.current,n)},GetCampaignData:function(){return r(CnnXt.Common.StorageKeys.configuration)?r(CnnXt.Common.StorageKeys.configuration).Campaign:null},GetCurrentConversationViewCount:nt,GetViewedArticles:tt,SetViewedArticles:it,UpdateViewedArticles:g,ResetConversationViews:rt,GetRepeatablesInConv:function(n){r(CnnXt.Common.StorageKeys.repeatablesInConv)||u(CnnXt.Common.StorageKeys.repeatablesInConv,{});var t=r(CnnXt.Common.StorageKeys.repeatablesInConv);return r(CnnXt.Common.StorageKeys.repeatablesInConv)[n]||(t[n]=0,u(CnnXt.Common.StorageKeys.repeatablesInConv,t)),r(CnnXt.Common.StorageKeys.repeatablesInConv)[n]},UpdateRepeatablesInConv:function(n){r(CnnXt.Common.StorageKeys.repeatablesInConv)||u(CnnXt.Common.StorageKeys.repeatablesInConv,{});var t=r(CnnXt.Common.StorageKeys.repeatablesInConv);t[n]=t[n]+1;u(CnnXt.Common.StorageKeys.repeatablesInConv,t)},ClearConfigSettings:function(){try{CnnXt.Storage.SetViewedArticles([],CnnXt.Storage.GetCurrentConversation().id)}catch(t){}s(CnnXt.Common.StorageKeys.conversations.current);s(CnnXt.Common.StorageKeys.conversations.previous);s(CnnXt.Common.StorageKeys.viewedArticles);s(CnnXt.Common.StorageKeys.configurationSiteCode);s(CnnXt.Common.StorageKeys.configurationConfigCode);s(CnnXt.Common.StorageKeys.configurationIsCustom);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.user.state);s(CnnXt.Common.StorageKeys.user.zipCodes);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.connext_user_profile);n.jStorage.deleteKey(CnnXt.Common.StorageKeys.connext_user_data);s(CnnXt.Common.StorageKeys.customZip);s(CnnXt.Common.StorageKeys.repeatablesInConv);localStorage.removeItem("_matherAnonId");s(CnnXt.Common.StorageKeys.configuration)},ClearUser:function(){p()},Logout:function(){p();f(CnnXt.Common.StorageKeys.igmRegID);f(CnnXt.Common.StorageKeys.IgmContent)},ClearOldCookies:function(){String.prototype.startsWith||(String.prototype.startsWith=function(n,t){return t=t||0,this.indexOf(n,t)===t});n.each(k(),function(n){var t=n.toString(),i,r;t.startsWith(" ")&&(t=t.trim());t=decodeURIComponent(t);(t.startsWith("Connext_ViewedArticles")||t.startsWith("sub_Connext_ViewedArticles"))&&(Cookies.remove(t),i=location.host.split("."),r="."+i[i.length-2]+"."+i[i.length-1],Cookies.remove(t,{domain:r}))})},SetAccessToken:function(n){return i("accessToken",n)},GetAccessToken:function(){return e.debug(o,"GetAccessToken",CnnXt.Common.StorageKeys.accessToken),t("accessToken")},GetCurrentConversation:function(){return r("CurrentConversation")},SetCurrentConversation:function(n){u("CurrentConversation",n)},SetUserToken:function(n){return i("userToken",n,365)},GetUserToken:function(){return t("userToken")},GetigmRegID:function(){return Cookies.get("igmRegID")},GetIgmContent:function(){return t("igmContent")},SetIgmContent:function(n){var t=new Date;return t.setDate(t.getDate()+30),i("igmContent",n,t)},SetigmRegID:function(n){var t=new Date;return t.setDate(t.getDate()+30),i("igmRegID",n,t)},SetExternalUserId:function(n){var t=new Date;return t.setDate(t.getDate()+30),i("ExternalUserId",n,t)},GetExternalUserId:function(){return Cookies.get("ExternalUserId")},SetUserRegId:function(n){return i("userMasterId",n,365)},GetUserRegId:function(){return t("userMasterId")},GetWhitelistInfoboxCookie:function(){return t(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistInfobox))},SetWhitelistInfoboxCookie:function(n){var t=new Date;return t.setDate(t.getDate()+30),i(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistInfobox),n,t)},RemoveWhitelistInfoboxCookie:function(){return f(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistInfobox))},GetNeedHidePinTemplateCookie:function(){return t(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.NeedHidePinTemplate))},SetNeedHidePinTemplateCookie:function(n){var t=new Date;return t.setDate(t.getDate()+1),i(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.NeedHidePinTemplate),n,t)},RemoveNeedHidePinTemplateCookie:function(){return f(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.NeedHidePinTemplate))},GetWhitelistSetIdCookie:function(){return t(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistSet))},SetWhitelistSetIdCookie:function(n,t){return i(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistSet),n,t)},RemoveWhitelistSetIdCookie:function(){return f(CnnXt.Utils.GetCookieName(CnnXt.Common.StorageKeys.WhitelistSet))},GetJanrainUser:function(){var t=localStorage.getItem(CnnXt.Common.StorageKeys.janrainUserProfile);try{return n.parseJSON(t)}catch(i){return null}},SetSiteCode:function(n){u(CnnXt.Common.StorageKeys.configurationSiteCode,n)},GetSiteCode:function(){return r(CnnXt.Common.StorageKeys.configurationSiteCode)},SetConfigCode:function(n){u(CnnXt.Common.StorageKeys.configurationConfigCode,n)},GetConfigCode:function(){return r(CnnXt.Common.StorageKeys.configurationConfigCode)},SetIsCustomConfiguration:function(n){u(CnnXt.Common.StorageKeys.configurationIsCustom,n)},SetUserLastUpdateDate:function(n){u(CnnXt.Common.StorageKeys.connext_userLastUpdateDate,n)},GetUserLastUpdateDate:function(){return u(CnnXt.Common.StorageKeys.connext_userLastUpdateDate)},GetIsCustomConfiguration:function(){return r(CnnXt.Common.StorageKeys.configurationIsCustom)},GetGuid:function(){return t(CnnXt.Common.StorageKeys.connext_user_Id)},SetGuid:function(n){return i(CnnXt.Common.StorageKeys.connext_user_Id,n)},GetUserData:function(){return n.jStorage.get(CnnXt.Common.StorageKeys.connext_user_data)},SetUserData:function(t){return n.jStorage.set(CnnXt.Common.StorageKeys.connext_user_data,t)},GetUserProfile:function(){var t=n.jStorage.get(CnnXt.Common.StorageKeys.connext_user_profile);if(t)try{return t}catch(i){return null}return null},SetUserProfile:function(t){return n.jStorage.set(CnnXt.Common.StorageKeys.connext_user_profile,t)},GetConnextPaywallCookie:function(){return t(CnnXt.Common.StorageKeys.connext_paywallFired)},SetConnextPaywallCookie:function(n){var t=!CnnXt.GetOptions().configSettings.UseParentDomain;return i(CnnXt.Common.StorageKeys.connext_paywallFired,n,null,t)},SetAccountDataExpirationCookie:function(n){var t=new Date;return t.setDate(t.getDate()+1),Cookies.set("Connext_AccountDataExpirationCookie",n,{expires:t})},GetAccountDataExpirationCookie:function(){return Cookies.get("Connext_AccountDataExpirationCookie")},WrongPin:function(){var n=CnnXt.Storage.GetPinAttempts(),t;return n?n++:n=1,t=new Date,t.setMinutes(t.getMinutes()+15),i("PinAttempts",n,t)},GetPinAttempts:function(){return t("PinAttempts")},SetRegistrationType:function(t){n.jStorage.set(CnnXt.Common.StorageKeys.connext_auth_type,t)},GetRegistrationType:function(){return n.jStorage.get(CnnXt.Common.StorageKeys.connext_auth_type)||{}},GetDeviceViews:function(n){return v(n+CnnXt.Common.StorageKeys.device_postfix)},GetViews:function(n){return v(n)},CheckCookie:function(){return d()},GetViewsData:function(){return c()},SetMeter:function(n){l=n},GetMeter:function(){return l},UpdateWhitelistSetCookieName:function(){var u="UpdateWhitelistSetCookieName",i,r,n;try{i=CnnXt.Common.StorageKeys.WhitelistSet;r=CnnXt.Utils.GetCookieName(i);t(r)==undefined&&t(i)!=undefined&&(n=JSON.parse(t(i)),n.Id&&n.Expiration&&(CnnXt.Storage.SetWhitelistSetIdCookie({Id:n.Id,Expiration:n.Expiration},new Date(n.Expiration)),f(i)))}catch(o){e.exception(NAME,u,o)}},UpdateWhitelistInfoboxCookieName:function(){var r="UpdateWhitelistSetCookieName",n,i;try{n=CnnXt.Common.StorageKeys.WhitelistInfobox;i=CnnXt.Utils.GetCookieName(n);t(i)==undefined&&t(n)!=undefined&&(CnnXt.Storage.SetWhitelistInfoboxCookie(!0),f(n))}catch(u){e.exception(NAME,r,u)}},UpdateNeedHidePinTemplateCookieName:function(){var r="UpdateNeedHidePinTemplateCookieName",n,i;try{n=CnnXt.Common.StorageKeys.NeedHidePinTemplate;i=CnnXt.Utils.GetCookieName(n);t(i)==undefined&&t(n)!=undefined&&(CnnXt.Storage.SetNeedHidePinTemplateCookie(!0),f(n))}catch(u){e.exception(NAME,r,u)}},SetGeolocationInfo:function(n){u(CnnXt.Common.StorageKeys.geolocationInfo,n)},GetGeolocationInfo:function(){r(CnnXt.Common.StorageKeys.geolocationInfo)}}},ConnextAPI=function(n){var i="API",t,u,f,h="api/",e={GetConfiguration:_.template("configuration/siteCode/<%= siteCode %>/configCode/<%= configCode %>?publishDate=<%= publishDate %>"),GetUserByEmailAndPassword:_.template("user?email=<%= email %>&password=<%= password %>"),GetUserByMasterId:_.template("user/id/<%= id %>"),GetUserByToken:_.template("user/token/<%= token %>"),EmailPreferences:"user/emailPreference",GetUserLastUpdateDate:_.template("user/getLastUpdateDate?masterId=<%=masterId%>"),CheckAccess:_.template("checkAccess/<%= masterId %>"),GetUserByEncryptedMasterId:_.template("user/encryptedMasterId?encryptedMasterId=<%= encryptedMasterId %>"),ClearServerCache:_.template("clear/siteCode/<%=siteCode%>/configCode/<%=configCode%>"),viewsData:"views",DeleteViewsByUserId:_.template("views/user/delete?siteCode=<%=SiteCode%>&configCode=<%=ConfigCode%>&userId=<%=UserId%>&masterId=<%=MasterId%>&settingsKey=<%=SettingsKey%>"),CreateUser:_.template("user/create?email=<%=email%>&password=<%= password %>"),ActivateByAccountNumber:_.template("user/Activate/customRegId/<%= customRegId %>/LastName/<%= LastName %>/accountNumber/<%= AccountNumber %>"),ActivateByZipCodeAndHouseNumber:_.template("user/Activate/customRegId/<%= customRegId %>/LastName/<%= LastName %>/ZipCode/<%= ZipCode %>/HouseNumber/<%= HouseNumber %>"),ActivateByZipCodeAndPhoneNumber:_.template("user/Activate/customRegId/<%= customRegId %>/LastName/<%= LastName %>/ZipCode/<%= ZipCode %>/Phone/<%= PhoneNumber %>"),LinkingBySubscription:_.template("user/Activate/customRegId/<%= customRegId %>/Subscription/<%= SubscriptionId %>"),GetDictionaryValue:_.template("dictionary/<%= ValueName %>"),GetClientIpInfo:"utils/ipInfo",CheckDigitalAccess:_.template("user/masterId/<%= masterId %>/DigitalAccess")},r={publishFile:{url:"",responceCode:"",publishDate:"",ex:""},config:{isExistsInLocalStorage:"",localPublishDate:""},clientUrl:"",reason:""},o=function(r){var o="Get",s,h;try{return s=f+e[r.method](r.options.payload),t.debug(i,o,"calling...",s,"OPTIONS",u),h="",r.options.meta&&(h=JSON.stringify(r.options.meta)),n.ajax({headers:{"Site-Code":u.siteCode,"Paper-Code":CnnXt.GetOptions().paperCode,"Product-Code":CnnXt.Utils.GetProductCode(),"x-test":"test","Access-Control-Allow-Origin":"*",Environment:CnnXt.GetOptions().environment,settingsKey:CnnXt.GetOptions().settingsKey,attr:CnnXt.GetOptions().attr,metaData:h,Version:CnnXt.GetVersion(),"Source-System":"Plugin"},url:s,type:"GET",dataType:"json",success:function(n,u,f){t.debug(i,o,"<< SUCCESS >>","textStatus",u,"data",n,"xhr",f);try{if(n&&f.status!=204){if(_.isFunction(r.options.onSuccess))r.options.onSuccess(n)}else _.isFunction(r.options.onNull)&&r.options.onNull()}catch(e){t.exception(o,e)}},error:function(n){if(t.error(o,"Ajax.Error",n),_.isFunction(r.options.onError))r.options.onError(n)},complete:function(){_.isFunction(r.options.onComplete)&&r.options.onComplete()}})}catch(c){t.log(i,o,"EXCEPTION",c);_.isFunction(r.options.onError)&&r.options.onError()}},s=function(r){var o="Post",s,h;try{return s=f+e[r.method](r.options.payload),t.debug(i,o,"calling...",s,"OPTIONS",u),h="",r.options.meta&&(h=JSON.stringify(r.options.meta)),n.ajax({headers:{"Site-Code":u.siteCode,"Paper-Code":CnnXt.GetOptions().paperCode,"Product-Code":CnnXt.Utils.GetProductCode(),"Config-Code":CnnXt.Storage.GetLocalConfiguration().Settings.Code,"x-test":"test","Access-Control-Allow-Origin":"*",Environment:CnnXt.GetOptions().environment,settingsKey:CnnXt.GetOptions().settingsKey,attr:CnnXt.GetOptions().attr,metaData:h,Version:CnnXt.GetVersion(),"Source-System":"Plugin"},url:s,type:"POST",data:r.options.payload,dataType:"json",success:function(n,u,f){t.debug(i,o,"<< SUCCESS >>","textStatus",u,"data",n,"xhr",f);try{if(n&&f.status!=204){if(_.isFunction(r.options.onSuccess))r.options.onSuccess(n)}else _.isFunction(r.options.onNull)&&r.options.onNull()}catch(e){t.exception(o,e)}},error:function(n){if(t.error(o,"Ajax.Error",n),_.isFunction(r.options.onError))r.options.onError(n)},complete:function(){_.isFunction(r.options.onComplete)&&r.options.onComplete()}})}catch(c){t.log(i,o,"EXCEPTION",c);_.isFunction(r.options.onError)&&r.options.onError()}},c=function(r){var s="GetNewsletters",o;try{return o=f+e.EmailPreferences,o+="?email="+r.options.email+"&emailPreferenceId="+r.options.id,t.debug(i,s,"calling...",o,"OPTIONS",u),n.ajax({headers:{"Site-Code":"MNG","Access-Control-Allow-Origin":"*",Environment:CnnXt.GetOptions().environment,settingsKey:CnnXt.GetOptions().settingsKey,Version:CnnXt.GetVersion(),"Source-System":"Plugin"},url:o,type:"GET",dataType:"json",success:function(n,i,u){t.debug("data:",n);try{n&&u.status!=204?_.isFunction(r.options.onSuccess)&&r.options.onSuccess():_.isFunction(r.options.onNull)&&r.options.onNull()}catch(f){t.exception(s,f)}},error:function(n){if(t.debug("error",n),_.isFunction(r.options.onError))r.options.onError(n)},complete:function(){_.isFunction(r.options.onComplete)&&r.options.onComplete()}})}catch(h){t.log(i,s,"EXCEPTION",h);_.isFunction(r.options.onError)&&r.options.onError()}},l=function(){var r="clearServerCache",u={siteCode:CnnXt.GetOptions().siteCode,configCode:CnnXt.GetOptions().configCode},o=f+e.ClearServerCache(u);return n.ajax({headers:{attr:CnnXt.GetOptions().attr},url:o,type:"POST",dataType:"json",success:function(n,u,f){t.debug(i,r,"<< SUCCESS >>","textStatus",u,"data",n,"xhr",f)},error:function(n){t.error(r,"Ajax.Error",n)}})};return{init:function(n){t=CnnXt.Logger;u=n;f=u.api+h},GetConfiguration:function(n){return r.clientUrl=document.location.href,r.userAgent=navigator.userAgent,r.guid=CnnXt.Storage.GetGuid(),r.localConfig=localStorage.getItem("IsLocalConfig"),n.meta=r,o({method:"GetConfiguration",options:n})},GetUserByEmailAndPassword:function(n){return n&&n.payload&&(n.payload.email&&(n.payload.email=encodeURIComponent(n.payload.email)),n.payload.password&&(n.payload.password=encodeURIComponent(n.payload.password))),o({method:"GetUserByEmailAndPassword",options:n})},ClearServerCache:function(){l()},CheckAccess:function(n){return o({method:"CheckAccess",options:n})},GetUserByMasterId:function(n){return o({method:"GetUserByMasterId",options:n})},GetUserLastUpdateDate:function(n){return o({method:"GetUserLastUpdateDate",options:n})},GetUserByEncryptedMasterId:function(n){return o({method:"GetUserByEncryptedMasterId",options:n})},CreateUser:function(n){return n&&n.payload&&(n.payload.email&&(n.payload.email=encodeURIComponent(n.payload.email)),n.payload.password&&(n.payload.password=encodeURIComponent(n.payload.password))),s({method:"CreateUser",options:n})},ActivateByAccountNumber:function(n){return s({method:"ActivateByAccountNumber",options:n})},ActivateByZipCodeAndHouseNumber:function(n){return s({method:"ActivateByZipCodeAndHouseNumber",options:n})},ActivateByZipCodeAndPhoneNumber:function(n){return s({method:"ActivateByZipCodeAndPhoneNumber",options:n})},LinkingBySubscription:function(n){return s({method:"LinkingBySubscription",options:n})},SendViewData:function(r){var u="SendViewData";return n.ajax({url:f+e.viewsData,headers:{Environment:CnnXt.GetOptions().environment},type:"POST",data:r,dataType:"json",success:function(n,r,f){t.debug(i,u,"<< SUCCESS >>","textStatus",r,"data",n,"xhr",f)},error:function(n){t.error(u,"Ajax.Error",n)},complete:function(){}})},GetViewData:function(){var t={UserId:CnnXt.GetOptions().deviceId,ConfigCode:CnnXt.GetOptions().configCode,SiteCode:CnnXt.GetOptions().siteCode,SettingsKey:CnnXt.GetOptions().settingsKey};return n.ajax({url:f+e.viewsData,headers:{Environment:CnnXt.GetOptions().environment},type:"GET",data:t})},DeleteViewsByUserId:function(){var t={UserId:CnnXt.GetOptions().deviceId,MasterId:CnnXt.User.getMasterId(),ConfigCode:CnnXt.GetOptions().configCode,SiteCode:CnnXt.GetOptions().siteCode,SettingsKey:CnnXt.GetOptions().settingsKey};return n.ajax({url:f+e.DeleteViewsByUserId(t),type:"GET",data:t})},meta:r,GetLastPublishDateS3:function(){var f="GetLastPublishDateS3",e;try{return e=CnnXt.Common.S3RootUrl[u.environment]+"data/last_publish/"+u.siteCode+".json?_="+(new Date).getTime(),t.debug(i,f,"jsonURL",e),r.publishFile.url=e,n.ajax({crossDomain:!0,contentType:"application/json; charset=utf-8",async:!0,url:e,success:function(n){t.debug(i,f,"success",n);r.publishFile.responceCode=200},error:function(n,u,e){t.debug(i,f,"error","a, b, c",n,u,e);r.publishFile.responceCode=n.status;r.reason=CnnXt.Common.DownloadConfigReasons.getPublishFailed}})}catch(o){t.error(i,f,"<<EXCEPTION>>",o);r.reason=CnnXt.Common.DownloadConfigReasons.getPublishFailed;r.publishFile.ex=o}},NewsletterSubscribe:function(n){return c({method:"NewsletterSubscribe",options:n})},GetProductCode:function(){return o({method:"GetDictionaryValue",options:{payload:{ValueName:"productCode"}}})},GetClientIpInfo:function(){var t=CnnXt.Common.APIUrl[CnnXt.GetOptions().environment]+h+e.GetClientIpInfo;return n.ajax({url:t,type:"GET"})},CheckDigitalAccess:function(n){return o({method:"CheckDigitalAccess",options:n})}}},ConnextUser=function(n){var i="User",t,h,f={},y=!1,s={},a,c,it,u,p,r,b,k,e={},d="UserName or Password invalid. Please try again or click on the Forgot/Reset Password link to update your password, or create an account if you have never registered an email address with us.",v={show:function(n){try{c.info(n).show()}catch(t){}},hide:function(){try{c.hide()}catch(n){}},showAndHide:function(n,t){try{c.info(n);b=setTimeout(function(){c.find(".alert").remove()},t)}catch(i){}}},o={LoginButton:"[data-mg2-submit=login]:visible",LoginAlert:"[data-mg2-alert=login]:visible",JanrainLoginBtn:"[data-mg2-submit=janrainLogin]:visible",InputUsername:"[data-mg2-alert=login] [data-mg2-input=Email]",InputPassword:"[data-mg2-alert=login] [data-mg2-input=Password]",ActionShowLogin:"[data-mg2-action=login]",LogoutButton:"[data-mg2-action=logout]",SubscribeButton:'[data-mg2-action="submit"]',SubmitZipCode:'[data-mg2-action="Zipcode"]',ConnextRun:'[data-mg2-action="connextRun"]',OpenNewsletterWidget:'[data-mg2-action="openNewsletterWidget"]',LoginModal:'<div data-mg2-alert="login" data-template-id="23" data-display-type="modal" data-width="400" id="mg2-login-modal"  tabindex="-1" class="Mg2-connext modal fade in"><div class="modal-body picker-bg"><i class="fa fa-times closebtn" data-dismiss="modal" aria-label="Close" aria-hidden="true"><\/i><form><h1 class="x-editable-text text-center h3">LOGIN<\/h1><p class="x-editable-text text-center m-b-2" >to save access to articles or get newsletters, allerts or recomendations  all for free<\/p><label class="textColor4 x-editable-text" >E-mail<\/label><input type="email" data-mg2-input="Email" class="text" name="email" value=""   data-mg2-input="Email" /><label class="textColor4 x-editable-text">Password<\/label><input type="password" data-mg2-input="Password" class="text" name="password" value=""  data-mg2-input="Password" /><a href="" data-mg2-submit="login" class="input submit x-editable-text" title="Login">Login<\/a><\/form><\/div><\/div>',CheckAccessPopup:'<div class="Mg2-connext modal fade in" id="CheckAccessPopup" data-display-type="modal" data-width="300" tabindex="-1"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body">We noticed that your access status has changed. Page will be reloaded based on your new access permissions<\/div><div class="modal-footer text-center"><button type="button" id="ConnextRunBtn" class="btn btn-default" data-dismiss="modal">OK<\/button><\/div><\/div><\/div><\/div>'},rt=function(){var r="Init";try{t.debug(i,r,"Initializing User...");o.LoginModal=h.LoginModal;ut();n("body").on("click",o.LogoutButton,function(n){n.preventDefault();var r=o.LogoutButton+".CLICK";t.debug(i,r);st()});n("body").on("click",'[data-dismiss="alert"]',function(){c.find(".alert").remove();clearTimeout(b)});n("body").on("click",o.SubscribeButton,function(r){var f;r.preventDefault();f=o.SubscribeButton+".CLICK";t.debug(i,f);try{var e=n(this),u=e.attr("href"),s=e.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val();u=CnnXt.Utils.AddParameterToURL(u,"email",s);e.attr("href",u);window.location.href=u}catch(r){t.error(i,f,"<<EXCEPTION>>",r)}});n("body").on("click",o.SubmitZipCode,function(r){var e;r.preventDefault();e=o.SubmitZipCode+".CLICK";t.debug(i,e);try{var f=n(this),u=f.attr("href"),s=f.parents(".Mg2-connext").find('[data-mg2-input="Zipcode"]').val();u=CnnXt.Utils.AddParameterToURL(u,"zipcode",s);f.attr("href",u);f[0].hasAttribute("target")?window.open(u,"_blank"):window.location.href=u}catch(r){t.error(i,e,"<<EXCEPTION>>",r)}});n("body").on("click",o.OpenNewsletterWidget,function(r){var e,u,f;r.preventDefault();e=o.OpenNewsletterWidget+".CLICK";t.debug(i,e);try{u=n(this);f={};u.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val()!=undefined&&u.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val()!==""&&(f.email=u.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val());u.data("category-ids-list")!=undefined&&(f.categoryIdsList=u.data("category-ids-list").toString().split(",").map(function(n){return parseInt(n,10)}));u.data("newsletter-ids-list")!=undefined&&(f.newsletterIdsList=u.data("newsletter-ids-list").toString().split(",").map(function(n){return parseInt(n,10)}));u.data("view-mode")!=undefined&&(f.viewMode=u.data("view-mode"));mg2WidgetAPI.openNewsletter(f)}catch(s){t.error(i,e,"<<EXCEPTION>>",r)}});n("body").on("click",".Mg2-btn-forgot",function(r){var e;r.preventDefault();e="Forgot password btn.CLICK";t.debug(i,e);try{var f=n(this),u=f.attr("href"),o=f.parents(".Mg2-connext").find('[data-mg2-input="Email"]').val();u=CnnXt.Utils.AddReturnUrlParamToLink(u);u=CnnXt.Utils.AddParameterToURL(u,"email",o);f.attr("href",u);f[0].hasAttribute("target")?window.open(u,"_blank"):window.location.href=u}catch(r){t.error(i,e,"<<EXCEPTION>>",r)}});n("body").on("click dblclick",o.LoginButton,function(r){var u,e,s;r.preventDefault();u=o.LoginButton+".CLICK";t.debug(i,u);try{a=n(o.LoginButton).loader();c=n(o.LoginAlert).jalert();a.on();f.MG2?(e=n(o.InputUsername+":visible").val(),s=n(o.InputPassword+":visible").val(),pt(e,s)):JanrainAuthenticate(n("[data-mg2-input=Username]:visible").val(),n("[data-mg2-input=Password]:visible").val())}catch(r){t.error(i,u,"<<EXCEPTION>>",r)}});n("body").on("click",o.JanrainLoginBtn,function(r){var u,f,e;r.preventDefault();u=o.JanrainLoginBtn+".CLICK";t.debug(i,u);try{window.janrain?(f=n("[data-mg2-input=Email]:visible").val(),e=n("[data-mg2-input=Password]:visible").val(),janrain.capture.ui.modal.open(),n("#capture_signIn_traditionalSignIn_emailAddress").val(f),n("#capture_signIn_traditionalSignIn_password").val(e),n("#capture_signIn_traditionalSignIn_signInButton").click()):t.error("No janrain global object found...")}catch(r){t.error(i,u,"<<EXCEPTION>>",r)}});n("body").on("click",o.ActionShowLogin,function(r){var e,u;r.preventDefault();e=o.ActionShowLogin+".Click";try{if(t.debug(i,e,"IS_LOGGED_IN",y),f.MG2){u=n(o.LoginModal);u.addClass("in");u.attr("id","mg2-login-modal");u.css("display","block");CnnXt.Utils.AddQueryParamsToAllLinks(u);u.connextmodal({backdrop:"true"});u.resize();u.on("hidden.bs.modal",function(n){CnnXt.Event.fire("onActionClosed",n)})}else f.GUP?lt(window):f.Janrain?window.janrain?janrain.capture.ui.modal.open():t.error("No janrain global object found..."):f.Auth0&&(Auth0Lock?tt():t.error("No Auth0 global object found..."));window.CnnXt.Event.fire("onActionShown",r)}catch(s){t.error(i,e,"Exception",s)}})}catch(u){t.error(i,r,u)}},ut=function(){var r="setAuthType",u;try{if(t.debug(i,r,"OPTIONS",h),h.Site.RegistrationTypeId==1)t.debug(i,r,"IsMG2Auth"),f.MG2=!0;else if(h.Site.RegistrationTypeId==2)t.debug(i,r,"IsJanrainAuth"),f.Janrain=!0,a=n(o.LoginButton).loader(),c=n(o.LoginAlert).jalert();else if(h.Site.RegistrationTypeId==3)f.GUP=!0;else if(h.Site.RegistrationTypeId==4){f.Auth0=!0;u=CnnXt.GetOptions().authSettings.auth0Lock;u.on("authenticated",function(n){u.getUserInfo(n.accessToken,function(n,u){if(n){t.error("showAuth0Login","","<<EXCEPTION>>",n);CnnXt.Storage.SetUserProfile("");return}CnnXt.Storage.SetUserProfile(u);CnnXt.Activation.IsActivationFlowRunning()?CnnXt.User.CheckAccess().done(function(n){t.debug(i,r,"User.CheckAccess.Done",n)}).fail(function(){t.debug(i,r,"User.CheckAccess.Fail")}).always(function(){CnnXt.Activation.Run({runAfterSuccessfulLogin:!0})}):CnnXt.Run()})})}else if(h.Site.RegistrationTypeId==5)t.debug(i,r,"IsCustomAuth"),f[CnnXt.Common.RegistrationTypes[5]]=!0;else throw"Unknown Registration Type";yt()}catch(e){t.error(i,r,"EXCEPTION",e)}},ft=function(){var h="checkAccess",c=n.Deferred(),v=n.Deferred(),a=n.Deferred();return!f.Custom&&e&&e.MasterId?CnnXt.API.GetUserLastUpdateDate({payload:{masterId:e.MasterId},onSuccess:function(n){t.debug(i,h,"<< SUCCESS >>","data",n);(CnnXt.Storage.GetUserLastUpdateDate()==null||new Date(CnnXt.Storage.GetUserLastUpdateDate())<new Date(n))&&(CnnXt.Storage.SetUserState(null),CnnXt.Storage.SetUserData(null),CnnXt.Storage.SetUserLastUpdateDate(n));v.resolve()},onNull:function(){t.debug(i,h,"<< NO RESULTS >>");v.resolve()},onError:function(n){t.debug(i,h,"<< ERROR >>","err",n);v.resolve()}}):v.resolve(),v.promise().then(function(){if(wt(),CnnXt.Storage.GetAccountDataExpirationCookie()||(CnnXt.Storage.SetUserState(null),CnnXt.Storage.SetUserData(null)),r=CnnXt.Storage.GetUserState(),f.MG2&&(CnnXt.Storage.GetigmRegID()?r==u.NotLoggedIn&&(r=null):(r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r))),f.Custom)try{Connext.GetOptions().authSettings.CalculateAuthStatusFunc().done(function(n){if(_.values(u).indexOf(n)==-1)throw"Unknown user state";r=n;CnnXt.Storage.SetUserState(r);CnnXt.Storage.SetAccountDataExpirationCookie(!0);r==u.NotLoggedIn||CnnXt.Storage.GetUserProfile()?a.resolve():Connext.GetOptions().authSettings.GetAuthProfileFunc().done(function(n){try{CnnXt.Storage.SetUserProfile(n);var r={};n.MasterId?(r.MasterId=n.MasterId,k=n.MasterId):t.debug(i,h,"authProfile.MasterId is undefined");n.DisplayName?r.DisplayName=n.DisplayName:t.debug(i,h,"authProfile.DisplayName is undefined");Object.getOwnPropertyNames(r).length>0&&CnnXt.Storage.SetUserData(r);a.resolve()}catch(f){t.warn(i,h,"EXCEPTION",f);CnnXt.Storage.SetUserState(u.NotLoggedIn);a.resolve()}}).fail(function(n){t.debug(i,h,"customAuth.GetAuthProfileFunc.fail (error)",n);CnnXt.Storage.SetUserState(u.NotLoggedIn);a.resolve()})}).fail(function(n){t.debug(i,h,"customAuth.GetAuthProfileFunc.fail (error)",n);CnnXt.Storage.SetUserState(u.NotLoggedIn);a.resolve()})}catch(v){t.warn(i,h,"EXCEPTION",v);CnnXt.Storage.SetUserState(u.NotLoggedIn);a.resolve()}else a.resolve();a.promise().then(function(){var a,v;if(r==null||r==undefined||f.Auth0||(f.Janrain&&(window.localStorage.getItem("janrainCaptureToken")?r==u.NotLoggedIn&&(r=null):(r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r))),r==u.NotLoggedIn?(CnnXt.Storage.ClearUser(),CnnXt.Storage.SetUserState(u.NotLoggedIn),c.reject("onNotAuthorized")):(e=CnnXt.Storage.GetUserData(),n(o.ActionShowLogin).hide(),n(o.LogoutButton).show(),r==u.LoggedIn?(f.Janrain?a="Janrain":f.MG2?a="MG2":f.GUP?a="GUP":f.Custom&&(a="Custom"),c.reject("onAuthorized")):w()&&(v=g(),c.reject(v))),r!=null&&c.resolve(!0)),!f.Custom&&(r==null||r==undefined||f.GUP||f.Auth0))try{s.Start=new Date;r=u.NotLoggedIn;CnnXt.Storage.SetUserState(r);CnnXt.Storage.SetAccountDataExpirationCookie(!0);ot().done(function(e){if(t.debug(i,h,"getUserData.done -- result",e),!e)throw"No User Data Result";if(k=e,f.MG2)CnnXt.API.GetUserByEncryptedMasterId({payload:{encryptedMasterId:e},onSuccess:function(r){f.Auth0?r.AuthSystem="Auth0":f.GUP&&(r.AuthSystem="GUP");t.debug(i,h,"<< SUCCESS >>","data",r);l("MasterId",r);s.Done=new Date;c.resolve(!0);n(o.ActionShowLogin).hide();n(o.LogoutButton).show()},onNull:function(){t.debug(i,h,"<< NO RESULTS >>");s.Done=new Date;c.reject("GetUserByMasterId.onNull")},onError:function(n){t.debug(i,h,"<< ERROR >>","err",n);s.Done=new Date;c.reject("GetUserMasterId.onError")}});else if(f.Janrain)CnnXt.API.GetUserByMasterId({payload:{id:e},onSuccess:function(n){t.debug(i,h,"<< SUCCESS >>","data",n);n.AuthSystem="Janrain";l("externalId",n);s.Done=new Date;c.resolve(!0)},onNull:function(){t.debug(i,h,"<< NO RESULTS >>");s.Done=new Date;c.reject("GetUserByToken.onNull")},onError:function(n){t.debug(i,h,"<< ERROR >>","err",n);s.Done=new Date;c.reject("GetUserByToken.onError")}});else if(f.Auth0)r=u.LoggedIn,CnnXt.Storage.SetUserState(r),CnnXt.Storage.GetUserData()?(l("externalId",CnnXt.Storage.GetUserData()),c.resolve(!0)):CnnXt.API.GetUserByMasterId({payload:{id:e},onSuccess:function(n){n.AuthSystem="Auth0";t.debug(i,h,"<< SUCCESS >>","data",n);l("externalId",n);s.Done=new Date;c.resolve(!0)},onNull:function(){t.debug(i,h,"<< NO RESULTS >>");s.Done=new Date;c.reject("GetUserByExternalId.onNull")},onError:function(n){t.debug(i,h,"<< ERROR >>","err",n);s.Done=new Date;c.reject("GetUserByExternalId.onError")}});else if(f.GUP){var a=vt(e);s.Done=new Date;t.debug(i,h,"getUserData.done -- gupUserHasAccess",a);c.resolve(!0);t.debug(i,h,"getUserData.done","Has GUP Data",e)}else CnnXt.Event.fire("onCriticalError",{"function":"getUserData.done",error:"Unknown Registration Type"})}).fail(function(n){t.debug(i,h,"getUserData.fail -- err",n);s.Done=new Date;c.reject(n)})}catch(y){t.error(i,h,"EXCEPTION",y);s.Done=new Date;c.reject()}})}),c.promise()},l=function(o,s){var a="processSuccessfulLogin",h,l,y,c,s;try{r=u.LoggedIn;e=CnnXt.Utils.ShapeUserData(s);h=CnnXt.Storage.GetUserData();h&&e&&(e.IgmContent=e.IgmContent?e.IgmContent:h.IgmContent,e.IgmRegID=e.IgmRegID?e.IgmRegID:h.IgmRegID,e.MasterId=e.MasterId?e.MasterId:h.MasterId,e.UserToken=e.UserToken?e.UserToken:h.UserToken);CnnXt.Storage.SetUserData(e);CnnXt.Storage.SetAccountDataExpirationCookie(!0);t.debug(i,a,"type",o,"USER_DATA",e);nt(!0);e.Subscriptions&&e.Subscriptions!=null&&(!e.Subscriptions||_.values(e.Subscriptions).length||e.Subscriptions.OwnedSubscriptions!=null)?(_.isObject(e.Subscriptions)||(e.Subscriptions=n.parseJSON(e.Subscriptions)),l=null,l=e.Subscriptions.OwnedSubscriptions?_.map(e.Subscriptions.OwnedSubscriptions,function(n){return n.BillingAddress&&n.BillingAddress.ZipCode?n.BillingAddress.ZipCode:n.DeliveryAddress?n.DeliveryAddress.ZipCode:null}):_.map(e.Subscriptions,function(n){return n.BillingAddress&&n.BillingAddress.ZipCode?n.BillingAddress.ZipCode:n.PostalCode}),CnnXt.Storage.SetUserZipCodes(l),n("#ddZipCode").html(l.toString())):v.show("NoSubscriptionData");f.MG2?(e.IgmRegID&&CnnXt.Storage.SetigmRegID(e.IgmRegID),e.IgmContent&&CnnXt.Storage.SetIgmContent(e.IgmContent)):f.Janrain||f.GUP||f.Auth0||CnnXt.Event.fire("onCriticalError",{"function":"processAuthentication",error:"Unknown Registration Type"});et(e);w()&&(y=n("body").data("modalmanager"),y&&(c=y.getOpenModals(),t.debug(i,a,"openModals",c),c.length>0&&c[0].isShown&&(v.show("AuthSuccess"),setTimeout(function(){c[0].$element.modal("hide")},1500))));s={UserId:Fprinting().getDeviceId(),ConfigCode:CnnXt.GetOptions().configCode,SiteCode:CnnXt.GetOptions().siteCode,SettingsKey:CnnXt.GetOptions().settingsKey,ViewData:CnnXt.Campaign.GetLocalViewData()};CnnXt.User.getMasterId()&&(s.masterId=CnnXt.User.getMasterId());CnnXt.Storage.SetUserState(r)}catch(p){t.error(i,a,"EXCEPTION",p)}},et=function(n){var f="defineUserState";try{n.DigitalAccess&&_.isEmpty(n.DigitalAccess.Errors)?n.Subscriptions&&n.Subscriptions.length!=0?n.DigitalAccess.AccessLevel.IsPremium?r=u.Subscribed:n.DigitalAccess.AccessLevel.IsUpgrade?r=u.SubscribedNotEntitled:n.DigitalAccess.AccessLevel.IsPurchase&&(r=u.NoActiveSubscription):r=u.LoggedIn:r=u.LoggedIn}catch(e){t.error(i,f,"EXCEPTION",e)}},w=function(){var n=!1;if(u)switch(r){case u.Subscribed:case u.SubscribedNotEntitled:case u.NoActiveSubscription:n=!0}return n},g=function(){var n="onNotAuthorized";switch(r){case u.LoggedIn:n="onAuthorized";break;case u.Subscribed:n="onHasAccess";break;case u.SubscribedNotEntitled:n="onHasAccessNotEntitled";break;case u.NoActiveSubscription:n="onHasNoActiveSubscription"}return n},ot=function(){var o="getUserData",e=n.Deferred(),c,h,s,l;try{return f.MG2?(c=CnnXt.Storage.GetigmRegID(),c?e.resolve(c):e.reject("No MG2 UserToken")):f.Janrain?window.JANRAIN?window.localStorage.getItem("janrainCaptureToken")?(t.debug(i,o,"Janrain Loaded"),h=ht(),t.debug(i,o,"janrainProfile",h),h.uuid?(r=u.LoggedIn,CnnXt.Storage.SetUserState(r),e.resolve(h.uuid)):e.reject("No Janrain Profile Data")):(r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),e.reject("Janrain Logged out User")):(r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),e.reject("Janrain object is exist")):f.GUP?at().then(function(n){t.debug(i,o,"getCurrentGUPUser.then (data)",n);n&&e.resolve(n)}).fail(function(n){t.debug(i,o,"getCurrentGUPUser.fail (error)",n);e.reject()}):f.Auth0?(s=Connext.GetOptions().authSettings.domain,(s==null||s=="")&&(s=Connext.GetOptions().authSettings.auth0.client?Connext.GetOptions().authSettings.auth0.client.baseOptions.domain:Connext.GetOptions().authSettings.auth0._domain),l="https://"+s+"/user/ssodata/",n.ajax({url:l,type:"GET",withCredentials:!0,crossDomain:!0,xhrFields:{withCredentials:!0},success:function(n){if(n&&n.sso)try{e.resolve(n.lastUsedUserID)}catch(f){t.error(i,o,"auth0 parse response error",f);r=u.NotLoggedIn;CnnXt.Storage.SetUserState(r);CnnXt.Storage.ClearUser();e.reject(null)}else t.debug(i,o,"SSO - false",n),r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),CnnXt.Storage.ClearUser(),e.reject(null)}})):(CnnXt.Event.fire("onCriticalError",{"function":"getUserData",error:"Unknown Registration Type"}),e.reject("Unknown Registration Type")),e.promise()}catch(a){t.error(i,o,"EXCEPTION",a)}},st=function(){var n="logoutUser";try{t.debug(i,n);nt(!1);CnnXt.Storage.SetUserState(u.NotLoggedIn);CnnXt.Run()}catch(r){t.error(i,n,"EXCEPTION",r)}},ht=function(){var u="getJanrainProfileData",r;try{return r=window.localStorage.getItem("janrainCaptureProfileData"),r==null&&(r=window.localStorage.getItem("janrainCaptureReturnExperienceData")),r?n.parseJSON(r):!1}catch(f){return t.log(i,u,"EXCEPTION",f),!1}},ct=function(n){var r="janrainAuthenticationCallback";try{if(t.debug(i,r,n),!n.userData.uuid)throw"No userData UUID";CnnXt.API.GetUserByMasterId({payload:{id:n.userData.uuid},onSuccess:function(n){n.AuthSystem="Janrain";t.debug(i,r,"<< SUCCESS >>","data",n);l("Form",n)},onNull:function(){t.debug(i,r,"<< NO RESULTS >>")},onError:function(n){t.debug(i,r,"<< ERROR >>","err",n)}})}catch(u){t.error(i,r,"EXCEPTION",u)}},lt=function(){var n=500,r=600,u=screen.width/2-n/2,f=screen.height/2-r/2,e=window.open(p.LoginServiceBasePath+"authenticate/?window-mode=popup","_blank","toolbar=no, scrollbars=yes, resizable=no, width="+n+", height="+r+", top="+f+", left="+u);e.onunload=function(n){t.debug(i,"<< GUP >>",n)};return},at=function(){return t.debug("User","getCurrentGUPUser"),n.ajax({type:"POST",url:p.UserServiceBasePath+"user/?callback=?",contentType:"application/json; charset=utf-8",dataType:"json",async:!0})},vt=function(n){var f="authenticateGUPUser";try{return t.debug(i,f),!n.meta.isAnonymous&&n.response.user?n.response.user.hasMarketAccess?(t.debug(i,f,"GUP User <<IS>> LOGGED IN, AND has market access"),r=u.Subscribed,CnnXt.Storage.SetUserState(r),!0):(t.debug(i,f,"GUP User <<IS>> LOGGED IN, but doesnt have marketAccess"),r=u.LoggedIn,CnnXt.Storage.SetUserState(r),!1):(t.debug(i,f,"GUP User <<NOT>> LOGGED IN"),r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),!1)}catch(e){return t.error(i,f,"EXCEPTION",e),r=u.NotLoggedIn,CnnXt.Storage.SetUserState(r),!1}},yt=function(){var n="registerEventlisteners";try{if(f.GUP)window.jQuery(window).on("focus.gup_login_popup",function(){t.debug("focus.gup_login_popup")})}catch(r){t.error(i,n,"EXCEPTION",r)}},nt=function(f){var s="handleUILoggedInStatus",e;try{e=n(o.ActionShowLogin);y=f;r=f?u.LoggedIn:u.NotLoggedIn;y?(n(o.LogoutButton).show(),n(o.ActionShowLogin).hide(),e.html(e.data("mg2-logged-in"))):(e.html(e.data("mg2-logged-out")),CnnXt.Storage.ClearUser(),n(o.LogoutButton).hide(),n(o.ActionShowLogin).show(),n("#ddZipCode").html(CnnXt.Storage.GetActualZipCodes()))}catch(h){t.debug(i,s,"EXCEPTION",h)}},pt=function(r,u){var f="MG2Authenticate";try{if(!r)return c.find(".alert").remove(),v.showAndHide("Please enter email",1e4),a.off(),!1;if(!u)return c.find(".alert").remove(),v.showAndHide("Please enter password",1e4),a.off(),!1;t.debug(i,f);CnnXt.API.GetUserByEmailAndPassword({payload:{email:r,password:u},onSuccess:function(u){u.Email=r;u.AuthSystem="MG2";t.debug(i,f,"<< SUCCESS >>","data",u);l("Form",u);n(o.ActionShowLogin).hide();n(o.LogoutButton).show();CnnXt.Run()},onNull:function(){t.debug(i,f,"<< NO RESULTS >>");v.show("NotAuthenticated")},onError:function(n){var r,u,o,e;if(t.debug(i,f,"<< ERROR >>","err",n),r="GenericAuthFailed",n.responseJSON||n.responseText)try{t.debug(i,f,"try parse error response");!n.responseJSON&&n.responseText?(u=JSON.parse(n.responseText),u.Message&&(o=JSON.parse(u.Message),r=o.Message,r=="UserName or Password invalid."&&(r=d))):(r=n.responseJSON.Message,e=JSON.parse(n.responseJSON.Message),e.Message&&(r=e.Message,r=="UserName or Password invalid."&&(r=d)))}catch(s){t.debug(i,f,"Error of parse response JSON")}c.find(".alert").remove();v.showAndHide(r,1e4)},onComplete:function(){a.off()}})}catch(e){t.error(i,f,"EXCEPTION",e)}},tt=function(){var n=CnnXt.GetOptions().authSettings;(n.auth0Lock==null||n.auth0Lock==undefined)&&t.warn("showAuth0Login","","<<EXCEPTION>>  Auth0Lock object is null",n.auth0Lock);n.auth0Lock.show()},wt=function(){var n="clearUserStateIfWasRedirect";try{t.debug("User",n);CnnXt.Utils.getUrlParam("clearUserState")&&(CnnXt.Storage.SetUserData(null),CnnXt.Storage.SetUserState(null))}catch(r){t.error(i,n,"EXCEPTION",r)}};return{init:function(n){t=CnnXt.Logger;h=n?n:{};u=CnnXt.Common.USER_STATES;r=u.NotLoggedIn;rt();h.Site.RegistrationTypeId==3&&(p={UserServiceBasePath:h.Settings?h.Settings.GUPAccountService:"",LoginServiceBasePath:h.Settings?h.Settings.GUPAccountLoginUrl:""})},CheckAccess:function(){var t=n.Deferred();return ft().done(function(){t.resolve()}).fail(function(){t.reject()}).always(function(){var t=Connext.Storage.GetLocalConfiguration().Site.RegistrationTypeId,n=CnnXt.Common.RegistrationTypes[t],i=g();CnnXt.Storage.GetUserState()!=u.NotLoggedIn&&CnnXt.Storage.GetUserState()!=null&&CnnXt.Event.fire("onLoggedIn",{AuthSystem:n,AuthProfile:CnnXt.Storage.GetUserProfile(),MG2AccountData:Connext.Storage.GetUserData()});CnnXt.Event.fire(i,{AuthSystem:n,AuthProfile:CnnXt.Storage.GetUserProfile(),MG2AccountData:Connext.Storage.GetUserData()})}),t.promise()},GetAuthTiming:function(){return s},JanrainLoaded:function(){it=!0;t.debug(i,"JanrainLoaded")},onLoginSuccess:function(n){t.debug(i,"onLoginSuccess",n);ct(n)},getUserState:function(){return CnnXt.Storage.GetUserState()},onLogout:function(){t.debug(i,"onLogout");y=!1;CnnXt.Storage.ClearUser()},getMasterId:function(){return CnnXt.Storage.GetUserData()?CnnXt.Storage.GetUserData().IgmRegID?CnnXt.Storage.GetUserData().IgmRegID:CnnXt.Storage.GetUserData().MasterId:null},isUserHasHighState:w,processSuccessfulLogin:l,showAuth0Login:tt}},ConnextMeterCalculation=function(n){function e(r){var f="evalArticleAge",u=n.Deferred(),e,o;try{t.debug(i,f,"-- Testing ---");e=w(r.Options);o=r.Options.Qualifier=="="?"==":r.Options.Qualifier;eval(e+o+r.Options.Val)?u.resolve():u.reject()}catch(s){t.error(i,f,s);u.reject(!1)}return u.promise()}function o(r){var f="evalUrlParam",u=n.Deferred(),e,o;try{t.debug(i,f,"-- Testing ---");e=CnnXt.Utils.GetUrlParam(r.Options.ParamName);o=CnnXt.Common.QualifierMap[r.Options.Qualifier];e!=null?eval("'"+e.toUpperCase()+"'"+o+"'"+r.Options.Val.toUpperCase()+"'")?(t.debug(i,f,"Segment["+r.id+"] --- Passed"),u.resolve()):(t.debug(i,f,"Segment["+r.id+"] --- FAILED"),u.reject()):o=="=="?u.reject():u.resolve()}catch(s){t.error(i,f,s);u.reject()}return u.promise()}function s(r){var o="evalHiddenField",u=n.Deferred(),e,f,s,h;try{t.debug(i,o,"-- Testing ---");e=!1;f=r.Options.Selector.trim()?n(r.Options.Selector+"[type='hidden']"):null;f&&f.length>0&&(s=n(f[0]).val(),h=CnnXt.Common.QualifierMap[r.Options.Qualifier],e=eval("'"+s.toUpperCase()+"'"+h+"'"+r.Options.Val.toUpperCase()+"'"));e?u.resolve():u.reject()}catch(c){t.error(i,o,c);u.reject(!1)}return u.promise()}function h(r){var f="evalSubdomain",u=n.Deferred();try{var e=r.Options.Val.toUpperCase(),o=window.location.hostname.toUpperCase(),s=r.Options.Qualifier.toUpperCase();s=="IN"^o.split(".").reverse().indexOf(e)>1?u.reject():u.resolve()}catch(h){t.error(i,f,h);u.reject(!1)}return u.promise()}function c(t){var i=!1,r=n.Deferred(),u;try{u=CnnXt.Storage.GetActualZipCodes();u&&t.Options.GeoQalifier!==undefined&&u.forEach(function(n){if(~t.Options.Zipcodes.indexOf(n))i=t.Options.GeoQalifier.toUpperCase()=="IN";else if(t.Options.Zipcodes.indexOf("*")>=0){var r=t.Options.Zipcodes.split(",")||t.Options.Zipcodes.split(""),u=r.filter(function(t){var i=t.split(""),r=n.split("");return r.length!=i.length?!1:i.every(function(n,t){return i[t]==="*"?!0:n===r[t]})});i=u.length>0?t.Options.GeoQalifier.toUpperCase()=="IN":t.Options.GeoQalifier.toUpperCase()!="IN"}else i=t.Options.GeoQalifier.toUpperCase()!="IN"})}catch(f){i=!1}return i?r.resolve():r.reject(),r.promise()}function l(r){var o="evalJSVar",e=n.Deferred(),s,h;try{t.debug(i,o,"-- Testing ---");var f=!0,c=r.Options.VarName,u=eval(c);n.isArray(u)?(u=u.map(function(n){return n.trim().toLowerCase()}),f=r.Options.Qualifier=="Contains"||r.Options.Qualifier=="Does Not Contain"?u.indexOf(r.Options.Val.toLowerCase())>=0?r.Options.Qualifier=="Contains":r.Options.Qualifier=="Doesn't contain":r.Options.Qualifier=="Equals"):(u&&(u=u.toString().toLowerCase()),r.Options.Qualifier=="Contains"||r.Options.Qualifier=="Does Not Contain"?u==undefined?f=r.Options.Qualifier=="Does Not Contain":(s=r.Options.Delimiter?new RegExp(r.Options.Delimiter.replace(/space/g,"/s"),"g"):/[ ,;]/g,h=u.split(s),f=h.indexOf(r.Options.Val.toLowerCase())>=0?r.Options.Qualifier=="Contains":r.Options.Qualifier=="Does Not Contain"):CnnXt.Utils.JSEvaluate(u,r.Options.Qualifier,r.Options.Val.toLowerCase(),"JavascriptCriteria")||(f=!1));f?e.resolve():e.reject()}catch(l){t.error(i,o,l);e.reject()}return e.promise()}function a(r){var o="evalUserState",u=n.Deferred(),f,e;try{f=CnnXt.User.getUserState();f==null&&(f="Logged Out");e=!0;CnnXt.Utils.JSEvaluate(f,r.Options.Qualifier,r.Options["User State"],"UserStateCriteria","string")||(e=!1);e?u.resolve():u.reject()}catch(s){t.error(i,o,s);u.reject(!1)}return u.promise()}function v(r){var o="evalAdBlock",u=n.Deferred(),f,e;try{f=CnnXt.Utils.detectAdBlock();e=r.Options["Ad Block"].toUpperCase();e=="DETECTED"^f?u.reject(!1):u.resolve()}catch(s){t.error(i,o,s);u.reject(!1)}return u.promise()}function y(r){var f="evalUrlMask",u=n.Deferred();try{t.debug(i,f,"-- Testing ---");var e=!1,o=window.location.href.replace(/#$/,""),s=r.Options.Val.replace(/\*$/,"");e=~o.indexOf(s)&&r.Options.Qualifier=="Equals"?!0:~o.indexOf(s)||r.Options.Qualifier!="Not Equals"?!1:!0;e?u.resolve():u.reject()}catch(h){t.error(i,f,h);u.reject(!1)}return u.promise()}function p(r){var o="evalMeta",f=n.Deferred(),e;try{t.debug(i,o,"-- Testing ---");var u=!1,s=CnnXt.Utils.getMetaTagsWithKeywords(),h="\\b"+r.Options.Val+"\\b",c=new RegExp(h);for(e=0;e<s.length;e++)if(c.test(s[e].content)){t.debug(i,o,"Found keyword",r.Options.Val);u=!0;break}u&&r.Options.Qualifier=="Not Equal"&&(u=!1);u||r.Options.Qualifier!="Not Equal"||(u=!0);u?f.resolve():f.reject()}catch(l){t.error(i,o,l);f.reject(!1)}return f.promise()}function w(u){var f="getArticleAge",o,e;try{if(t.debug(i,f,u),_.isNumber(r.articleAge)&&!isNaN(r.articleAge))return t.debug(i,f,"Article Age Already Deterimed...using Cached value"),r.articleAge;o=_.isNothing(u.Format)?CnnXt.Common.DefaultArticleFormat:u.Format;t.info(i,f,"Using Format: ",o);e=u.Selector.indexOf("$")>-1?eval(u.Selector):n(u.Selector).text();t.info(i,f,"articleDateData",e);var h=CnnXt.Utils.ParseCustomDates(e,o),c=CnnXt.Utils.Now(),s=CnnXt.Utils.Diff(c,h);return t.debug(i,f,"Date Used for Compare: "+e,"Article Age In Days:: ("+s+")"),r.articleAge=s,r.articleAge}catch(l){return t.error(i,f,l),!1}}var i="MeterCalculation",t,u={ArticleAge:e,HiddenField:s,Subdomain:h,Geo:c,Url:o,JSVar:l,Meta:p,UserState:a,AdBlock:v,URLMask:y},r={},f=function(r){var f="calculateMeterLevel",e=n.Deferred(),o;try{t.debug(i,f,"calculating meter level....");o=!1;n.each(r,function(r,s){if(t.debug(i,f,"rules.each",r,s),o)t.debug(i,f,"Rule Already Set...Skipping this rule.");else{var h=!0;n.each(s.Segments,function(n,r){t.debug(i,f,"segments.each",n,r);h?u[r.SegmentType](r).done(function(){t.debug(i,f,"Segment["+r.id+"] --- PASSED")}).fail(function(){h=!1;t.debug(i,f,"Segment["+r.id+"] --- FAILED")}):t.debug(i,f,"Previous Segment Failed, Not processing rest of segments.")});h&&(t.debug(i,f,"All Segments Passed, Using ["+s.Name+"] Rule "),o=!0,e.resolve(s))}});o||e.reject()}catch(s){t.error(i,f,"EXCEPTION",s);e.reject(s)}return e.promise()};return{init:function(){t=CnnXt.Logger;t.debug(i,"MeterCalculation.Init")},CalculateMeterLevel:function(n){return f(n)}}},ConnextCampaign=function(n){var r="Campaign",a="{{ArticleLeft}}",i,t,u,v,y=function(n,f){var e="processCampaign";try{if(i.debug(r,e,n),CnnXt.Storage.ClearOldCookies(),!n)throw"No Meter Level Set";if(!f)throw"No Campaign Data.";if(u=n,t=g(n),t)i.debug(r,e,"Conversation To Process",t),w();else{CnnXt.Storage.SetCurrentConversation(null);p();throw CnnXt.Common.ERROR.NO_CONVO_FOUND;}}catch(o){i.warn(r,e,"EXCEPTION",o);CnnXt.Event.fire("onCriticalError",o)}},p=function(){CnnXt.Storage.UpdateViewedArticles(-1);n("#ddCurrentConversationArticleViews").html(CnnXt.Storage.GetCurrentConversationViewCount(-1))},w=function(){var n="processConversation",u,f;try{i.debug(r,n);CnnXt.Storage.UpdateViewedArticles(t.id);tt(CnnXt.Storage.GetCurrentConversationViewCount(t.id));CnnXt.Storage.SetCurrentConversation(t);u=c();f=c(!0);d(f);CnnXt.Storage.SetCurrentConversation(t);CnnXt.Event.fire("onConversationDetermined",t);k(t);u.length>0?(i.debug(r,n,"ACTIONS DETERMINGED ---> ",u),CnnXt.Action.ProcessActions(u)):i.warn(r,n,"No 'Actions' to execute.")}catch(e){i.error(r,n,"EXCEPTION",e)}},b=function(){var n={},t,i;if(n.AllowedIpSet=CnnXt.Storage.GetWhitelistSetIdCookie()?JSON.parse(CnnXt.Storage.GetWhitelistSetIdCookie()):undefined,t=CnnXt.Storage.GetLocalConfiguration(),t.Campaign&&t.Campaign.Conversations){i=t.Campaign.Conversations;for(convo in i)n[convo]={},n[convo].ActiveConversationId=CnnXt.Storage.GetCurrentConversations()[convo]!=null?CnnXt.Storage.GetCurrentConversations()[convo].id:null,n[convo].ArticleCount=CnnXt.Storage.GetCurrentConversations()[convo]!=null?CnnXt.Storage.GetViews(CnnXt.Storage.GetCurrentConversations()[convo].id):null,n[convo].Conversations=[],i[convo].forEach(function(t){var i=CnnXt.Storage.GetDeviceViews(t.id);n[convo].Conversations.push({Id:t.id,ViewCount:i,StartDate:t.Props.Date.started})}),CnnXt.Storage.GetDeviceViews(-1)&&n[convo].Conversations.push({Id:-1,ViewCount:CnnXt.Storage.GetDeviceViews(-1),StartDate:null})}return n},k=function(n){if(!n||!n.Options||!n.Options.Expirations||!n.Options.Expirations.Activate)return!1;var t=n.Options.Expirations.Activate;CnnXt.Activation.init(t)},d=function(u){var e=99999,o=_.where(u,{ActionTypeId:3}),s=[];i.debug(r,"calculateArticleLeft","Try to find paywalls");o.length>0?(i.debug(r,"paywalls found",o),n.each(o,function(t,i){var r=-1;i.Who.ViewsCriteria&&n.each(i.Who.ViewsCriteria,function(n,t){t.Qualifier=="=="||t.Qualifier==">="?r=t.Val>r?t.Val:r:t.Qualifier==">"&&(r=parseInt(t.Val)+1>r?parseInt(t.Val)+1:r);s.push(r)});e>r&&(e=r)}),e=e==-1?99999:_.min(s),t.Props.ArticleLeft=e==99999?"unlimited":e-f(),t.Props.ArticleLeft<0&&(t.Props.ArticleLeft=0),n.each(u,function(n,i){i.What.Html&&(i.What.Html=i.What.Html.replace(a,t.Props.ArticleLeft))})):t.Props.ArticleLeft="unlimited";n("#ddCurrentConversationArticleLeft").html(t.Props.ArticleLeft)},g=function(){var n="getCurrentConversation",f,o,c;try{return(f=nt(u),f)?(i.debug(r,n,"Found Stored Conversation",f),t=f,s()?(i.debug(r,n,"Found Stored Conversation --- IS VALID"),t):(i.debug(r,n,"Found Stored Conversation --- NOT VALID"),t=h(),t?(l(),CnnXt.Storage.ResetConversationViews(t,Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain),CnnXt.Event.fire("onDebugNote","Conversation Expire: "+t.Props.expiredReason),t):f)):(o=e(u),o)?(t=o[0],l(),i.debug(r,n,"No Current Conversation Stored....Using first conversation in campaign",t),s())?t:(i.debug(r,n,"Found Stored Conversation --- NOT VALID"),c=h(),c)?(CnnXt.Storage.ResetConversationViews(t,Connext.Storage.GetLocalConfiguration().Settings.UseParentDomain),c):t:(i.debug(r,n,"No Conversation for this meter level"),i.debug(r,n,"NO RETURN FIRED, USING CATCH ALL"),!1)}catch(a){return i.error(r,n,"EXCEPTION",a),!1}},s=function(){var e="isConversationValid",u=t.Options.Expirations,o,s,f,h,c;try{if(t.Props.isExpired)return i.debug(r,e,"Current conversation was previously set to expired."),!1;if(u.Time){var l=CnnXt.Utils.Now(),a=new Date(Date.parse(t.Props.Date.expiration)),v=l>=a;if(v)return i.debug(r,e,"Current conversation has expired base on date..."),t.Props.isExpired=!0,t.Props.expiredReason="Time",!1}else i.debug(r,e,"No expiration time set for this conversation.");if(u.UserState&&((o=u.UserState,o["User State"]==CnnXt.User.getUserState())||o["User State"]=="Logged In"&&CnnXt.User.getUserState()=="Subscribed"))return t.Props.isExpired=!0,t.Props.expiredReason="UserState",!1;if(u.Register&&CnnXt.GetOptions().integrateFlittz&&window.Flittz&&window.Flittz.FlittzUserStatus=="FlittzLoggedIn")return t.Props.isExpired=!0,t.Props.expiredReason="Register",!1;if(u.JSVar){i.debug(r,e,"Checking Javascript Expiration Criteria: ",u);s=u.JSVar.JSVarName;try{f=eval(s)}catch(y){}if(n.isArray(f)){if(f=f.map(function(n){return n.trim().toLowerCase()}),u.JSVar.JSVarQualifier=="In"||u.JSVar.JSVarQualifier=="NotIn")if(f.indexOf(u.JSVar.JSVarValue.toLowerCase())>=0){if(u.JSVar.JSVarQualifier=="In")return t.Props.isExpired=!0,t.Props.expiredReason="JSVar",!1}else if(u.JSVar.JSVarQualifier=="NotIn")return t.Props.isExpired=!0,t.Props.expiredReason="JSVar",!1}else if(f&&(f=f.toString().toLowerCase()),u.JSVar.JSVarQualifier=="In"||u.JSVar.JSVarQualifier=="NotIn"){if(h=u.JSVar.JSVarDelimiter?new RegExp(u.JSVar.JSVarDelimiter.replace(/space/g,"/s"),"g"):/[ ,;]/g,c=f.split(h),c.indexOf(u.JSVar.JSVarValue.toLowerCase())>=0){if(u.JSVar.JSVarQualifier=="In")return t.Props.isExpired=!0,t.Props.expiredReason="JSVar",!1}else if(u.JSVar.JSVarQualifier=="NotIn")return t.Props.isExpired=!0,t.Props.expiredReason="JSVar",!1}else if(CnnXt.Utils.JSEvaluate(f,u.JSVar.JSVarQualifier,u.JSVar.JSVarValue.toLowerCase(),"JavascriptCriteria"))return t.Props.isExpired=!0,t.Props.expiredReason="JSVar",!1}return!0}catch(y){return i.error(r,e,"EXCEPTION",y),!0}},h=function(){var o="getNextConversation",n,f;try{return n=t.Props.expiredReason,f=t.Options.Expirations[n].nextConversation,i.debug(r,o,"ExpirationReason",n,f,e(u)),t=_.findByKey(e(u),{id:f})}catch(s){i.error(r,o,"EXCEPTION",s)}},c=function(u){var e="determineConversationActions";try{i.debug(r,e,t.Actions);var s=[],h=!1,c=f();return n.each(t.Actions,function(f,l){var v,a;if(i.debug(r,e,"Actions.EACH",l),l.ActionTypeId!=3||t.Props.paywallLimit||(t.Props.paywallLimit=l.Who.ViewsCriteria?l.Who.ViewsCriteria[0].Val:Infinity,o()),l.ActionTypeId!=3||!h){v=!0;try{if(a=l.Who,a.ViewsCriteria&&!u?(_.isArray(a.ViewsCriteria)||(a.ViewsCriteria=[a.ViewsCriteria]),a.ViewsCriteria.forEach(function(n){i.debug(r,e,"Checking ViewsCriteria",n);CnnXt.Utils.JSEvaluate(parseInt(c),n.Qualifier,parseInt(n.Val),"ArticleView","integer")||(v=!1)})):a.ViewsCriteria&&u&&(v=!0),a.HiddenFieldCriteria&&v==!0&&(_.isArray(a.HiddenFieldCriteria)||(a.HiddenFieldCriteria=[a.HiddenFieldCriteria]),a.HiddenFieldCriteria.forEach(function(n){v&&(i.debug(r,e,"Checking HiddenFieldCriteria: ",n),CnnXt.Utils.JSEvaluate(CnnXt.Utils.GetHiddenFormFieldValue(n.Id),n.Qualifier,n.Val,"HiddenFormField")||(v=!1))})),a.GeoCriteria&&v==!0)try{_.isArray(a.GeoCriteria)||(a.GeoCriteria=[a.GeoCriteria]);a.GeoCriteria.forEach(function(n){if(v){i.debug(r,e,"Checking GeoCriteria: ",n);var t=CnnXt.Storage.GetActualZipCodes();t&&n.Type!==undefined&&t.forEach(function(t){if(~n.Zip.indexOf(t))v=n.Type.toUpperCase()=="IN";else if(n.Zip.indexOf("*")>=0){var i=n.Zip.split(",")||n.Zip.split(""),r=i.filter(function(n){var i=n.split(""),r=t.split("");return r.length!=i.length?!1:i.every(function(n,t){return i[t]==="*"?!0:n===r[t]})});v=r.length>0?n.Type.toUpperCase()=="IN":n.Type.toUpperCase()!="IN"}else v=n.Type.toUpperCase()!="IN"})}})}catch(p){v=!1}if(a.JavascriptCriteria&&v==!0)try{_.isArray(a.JavascriptCriteria)||(a.JavascriptCriteria=[a.JavascriptCriteria]);a.JavascriptCriteria.forEach(function(t){var f,u,o,s;if(v){i.debug(r,e,"Checking JavascriptCriteria: ",t);f=t.Eval;try{u=eval(f)}catch(h){}n.isArray(u)?(u=u.map(function(n){return n.trim().toLowerCase()}),v=t.Qualifier=="In"||t.Qualifier=="NotIn"?u.indexOf(t.Val.toLowerCase())>=0?t.Qualifier=="In":t.Qualifier=="NotIn":t.Qualifier=="=="):(u!==undefined&&u!==""&&(u=u.toString().toLowerCase()),t.Qualifier=="In"||t.Qualifier=="NotIn"?u==undefined?v=t.Qualifier=="NotIn":(o=t.Delimiter?new RegExp(t.Delimiter.replace(/space/g,"/s"),"g"):/[ ,;]/g,s=u.split(o),v=s.indexOf(t.Val.toLowerCase())>=0?t.Qualifier=="In":t.Qualifier=="NotIn"):CnnXt.Utils.JSEvaluate(u,t.Qualifier,t.Val.toLowerCase(),"JavascriptCriteria")||(v=!1))}})}catch(p){i.debug(r,e,"Error evaluating javascript criteria.");v=!1}a.ScreenSizeCriteria&&v==!0&&(_.isArray(a.ScreenSizeCriteria)||(a.ScreenSizeCriteria=[a.ScreenSizeCriteria]),a.ScreenSizeCriteria.forEach(function(n){v&&(i.debug(r,e,"Checking ScreenSizeCriteria: ",n),CnnXt.Utils.JSEvaluate(CnnXt.Utils.getDeviceType(),n.Qualifier,n.Value,"ScreenSizeCriteria","string")||(v=!1))}));a.UrlCriteria&&v==!0&&(_.isArray(a.UrlCriteria)||(a.UrlCriteria=[a.UrlCriteria]),a.UrlCriteria.forEach(function(n){v&&(i.debug(r,e,"Checking UrlCriteria",n),CnnXt.Utils.JSEvaluate(CnnXt.Utils.getUrlParam(n.Eval),n.Qualifier,n.Value,"UrlCriteria")||(v=!1))}));a.URLMaskCriteria&&v==!0&&a.URLMaskCriteria.forEach(function(n){if(v){i.debug(r,e,"Checking UrlCriteria",n);var f=window.location.href,t=f.replace(/#$/,""),o=t.length,u=n.Value.replace(/\*$/,""),s=u.length;t.indexOf(u)==0&&o>s&&n.Qualifier=="=="||t.indexOf(u)!=0&&n.Qualifier=="!="||(v=!1)}});a.SubDomainCriteria&&v==!0&&(_.isArray(a.SubDomainCriteria)||(a.SubDomainCriteria=[a.SubDomainCriteria]),a.SubDomainCriteria.forEach(function(n){if(v){i.debug(r,e,"Checking SubDomainCriteria",n);var t=n.Value.toUpperCase(),u=window.location.hostname.toUpperCase(),f=n.Qualifier.toUpperCase();f=="=="^u.split(".").reverse().indexOf(t)>1&&(v=!1)}}));a.MetaKeywordCriteria&&v==!0&&(_.isArray(a.MetaKeywordCriteria)||(a.MetaKeywordCriteria=[a.MetaKeywordCriteria]),a.MetaKeywordCriteria.forEach(function(n){var t;if(v){i.debug(r,e,"Checking MetaKeywordCriteria: ",n);var f=CnnXt.Utils.getMetaTagsWithKeywords(),u=!1,o="\\b"+n.Value+"\\b",s=new RegExp(o);for(t=0;t<f.length;t++)if(s.test(f[t].content)){i.debug(r,e,"Found keyword",n.Value);u=!0;break}u&&n.Qualifier=="!="&&(v=!1);u||(v=n.Qualifier=="!="?!0:!1)}}));a.UserStateCriteria&&v==!0&&(_.isArray(a.UserStateCriteria)||(a.UserStateCriteria=[a.UserStateCriteria]),a.UserStateCriteria.forEach(function(n){if(v){i.debug(r,e,"Checking UserStateCriteria",n);var t=CnnXt.User.getUserState();t||(t="Logged Out");CnnXt.Utils.JSEvaluate(t,n.Qualifier,n.Value,"UserStateCriteria","string")||(v=!1)}}));a.EZPayCriteria&&v==!0&&a.EZPayCriteria.forEach(function(n){var u,t,f;v&&(i.debug(r,e,"Checking EZPayCriteria",n),u=CnnXt.User.getUserState(),u!=="Logged Out"?(t=CnnXt.Storage.GetUserData(),t&&t.Subscriptions?(f=t.Subscriptions[0],f.IsEZPay.toString()!=n.Value&&(v=!1)):v=!1):v=!1)});a.ExpireDateCriteria&&v==!0&&a.ExpireDateCriteria.forEach(function(n){var f,t,u,o;v&&(i.debug(r,e,"Checking ExpireDateCriteria",n),f=CnnXt.User.getUserState(),f!=="Logged Out"?(t=CnnXt.Storage.GetUserData(),t&&t.Subscriptions?(u=t.Subscriptions[0],u.ExpirationDate&&(o=CnnXt.Utils.GetTimeByType(u.ExpirationDate,n["Expire Date Type"]),CnnXt.Utils.JSEvaluate(o,n.Qualifier,n.Value,"ExpireDateCriteria","integer")||(v=!1))):v=!1):v=!1)});a.AdBlockCriteria&&v==!0&&(_.isArray(a.AdBlockCriteria)||(a.AdBlockCriteria=[a.AdBlockCriteria]),a.AdBlockCriteria.forEach(function(n){if(v){i.debug(r,e,"Checking AdBlockCriteria",n);var t=CnnXt.Utils.detectAdBlock();t&&n.Value=="Detected"||(t||n.Value!="Not Detected")&&(v=!1)}}))}catch(y){v=!1;i.error(r,e,"EXCEPTION",y)}v?(i.debug(r,e,"===== ACTION PASSED =====",l),l.ActionTypeId!=3||u||(h=!0),s.push(l)):i.debug(r,e,"%%%%% ACTION FAILED %%%%%",l)}}),s}catch(l){i.error(r,e,"EXCEPTION",l)}},nt=function(n){var u="getStoredConversationByMeterLevel",f,t;try{return i.debug(r,u,"meterLevel",n),f=null,t=CnnXt.Storage.GetCurrentConversations(),i.debug(r,u,"currentConversations",t),t&&(f=t[n]),f}catch(e){return i.error(r,u,"EXCEPTION",e),!1}},e=function(n){var t="getAllConversationsMeterLevel";try{return i.debug(r,t,"meterLevel",n),CnnXt.Storage.GetCampaignData().Conversations[n]}catch(u){return i.error(r,t,"EXCEPTION",u),!1}},o=function(){var f="saveCurrentConversation",n;try{n=CnnXt.Storage.GetCurrentConversations();n[u]=t;CnnXt.Storage.SetCurrentConversations(n)}catch(e){i.error(r,f,"EXCEPTION",e)}},l=function(){var u="setDefaultConversationProps",n;try{if(n=CnnXt.Utils.Now(),t.Props.Date.started=t.Props.Date.started?t.Props.Date.started:CnnXt.Utils.Now(),t.Options.Expirations.Time)switch(t.Options.Expirations.Time.key){case"m":t.Props.Date.expiration=new Date(n.setMinutes(n.getMinutes()+parseInt(t.Options.Expirations.Time.val)));break;case"h":t.Props.Date.expiration=new Date(n.setHours(n.getHours()+parseInt(t.Options.Expirations.Time.val)));break;case"d":t.Props.Date.expiration=new Date(n.setDate(n.getDate()+parseInt(t.Options.Expirations.Time.val)));break;case"w":t.Props.Date.expiration=new Date(n.setDate(n.getDate()+parseInt(t.Options.Expirations.Time.val)*7));break;case"M":t.Props.Date.expiration=new Date(n.setMonth(n.getMonth()+parseInt(t.Options.Expirations.Time.val)));break;case"y":t.Props.Date.expiration=new Date(n.setFullYear(n.getFullYear()+parseInt(t.Options.Expirations.Time.val)))}else i.debug(u,"No expiration time set for this conversation.");o()}catch(f){i.error(r,u,"EXCEPTION",f)}},tt=function(n){var u="updateArticleViewCount";try{i.debug(r,u);t.Props.views=_.isNumber(arguments[0])?n:f();o()}catch(e){i.error(r,u,"EXCEPTION",e)}},f=function(){return CnnXt.Storage.GetCurrentConversationViewCount()};return{init:function(n){i=CnnXt.Logger;v=n;i.debug(r,"Campaign.Init")},ProcessCampaign:function(n,t){return y(n,t)},GetCurrentConversationProps:function(){try{return t.Props}catch(n){return i.error(r,"GetCurrentConversationProps.Exception",n),null}},GetCurrentConversation:function(){return t},GetCurrentConversationViewCount:function(){return f()},EventCompleted:function(){var n="EventCompleted";try{}catch(t){i.error(r,n,"<<EXCEPTION>>",t)}},GetLocalViewData:function(){return b()}}},ConnextAction=function(n){function c(){return t.debug(i,"getArticleCost"),sessionStorage.getItem("ArticleCost")}function p(t){var f=n(t.target),r=f.parents(".Mg2-connext"),i,u;r.length&&(i=n(r[0]).attr("id"),i&&(u=parseInt(i.split("-")[1]),t.actionId=u));CnnXt.Event.fire("onButtonClick",t)}function et(t){var f=n(t.target),r=f.parents(".Mg2-connext"),i,u;r.length&&(i=n(r[0]).attr("id"),i&&(u=parseInt(i.split("-")[1]),t.actionId=u));CnnXt.Event.fire("onNewsdayButtonClick",t);CnnXt.Event.fire("onButtonClick",t)}var i="Action",t,l="ConneXt_Action_Id-",r,s,e,u={CloseButton:"closeButton",CloseSpan:"closeSpan",ClickOutside:"clickOutside",EscButton:"escButton"},w="[data-fz-btn=smartAuth]",a,f={Banner:1,Modal:2,Paywall:3,Inline:4,SmallInfoBox:6,JSCall:7,Newsletter:11,Activation:12},b=function(r){var u="processActions";try{t.debug(i,u,r);n.each(r,function(n,r){t.debug(i,u,"Actions.EACH",n,r);r.What.Html?_.isArray(r.Who.PromiseCriteria)?(t.debug(i,u,"promises array found"),k(r.Who.PromiseCriteria).then(function(){t.debug(i,u,"Promise Criterias Resolved");v(r)},function(){t.debug(i,u,"Promise Criterias Rejected")})):v(r):t.debug(i,u,"ACTION has no html")})}catch(f){t.error(i,u,"EXCEPTION",f)}},k=function(r){var e="resolvePromiseCriterias",u=n.Deferred(),f;try{f=[];r.forEach(function(n){f.push(eval(n.Name))});n.when.apply(n,f).then(function(){arguments.length==0&&(arguments=[],arguments.push(null));Array.prototype.forEach.call(arguments,function(n,t){var i=r[t];CnnXt.Utils.JSEvaluate(n?n.toString().toLowerCase():n,i.Qualifier,i.Value.toLowerCase(),"Promise")||u.reject()});u.resolve()},function(){u.reject()})}catch(o){t.debug(i,e,"Promise object is null or undefined");u.reject()}return u.promise()},v=function(r){var f="handleAction",e,u;try{t.debug(i,f,"action",r);e=r.What.CSS;u=r.What.Html.trim();u=ut(u);u=n(u).prop("id",l+r.id);t.info("ACTION HTML",u);n(u).addClass("hide");n(u).prepend('<style id="'+r.id+'-mg2style">'+e+"<\/style>");r.inProgress=!1;n("#themeLink").length==0?n("body").append(u):n("#themeLink").before(u);d(r)}catch(o){t.error(i,f,"EXCEPTION",o)}},h=function(e){var b="executeAction",d,o,h,y,a,c,v,k,p;try{if(t.debug(i,b,e),e.What.Type==f.Paywall&&tt(e),e.closeEvent=null,o=n("#"+l+e.id),o.removeClass("hide"),e.What.Type==f.Banner&&(c=e.What.Location?e.What.Location:"top",v={},v[c]="0px",o.css(c,"-2500px").removeClass("hide"),k=o.outerHeight(),o.css(c,"-"+k+"px").animate(v,function(){})),e.What.Type==f.Modal){o.addClass("in");o.connextmodal({backdrop:"true"});o.resize();o.css("display","block");e.What["Transparent backdrop"]=="True"||e.What["Transparent backdrop"]=="true"?n(".connext-modal-backdrop.fade.in").addClass("transparent"):n(".connext-modal-backdrop.fade.in").removeClass("transparent");n(o).one("keydown",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(e.closeEvent=u.EscButton)}).one("hidden",function(){e.isMultipleTimeRepeatable&&(e.closeEvent==null||e.closeEvent==undefined?(e.closeEvent=u.ClickOutside,e.actionDom=o,CnnXt.Event.fire("onActionClosed",e)):(e.closeEvent===u.EscButton||e.closeEvent===u.CloseButton)&&(e.actionDom=o,CnnXt.Event.fire("onActionClosed",e)));e.isMultipleTimeRepeatable=!1})}if(e.What.Type==f.Paywall){if(a=o.data("display-type"),t.debug(i,b,"displayType",a),a=="inline"){if(r=e.What.Selector,s=e.What.Position,n(r).length==0)return t.debug(i,"not found element by current content selector",r),o.remove(),!1;o.remove();h=n(r).width();y=String(h).length<4?String(h)[0]+"00":String(h)[0]+String(h)[1]+"00";o.addClass("Mg2-inline-scale-"+y);s=="before"?n(r).prepend(o):n(r).append(o);n(window,r).resize(function(){var t=n(r).width(),i=String(t).length<4?String(t)[0]+"00":String(t)[0]+String(t)[1]+"00",u=o.attr("class").replace(/\b\sMg2-inline-scale-\d+\b/g,"");o.attr("class",u);o.addClass("Mg2-inline-scale-"+i)})}else if(a=="modal"){o.addClass("in");e.What.NotClosable_paywall=="True"||e.What.NotClosable_paywall=="true"?(o.find(".closebtn").attr("data-dismiss","notclosablepaywall"),o.connextmodal({backdrop:"static",keyboard:!1})):o.connextmodal({backdrop:"true"});e.What.Transparent_backdrop_paywall=="True"||e.What.Transparent_backdrop_paywall=="true"?n(".connext-modal-backdrop.fade.in").addClass("transparent"):n(".connext-modal-backdrop.fade.in").removeClass("transparent");o.resize();o.css("display","block");n(o).one("keydown",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(e.closeEvent=u.EscButton)}).one("hidden",function(){if(e.isMultipleTimeRepeatable)if(e.closeEvent==null||e.closeEvent==undefined){if(e.What.NotClosable_paywall=="True"||e.What.NotClosable_paywall=="true")return!1;e.closeEvent=u.ClickOutside;e.actionDom=o;CnnXt.Event.fire("onActionClosed",e)}else(e.closeEvent===u.EscButton||e.closeEvent===u.CloseButton)&&(e.actionDom=o,CnnXt.Event.fire("onActionClosed",e));e.isMultipleTimeRepeatable=!1})}else a=="banner"?(c="bottom",v={},v[c]="0px",o.css(c,"-2500px").removeClass("hide"),k=o.outerHeight(),o.css(c,"-"+k+"px").animate(v,function(){})):t.warn(i,b,"Can't determine display type.");n("#ConneXt_Action_Id-"+e.id).find(w).click(function(n){e.Conversation=CnnXt.Campaign.GetCurrentConversation();e.Conversation.Campaign=CnnXt.Storage.GetCampaignData();e.ButtonArgs=n;e.ActionDom=o;CnnXt.GetOptions().integrateFlittz&&CnnXt.Event.fire("onFlittzButtonClick",e)})}if(e.What.Type==f.Inline){if(r=e.What.Selector,s=e.What.Position,n(r).length==0)return t.debug(i,"not found element by current content selector",r),o.remove(),!1;h=n(r).width();y=String(h).length<4?String(h)[0]+"00":String(h)[0]+String(h)[1]+"00";o.addClass("Mg2-inline-scale-"+y);s=="before"?n(r).prepend(o):n(r).append(o);n(window,r).resize(function(){var t=n(r).width(),i=String(t).length<4?String(t)[0]+"00":String(t)[0]+String(t)[1]+"00",u=o.attr("class").replace(/\b\sMg2-inline-scale-\d+\b/g,"");o.attr("class",u);o.addClass("Mg2-inline-scale-"+i)})}if(e.What.Type==f.SmallInfoBox&&o.removeClass("hide"),e.What.Type==f.JSCall){n("#ConneXt_Action_Id-"+e.id).remove();try{if(e.What.Javascript!=undefined)try{eval(e.What.Javascript)}catch(d){}}catch(d){t.error(i,b,"Custom JS Call exception",d)}}if(e.What.Type==f.Newsletter)if(a=o.data("display-type"),a=="inline"){if(r=e.What.Selector,n(r).length==0)return t.debug(i,"not found element by current content selector",r),o.remove(),!1;h=n(r).width();y=String(h).length<4?String(h)[0]+"00":String(h)[0]+String(h)[1]+"00";o.addClass("Mg2-inline-scale-"+y);n(r).append(o);n(window,r).resize(function(){var t=n(r).width(),i=String(t).length<4?String(t)[0]+"00":String(t)[0]+String(t)[1]+"00",u=o.attr("class").replace(/\b\sMg2-inline-scale-\d+\b/g,"");o.attr("class",u);o.addClass("Mg2-inline-scale-"+i)})}else if(a=="modal"){o.addClass("in");o.connextmodal({backdrop:"true"});o.resize();o.css("display","block");n(o).one("keydown",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(e.closeEvent=u.EscButton)}).one("hidden",function(){e.isMultipleTimeRepeatable&&(e.closeEvent==null||e.closeEvent==undefined?(e.closeEvent=u.ClickOutside,e.actionDom=o,CnnXt.Event.fire("onActionClosed",e)):(e.closeEvent===u.EscButton||e.closeEvent===u.CloseButton)&&(e.actionDom=o,CnnXt.Event.fire("onActionClosed",e)));e.isMultipleTimeRepeatable=!1})}p=o.attr("id");n("#"+p+" [data-dismiss=banner], #"+p+" [data-dismiss=info-box], #"+p+" [data-dismiss=inline], #"+p+"  [data-dismiss=modal]").one("click",function(t){t.preventDefault();var r=n(this),i=r.attr("href");i!="#"&&i?(r[0].hasAttribute("target")?window.open(i,"_blank"):window.location.href=i,CnnXt.Event.fire("onButtonClick",e)):(e.closeEvent=u.CloseButton,r.closest(".Mg2-connext").addClass("hide"),e.actionDom=o,e.isMultipleTimeRepeatable&&(n(e.What.Html).hasClass("modal")||(CnnXt.Event.fire("onActionClosed",e),e.isMultipleTimeRepeatable=!1)))});n("#"+p+" [data-dismiss=notclosablepaywall]").one("click",function(t){t.preventDefault();var r=n(this),i=r.attr("href");if(i!="#"&&i)r[0].hasAttribute("target")?window.open(i,"_blank"):window.location.href=i,CnnXt.Event.fire("onButtonClick",e);else return!1});e.actionDom=o;e.isMultipleTimeRepeatable||CnnXt.Event.fire("onActionShown",e);!e.isMultipleTimeRepeatable&&e.When.Time.Repeatable>1&&(e.isMultipleTimeRepeatable=!0);e.When.Time.Repeatable==1&&(e.isMultipleTimeRepeatable=!0)}catch(d){t.error(i,b,"EXCEPTION",d)}},ot=function(n){return function(t){return t&&this===t.target,n.apply(this,arguments)}},d=function(n){var r="registerActionEvents";try{t.debug(i,r,"action",n);n.When||(n.When={Time:{Delay:0}});n.When&&n.When.Time?(n.count=0,y(n)):n.When&&n.When.Hover?nt(n):n.When&&n.When.EOS?g(n):t.debug(i,r,"NO ACTION TO REGISTER",n)}catch(u){t.error(i,r,"EXCEPTION",u)}},y=function(n){var u="setTimedAction",r;try{r=CnnXt.Storage.GetRepeatablesInConv(n.id);n.When.Time.Repeatable||(n.When.Time.Repeatable=1);n.When.Time.RepeatableConv||(n.When.Time.RepeatableConv=1);n.When.Time.Repeatable>n.count&&n.When.Time.RepeatableConv>r&&setTimeout(function(){h(n);n.count++;CnnXt.Storage.UpdateRepeatablesInConv(n.id)},n.When.Time.Delay)}catch(f){t.error(i,u,"EXCEPTION",f)}},g=function(r){var f="SetEosEvent",u;try{r.count=0;u="#ConneXt_Action_Id-"+r.id;setTimeout(function(){n(r.When.EOS.Selector).viewportChecker({offset:10,classToAdd:"visible-"+r.id,callbackFunctionBeforeAddClass:function(t){if(!t.hasClass("visible-"+r.id)){var i=CnnXt.Storage.GetRepeatablesInConv(r.id);n(u).is(":not(:visible)")&&r.When.EOS.Repeatable>r.count&&r.When.EOS.RepeatableConv>i&&(r.inProgress||(r.inProgress=!0,h(r),r.count++,r.inProgress=!1,CnnXt.Storage.UpdateRepeatablesInConv(r.id)))}},callbackFunction:function(t){n(t).removeClass("visible"+r.id)},repeat:!0,scrollHorizontal:!1})},r.When.EOS.Delay)}catch(e){t.error(i,f,"EXCEPTION",e)}},nt=function(r){var f="setHoverEvent",u;try{u=r.When.Hover.Delay?r.When.Hover.Delay:0;setTimeout(function(){var t=0,i="#ConneXt_Action_Id-"+r.id;n(r.When.Hover.Selector).on("mouseenter",function(u){if(u.stopPropagation(),_.isNumber(parseInt(r.When.Hover.Repeatable))&&_.isNumber(parseInt(r.When.Hover.RepeatableConv))){var f=CnnXt.Storage.GetRepeatablesInConv(r.id);if(n(i).is(":not(:visible)"))t<r.When.Hover.Repeatable&&r.When.Hover.RepeatableConv>f&&(h(r),t++,CnnXt.Storage.UpdateRepeatablesInConv(r.id));else return!1}return!1}).children().mouseover(function(){return r.When.Hover.IncludeChildren=="False",!1})},u)}catch(e){t.error(i,f,"EXCEPTION",e)}},tt=function(u){var p="hideContent",h,y;try{h=new RegExp(/script|style|meta/i);e=u.What.Effect;r=u.What.Selector;var l=u.What.Terminator,c=u.What.PrevChars,f=0,v=n(r)[0],s=n(r).clone();s.find(".Mg2-connext[data-display-type=inline]").remove();s.find(".Mg2-connext[data-display-type=info-box]").remove();s.find(".Mg2-connext[data-display-type=banner]").remove();a=s[0].innerHTML;y=v.childNodes;e&&t(v,y);n(".flittz").removeClass("blurry-text");n(".flittz").removeClass("trimmed-text");n(".trimmed-text").remove();function t(n,i){for(var r,u,v,y,a=0;a<i.length;a++)if(r=i[a],f>=c)e=="blur"?r.classList?(r.classList.add("blurry-text"),o(r)):(u=document.createElement("span"),u.innerHTML=r.textContent,u.classList.add("blurry-text"),o(u),r.parentNode.insertBefore(u,r),n.removeChild(r)):r.classList?r.classList.add("trimmed-text"):(u=document.createElement("span"),u.innerHTML=r.textContent,u.classList.add("trimmed-text"),r.parentNode.insertBefore(u,r),n.removeChild(r));else if(r.tagName)h.test(r.tagName)||t(r,r.childNodes);else if(f+=r.length,c<=f){var b=f-c,s=r.textContent.substr(0,r.textContent.length-b),p=Math.min(s.length,s.lastIndexOf(" ")),w;for(p!=-1?(s=s.substr(0,p)+l,w=r.textContent.substr(p)):(w=r.textContent.substr(s.length),s+=l),r.textContent=s,v=document.createElement("span"),v.innerHTML=w,v.classList.add(e=="blur"?"blurry-text":"trimmed-text"),o(v),n.insertBefore(v,i[a+1]),y=a+1;y<i.length;y++)r=i[y],r.classList&&(h.test(r.tagName)||(r.classList.add(e=="blur"?"blurry-text":"trimmed-text"),o(r)))}}}catch(w){t.error(i,p,"EXCEPTION",w);throw{name:"HideContentExeption",message:"Cannot hide content!"};}},o=function(t){var i,r;if(n(t).children().length==0){if(i=n(t).text(),i)for(r=0;r<i.length;r++)i=i.replaceAt(r,CnnXt.Utils.GetNextLetter(i[r]));n(t).text(i)}else n.each(n(t).children(),function(n,t){o(t)})},it=function(){var u="showContent";try{t&&t.debug(i,u);n(r).html(a)}catch(f){t.error(i,u,"EXCEPTION",f)}},rt=function(n){var i=CnnXt.Utils.Now(),r=new Date(n.Props.Date.expiration),t;return t=n.Options.Expirations.Time.key=="d"||n.Options.Expirations.Time.key=="w"||n.Options.Expirations.Time.key=="m"||n.Options.Expirations.Time.key=="y"?parseInt((r-i)/864e5)+1:parseInt((r-i)/864e5),t<=0?"less than 1":t},ut=function(r){var e="handleDynamicHtml";try{var u=CnnXt.Campaign.GetCurrentConversationProps(),o=CnnXt.Campaign.GetCurrentConversation(),s=r.replace(/{{(.*?)}}/g,function(n){var a="FixedHtml",f="User",h,s,e,r,l;switch(n){case"{{FreeViewsLeft}}":return h=eval(u.paywallLimit-u.views),parseInt(h)<0&&(h=0),h;case"{{CurrentViewCount}}":return u.views;case"{{ExpireTimeLeft}}":return rt(o);case"{{ArticleCost}}":return t.debug(i,a,"Replace ArticleCost to",c()),c()?c():"";case"{{UserFullName}}":try{if(s=CnnXt.Storage.GetUserState(),e=CnnXt.Storage.GetLocalConfiguration().Site.RegistrationTypeId,s){if(s=="Logged Out")return f;if(s!=="Logged Out"){if(s!=="Logged In"&&e===1)return r=CnnXt.Storage.GetUserData(),r?(l=null,r.OwnedSubscriptions?l=r.OwnedSubscriptions[0].FullName:r.Subscriptions&&(l=r.Subscriptions[0].FirstName+" "+r.Subscriptions[0].LastName),l||f):f;if(e===2)return r=CnnXt.Storage.GetJanrainUser(),r?r.displayName||f:f;if(e===3,e===4)return r=CnnXt.Storage.GetUserProfile(),r?r.name||r.nickname||f:f;if(e===5&&(r=CnnXt.Storage.GetUserData(),r))return r.DisplayName}}else return f}catch(v){return t.error(a,"EXCEPTION",v),f}}}),f=n(s);return CnnXt.Utils.AddQueryParamsToAllLinks(f),f[0].outerHTML}catch(h){return t.error(i,e,"EXCEPTION",h),r}},ft=function(){n("body").on("click",'[data-mg2-action="click"]',p);n("body").on("click",'[data-mg2-action="login"], [data-mg2-action="connextRun"], [data-mg2-action="submit"], [data-mg2-action="Zipcode"], [data-mg2-action="openNewsletterWidget"],[data-mg2-action="activation"]',function(n){n.preventDefault();p(n)});n("body").on("click",'[data-mg2-action="click-Newsday"]',et)};return{init:function(){t=CnnXt.Logger;t.debug(i,"Action.Init");ft()},ProcessActions:function(n){return b(n)},IntegrateProduct:function(){it()},SetTimedAction:function(n){y(n)}}},ConnextWhitelist=function(n){function k(n,t){var o="compareIPs",e,i,u;try{return(e=/^([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?$/,!n||!t)?!1:(i=!1,u=!1,e.test(t)&&(~t.indexOf("/")?u=!0:i=!0),i)?n===t:u?CnnXt.Utils.IPWithinRangeCIDR(n,t):!1}catch(s){return r.exception(f,o,s),!1}}function c(t){var u=CnnXt.Storage.GetWhitelistInfoboxCookie(),f=CnnXt.Storage.GetNeedHidePinTemplateCookie(),r;if(!f&&t){if(t.InfoBoxHtml&&u)n("body").append(t.InfoBoxHtml),i=n(".Mg2-pin-infobox"),r=l(),r||a(i),i.show(),y(),h=!1,CnnXt.ConnextContinueProcessing(e);else if(t.ModalHtml&&!u){n("body").append(t.ModalHtml);i=n(".Mg2-pin-modal");r=l();r||a(i);i.on("show.bs.modal",function(){y();h=!1});i.addClass("in");i.connextmodal({backdrop:"true"});i.resize()}else CnnXt.ConnextContinueProcessing(e);d()}else CnnXt.ConnextContinueProcessing(e)}function y(){var n=p();CnnXt.Event.fire("onAccessTemplateShown",n)}function o(n){if(!h){var t=p();t.closeEvent=n;CnnXt.Event.fire("onAccessTemplateClosed",t);h=!0}}function p(){return{WhitelistSets:e.WhitelistSets,FoundInWhithelistSet:t,UserIP:s}}var f="Whitelist",r,s="",t=null,u={CloseButton:"closeButton",ClickOutside:"clickOutside",AccessGranted:"accessGranted",EscButton:"escButton"},h=!0,i,e,w=100,v=function(n,i){n&&n.ipAddress&&(s=n.ipAddress,i&&i.WhitelistSets&&i.WhitelistSets.forEach(function(n){n&&_.isArray(n.IPs)&&n.IPs.forEach(function(i){!t&&k(s,i.IP)&&(t=n)})}));t?t.CodesAreNotRequired?CnnXt.Event.fire("onAccessGranted",{message:"Success! Now you have full access",status:200}):c(t):c(t)},b=function(i){var u="checkClientIp";return r.debug(f,u,"Check client IP"),e=i,n.ajax({url:CnnXt.Common.IPInfo,type:"GET",success:function(n){r.debug(f,u,"success",n);v(n,i)},error:function(){r.debug(f,u,"IPInfo call failed. Calling API to get info");CnnXt.API.GetClientIpInfo().done(function(n){r.debug(f,u,"success",n);v(n,i)}).fail(function(n){r.error(f,u,"error",n);c(t)})}})},l=function(){var n=CnnXt.Storage.GetPinAttempts(),t=!0;return n&&n>=5&&(t=!1),t},a=function(n){var t=n.find(".Mg2-pin__message");t.text("You exceeded maximum amount of times. You will be allowed to try again in 15 minutes.").addClass("Mg2-pin__message_error").show();n.find(".Mg2-pin__input").hide();n.find(".Mg2-pin__button").hide()},d=function(){function f(i,r,u){var f=CnnXt.GetOptions().api+"api/whitelist/check?code="+encodeURIComponent(i)+"&setId="+t.id+"&ip="+s;n.ajax({method:"GET",url:f}).done(function(n){CnnXt.Storage.SetWhitelistSetIdCookie({Id:n.WhitelistSetId,Expiration:n.expires},new Date(n.expires));h(r,{message:"Success! Now you have full access",status:200});var t={UserId:Fprinting().getDeviceId(),ConfigCode:CnnXt.GetOptions().configCode,SiteCode:CnnXt.GetOptions().siteCode,SettingsKey:CnnXt.GetOptions().settingsKey,ViewData:CnnXt.Campaign.GetLocalViewData()};CnnXt.User.getMasterId()&&(t.masterId=CnnXt.User.getMasterId());CnnXt.API.SendViewData(t)}).fail(function(n){var t=n.responseText?JSON.parse(n.responseText).Message:n.statusText,i=n.responseText?JSON.parse(n.responseText).ErrorCode:"";c(r,{message:t,status:i},u)})}function h(t,i){t.text(i.message).addClass("Mg2-pin__message_success").show();setTimeout(function(){n(".Mg2-pin-modal").connextmodal("hide");n(".Mg2-pin-infobox").hide();CnnXt.Run()},1e3);CnnXt.Event.fire("onAccessGranted",i);o(u.AccessGranted)}function c(n,t,i){t.status==w&&CnnXt.Storage.WrongPin();n.text(t.message).addClass("Mg2-pin__message_error").show();i.val("");CnnXt.Event.fire("onAccessDenied",t)}var i=n(".Mg2-pin-modal"),r=n(".Mg2-pin-infobox");n(".Mg2-pin__button").on("click",function(){var r=n(this).parents(".Mg2-pin"),u=l(),t,i;if(!u){a(r);return}t=r.find('.Mg2-pin__input[type="password"]');i=r.find(".Mg2-pin__message");i.hide().removeClass("Mg2-pin__message_error Mg2-pin__message_success");t.removeClass("Mg2-pin__input_error");t.val().length?f(t.val(),i,t):(t.addClass("Mg2-pin__input_error"),i.text("Please enter code").addClass("Mg2-pin__message_error").show())});i.on("keydown",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(i.closeEvent=u.EscButton)}).on("hidden",function(){CnnXt.Storage.SetWhitelistInfoboxCookie(!0);i.closeEvent==null||i.closeEvent==undefined?o(u.ClickOutside):i.closeEvent==u.EscButton&&o(u.EscButton);CnnXt.ConnextContinueProcessing(e)}).on("click","[data-dismiss]",function(){n(this).hasClass("proceed-without-pin")&&CnnXt.Storage.SetNeedHidePinTemplateCookie(!0);i.closeEvent=u.CloseButton;o(u.CloseButton)});r.on("click","[data-dismiss]",function(n){n.preventDefault();r.addClass("hide");o(u.CloseButton)}).on("click",".proceed-without-pin",function(){CnnXt.Storage.SetNeedHidePinTemplateCookie(!0)})};return{init:function(){r=CnnXt.Logger;CnnXt.Storage.UpdateWhitelistSetCookieName();CnnXt.Storage.UpdateWhitelistInfoboxCookieName();CnnXt.Storage.UpdateNeedHidePinTemplateCookieName();r.debug(f,"Whitelist.Init")},checkClientIp:b}},ConnextAppInsights=function(){var n,t=null,i=function(t,i){n=CnnXt.Logger;var r=window.appInsights||function(n){function i(n){t[n]=function(){var i=arguments;t.queue.push(function(){t[n].apply(t,i);t.context})}}var t={config:n},u=document,e=window,o="script",s="AuthenticatedUserContext",h="start",c="stop",l="Track",a=l+"Event",v=l+"Page",y=u.createElement(o),r,f;y.src=n.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js";u.getElementsByTagName(o)[0].parentNode.appendChild(y);try{t.cookie=u.cookie}catch(p){}for(t.queue=[],t.version="1.0",r=["Event","Exception","Metric","PageView","Trace","Dependency"];r.length;)i("track"+r.pop());return i("set"+s),i("clear"+s),i(h+a),i(c+a),i(h+v),i(c+v),i("flush"),n.disableExceptionTracking||(r="onerror",i("_"+r),f=e[r],e[r]=function(n,i,u,e,o){var s=f&&f(n,i,u,e,o);return s!==!0&&t["_"+r](n,i,u,e,o),s}),t}({instrumentationKey:CnnXt.Common.APPInsightKeys[CnnXt.GetOptions().environment],disableExceptionTracking:!0,appUserId:t,accountId:i});window.appInsights=r;r.queue||(r.queue=[]);r.queue.push(function(){r.context.addTelemetryInitializer(function(n){var t=n.data.baseData;if(n.data.baseType==="RemoteDependencyData")return t.data.indexOf("connext")!==-1||t.target.indexOf("auth0")!==-1})});r.setAuthenticatedUserContext(t,i);r.trackPageView()},r=function(t,i){try{var r=f(t,i);appInsights.trackEvent(t,r)}catch(u){CnnXt.GetOptions().debug&&n.error("track Application insights error")}},u=function(n){var t=CnnXt.Storage.GetLocalConfiguration(),r=CnnXt.Storage.GetCurrentConversation(),i=CnnXt.Utils.GetUserMeta(),u=CnnXt.Storage.GetUserData(),f=CnnXt.Storage.GetMeter();n=n||{};var e=CnnXt.Storage.GetJanrainUser(),o=CnnXt.Storage.GetUserProfile(),s=CnnXt.Storage.GetUserData();return{cnvid:r?r.id:null,cnvn:r?r.Name:"",mlm:f?f.method:"",ml:CnnXt.GetOptions().currentMeterLevel,artlft:r?r.Props.ArticleLeft:null,artc:CnnXt.Storage.GetCurrentConversationViewCount(),cmid:t&&t.Campaign?t.Campaign.id:null,cmn:t&&t.Campaign?t.Campaign.Name:"",dmid:t&&t.DynamicMeter?t.DynamicMeter.id:null,dmn:t&&t.DynamicMeter?t.DynamicMeter.Name:"",cnfc:t&&t.Settings?t.Settings.Code:"",cnfn:t&&t.Settings?t.Settings.Name:"",sc:t&&t.Site?t.Site.SiteCode:"",at:t&&t.Site?CnnXt.Common.RegistrationTypes[t.Site.RegistrationTypeId]:"",crid:u?u.MasterId:null,igmrid:u?u.IgmRegID:null,us:CnnXt.Storage.GetUserState(),em:o?o.email:e?e.email:s?s.Email:"",ip:CnnXt.Utils.GetIP(),zc:CnnXt.Storage.GetActualZipCodes(),did:CnnXt.GetOptions().deviceId,dt:i?i.deviceType:"",os:i?i.OS:"",brw:i?i.Browser:"",url:i?i.URL:"",attr:CnnXt.GetOptions().attr,stk:CnnXt.GetOptions().settingsKey}},f=function(n,t){var i=t.EventData,f=CnnXt.Storage.GetLocalConfiguration(),r={cnfc:f&&f.Settings?f.Settings.Code:"",sc:f&&f.Site?f.Site.SiteCode:"",stk:CnnXt.GetOptions().settingsKey};switch(n){case"onDynamicMeterFound":r.dmn=i;break;case"onCampaignFound":r.cmn=i.Name;r.cmid=i.id;break;case"onMeterLevelSet":r.mlm=i.method;r.ml=i.level;r.rid=i.rule?i.rule.id:null;r.rn=i.rule?i.rule.Name:null;break;case"onConversationDetermined":r.cnvid=i.id;r.cnvn=i.Name;r.ml=i.MeterLevelId;r.vws=i.Props.views;r.artlft=i.Props.ArticleLeft;break;case"onAuthorized":case"onHasAccess":case"onHasAccessNotEntitled":case"onHasNoActiveSubscription":r.crid=i.MG2AccountData?i.MG2AccountData.MasterId:null;r.igmRegId=i.MG2AccountData?i.MG2AccountData.IgmRegID:null;r.as=i.MG2AccountData?i.MG2AccountData.AuthSystem:null;break;case"onLoggedIn":r.crid=i.MG2AccountData?i.MG2AccountData.MasterId:null;r.igmRegId=i.MG2AccountData?i.MG2AccountData.IgmRegID:null;r.as=i.MG2AccountData?i.MG2AccountData.AuthSystem:null;r.us=CnnXt.Storage.GetUserState();break;case"onActionShown":r.actid=i.id;r.actn=i.Name;r.actt=i.ActionTypeId;r.usdfdt=i.UserDefinedData;r.artc=i.ArticlesViewed;break;case"onActionClosed":r.actid=i.id;r.actn=i.Name;r.actt=i.ActionTypeId;r.usdfdt=i.UserDefinedData;r.artc=i.ArticlesViewed;r.clev=i.closeEvent;break;case"onButtonClick":r.udfat=i.UserDefinedDataAttr;r.actid=t.Action?t.Action.id:null;r.actn=t.Action?t.Action.Name:null;r.actt=t.Action?t.Action.ActionTypeId:null;r.btnhtml=i.ButtonHTML||"";break;case"onFinish":r=u(t)}return r};return{init:i,trackEvent:r,getUserId:function(){return t}}},ConnextActivation=function(n){function ft(t,i){if(e.debug(o,"checkAccessAfterLinking",t),_.isString(t))try{t=n.parseJSON(t)}catch(r){a(t,i.SearchOption,i.autoLink)}t.errorCode||!t.Success?a(t,i.SearchOption,i.autoLink):bt().then(function(){kt(t,i.SearchOption)},function(n){a(t,i.SearchOption,i.autoLink,n)})}function et(n){n.preventDefault();k()}function ot(i){i.preventDefault();n(t.SubSteps.FailActivation).hide();n(t.SubSteps.ActivateForm).show();r=f.Activate;CnnXt.Event.fire("onActivationLinkErrorStepClosed",{ActivationSettings:u,closeEvent:h.MoveToActivate});CnnXt.Event.fire("onActivationLinkStepShown",{ActivationSettings:u})}function w(){s=!1}function st(){i.closeEvent=h.CloseButton}function ti(){window.addEventListener("resize",function(){s&&setTimeout(function(){y()},25)})}var o="Activation",e,s=!1,i,g=!1,u="",l,h={CloseButton:"closeButton",CloseSpan:"closeSpan",ClickOutside:"clickOutside",EscButton:"escButton",MoveToActivate:"moveToLinkStep",MoveToSuccess:"moveToSuccessStep",MoveToFail:"moveToErrorStep"},f={Authenticate:"Authenticate",Activate:"Activate",Success:"Success",Fail:"Fail"},b,r,t={Modal:"[data-connext-dynamic-size]",Step:"data-connext-template-step",Steps:{Authenticate:'[data-connext-template-step="Authenticate"]',Activate:'[data-connext-template-step="Activate"]'},SubStep:"data-connext-template-substep",SubSteps:{Login:'[data-connext-template-substep="Login"]',Registration:'[data-connext-template-substep="Registration"]',SubscribeLink:'[data-connext-template-substep="SubscribeLink"]',UpgradeLink:'[data-connext-template-substep="UpgradeLink"]',ActivateForm:'[data-connext-template-substep="ActivateForm"]',SuccessActivation:'[data-connext-template-substep="Success"]',FailActivation:'[data-connext-template-substep="Fail"]'},Run:'[data-mg2-action="activation"]',Buttons:{ConnextRun:'[data-mg2-action="connextRun"]:visible',BackStep:'[data-mg2-acton="backStep"]:visible'},Inputs:{common:"[data-connext-input]",visible:"[data-connext-input]:visible",Email:'[data-connext-input="Email"]:visible',AllEmails:'[data-connext-input="Email"]',Password:'[data-connext-input="Password"]:visible',SearchOptions:'[data-connext-input="SearchOption"]:visible',LastName:'[data-connext-input="LastName"]:visible',AccountNumber:'[data-connext-input="AccountNumber"]:visible',ZipCode:'[data-connext-input="ZipCode"]:visible',HouseNumber:'[data-connext-input="HouseNumber"]:visible',PhoneNumber:'[data-connext-input="PhoneNumber"]:visible'},Links:'[redirect="true"]',CloseButton:'[data-connext-role="close"]',ErrorMessages:{LoginSubstep:'[data-connext-template-substep="LoginFormError"]',RegistrationSubStep:'[data-connext-template-substep="RegistrationFormError"]',Activation:'[data-connext-template-substep="ActivateFormError"]'},AuthSystems:{Janrain:".janrain-close-modal",Auth0:".auth0-lock-close-button"}},v={emailInUse:"There is already an account associated with this email address. Please enter a new email address. ",emailAndPassRequired:"Please enter email and password. ",fieldsRequired:"Please fill out all the required fields. ",invalidCredits:"There was an error with your E-Mail/Password combination. Please try again. ",noSubscriptions:"Subscriptions not found. ",requiredEmail:"Email is required. ",requiredPassword:"Password is required. ",linkingFailed:"I'm sorry, an error occurred and we can't complete this process.  Please contact customer service for assistance. ",digitalAccessNeedUpgrade:"I'm sorry, your subscription does not give you access to this content. Please <a data-connext-link='Upgrade' redirect='true'>upgrade<\/a> to get access. ",digitalAccessNeedPurchase:"I'm sorry, your subscription does not give you access to this content. Please <a data-connext-link='Subscribe' redirect='true'>subscribe<\/a> to get access. "},ht={ActivateByAccountNumber:"ActivateByAccountNumber",ActivateByZipCodeAndHouseNumber:"ActivateByZipCodeAndHouseNumber",ActivateByZipCodeAndPhoneNumber:"ActivateByZipCodeAndPhoneNumber",ActivateBySubscriptionId:"ActivateBySubscriptionId"},c={Authenticate:420,Activate:672},k=function(n){if(!s||n&&n.runAfterSuccessfulLogin){var t=CnnXt.Utils.GetActivationUrlParams();if(y(),r==f.Activate&&t.subscriptionNumber)ut(t.subscriptionNumber);else{if(r==null)return!1;s=!0;nt();tt();r==f.Authenticate?gt[b]():p()}}},ct=function(){window.janrain?janrain.capture.ui.modal.open():e.error("No janrain global object found...")},lt=function(){CnnXt.User.showAuth0Login()},y=function(){var n=Connext.Storage.GetUserState();n==null&&(n=l.NotLoggedIn);n==l.NotLoggedIn?(r=f.Authenticate,i.attr("data-width",c.Authenticate),i.css("width",c.Authenticate).css("margin-left","-"+c.Authenticate/2+"px")):n==l.Subscribed?(r=null,s=!1):(r=f.Activate,i.attr("data-width",c.Activate),i.css("width",c.Activate).css("margin-left","-"+c.Activate/2+"px"))},nt=function(){var u=i.find("["+t.Step+"]");u.each(function(i,u){var f=n(u);f.attr(t.Step)==r?f.show():f.hide()})},at=function(n){if(y(),r!=null||n?r==null&&n&&(CnnXt.Run(),CnnXt.Event.fire("onActivationLoginStepClosed",{ActivationSettings:u,closeEvent:h.MoveToActivate})):it(),nt(),n&&r==f.Activate){var t=CnnXt.Utils.GetActivationUrlParams();t.subscriptionNumber?(it(),ut(t.subscriptionNumber)):(CnnXt.Event.fire("onActivationLoginStepClosed",{ActivationSettings:u,closeEvent:h.MoveToActivate}),CnnXt.Event.fire("onActivationLinkStepShown",{ActivationSettings:u}))}},tt=function(){var n=i.find(t.SubSteps.SubscribeLink),r=i.find(t.SubSteps.UpgradeLink),u=Connext.Storage.GetUserState();u==l.SubscribedNotEntitled?(n.hide(),r.show()):(r.hide(),n.show())},p=function(){var o=CnnXt.GetOptions(),e;!o.silentmode&&u.IsActivationOnly?(i.find('.connext-actflow-close-wrapper, [data-connext-role="close"]').remove(),e={backdrop:"static",keyboard:!1}):e={backdrop:"true"};i.attr("data-width",c[r]).css("margin-left","-"+c[r]/2+"px");i.addClass("in").show();i.connextmodal(e);i.resize();CnnXt.Event.fire("onActivationFormShown",{ActivationSettings:u});i.find(t.SubSteps.SuccessActivation).hide();i.find(t.SubSteps.FailActivation).hide();r==f.Authenticate?CnnXt.Event.fire("onActivationLoginStepShown",{ActivationSettings:u}):r==f.Activate&&(i.find(t.SubSteps.ActivateForm).show(),CnnXt.Event.fire("onActivationLinkStepShown",{ActivationSettings:u}));vt();i.closeEvent=null;i.find('[data-connext-role="close"]').on("click",function(){var r=n(this),t=r.attr("href");t&&t!=="#"&&(r[0].hasAttribute("target")?window.open(t,"_blank"):window.location.href=t);i.closeEvent=h.CloseButton});i.on("keyup",function(n){(n.key==="Escape"||n.key==="Esc"||n.keyCode===27)&&(i.closeEvent=h.EscButton,s=!1)}).one("hidden",function(){s=!1;i.closeEvent||(i.closeEvent=h.ClickOutside);var n={ActivationSettings:u,closeEvent:i.closeEvent};r==f.Authenticate&&CnnXt.Event.fire("onActivationLoginStepClosed",n);r==f.Activate&&CnnXt.Event.fire("onActivationLinkStepClosed",n);r==f.Success&&(n.ActivateStatus="success",CnnXt.Event.fire("onActivationLinkSuccessStepClosed",n),dt());r==f.Fail&&(n.ActivateStatus="error",CnnXt.Event.fire("onActivationLinkErrorStepClosed",n));CnnXt.Event.fire("onActivationFormClosed",n)})},vt=function(){var u=CnnXt.Utils.GetActivationUrlParams(),e;r==f.Authenticate&&u.email&&i.find(t.Inputs.AllEmails).val(u.email);e=i.find(t.Links);e.each(function(t,i){var u=n(i),r=u.attr("href"),f;r=CnnXt.Utils.AddReturnUrlParamToLink(r);u.attr("data-connext-link")=="Upgrade"?(f=CnnXt.Utils.GetProductCode(),f?(r=CnnXt.Utils.AddParameterToURL(r,"product",f),u.attr("href",r)):CnnXt.API.GetProductCode().then(function(n){r=CnnXt.Utils.AddParameterToURL(r,"product",n);u.attr("href",r)},function(){u.attr("href",r)})):u.attr("href",r)})},it=function(){i.connextmodal("toggle")},rt=function(n){var i="login",r={email:n.Email,password:n.Password};return d(t.ErrorMessages.LoginSubstep,!1),CnnXt.API.GetUserByEmailAndPassword({payload:r,onSuccess:function(n){e.debug(o,i,"onSuccess",n);pt(n,"onSuccess",r)},onError:function(n){e.debug(o,i,"onError",n);d(t.ErrorMessages.LoginSubstep,v.invalidCredits)}})},yt=function(i){var r="register",u={email:i.Email,password:i.Password,DisplayName:i.DisplayName};return CnnXt.API.CreateUser({payload:u,onSuccess:function(n){e.debug(o,r,"onSuccess",n);(n.Success||n.CustomerRegistrationId)&&rt(i)},onError:function(i){var u="",s,f;e.debug(o,r,"onError",i);try{s=n.parseJSON(i.responseText);f=n.parseJSON(s.Message);n.isArray(f.Errors)?f.Errors.forEach(function(n){u+=_.isString(n)?n+" ":n.Message+" "}):u+=f.Message}catch(h){e.error(o,r,"EXCEPTION",h)}d(t.ErrorMessages.RegistrationSubStep,u)}})},pt=function(n,t){n.Email=t.email;n.AuthSystem="MG2";CnnXt.User.processSuccessfulLogin("Form",n);ti();at(!0);tt()},wt=function(n){var r=n.SearchOption,i=CnnXt.Storage.GetUserData(),t=n;return t.customRegId=i&&i.MasterId?i.MasterId:null,t.autoLink=!1,CnnXt.Event.fire("onActivationLinkStepSubmitted",{ActivationSettings:u,Payload:t,ActivateBy:t.SearchOption}),e.debug(o,"activate",t),CnnXt.API[r]({payload:t,onSuccess:function(n){ft(n,t)},onError:function(n){a(n,t.SearchOption,t.autoLink)}})},ut=function(n){var i=CnnXt.Storage.GetUserData(),f=i&&i.MasterId?i.MasterId:null,r=ht.ActivateBySubscriptionId,t={customRegId:f,SubscriptionId:n,autoLink:!0};return CnnXt.Event.fire("onActivationLinkStepSubmitted",{ActivationSettings:u,Payload:t,ActivateBy:r}),CnnXt.API.LinkingBySubscription({payload:t,onSuccess:function(n){ft(n,t)},onError:function(n){a(n,r,t.autoLink)}})},bt=function(t){var i=n.Deferred(),r=CnnXt.Storage.GetUserData(),u;return t=t||(r&&r.MasterId?r.MasterId:null),u={masterId:t},e.debug(o,"checkDigitalAccess","MasterId",t),CnnXt.API.CheckDigitalAccess({payload:u,onSuccess:function(n){if(n){if(_.isString(n)){var t=JSON.parse(n);t&&_.isArray(t.Errors)&&_.findWhere(t.Errors,{Code:400})&&i.reject()}_.isString(n.AccessLevel)&&(n.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Premium&&i.resolve(),n.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Upgrade&&i.reject({needUpgrade:!0}),n.AccessLevel.toUpperCase()===CnnXt.Common.DigitalAccessLevels.Purchase&&i.reject({needPurchase:!0}));_.isObject(n.AccessLevel)&&(n.AccessLevel.IsPremium&&i.resolve(),n.AccessLevel.IsUpgrade&&i.reject({needUpgrade:!0}),n.AccessLevel.IsPurchase&&i.reject({needPurchase:!0}))}i.reject()},onNull:function(){i.reject()},onError:function(){i.reject()}}),i.promise()},kt=function(i,e,o){s=!1;CnnXt.Storage.SetUserState(null);r=f.Success;o&&p();n(".connext-actflow-close-wrapper .closebtn").attr("data-mg2-action","connextRun");n(t.SubSteps.ActivateForm).hide();n(t.Steps.Activate).show();n(t.Steps.Authenticate).hide();n(t.SubSteps.SuccessActivation).show();CnnXt.Event.fire("onActivationLinkStepClosed",{ActivationSettings:u,closeEvent:h.MoveToSuccess});CnnXt.Event.fire("onActivationLinkSuccessStepShown",{ActivationSettings:u,Response:i,ActivateBy:e})},a=function(i,e,o,s){var c,l,a,y,w;r=f.Fail;o&&p();n(t.SubSteps.ActivateForm).hide();n(t.Steps.Activate).show();n(t.Steps.Authenticate).hide();n(t.SubSteps.FailActivation).show();c="";c=s&&s.needUpgrade?v.digitalAccessNeedUpgrade:s&&s.needPurchase?v.digitalAccessNeedPurchase:v.linkingFailed;n(t.SubSteps.FailActivation).find('[data-connext-role="linkingErrorMessage"] span').html(c);s&&s.needUpgrade&&(l=n(t.SubSteps.UpgradeLink).find('[data-connext-link="Upgrade"]').attr("href"),a=n(t.SubSteps.FailActivation).find('[data-connext-link="Upgrade"]'),a.attr("href",l));s&&s.needPurchase&&(y=n(t.SubSteps.SubscribeLink).find('[data-connext-link="Subscribe"]').attr("href"),w=n(t.SubSteps.FailActivation).find('[data-connext-link="Subscribe"]'),w.attr("href",y));r=f.Fail;CnnXt.Event.fire("onActivationLinkStepClosed",{ActivationSettings:u,closeEvent:h.MoveToFail});CnnXt.Event.fire("onActivationLinkErrorStepShown",{ActivationSettings:u,Response:i,ActivateBy:e})},d=function(t,i){var r=n(t);if(r.length==0)return!1;i?(r.text(i),r.show()):r.hide()},dt=function(){b!="MG2"&&CnnXt.Storage.SetUserData(null);CnnXt.Run()},gt={MG2:p,Auth0:lt,Janrain:ct},ni=function(){if(!g){g=!0;n("body").off("click",t.Buttons.BackStep,ot).on("click",t.Buttons.BackStep,ot);n("body").off("click",t.AuthSystems.Auth0,w).on("click",t.AuthSystems.Auth0,w);n("body").off("click",t.AuthSystems.Janrain,w).on("click",t.AuthSystems.Janrain,w);n("body").off("click",t.Buttons.ConnextRun,st).on("click",t.Buttons.ConnextRun,st);n("body").off("click",t.Run,et).on("click",t.Run,et)}};return{init:function(t){u=t;ni();l=CnnXt.Common.USER_STATES;i=n(u.ActivationFormHtml);b=CnnXt.Common.RegistrationTypes[CnnXt.Storage.GetLocalConfiguration().Site.RegistrationTypeId];e=CnnXt.Logger;e.debug(o,"Activation.Init");y()},Run:function(n){u.IsActivationOnly?CnnXt.User.CheckAccess().always(function(){n&&n.silentmode||k(n)}):k(n)},Login:rt,Register:yt,Activate:wt,IsActivationFlowRunning:function(){return s}}},CnnXt=function(n){function nt(){var n=document.createElement("div");n.innerHTML="&nbsp;";n.className="adsbox";n.id="TestAdBlock";n.style.position="absolute";n.style.bottom="0";n.style.zIndex="-1";document.body.appendChild(n)}var b="1.12.5",h=null,r="Core",t,e={},f=!1,c=!1,i,k={debug:!1,silentmode:!1,integrateFlittz:!1,environment:"prod",settingsKey:null,configSettings:{EnforceUniqueArticles:!1},authSettings:null,loadType:"ajax",BatchCount:5},a=!1,u,o,s=!1,d=5e3,g=function(){try{t=CnnXt.Logger;i.configCode=i.configCode.toUpperCase();a?CnnXt.Run():(e.PluginStartTime=new Date,nt(),ut(ft),a=!0)}catch(n){}},tt=function(r){var f,u,e;t.debug("closeAllTemplates","Close all Connext Templates");n(".Mg2-connext.paywall.flittz:visible").length>0&&i.integrateFlittz&&(f={},f.actionDom=n(".Mg2-connext.paywall.flittz:visible")[0],CnnXt.Event.fire("onFlittzPaywallClosed",f));n(".Mg2-connext[data-display-type=inline]").addClass("hide");n(".Mg2-connext[data-display-type=info-box]").addClass("hide");n(".Mg2-connext[data-display-type=banner]").addClass("hide");u=n(".Mg2-connext.modal:visible");e=u.length;u.length>0?u.each(function(t,i){n(i).on("hidden.bs.modal",function(){n(this).off("hidden.bs.modal");e--;r&&e===0&&r()});n(i).connextmodal("hide")}):r&&r()},it=function(){t.debug("IntegrateProduct","Show article content");n(".blurry-text").removeClass("blurry-text");n(".trimmed-text").removeClass("trimmed-text");CnnXt.Action.IntegrateProduct()},rt=function(n,t){CnnXt.Storage.SetGeolocationInfo(n);n.ipAddress&&CnnXt.Utils.SetIP(n.ipAddress);n.zipCode?CnnXt.Storage.SetCalculatedZipCode(n.zipCode):CnnXt.Storage.SetCalculatedZipCode("00000");_.isFunction(t)&&t()},ut=function(i){var u="getZipCode";try{n.jStorage.get(CnnXt.Common.StorageKeys.customZip)?_.isFunction(i)&&i():n.ajax({url:CnnXt.Common.IPInfo,type:"GET",success:function(n){rt(n,i)},error:function(){t.debug(r,u,"Geolocation call failed. We set zipcode by default as 00000");CnnXt.Storage.SetCalculatedZipCode("00000");_.isFunction(i)&&i()}})}catch(f){t.exception(r,u,f)}},ft=function(){var f="checkRequirements",u;try{if(t.debug(r,f),!window.jQuery)throw"Jquery not loaded";if(i=n.extend(!0,k,i),i.integrateFlittz&&(i.silentmode=!0),i.runSettings&&(i.runSettings.runPromise&&_.isFunction(i.runSettings.runPromise.then)?(i.silentmode=!0,i.runSettings.hasValidPromise=!0,_.isFunction(i.runSettings.onRunPromiseResolved)||(i.runSettings.onRunPromiseResolved=n.noop),_.isFunction(i.runSettings.onRunPromiseRejected)||(i.runSettings.onRunPromiseRejected=n.noop)):(i.runSettings.hasValidPromise=!1,t.warn("No or invalid promise object in 'runSettings'")),_.isNumber(i.runSettings.runOffset)||(i.runSettings.runOffset=d)),t.setDebug(i.debug),CnnXt.Utils.init(),u=CnnXt.Utils.GetUserMeta().deviceType,u=="Mobile"?n("body").addClass("mobile"):u=="Tablet"&&n("body").addClass("tablet"),CnnXt.Utils.GetUserMeta().OS=="IOS"&&n("body").addClass("ios-fix-body-styles"),i.loadType=="ajax"&&(n("body").find(".mg2-Connext").remove(),n("body").find(".debug_details").remove()),i.debug){CnnXt.Utils.CreateDebugDetailPanel();var e=CnnXt.Storage.GetSiteCode(),o=CnnXt.Storage.GetConfigCode(),s=CnnXt.Storage.GetIsCustomConfiguration();n("#ConnextSiteCode").val(e);n("#ConnextConfigCode").val(o);n("#ConnextCustomConfiguration").prop("checked",s);s&&(i.siteCode=e,i.configCode=o)}if(!i.siteCode)throw"No Site Code";if(!i.configCode)throw"No Config Code";v();i.runSettings&&ot()}catch(h){t.exception(r,f,h)}},et=function(){CnnXt.CloseTemplates(function(){if(CnnXt.IntegrateProduct(),f){var n=CnnXt.Storage.GetLocalConfiguration();n.Settings.Site||(n.Settings.Site=n.Site);l(n)}else v()})},v=function(){var u="setDefaults",f,n;try{if(t.debug(r,u),i.environment==null)for(f=location.hostname,n=0;n<CnnXt.Common.Environments.length;n++)if(f.indexOf(CnnXt.Common.Environments[n])>=0){i.environment=CnnXt.Common.Environments[n];break}i.environment==null&&(i.environment="prod");i.api=CnnXt.Common.APIUrl[i.environment];CnnXt.API.init(i);CnnXt.Storage.init();CnnXt.Event.init(i);CnnXt.Event.fire("onInit",null);t.debug("OPTIONS.API",i.api);Fprinting().init().done(function(n){i.deviceId=n}).always(function(){try{var n=CnnXt.Storage.GetUserData()?CnnXt.Storage.GetUserData().MasterId?CnnXt.Storage.GetUserData().MasterId:CnnXt.Storage.GetUserData().IgmRegID:null;CnnXt.AppInsights.init(i.deviceId,n)}catch(f){t.exception(r,u,f)}st();CnnXt.Utils.HangleMatherTool()})}catch(e){t.exception(r,u,e)}},ot=function(){var n="setupRunSettings";t.debug(r,n,"OPTIONS.runSettings",i.runSettings);try{i.runSettings.hasValidPromise&&i.runSettings.runPromise.then(function(n){if(!s){i.runSettings.onRunPromiseResolved(n);CnnXt.Run()}clearTimeout(o)},function(n){if(!s){i.runSettings.onRunPromiseRejected(n);CnnXt.Run()}clearTimeout(o)});o=setTimeout(function(){s||CnnXt.Run()},i.runSettings.runOffset)}catch(u){t.exception(r,n,u)}},st=function(){var f="defineConfiguration";try{CnnXt.API.GetLastPublishDateS3().done(function(e){t.debug(r,f,"CnnXt.API.GetLastPublishDateS3.Done",e);try{u=n.parseJSON(e);u=CnnXt.Utils.ConvertObjectKeysToUpperCase(u);u[i.configCode]?ht().done(function(u){try{f="setDefaults.defineConfiguration.getConfiguration() <<DONE>>";t.debug(r,f,"configuration",u);c=!0;u?(t.debug(r,f,"CONFIGURATION FOUND",u),u.Settings=n.extend(!0,i.configSettings,u.Settings),u.Settings.Site=u.Site,u.Settings.LastPublishDate!=CnnXt.Storage.GetLastPublishDate()&&(ct(),CnnXt.Storage.SetLastPublishDate(u.Settings.LastPublishDate)),h=u,CnnXt.Storage.SetLocalConfiguration(h),CnnXt.Event.fire("onDebugNote","Init is done!"),(!i.silentmode||u.Settings.UseActivationFlow)&&l(u)):(t.error(r,f,"No Config Settings Found"),CnnXt.Event.fire("onNoConfigSettingFound","No Config Settings Found"))}catch(e){t.exception(r,f,"getConfiguration.done <<EXCEPTION>>",e)}}).fail(function(n){c=!0;t.error(r,f,"No Config Settings Found","Error getting Config Settings",n);CnnXt.Event.fire("onNoConfigSettingFound","No Config Settings Found",n)}):(t.warn(r,f,"CONFIGURATION CODE IS NOT FOUND IN PUBLISH FILE"),CnnXt.Event.fire("onDebugNote","Configuration code is not found in publish file."))}catch(o){t.exception(r,f,"GetLastPublishDateS3.done <<EXCEPTION>>",o)}}).fail(function(n){t.error(r,f,"CnnXt.API.GetLastPublishDateS3.Fail",n)})}catch(e){t.exception(r,f,e)}},ht=function(){var f="getConfiguration",o=n.Deferred(),s,e,l,h,c;try{s=CnnXt.Storage.GetLocalConfiguration();e=new Date;e.setMonth(e.getMonth()+1);e=new Date(e);t.debug(r,f,"localConfiguration",s);s?(t.debug(r,f,"Found Local Configuration",s),CnnXt.API.meta.config.isExistsInLocalStorage=!0,l=CnnXt.Storage.GetLastPublishDate(),CnnXt.API.meta.config.localPublishDate=l,t.debug(r,f,"No 'storedLastPublishDate', getting LastPublishDate from S3"),h=u[i.configCode],c=wt(u,s.Settings.LastPublishDate),c?(CnnXt.API.meta.reason=CnnXt.Common.DownloadConfigReasons.oldConfig,CnnXt.Event.fire("onDebugNote","Current config is old."),y(h).done(function(n){t.debug(r,f,"getConfigurationFromServer","<<DONE>>",n);CnnXt.Utils.MergeConfiguration(n);CnnXt.Storage.SetLastPublishDate(n.Settings.LastPublishDate,e);_.isObject(h)&&h.Reset&&(CnnXt.Storage.ResetConversationViews(null,n.Settings.UseParentDomain),CnnXt.Storage.RemoveWhitelistSetIdCookie(),CnnXt.Storage.RemoveWhitelistInfoboxCookie(),CnnXt.Storage.RemoveNeedHidePinTemplateCookie(),CnnXt.Storage.SetCurrentConversations({}),CnnXt.Storage.SetCurrentConversation(null));o.resolve(n)}).fail(function(n){t.error(r,f,"getConfigurationFromServer","<<FAILS>>",n);o.reject(n)})):(CnnXt.Storage.SetLastPublishDate(s.Settings.LastPublishDate,e),o.resolve(s)),t.debug(r,f,"isConfigOld",c)):(CnnXt.API.meta.config.isExistsInLocalStorage=!1,CnnXt.API.meta.reason=CnnXt.Common.DownloadConfigReasons.noLocalConfig,y().done(function(n){t.debug(r,f,"getConfigurationFromServer","<<DONE>>",n);lt(n,e);o.resolve(n)}).fail(function(n){t.error(r,f,"getConfigurationFromServer","<<FAILS>>",n);o.reject(n)}))}catch(a){t.error(r,f,"EXCEPTION",a);o.reject(a)}return o.promise()},ct=function(){var n=u[i.configCode];_.isObject(n)&&n.Reset&&CnnXt.Storage.ResetConversationViews(null,newConfiguration.Settings.UseParentDomain)},lt=function(i,u){var f="storeConfigurationFromServer";try{n.jStorage.deleteKey(CnnXt.Common.StorageKeys.conversations.current);at(i);CnnXt.Storage.SetLocalConfiguration(i);CnnXt.Storage.SetLastPublishDate(i.Settings.LastPublishDate,u)}catch(e){t.error(r,f,"EXCEPTION",e)}},at=function(t){var i=CnnXt.Storage.GetRegistrationType();i.Id&&i.IsOverride?t.Site.RegistrationTypeId=i.Id:(n("#OverrideAuthType").prop("checked",!1),n("#selAuthType").val(t.Site.RegistrationTypeId))},l=function(n){var i="processConfiguration",u;try{t.debug(r,i);n.Settings.Active?n.Settings.UseActivationFlow?(f||(CnnXt.User.init(n.Settings),u={ActivationFormName:n.Settings.ActivationTemplate.Name,ActivationFormHtml:n.Settings.ActivationTemplate.Html,IsActivationOnly:!0},CnnXt.Activation.init(u)),yt(n)):(f||(CnnXt.MeterCalculation.init(),CnnXt.User.init(n.Settings),CnnXt.Campaign.init(n.Settings),CnnXt.Action.init(n.Settings),CnnXt.Whitelist.init()),vt(n)):(t.warn(r,i,"CONFIGURATION IS INACTIVE"),CnnXt.Event.fire("onDebugNote","Configuration is inactive."))}catch(e){t.log("Core.Init <<EXCEPTION>>",e)}},vt=function(u){var o="processUsualConfiguration",s;try{f=!0;t.debug(r,o);u||(u=h);e.StartProcessingTime=new Date;u.Site.SiteTheme.ThemeUrl&&u.Site.SiteTheme.ThemeUrl!=="default"?(s=CnnXt.Common.CSSPluginUrl[i.environment],n("#themeLink").length==0&&(n("body > link").length==0?n("body").append('<link href="" id ="themeLink" rel="stylesheet" type="text/css">'):n('<link href="" id ="themeLink" rel="stylesheet" type="text/css">').insertAfter(n("body > link").last())),n("#themeLink").attr("href",s+u.Site.SiteTheme.ThemeUrl)):u.Site.SiteTheme.ThemeUrl&&u.Site.SiteTheme.ThemeUrl=="default"&&n("#themeLink").remove();CnnXt.Event.fire("onDynamicMeterFound",u.DynamicMeter.Name);CnnXt.Event.fire("onCampaignFound",u.Campaign);n.when(CnnXt.Storage.CheckCookie()).then(function(){CnnXt.User.CheckAccess().done(function(n){t.debug(r,o,"User.CheckAccess.Done",n)}).fail(function(){t.debug(r,o,"User.CheckAccess.Fail")}).always(function(){var i;CnnXt.Storage.GetWhitelistSetIdCookie()?p():CnnXt.Whitelist.checkClientIp(u);i=CnnXt.User.GetAuthTiming();t.debug(r,o,"User.CheckAccess.Always","UserAuthTime",i);var f=(new Date).getMilliseconds(),s=f-e.StartProcessingTime.getMilliseconds(),h=f-e.PluginStartTime.getMilliseconds();n("#ddProcessingTime").html(s+"ms");n("#ddTotalProcessingTime").html(h+"ms")})})}catch(c){t.log("Core.Init <<EXCEPTION>>",c)}},yt=function(){try{t.debug(r,"processActivationOnlyConfiguration");CnnXt.Activation.Run(i);f=!0}catch(n){t.log("Core.Init <<EXCEPTION>>",n)}},pt=function(n){var f="connextContinueProcessing",u;CnnXt.Storage.GetWhitelistSetIdCookie()||CnnXt.MeterCalculation.CalculateMeterLevel(n.DynamicMeter.Rules).done(function(n){t.debug(r,f,"Determined meter level",n);u=n.MeterLevelId;CnnXt.Event.fire("onMeterLevelSet",{method:"Dynamic",level:u,rule:n})}).fail(function(){t.warn(r,f,"Failed to determined Meter Level...using default");u=n.Settings.DefaultMeterLevel;CnnXt.Event.fire("onMeterLevelSet",{method:"Default",level:u})}).always(function(){t.info(r,f,"METER CALCULATION --- ALWAYS CALLED",u);i.currentMeterLevel=u;CnnXt.Campaign.ProcessCampaign(CnnXt.Common.MeterLevels[u],n.Campaign);p()})},y=function(u){var f="getConfigurationFromServer",e=n.Deferred(),o=u&&u.Date?encodeURIComponent(u.Date):undefined;try{CnnXt.API.GetConfiguration({payload:{siteCode:i.siteCode,configCode:i.configCode,publishDate:o},onSuccess:function(n){t.debug(r,f,"<< SUCCESS >>","data",n);var i=CnnXt.Utils.ProcessConfiguration(n);t.debug(r,f,"<< SUCCESS >>","processedConfiguration",i);e.resolve(i)},onNull:function(){t.debug(r,f,"<< NO RESULTS >>");e.reject("Configuration Not Found")},onError:function(n){t.debug(r,f,"<< ERROR >>","err",n);e.reject("Error Getting Configuration Data")}})}catch(s){t.error(r,f,"<<EXCEPTION>>",s)}return e.promise()},wt=function(n,u){var e="isConfigurationOld",o,s,f,h;try{if(_.isObject(n)){if(t.debug(r,e,"s3Data",n,"OPTIONS.configCode",i.configCode),s=n[i.configCode.toUpperCase()],o=s&&s.Date?s.Date:s,o)return _.isObject(o)?(t.log(r,e,".json file has a configCode property and its an object",o),f=new Date(Date.parse(o.Date)),CnnXt.API.meta.config.publisfDate=f,f.setSeconds(f.getSeconds()-10),h=new Date(Date.parse(u)),f>h?(t.debug(r,e,"Server date is << AFTER >>"),!0):(t.debug(r,e,"Server date is << NOT AFTER >>"),!1)):(t.log(r,e,".json file has a property same as this configCode",o),f=new Date(Date.parse(o)),f.setSeconds(f.getSeconds()-10),h=new Date(Date.parse(u)),f>h?(t.debug(r,e,"Server date is << AFTER >>"),!0):(t.debug(r,e,"Server date is << NOT AFTER >>"),!1));CnnXt.API.meta.config.publisfDate=null;CnnXt.API.meta.config.ex="s3Data does not have the current configCode as a key "+i.configCode;CnnXt.API.meta.reason=CnnXt.Common.DownloadConfigReasons.noConfigCodeinPublish;throw"s3Data does not have the current configCode as a key";}else{CnnXt.API.meta.config.publisfDate=null;CnnXt.API.meta.config.ex="s3Data is not an object";CnnXt.API.meta.reason=CnnXt.Common.DownloadConfigReasons.parsePublishFailed;throw"s3Data is not an object";}}catch(c){return t.error(r,e,"EXCEPTION",c),!0}},p=function(){var t,n;CnnXt.Campaign.GetCurrentConversationViewCount()!==1&&CnnXt.Campaign.GetCurrentConversationViewCount()%CnnXt.GetOptions().BatchCount==0&&(t={UserId:CnnXt.GetOptions().deviceId,ConfigCode:CnnXt.GetOptions().configCode,SiteCode:CnnXt.GetOptions().siteCode,SettingsKey:CnnXt.GetOptions().settingsKey,ViewData:CnnXt.Campaign.GetLocalViewData()},CnnXt.User.getMasterId()&&(n=CnnXt.User.getMasterId(),n=decodeURIComponent(n),t.masterId=n),CnnXt.API.SendViewData(t));CnnXt.Event.fire("onFinish")},w=function(){CnnXt.CloseTemplates(function(){if(CnnXt.IntegrateProduct(),c){s=!0;clearTimeout(o);var n=CnnXt.Storage.GetLocalConfiguration();n?l(n):t.warn(r,"Run","configuration is not found!!")}else t.debug(r,"Run","Connext is not initialized yet, wait 100ms"),setTimeout(w,100)})};return{init:function(t){return i=t?t:{},ConnextLogger(n),g(),Connext={DisplayName:CnnXt.DisplayName,CloseTemplates:CnnXt.CloseTemplates,IntegrateProduct:CnnXt.IntegrateProduct,Run:CnnXt.Run,GetVersion:CnnXt.GetVersion,GetCurrentVersion:CnnXt.GetCurrentVersion,GetOptions:CnnXt.GetOptions,Storage:{GetLastPublishDate:CnnXt.Storage.GetLastPublishDate,GetSiteCode:function(){return CnnXt.Storage.GetLocalConfiguration().Site.SiteCode},GetConfigCode:function(){return CnnXt.Storage.GetLocalConfiguration().Settings.Code},GetLocalConfiguration:CnnXt.Storage.GetLocalConfiguration,GetCurrentConversations:CnnXt.Storage.GetCurrentConversations,GetCurrentConversation:CnnXt.Storage.GetCurrentConversation,GetCurrentMeterLevel:function(){return i.currentMeterLevel},GetCampaignData:CnnXt.Storage.GetCampaignData,GetRegistrationType:CnnXt.Storage.GetRegistrationType,GetActualZipCodes:CnnXt.Storage.GetActualZipCodes,GetCurrentConversationArticlesCount:CnnXt.Campaign.GetCurrentConversationViewCount,GetArticlesLeft:function(){var n=CnnXt.Storage.GetCurrentConversation();return n?n.Props.ArticleLeft:undefined},GetUserState:CnnXt.Storage.GetUserState,GetUserZipCodes:CnnXt.Storage.GetUserZipCodes,GetActualZipCodes:CnnXt.Storage.GetActualZipCodes,GetJanrainUser:CnnXt.Storage.GetJanrainUser,GetUserData:CnnXt.Storage.GetUserData,GetUserProfile:CnnXt.Storage.GetUserProfile,GetConnextPaywallCookie:CnnXt.Storage.GetConnextPaywallCookie},Common:{USER_STATES:CnnXt.Common.USER_STATES}}},Logger:ConnextLogger(n),Whitelist:ConnextWhitelist(n),MeterCalculation:ConnextMeterCalculation(n),Campaign:ConnextCampaign(n),Action:ConnextAction(n),Activation:ConnextActivation(n),Common:ConnextCommon(),Utils:ConnextUtils(n),API:ConnextAPI(n),Event:ConnextEvents(n),Storage:ConnextStorage(n),User:ConnextUser(n),AppInsights:ConnextAppInsights(n),CloseTemplates:tt,IntegrateProduct:it,Run:function(){CnnXt.Event.fire("onRun");w()},ReInit:et,GetVersion:function(){return b},GetCurrentVersion:function(){return"Version: "+window.connextVersion+", Build: "+window.connextBuild},GetOptions:function(){return i},ShowContent:function(){CnnXt.Action.ShowContent()},fire:function(){},EventCompleted:function(n){CnnXt.Campaign.EventCompleted(n)},ConnextContinueProcessing:pt,DisplayName:ConnextCommon().DisplayName}}(jQuery),Connext={init:CnnXt.init};